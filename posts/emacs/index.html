<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Personal emacs configuration - EXPLORE THE WORLD, FULFILL YOUR BEING.</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Personal emacs configuration"><meta property="og:image" content><meta property="og:title" content="Personal emacs configuration"><meta property="og:description" content="Personal emacs configuration"><meta property="og:type" content="article"><meta property="og:url" content="https://jousimies.github.io/posts/emacs/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-03-08T00:54:00+08:00"><meta property="article:modified_time" content="2023-03-08T00:58:52+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Personal emacs configuration"><meta name=twitter:description content="Personal emacs configuration"><script src=https://jousimies.github.iojs/feather.min.js></script>
<link href=https://jousimies.github.io/css/fonts.2c2227b81b1970a03e760aa2e6121cd01f87c88586803cbb282aa224720a765f.css rel=stylesheet><link rel=stylesheet type=text/css media=screen href=https://jousimies.github.io/css/main.ac08a4c9714baa859217f92f051deb58df2938ec352b506df655005dcaf98cc0.css><link id=darkModeStyle rel=stylesheet type=text/css href=https://jousimies.github.io/css/dark.726cd11ca6eb7c4f7d48eb420354f814e5c1b94281aaf8fd0511c1319f7f78a4.css media="(prefers-color-scheme: dark)"><script type=text/javascript src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script type=text/x-mathjax-config>
		MathJax.Hub.Config({
			tex2jax: {
				inlineMath: [['$','$'], ['\\(','\\)']],
				displayMath: [['$$','$$'], ['\[','\]']],
				processEscapes: true,
				processEnvironments: true,
				skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
				TeX: { equationNumbers: { autoNumber: "AMS" },
						 extensions: ["AMSmath.js", "AMSsymbols.js"] }
			}
		});
		</script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js onload=renderMathInElement(document.body)></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script></head><body><div class=content><header><div class=main><a href=https://jousimies.github.io>EXPLORE THE WORLD, FULFILL YOUR BEING.</a></div><nav><a href=/>HOME</a>
<a href=/posts>POSTS</a>
<a href=/tags>TAGS</a>
<a href=/about>ABOUT</a></nav></header><main><article><div class=title><h1 class=title>Personal emacs configuration</h1><div class=meta>Posted on Mar 8, 2023</div></div><section class=body><h2 id=early-init>Early Init</h2><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#007f7f>;;; early-init.el --- Early Init File -*- lexical-binding: t; no-byte-compile: t -*-</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;; Profiling since here when in debug-mode</span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>when</span> init-file-debug
</span></span><span style=display:flex><span>  (profiler-start <span style=color:#0ff;font-weight:700>&#39;cpu</span>)
</span></span><span style=display:flex><span>  (add-hook <span style=color:#0ff;font-weight:700>&#39;window-setup-hook</span> #&#39;profiler-stop <span style=color:#ff0;font-weight:700>0</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;; Defer garbage collection further back in the startup process</span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> gc-cons-threshold most-positive-fixnum
</span></span><span style=display:flex><span>      gc-cons-percentage <span style=color:#ff0;font-weight:700>1.0</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;; Prevent the glimpse of un-styled Emacs by disabling these UI elements early.</span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>push</span> &#39;(menu-bar-lines . <span style=color:#ff0;font-weight:700>0</span>) default-frame-alist)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>push</span> &#39;(tool-bar-lines . <span style=color:#ff0;font-weight:700>0</span>) default-frame-alist)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>push</span> &#39;(vertical-scroll-bars . <span style=color:#ff0;font-weight:700>0</span>) default-frame-alist)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>push</span> &#39;(undecorated . t) default-frame-alist)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>push</span> &#39;(fullscreen . maximized) initial-frame-alist)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;; To suppress flashing at startup</span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq-default</span> inhibit-redisplay t
</span></span><span style=display:flex><span>              inhibit-message t)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(add-hook <span style=color:#0ff;font-weight:700>&#39;after-init-hook</span>
</span></span><span style=display:flex><span>          (<span style=color:#fff;font-weight:700>lambda</span> ()
</span></span><span style=display:flex><span>            (<span style=color:#fff;font-weight:700>setq-default</span> inhibit-redisplay nil
</span></span><span style=display:flex><span>                          inhibit-message nil)
</span></span><span style=display:flex><span>            (redisplay)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;; Disable mode-line when emacs startup.</span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq-default</span> mode-line-format nil)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> byte-compile-warnings nil)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(fset <span style=color:#0ff;font-weight:700>&#39;display-startup-echo-area-message</span> <span style=color:#0ff;font-weight:700>&#39;ignore</span>)
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; early-init.el ends here</span>
</span></span></code></pre></div><h2 id=init>Init</h2><h3 id=header>Header</h3><p>关于 lexical-binding 的作用见 <a href=https://nullprogram.com/blog/2016/12/22/>Make Emacs run (slightly) faster with lexical binding</a> . 或者 <a href=http://www.yinwang.org/blog-cn/2013/03/26/lisp-dead-alive>Lisp 已死，Lisp 万岁！</a></p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#007f7f>;; init.el --- Personal Emacs Configuration -*- lexical-binding: t; no-byte-compile: t -*-</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Commentary:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Code:</span>
</span></span></code></pre></div><h3 id=speedup>Speedup</h3><p>这部份的内容来源：<a href=https://github.com/seagle0128/.emacs.d/blob/master/init.el>.emacs.d/init.el at master · seagle0128/.emacs.d</a>
可以加快 Emacs 的启动速度。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#007f7f>;; https://github.com/seagle0128/.emacs.d/blob/master/init.el</span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> auto-mode-case-fold nil)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>unless</span> (<span style=color:#fff;font-weight:700>or</span> (daemonp) noninteractive init-file-debug)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>let</span> ((old-file-name-handler-alist file-name-handler-alist))
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>setq</span> file-name-handler-alist nil)
</span></span><span style=display:flex><span>    (add-hook <span style=color:#0ff;font-weight:700>&#39;emacs-startup-hook</span>
</span></span><span style=display:flex><span>              (<span style=color:#fff;font-weight:700>lambda</span> ()
</span></span><span style=display:flex><span>                <span style=color:#0ff;font-weight:700>&#34;Recover file name handlers.&#34;</span>
</span></span><span style=display:flex><span>                (<span style=color:#fff;font-weight:700>setq</span> file-name-handler-alist
</span></span><span style=display:flex><span>                      (delete-dups (append file-name-handler-alist
</span></span><span style=display:flex><span>                                           old-file-name-handler-alist)))))))
</span></span></code></pre></div><h3 id=path>PATH</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>require</span> <span style=color:#0ff;font-weight:700>&#39;cl-lib</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> add-subdirs-to-load-path (search-dir)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>let*</span> ((dir (file-name-as-directory search-dir)))
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>dolist</span> (subdir
</span></span><span style=display:flex><span>         <span style=color:#007f7f>;; 过滤出不必要的目录，提升Emacs启动速度</span>
</span></span><span style=display:flex><span>         (cl-remove-if
</span></span><span style=display:flex><span>      #&#39;(<span style=color:#fff;font-weight:700>lambda</span> (subdir)
</span></span><span style=display:flex><span>          (<span style=color:#fff;font-weight:700>or</span>
</span></span><span style=display:flex><span>           <span style=color:#007f7f>;; 不是目录的文件都移除</span>
</span></span><span style=display:flex><span>           (not (file-directory-p (concat dir subdir)))
</span></span><span style=display:flex><span>           <span style=color:#007f7f>;; 父目录、 语言相关和版本控制目录都移除</span>
</span></span><span style=display:flex><span>           (member subdir &#39;(<span style=color:#0ff;font-weight:700>&#34;.&#34;</span> <span style=color:#0ff;font-weight:700>&#34;..&#34;</span>
</span></span><span style=display:flex><span>                    <span style=color:#0ff;font-weight:700>&#34;dist&#34;</span> <span style=color:#0ff;font-weight:700>&#34;node_modules&#34;</span> <span style=color:#0ff;font-weight:700>&#34;__pycache__&#34;</span>
</span></span><span style=display:flex><span>                    <span style=color:#0ff;font-weight:700>&#34;RCS&#34;</span> <span style=color:#0ff;font-weight:700>&#34;CVS&#34;</span> <span style=color:#0ff;font-weight:700>&#34;rcs&#34;</span> <span style=color:#0ff;font-weight:700>&#34;cvs&#34;</span> <span style=color:#0ff;font-weight:700>&#34;.git&#34;</span> <span style=color:#0ff;font-weight:700>&#34;.github&#34;</span>))))
</span></span><span style=display:flex><span>      (directory-files dir)))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>let</span> ((subdir-path (concat dir (file-name-as-directory subdir))))
</span></span><span style=display:flex><span>    <span style=color:#007f7f>;; 目录下有 .el .so .dll 文件的路径才添加到 `load-path&#39; 中，提升Emacs启动速度</span>
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>when</span> (cl-some #&#39;(<span style=color:#fff;font-weight:700>lambda</span> (subdir-file)
</span></span><span style=display:flex><span>               (<span style=color:#fff;font-weight:700>and</span> (file-regular-p (concat subdir-path subdir-file))
</span></span><span style=display:flex><span>                <span style=color:#007f7f>;; .so .dll 文件指非Elisp语言编写的Emacs动态库</span>
</span></span><span style=display:flex><span>                (member (file-name-extension subdir-file) &#39;(<span style=color:#0ff;font-weight:700>&#34;el&#34;</span> <span style=color:#0ff;font-weight:700>&#34;so&#34;</span> <span style=color:#0ff;font-weight:700>&#34;dll&#34;</span>))))
</span></span><span style=display:flex><span>           (directory-files subdir-path))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#007f7f>;; 注意：`add-to-list&#39; 函数的第三个参数必须为 t ，表示加到列表末尾</span>
</span></span><span style=display:flex><span>      <span style=color:#007f7f>;; 这样Emacs会从父目录到子目录的顺序搜索Elisp插件，顺序反过来会导致Emacs无法正常启动</span>
</span></span><span style=display:flex><span>      (add-to-list <span style=color:#0ff;font-weight:700>&#39;load-path</span> subdir-path t))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#007f7f>;; 继续递归搜索子目录</span>
</span></span><span style=display:flex><span>    (add-subdirs-to-load-path subdir-path)))))
</span></span><span style=display:flex><span>(add-subdirs-to-load-path <span style=color:#0ff;font-weight:700>&#34;~/.emacs.d/packages&#34;</span>)
</span></span><span style=display:flex><span>(add-to-list <span style=color:#0ff;font-weight:700>&#39;load-path</span> <span style=color:#0ff;font-weight:700>&#34;~/.emacs.d/lisp&#34;</span>)
</span></span></code></pre></div><p>如果使用 emacs-plus, 会自动的添加到 path 当中，或者使用<a href=https://github.com/purcell/exec-path-from-shell>purcell/exec-path-from-shell: Make Emacs use the $PATH set up by the user&rsquo;s shell</a>. 或者使用下面的配置.</p><p>这部份的配置来源：<a href=https://www.emacswiki.org/emacs/ExecPath>EmacsWiki: Exec Path</a></p><p>不设置 <code>exec-path</code>, 在 MacOS 上有可能会提示找不到程序。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#007f7f>;; https://www.emacswiki.org/emacs/ExecPath</span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> set-exec-path-from-shell-PATH ()
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;This is particularly useful under Mac OS X and macOS.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>let</span> ((path-from-shell (replace-regexp-in-string
</span></span><span style=display:flex><span>                          <span style=color:#0ff;font-weight:700>&#34;[ \t\n]*$&#34;</span> <span style=color:#0ff;font-weight:700>&#34;&#34;</span> (shell-command-to-string
</span></span><span style=display:flex><span>                                          <span style=color:#0ff;font-weight:700>&#34;$SHELL --login -c &#39;echo $PATH&#39;&#34;</span>))))
</span></span><span style=display:flex><span>    (setenv <span style=color:#0ff;font-weight:700>&#34;PATH&#34;</span> path-from-shell)
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>setq</span> exec-path (split-string path-from-shell path-separator))))
</span></span><span style=display:flex><span>(set-exec-path-from-shell-PATH)
</span></span></code></pre></div><h3 id=utility-hooks-and-functions>Utility Hooks and Functions</h3><p>这个 <a href=https://github.com/ajgrf/on.el/tree/master/>ajgrf/on.el: Hooks for faster Emacs startup – GitHub mirror</a> 增加了一些有用的 hook，可以控制包的启动时机。</p><p>更多参见：<a href=https://github.com/emacs-magus>emacs-magus</a>.</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> on)
</span></span></code></pre></div><h3 id=variables>Variables</h3><p>定义一些变量，方便配置文件位置或针对特定系统进行相关设定。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defvar</span> my-cloud <span style=color:#0ff;font-weight:700>&#34;~/Nextcloud&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;This folder is My cloud.&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;; L.Personal.Galaxy location may change, but folders in this directory never change.</span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defvar</span> my-galaxy (expand-file-name <span style=color:#0ff;font-weight:700>&#34;L.Personal.Galaxy&#34;</span> my-cloud)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;This folder stores all the plain text files of my life.&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defvar</span> website-directory <span style=color:#0ff;font-weight:700>&#34;~/Nextcloud/L.Personal.Galaxy/website&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;The source folder of my blog.&#34;</span>)
</span></span></code></pre></div><p><a href=https://github.com/emacscollective/no-littering>https://github.com/emacscollective/no-littering</a>, 会将一些包产生的文件集中放置到 etc 和 var 两个文件夹中，而不是散落在 user-emacs-directory 当中。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> no-littering)
</span></span></code></pre></div><h3 id=require-configurations>Require configurations</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>require</span> <span style=color:#0ff;font-weight:700>&#39;init-benchmark</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>require</span> <span style=color:#0ff;font-weight:700>&#39;init-evil</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>require</span> <span style=color:#0ff;font-weight:700>&#39;init-edit</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>require</span> <span style=color:#0ff;font-weight:700>&#39;init-ui</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>require</span> <span style=color:#0ff;font-weight:700>&#39;init-builtin</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>require</span> <span style=color:#0ff;font-weight:700>&#39;init-auto-save</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>require</span> <span style=color:#0ff;font-weight:700>&#39;init-server</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>require</span> <span style=color:#0ff;font-weight:700>&#39;init-git</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>require</span> <span style=color:#0ff;font-weight:700>&#39;init-del</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>require</span> <span style=color:#0ff;font-weight:700>&#39;init-template</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>require</span> <span style=color:#0ff;font-weight:700>&#39;init-edit</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>require</span> <span style=color:#0ff;font-weight:700>&#39;init-completion</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>require</span> <span style=color:#0ff;font-weight:700>&#39;init-helpful</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>require</span> <span style=color:#0ff;font-weight:700>&#39;init-search</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>require</span> <span style=color:#0ff;font-weight:700>&#39;init-undo</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>require</span> <span style=color:#0ff;font-weight:700>&#39;init-spell</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>require</span> <span style=color:#0ff;font-weight:700>&#39;init-translate</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>require</span> <span style=color:#0ff;font-weight:700>&#39;init-language</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>require</span> <span style=color:#0ff;font-weight:700>&#39;init-org</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>require</span> <span style=color:#0ff;font-weight:700>&#39;init-org+</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>require</span> <span style=color:#0ff;font-weight:700>&#39;init-note-taking</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>require</span> <span style=color:#0ff;font-weight:700>&#39;init-blog</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>require</span> <span style=color:#0ff;font-weight:700>&#39;init-gtd</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>require</span> <span style=color:#0ff;font-weight:700>&#39;init-bib</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>require</span> <span style=color:#0ff;font-weight:700>&#39;init-finance</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>require</span> <span style=color:#0ff;font-weight:700>&#39;init-latex</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>require</span> <span style=color:#0ff;font-weight:700>&#39;init-rime</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>require</span> <span style=color:#0ff;font-weight:700>&#39;init-reader</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>require</span> <span style=color:#0ff;font-weight:700>&#39;init-elfeed</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>require</span> <span style=color:#0ff;font-weight:700>&#39;init-mail</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>require</span> <span style=color:#0ff;font-weight:700>&#39;init-browser</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>require</span> <span style=color:#0ff;font-weight:700>&#39;init-vterm</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>require</span> <span style=color:#0ff;font-weight:700>&#39;init-misc</span>)
</span></span></code></pre></div><h3 id=custom>Custom</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> custom-file (locate-user-emacs-file <span style=color:#0ff;font-weight:700>&#34;custom.el&#34;</span>))
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>when</span> (file-exists-p custom-file)
</span></span><span style=display:flex><span>  (load custom-file))
</span></span></code></pre></div><h3 id=show-startup-info>Show startup info</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(add-hook <span style=color:#0ff;font-weight:700>&#39;window-setup-hook</span>
</span></span><span style=display:flex><span>          (<span style=color:#fff;font-weight:700>lambda</span> ()
</span></span><span style=display:flex><span>            (garbage-collect)
</span></span><span style=display:flex><span>            (<span style=color:#fff;font-weight:700>let</span> ((curtime (current-time)))
</span></span><span style=display:flex><span>              (message <span style=color:#0ff;font-weight:700>&#34;Times: init:%.06f total:%.06f gc-done:%d&#34;</span>
</span></span><span style=display:flex><span>                       (float-time (time-subtract after-init-time before-init-time))
</span></span><span style=display:flex><span>                       (float-time (time-subtract curtime before-init-time))
</span></span><span style=display:flex><span>                       gcs-done)))
</span></span><span style=display:flex><span>          <span style=color:#ff0;font-weight:700>90</span>)
</span></span></code></pre></div><h3 id=footer>Footer</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#007f7f>;;; init.el ends here.</span>
</span></span></code></pre></div><h2 id=benchmark>Benchmark</h2><h3 id=header>Header</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#007f7f>;; init-benchmark.el --- benchmark *- lexical-binding: t; no-byte-compile: t -*-</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Commentary:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Code:</span>
</span></span></code></pre></div><h3 id=benchmark>Benchmark</h3><p>可以使用的配置：<a href=https://github.com/purcell/emacs.d/blob/master/lisp/init-benchmarking.el>emacs.d/init-benchmarking.el at master · purcell/emacs.d</a></p><p>Emacs 进行性检检测还可以使用<a href=https://github.com/dholm/benchmark-init-el>dholm/benchmark-init-el: Benchmark your Emacs initialization</a> 或者<a href=https://github.com/jschaf/esup>jschaf/esup: ESUP - Emacs Start Up Profiler</a>.</p><p>相比较与使用 Emacs 内置的 <code>package.el</code>, 使用 borg 管理包，Emacs 的启动时间有一个明显的优化。</p><p>为了提高 Emacs 的启动速度，需要做的几个方面包括：<a href=#speedup>Speedup</a>, <a href=#path>PATH</a>, <a href=#early-init>Early Init</a>, 以及使用 gcmh 管理使用时的 Garbage collection 行为。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#007f7f>;; https://github.com/purcell/emacs.d/blob/master/lisp/init-benchmarking.el</span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> sanityinc/time-subtract-millis (b a)
</span></span><span style=display:flex><span>  (* <span style=color:#ff0;font-weight:700>1000.0</span> (float-time (time-subtract b a))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defvar</span> sanityinc/require-times nil
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;A list of (FEATURE LOAD-START-TIME LOAD-DURATION).
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>LOAD-DURATION is the time taken in milliseconds to load FEATURE.&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> sanityinc/require-times-wrapper (orig feature <span style=color:#fff;font-weight:700>&amp;rest</span> args)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Note in </span><span style=color:#0ff;font-weight:700>`sanityinc/require-times&#39;</span><span style=color:#0ff;font-weight:700> the time taken to require each feature.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>let*</span> ((already-loaded (memq feature features))
</span></span><span style=display:flex><span>         (require-start-time (<span style=color:#fff;font-weight:700>and</span> (not already-loaded) (current-time))))
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>prog1</span>
</span></span><span style=display:flex><span>        (apply orig feature args)
</span></span><span style=display:flex><span>      (<span style=color:#fff;font-weight:700>when</span> (<span style=color:#fff;font-weight:700>and</span> (not already-loaded) (memq feature features))
</span></span><span style=display:flex><span>        (<span style=color:#fff;font-weight:700>let</span> ((time (sanityinc/time-subtract-millis (current-time) require-start-time)))
</span></span><span style=display:flex><span>          (add-to-list <span style=color:#0ff;font-weight:700>&#39;sanityinc/require-times</span>
</span></span><span style=display:flex><span>                       (list feature require-start-time time)
</span></span><span style=display:flex><span>                       t))))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(advice-add <span style=color:#0ff;font-weight:700>&#39;require</span> <span style=color:#fff;font-weight:700>:around</span> <span style=color:#0ff;font-weight:700>&#39;sanityinc/require-times-wrapper</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>define-derived-mode</span> sanityinc/require-times-mode tabulated-list-mode <span style=color:#0ff;font-weight:700>&#34;Require-Times&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Show times taken to </span><span style=color:#0ff;font-weight:700>`require&#39;</span><span style=color:#0ff;font-weight:700> packages.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> tabulated-list-format
</span></span><span style=display:flex><span>        [(<span style=color:#0ff;font-weight:700>&#34;Start time (ms)&#34;</span> <span style=color:#ff0;font-weight:700>20</span> sanityinc/require-times-sort-by-start-time-pred)
</span></span><span style=display:flex><span>         (<span style=color:#0ff;font-weight:700>&#34;Feature&#34;</span> <span style=color:#ff0;font-weight:700>30</span> t)
</span></span><span style=display:flex><span>         (<span style=color:#0ff;font-weight:700>&#34;Time (ms)&#34;</span> <span style=color:#ff0;font-weight:700>12</span> sanityinc/require-times-sort-by-load-time-pred)])
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> tabulated-list-sort-key (cons <span style=color:#0ff;font-weight:700>&#34;Start time (ms)&#34;</span> nil))
</span></span><span style=display:flex><span>  <span style=color:#007f7f>;; (setq tabulated-list-padding 2)</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> tabulated-list-entries #&#39;sanityinc/require-times-tabulated-list-entries)
</span></span><span style=display:flex><span>  (tabulated-list-init-header)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>when</span> (fboundp <span style=color:#0ff;font-weight:700>&#39;tablist-minor-mode</span>)
</span></span><span style=display:flex><span>    (tablist-minor-mode)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> sanityinc/require-times-sort-by-start-time-pred (entry1 entry2)
</span></span><span style=display:flex><span>  (&lt; (string-to-number (elt (nth <span style=color:#ff0;font-weight:700>1</span> entry1) <span style=color:#ff0;font-weight:700>0</span>))
</span></span><span style=display:flex><span>     (string-to-number (elt (nth <span style=color:#ff0;font-weight:700>1</span> entry2) <span style=color:#ff0;font-weight:700>0</span>))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> sanityinc/require-times-sort-by-load-time-pred (entry1 entry2)
</span></span><span style=display:flex><span>  (&gt; (string-to-number (elt (nth <span style=color:#ff0;font-weight:700>1</span> entry1) <span style=color:#ff0;font-weight:700>2</span>))
</span></span><span style=display:flex><span>     (string-to-number (elt (nth <span style=color:#ff0;font-weight:700>1</span> entry2) <span style=color:#ff0;font-weight:700>2</span>))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> sanityinc/require-times-tabulated-list-entries ()
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>cl-loop</span> for (feature start-time millis) in sanityinc/require-times
</span></span><span style=display:flex><span>           with order = <span style=color:#ff0;font-weight:700>0</span>
</span></span><span style=display:flex><span>           <span style=color:#fff;font-weight:700>do</span> (<span style=color:#fff;font-weight:700>cl-incf</span> order)
</span></span><span style=display:flex><span>           collect (list order
</span></span><span style=display:flex><span>                         (vector
</span></span><span style=display:flex><span>                          (format <span style=color:#0ff;font-weight:700>&#34;%.3f&#34;</span> (sanityinc/time-subtract-millis start-time before-init-time))
</span></span><span style=display:flex><span>                          (symbol-name feature)
</span></span><span style=display:flex><span>                          (format <span style=color:#0ff;font-weight:700>&#34;%.3f&#34;</span> millis)))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> sanityinc/require-times ()
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Show a tabular view of how long various libraries took to load.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>with-current-buffer</span> (get-buffer-create <span style=color:#0ff;font-weight:700>&#34;*Require Times*&#34;</span>)
</span></span><span style=display:flex><span>    (sanityinc/require-times-mode)
</span></span><span style=display:flex><span>    (tabulated-list-revert)
</span></span><span style=display:flex><span>    (display-buffer (current-buffer))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> sanityinc/show-init-time ()
</span></span><span style=display:flex><span>  (message <span style=color:#0ff;font-weight:700>&#34;init completed in %.2fms&#34;</span>
</span></span><span style=display:flex><span>           (sanityinc/time-subtract-millis after-init-time before-init-time)))
</span></span></code></pre></div><h3 id=footer>Footer</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>provide</span> <span style=color:#0ff;font-weight:700>&#39;init-benchmark</span>)
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; init-beanchmark.el ends here.</span>
</span></span></code></pre></div><h2 id=rudimentary-configuration>Rudimentary Configuration</h2><p>在经历了多种尝试之后，我最终选择了 Evil 模式编辑，其他的模式编辑有 <a href=https://github.com/meow-edit/meow>meow-edit/meow: Yet another modal editing on Emacs / 猫态编辑</a>.</p><p>我不使用 Meow 是因为它只能在 Emacs 中使用。</p><p>也曾经长时间使用过 Emacs 的原生按键方式，该体验在 Mac 系统上具有较好的一致性，但是原生按键方式有点费手。</p><h3 id=header>Header</h3><p>关于 lexical-binding 的作用见 <a href=https://nullprogram.com/blog/2016/12/22/>Make Emacs run (slightly) faster with lexical binding</a> . 或者 <a href=http://www.yinwang.org/blog-cn/2013/03/26/lisp-dead-alive>Lisp 已死，Lisp 万岁！</a></p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#007f7f>;; init-evil.el --- Personal Emacs Configuration -*- lexical-binding: t; no-byte-compile: t -*-</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Commentary:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Code:</span>
</span></span></code></pre></div><h3 id=evil>evil</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> evil
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:bind</span> (<span style=color:#fff;font-weight:700>:map</span> evil-insert-state-map
</span></span><span style=display:flex><span>              (<span style=color:#0ff;font-weight:700>&#34;C-e&#34;</span> . move-end-of-line)
</span></span><span style=display:flex><span>              (<span style=color:#0ff;font-weight:700>&#34;C-k&#34;</span> . kill-line))
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> ((after-init . evil-mode)
</span></span><span style=display:flex><span>         (after-change-major-mode . (<span style=color:#fff;font-weight:700>lambda</span> ()
</span></span><span style=display:flex><span>                                      (<span style=color:#fff;font-weight:700>setq-local</span> evil-shift-width tab-width))))
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:init</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> evil-want-keybinding nil)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> evil-want-integration t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> evil-want-C-u-scroll t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> evil-want-C-h-delete t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> evil-respect-visual-line-mode t)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> evil-undo-system <span style=color:#0ff;font-weight:700>&#39;undo-fu</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> evil-visual-state-cursor <span style=color:#0ff;font-weight:700>&#39;hollow</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> evil-normal-state-tag <span style=color:#0ff;font-weight:700>&#34; 𝐍 &#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> evil-insert-state-tag <span style=color:#0ff;font-weight:700>&#34; 𝐈 &#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> evil-motion-state-tag <span style=color:#0ff;font-weight:700>&#34; 𝐌 &#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> evil-visual-state-tag <span style=color:#0ff;font-weight:700>&#34; 𝐕 &#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> evil-replace-state-tag <span style=color:#0ff;font-weight:700>&#34; 𝐑 &#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> evil-operator-state-tag <span style=color:#0ff;font-weight:700>&#34; O &#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> evil-emacs-state-tag <span style=color:#0ff;font-weight:700>&#34; E &#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(global-set-key (kbd <span style=color:#0ff;font-weight:700>&#34;C-M-u&#34;</span>) <span style=color:#0ff;font-weight:700>&#39;universal-argument</span>)
</span></span></code></pre></div><p>下面的配置来源：<a href=https://github.com/redguardtoo/emacs.d/blob/master/lisp/init-evil.el>emacs.d/init-evil.el at master · redguardtoo/emacs.d</a></p><h3 id=evil-collection>evil-collection</h3><p><a href=https://github.com/emacs-evil/evil-collection>emacs-evil/evil-collection: A set of keybindings for evil-mode</a> 设置 Major mode 下的按键绑定，比自己一一设置要方便。若没有你使用的，可以提 PR.</p><p>我使用 <code>SPC</code> 作为 <code>leader key</code>, 这个键在 evil-collection 的 major mode 中被配置成了其他的功能，可以通过设置 <code>evil-collection-key-blacklist</code> 禁用 <code>SPC</code> 键。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> evil-collection
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:after</span> evil
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> evil-collection-key-blacklist &#39;(<span style=color:#0ff;font-weight:700>&#34;SPC&#34;</span> <span style=color:#0ff;font-weight:700>&#34;,&#34;</span>))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> forge-add-default-bindings nil)
</span></span><span style=display:flex><span>  (evil-collection-init))
</span></span></code></pre></div><h3 id=evil-commentary>evil-commentary</h3><p><a href=https://github.com/linktohack/evil-commentary>linktohack/evil-commentary: Comment stuff out. A port of vim-commentary</a> 通过使用 <code>gcc</code> 添加注释，在 Mac 上可以通过使用 <code>s-/</code> 进行。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> evil-commentary
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (on-first-file . evil-commentary-mode))
</span></span></code></pre></div><h3 id=evil-surround>evil-surround</h3><p><a href=https://github.com/emacs-evil/evil-surround>emacs-evil/evil-surround: you will be surrounded (surround.vim for evil, the extensible vi layer)</a> 可以在指定的区域添加成对的符号，具体使用参见以上页面。</p><p>具体的使用是对于 visual 状态，使用 <code>S =</code> 来插入成对的等于号，其他的符号同理。若要修改的话，使用 <code>cs = *</code> 来将等于号改为星号，其他的符号同理。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> evil-surround
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (on-first-file . global-evil-surround-mode))
</span></span></code></pre></div><h3 id=evil-embrace>evil-embrace</h3><p><a href=https://github.com/cute-jumper/evil-embrace.el>cute-jumper/evil-embrace.el: Evil integration of embrace.el</a> 具有和 evil-surround 相似的功能。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> evil-embrace
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (org-mode . embrace-org-mode-hook)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (evil-embrace-enable-evil-surround-integration))
</span></span></code></pre></div><h3 id=which-key-mode>which-key-mode</h3><p><a href=https://github.com/justbur/emacs-which-key>justbur/emacs-which-key: Emacs package that displays available keybindings in popup</a> 可以提示按键，对于不常使用的按键序列，有时想不起来，有提示还是很方便的。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> which-key
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (after-init . which-key-mode)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> which-key-show-early-on-C-h t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> which-key-idle-delay <span style=color:#ff0;font-weight:700>10000</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> which-key-idle-secondary-delay <span style=color:#ff0;font-weight:700>0.05</span>))
</span></span></code></pre></div><h3 id=general>general</h3><p><a href=https://github.com/noctuid/general.el>noctuid/general.el: More convenient key definitions in emacs</a> 结合 Evil 可以设置一系列的按键绑定，相对于 Emacs 原生的按键方式，序列化的按键比较友好。</p><p>具体的使用方式见 package 的 README 文件。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> general
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (general-create-definer my/space-leader-def
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>:prefix</span> <span style=color:#0ff;font-weight:700>&#34;SPC&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>:non-normal-prefix</span> <span style=color:#0ff;font-weight:700>&#34;M-SPC&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>:states</span> &#39;(normal visual insert emacs)))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(general-create-definer my/comma-leader-def
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:prefix</span> <span style=color:#0ff;font-weight:700>&#34;,&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:non-normal-prefix</span> <span style=color:#0ff;font-weight:700>&#34;M-,&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:states</span> &#39;(normal visual insert emacs))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> my/emacs-config ()
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;My literate Emacs configuration.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>  (find-file (expand-file-name <span style=color:#0ff;font-weight:700>&#34;emacs.org&#34;</span> user-emacs-directory)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(my/space-leader-def
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;f&#34;</span> &#39;(<span style=color:#fff;font-weight:700>:ignore</span> t <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Files&#34;</span>))
</span></span></code></pre></div><p>为了重用 g 绑定的按键，需要先将其上的键绑定取消掉。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>with-eval-after-load</span> <span style=color:#0ff;font-weight:700>&#39;evil</span>
</span></span><span style=display:flex><span>  (evil-define-key &#39;(normal motion visual) <span style=color:#0ff;font-weight:700>&#39;global</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;ge&#34;</span> nil
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;gn&#34;</span> nil))
</span></span></code></pre></div><h3 id=footer>Footer</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>provide</span> <span style=color:#0ff;font-weight:700>&#39;init-evil</span>)
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; init-evil.el ends here.</span>
</span></span></code></pre></div><h2 id=emacs-user-interface-delicious>Emacs User Interface, Delicious</h2><h3 id=header>Header</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#007f7f>;; init-ui.el --- UI *- lexical-binding: t; no-byte-compile: t -*-</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Commentary:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Code:</span>
</span></span></code></pre></div><h3 id=fonts>Fonts</h3><p><code>Insevka Fixed</code> 和 <code>Source Han Serif SC</code> 这两个字体等宽，在 org-mode 中可以对齐表格。</p><p>尝试过 <code>variable-pitch-mode</code> 和 <code>fixed-pitch-mode</code>, 不好用。</p><p>不设置 charset，在 MacOS 上默认使用 <code>PingFanc SC</code> 字体，看起来也可以。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(set-face-attribute <span style=color:#0ff;font-weight:700>&#39;default</span> nil <span style=color:#fff;font-weight:700>:font</span> <span style=color:#0ff;font-weight:700>&#34;Iosevka Term&#34;</span> <span style=color:#fff;font-weight:700>:height</span> <span style=color:#ff0;font-weight:700>160</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>if</span> (display-graphic-p)
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>dolist</span> (charset &#39;(kana han cjk-misc bopomofo))
</span></span><span style=display:flex><span>      (set-fontset-font (frame-parameter nil <span style=color:#0ff;font-weight:700>&#39;font</span>)
</span></span><span style=display:flex><span>                        charset (font-spec <span style=color:#fff;font-weight:700>:family</span> <span style=color:#0ff;font-weight:700>&#34;Source Han Serif SC&#34;</span> <span style=color:#fff;font-weight:700>:height</span> <span style=color:#ff0;font-weight:700>140</span>)) t <span style=color:#0ff;font-weight:700>&#39;prepend</span>))
</span></span></code></pre></div><h3 id=themes>Themes</h3><p>当前内置的 Modus-themes 主题看起来很好，I like it.</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> modus-themes
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> modus-themes-bold-constructs t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> modus-themes-italic-constructs t)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> modus-themes-common-palette-overrides
</span></span><span style=display:flex><span>    &#39;(<span style=color:#007f7f>;; mode-line</span>
</span></span><span style=display:flex><span>      (border-mode-line-active unspecified)
</span></span><span style=display:flex><span>      (border-mode-line-inactive unspecified)
</span></span><span style=display:flex><span>      (bg-mode-line-active bg-main)
</span></span><span style=display:flex><span>      (fg-mode-line-active fg-main)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#007f7f>;; line-number</span>
</span></span><span style=display:flex><span>      (fg-line-number-inactive <span style=color:#0ff;font-weight:700>&#34;gray50&#34;</span>)
</span></span><span style=display:flex><span>      (fg-line-number-active red-cooler)
</span></span><span style=display:flex><span>      (bg-line-number-inactive unspecified)
</span></span><span style=display:flex><span>      (bg-line-number-active unspecified)
</span></span><span style=display:flex><span>      <span style=color:#007f7f>;; link</span>
</span></span><span style=display:flex><span>      (underline-link border)
</span></span><span style=display:flex><span>      (underline-link-visited border)
</span></span><span style=display:flex><span>      (underline-link-symbolic border)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#007f7f>;; org agenda</span>
</span></span><span style=display:flex><span>      (date-common cyan)   <span style=color:#007f7f>; default value (for timestamps and more)</span>
</span></span><span style=display:flex><span>      (date-deadline red-warmer)
</span></span><span style=display:flex><span>      (date-event magenta-warmer)
</span></span><span style=display:flex><span>      (date-holiday blue) <span style=color:#007f7f>; for M-x calendar</span>
</span></span><span style=display:flex><span>      (date-now yellow-warmer)
</span></span><span style=display:flex><span>      (date-scheduled magenta-cooler)
</span></span><span style=display:flex><span>      (date-weekday cyan-cooler)
</span></span><span style=display:flex><span>      (date-weekend blue-faint)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#007f7f>;; org heading</span>
</span></span><span style=display:flex><span>      (fg-heading-1 blue-warmer)
</span></span><span style=display:flex><span>      (fg-heading-2 yellow-cooler)
</span></span><span style=display:flex><span>      (fg-heading-3 cyan-cooler)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> modus-themes-prompts &#39;(extrabold italic))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> modus-themes-completions
</span></span><span style=display:flex><span>    &#39;((matches . (extrabold))
</span></span><span style=display:flex><span>      (selection . (semibold italic text-also)))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(load-theme <span style=color:#0ff;font-weight:700>&#39;modus-operandi</span> t)
</span></span></code></pre></div><h4 id=theme-switch>Theme switch</h4><p>emacs-plus can switch themes by system. 通过增加的补定实现的此功能，若是不使用这种方法，还有 <a href=https://github.com/LionyxML/auto-dark-emacs>auto-dark-emacs</a> 可以使用。</p><p>使用 <a href=https://github.com/mclear-tools/build-emacs-macos/tree/main/>mclear-tools/build-emacs-macos: Build script for emacs and macos</a> 自编译 Emacs 也有改变主题的 patch.</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> my/apply-theme (appearance)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Load theme, taking current system APPEARANCE into consideration.&#34;</span>
</span></span><span style=display:flex><span>  (mapc #&#39;disable-theme custom-enabled-themes)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>pcase</span> appearance
</span></span><span style=display:flex><span>    (<span style=color:#0ff;font-weight:700>&#39;light</span> (load-theme <span style=color:#0ff;font-weight:700>&#39;modus-operandi</span> t))
</span></span><span style=display:flex><span>    (<span style=color:#0ff;font-weight:700>&#39;dark</span> (load-theme <span style=color:#0ff;font-weight:700>&#39;modus-vivendi</span> t))))
</span></span><span style=display:flex><span>(add-hook <span style=color:#0ff;font-weight:700>&#39;ns-system-appearance-change-functions</span> #&#39;my/apply-theme)
</span></span></code></pre></div><h3 id=fringe-mode>fringe-mode</h3><p>因为我要使用 <a href=#org-transclusion>org-transclusion</a>, 所以不能默认不显示 fringe. 将其设置为最小模式。</p><p>fringe-mode 需要跟一个 cons cell, 直接使用 minimal 会报错。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(define-fringe-bitmap <span style=color:#0ff;font-weight:700>&#39;right-curly-arrow</span>  [])
</span></span><span style=display:flex><span>(define-fringe-bitmap <span style=color:#0ff;font-weight:700>&#39;left-curly-arrow</span>  [])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(fringe-mode &#39;(<span style=color:#ff0;font-weight:700>1</span> . <span style=color:#ff0;font-weight:700>1</span>))
</span></span></code></pre></div><h3 id=hl-line-mode>hl-line-mode</h3><p>高亮当前行，全局开启使用 <code>global-hl-line-mode</code>.</p><p>不使用 <code>global-hl-line-mode</code> 因为不想在 dashboard 中开启行高亮。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(add-hook <span style=color:#0ff;font-weight:700>&#39;prog-mode-hook</span> <span style=color:#0ff;font-weight:700>&#39;hl-line-mode</span>)
</span></span><span style=display:flex><span>(add-hook <span style=color:#0ff;font-weight:700>&#39;org-mode-hook</span> <span style=color:#0ff;font-weight:700>&#39;hl-line-mode</span>)
</span></span></code></pre></div><h3 id=line-numbers>line numbers</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq-default</span> display-line-numbers-widen t)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> display-line-numbers-type <span style=color:#0ff;font-weight:700>&#39;relative</span>)
</span></span><span style=display:flex><span>(add-hook <span style=color:#0ff;font-weight:700>&#39;prog-mode-hook</span> <span style=color:#0ff;font-weight:700>&#39;display-line-numbers-mode</span>)
</span></span><span style=display:flex><span>(add-hook <span style=color:#0ff;font-weight:700>&#39;org-mode-hook</span> <span style=color:#0ff;font-weight:700>&#39;display-line-numbers-mode</span>)
</span></span><span style=display:flex><span>(add-hook <span style=color:#0ff;font-weight:700>&#39;LaTeX-mode-hook</span> <span style=color:#0ff;font-weight:700>&#39;display-line-numbers-mode</span>)
</span></span></code></pre></div><h3 id=scroll-bar-mode>scroll-bar-mode</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(scroll-bar-mode <span style=color:#ff0;font-weight:700>0</span>)
</span></span></code></pre></div><h3 id=fill-column-indicator>fill column indicator</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq-default</span> fill-column <span style=color:#ff0;font-weight:700>90</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(face-spec-set <span style=color:#0ff;font-weight:700>&#39;fill-column-indicator</span>
</span></span><span style=display:flex><span>               &#39;((default <span style=color:#fff;font-weight:700>:height</span> <span style=color:#ff0;font-weight:700>0.1</span>))
</span></span><span style=display:flex><span>               <span style=color:#0ff;font-weight:700>&#39;face-override-spec</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;; only show fill indicator in prog mode.</span>
</span></span><span style=display:flex><span>(add-hook <span style=color:#0ff;font-weight:700>&#39;prog-mode-hook</span> <span style=color:#0ff;font-weight:700>&#39;display-fill-column-indicator-mode</span>)
</span></span></code></pre></div><h3 id=paren>Paren</h3><p>显示对应的括号，这个在 elisp 中挺友好。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> show-paren-style <span style=color:#0ff;font-weight:700>&#39;parenthesis</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> show-paren-context-when-offscreen <span style=color:#0ff;font-weight:700>&#39;overlay</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(add-hook <span style=color:#0ff;font-weight:700>&#39;text-mode-hook</span> <span style=color:#0ff;font-weight:700>&#39;show-paren-mode</span>)
</span></span></code></pre></div><h3 id=cursor-and-color>Cursor and color</h3><p>默认关闭光标闪烁。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(blink-cursor-mode <span style=color:#ff0;font-weight:700>-1</span>)
</span></span></code></pre></div><p>使用 Evil，通过光标的颜色来提示当前的输入法状态，结合使用<a href=http://zzzm.ysepan.com/>三码郑码 / 至至郑码 （至简·至爱）zhengma.plus</a> 输入法，具有很好的使用体验，相当的明确感。</p><p>关于光标自动更换颜色，这里有个包可以使用：<a href=https://github.com/Eason0210/im-cursor-chg>Eason0210/im-cursor-chg</a>.</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> im--chinese-p ()
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Check if the current input state is Chinese.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>if</span> (<span style=color:#fff;font-weight:700>featurep</span> <span style=color:#0ff;font-weight:700>&#39;rime</span>)
</span></span><span style=display:flex><span>      (<span style=color:#fff;font-weight:700>and</span> (rime--should-enable-p)
</span></span><span style=display:flex><span>           (not (rime--should-inline-ascii-p))
</span></span><span style=display:flex><span>           current-input-method)
</span></span><span style=display:flex><span>    current-input-method))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> im-change-cursor-color ()
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Set cursor color depending on input method.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>  (set-cursor-color (<span style=color:#fff;font-weight:700>if</span> (im--chinese-p)
</span></span><span style=display:flex><span>                        <span style=color:#0ff;font-weight:700>&#34;red&#34;</span>
</span></span><span style=display:flex><span>                      (foreground-color-at-point))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(add-hook <span style=color:#0ff;font-weight:700>&#39;post-command-hook</span> <span style=color:#0ff;font-weight:700>&#39;im-change-cursor-color</span>)
</span></span></code></pre></div><p><a href=https://emacs-china.org/t/topic/17717/42>切换输入法时自动更换光标颜色 - Emacs-general - Emacs China</a> 提到了 <code>post-command-hook</code> 的开销比较大，调用频繁。</p><p>使用 evil 内置的 hook 也可以达到切换光标颜色的功能，同时避免 <code>post-command-hook</code> 的巨大开销。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> im--chinese-p ()
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Check if the current input state is Chinese.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>if</span> (<span style=color:#fff;font-weight:700>featurep</span> <span style=color:#0ff;font-weight:700>&#39;rime</span>)
</span></span><span style=display:flex><span>      (<span style=color:#fff;font-weight:700>and</span> (rime--should-enable-p)
</span></span><span style=display:flex><span>           (not (rime--should-inline-ascii-p))
</span></span><span style=display:flex><span>           current-input-method)
</span></span><span style=display:flex><span>    current-input-method))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(add-hook <span style=color:#0ff;font-weight:700>&#39;evil-insert-state-entry-hook</span>
</span></span><span style=display:flex><span>          (<span style=color:#fff;font-weight:700>lambda</span> ()
</span></span><span style=display:flex><span>            (<span style=color:#fff;font-weight:700>when</span> (im--chinese-p)
</span></span><span style=display:flex><span>              (set-cursor-color <span style=color:#0ff;font-weight:700>&#34;red&#34;</span>))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(add-hook <span style=color:#0ff;font-weight:700>&#39;evil-insert-state-exit-hook</span>
</span></span><span style=display:flex><span>          (<span style=color:#fff;font-weight:700>lambda</span> ()
</span></span><span style=display:flex><span>            (set-cursor-color (foreground-color-at-point))))
</span></span></code></pre></div><h3 id=frame>Frame</h3><p>窗口透明，更多见：<a href=https://emacs-china.org/t/emacs/2405/11>Emacs 透明窗口 - Emacs-general - Emacs China</a></p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(set-frame-parameter nil <span style=color:#0ff;font-weight:700>&#39;alpha</span> &#39;(<span style=color:#ff0;font-weight:700>90</span> . <span style=color:#ff0;font-weight:700>100</span>))
</span></span></code></pre></div><p>在 MacOS 上新建的 frame 总是位于屏幕的左上角。解决方案：<a href=https://christiantietze.de/posts/2021/06/emacs-center-window/>Automatically Center New Emacs Windows (Aka Frames) on Screen • Christian Tietze</a>.</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> ct/frame-center (<span style=color:#fff;font-weight:700>&amp;optional</span> frame)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Center a frame on the screen.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>let*</span> ((frame (<span style=color:#fff;font-weight:700>or</span> (<span style=color:#fff;font-weight:700>and</span> (boundp <span style=color:#0ff;font-weight:700>&#39;frame</span>) frame) (selected-frame)))
</span></span><span style=display:flex><span>         (center (ct/frame-get-center frame)))
</span></span><span style=display:flex><span>    (apply <span style=color:#0ff;font-weight:700>&#39;set-frame-position</span> (flatten-list (list frame center)))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> ct/screen-usable-height (<span style=color:#fff;font-weight:700>&amp;optional</span> display)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Return the usable height of the display.
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>Some window-systems have portions of the screen which Emacs
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>cannot address. This function should return the height of the
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>screen, minus anything which is not usable.&#34;</span>
</span></span><span style=display:flex><span>  (- (display-pixel-height display)
</span></span><span style=display:flex><span>     (<span style=color:#fff;font-weight:700>cond</span> ((eq window-system <span style=color:#0ff;font-weight:700>&#39;ns</span>) <span style=color:#ff0;font-weight:700>22</span>) <span style=color:#007f7f>;; macOS Menu Bar offset</span>
</span></span><span style=display:flex><span>           (t <span style=color:#ff0;font-weight:700>0</span>))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> ct/screen-usable-width (<span style=color:#fff;font-weight:700>&amp;optional</span> display)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Return the usable width of the display.&#34;</span>
</span></span><span style=display:flex><span>  (display-pixel-width display))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> ct/center-box (w h cw ch)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Center a box inside another box.
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>Returns a list of `(TOP LEFT)&#39; representing the centered position
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>of the box `(w h)&#39; inside the box `(cw ch)&#39;.&#34;</span>
</span></span><span style=display:flex><span>  (list (/ (- cw w) <span style=color:#ff0;font-weight:700>2</span>) (/ (- ch h) <span style=color:#ff0;font-weight:700>2</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> ct/frame-get-center (frame)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Return the center position of FRAME on it&#39;s display.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>let</span> ((disp (frame-parameter frame <span style=color:#0ff;font-weight:700>&#39;display</span>)))
</span></span><span style=display:flex><span>    (ct/center-box (frame-pixel-width frame) (frame-pixel-height frame)
</span></span><span style=display:flex><span>                   (ct/screen-usable-width disp) (ct/screen-usable-height disp))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> ct/frame-center (<span style=color:#fff;font-weight:700>&amp;optional</span> frame)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Center a frame on the screen.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>  (apply <span style=color:#0ff;font-weight:700>&#39;set-frame-position</span>
</span></span><span style=display:flex><span>         (<span style=color:#fff;font-weight:700>let*</span> ((frame (<span style=color:#fff;font-weight:700>or</span> (<span style=color:#fff;font-weight:700>and</span> (boundp <span style=color:#0ff;font-weight:700>&#39;frame</span>) frame) (selected-frame)))
</span></span><span style=display:flex><span>                (center (ct/frame-get-center frame)))
</span></span><span style=display:flex><span>           <span style=color:#007f7f>;; Flatten the X/Y list in `center` into a single list with `frame`</span>
</span></span><span style=display:flex><span>           <span style=color:#007f7f>;; so this list can be applied as parameters to `set-frame-position`:</span>
</span></span><span style=display:flex><span>           `(,frame ,@center))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(add-to-list <span style=color:#0ff;font-weight:700>&#39;after-make-frame-functions</span> #&#39;ct/frame-center <span style=color:#ff0;font-weight:700>0</span>)
</span></span></code></pre></div><p>默认的 make-frame 的按键是 <code>s-n</code>, 使用修改的函数实现了同一个按键，两种形为。我默认的 frame 是全屏使用，只在少数时候使用 make-frame 的功能。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> my/make-or-delete-frame ()
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>if</span> (= (frame-width) <span style=color:#ff0;font-weight:700>80</span>) <span style=color:#007f7f>;; 80 is the default frame width.</span>
</span></span><span style=display:flex><span>      (delete-frame)
</span></span><span style=display:flex><span>    (make-frame)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(global-set-key (kbd <span style=color:#0ff;font-weight:700>&#34;s-n&#34;</span>) <span style=color:#0ff;font-weight:700>&#39;my/make-or-delete-frame</span>)
</span></span></code></pre></div><h3 id=modeline>modeline</h3><h4 id=mode-line-format>mode-line-format</h4><p>2023-01-30 发现 doom-modeline 总是在不停的 <code>redisplay_internal</code> ，需要消耗较多的资源。所以暂时禁用此包，通过自定义 mode-line-format 来配置 modeline。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>210  56% + command-execute
</span></span><span style=display:flex><span> 94  25% + ...
</span></span><span style=display:flex><span> 62  16% - redisplay_internal (C function)
</span></span><span style=display:flex><span> 61  16%  - eval
</span></span><span style=display:flex><span> 51  13%   + doom-modeline-segment--buffer-info
</span></span><span style=display:flex><span>  9   2%   + doom-modeline-format--main
</span></span><span style=display:flex><span>  1   0%   + doom-modeline-segment--modals
</span></span></code></pre></div><p><a href=https://emacs.stackexchange.com/questions/5529/how-to-right-align-some-items-in-the-modeline>mode line - How to right align some items in the modeline? - Emacs Stack Exchange</a>
以下的函数来自上面的链接中的回答，使用 <code>string-width</code> 替代了 <code>length</code> ，否则在对含有中文的 heading 进行 org-clock 的时候，会导致超出 mode-line 只显示部份的 heading。</p><p>2023-02-01 Emacs 29 上使用 <code>string-pixel-width</code> 替代 <code>string-width</code> ，可以获得象素级对齐。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> my/mode-line-padding ()
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>let*</span> ((r-length (string-width (format-mode-line global-mode-string))))
</span></span><span style=display:flex><span>    (propertize <span style=color:#0ff;font-weight:700>&#34; &#34;</span>
</span></span><span style=display:flex><span>                <span style=color:#0ff;font-weight:700>&#39;display</span> `(space <span style=color:#fff;font-weight:700>:align-to</span> (- right ,(+ r-length <span style=color:#ff0;font-weight:700>1</span>))))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(add-to-list <span style=color:#0ff;font-weight:700>&#39;global-mode-string</span>
</span></span><span style=display:flex><span>             &#39;(<span style=color:#fff;font-weight:700>:eval</span> (propertize
</span></span><span style=display:flex><span>                      (concat
</span></span><span style=display:flex><span>                       <span style=color:#0ff;font-weight:700>&#34;𝚻𝚨𝚩 &#34;</span>
</span></span><span style=display:flex><span>                       (number-to-string (tab-bar--current-tab-index))
</span></span><span style=display:flex><span>                       <span style=color:#0ff;font-weight:700>&#34;: &#34;</span>
</span></span><span style=display:flex><span>                       (alist-get <span style=color:#0ff;font-weight:700>&#39;group</span> (tab-bar--current-tab))) <span style=color:#0ff;font-weight:700>&#39;face</span> <span style=color:#0ff;font-weight:700>&#39;font-lock-constant-face</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> mode-line-end-spaces
</span></span><span style=display:flex><span>      &#39;(<span style=color:#0ff;font-weight:700>&#34;&#34;</span>
</span></span><span style=display:flex><span>        global-mode-string))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> mode-line-position-column-line-format &#39;(<span style=color:#0ff;font-weight:700>&#34; %l,%c&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> mode-line-percent-position &#39;(<span style=color:#ff0;font-weight:700>-4</span> <span style=color:#0ff;font-weight:700>&#34;%p&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq-default</span> mode-line-format
</span></span><span style=display:flex><span>              `(<span style=color:#0ff;font-weight:700>&#34;%e&#34;</span>
</span></span><span style=display:flex><span>                mode-line-front-space
</span></span><span style=display:flex><span>                (<span style=color:#fff;font-weight:700>:propertize</span> (<span style=color:#0ff;font-weight:700>&#34;&#34;</span> mode-line-mule-info mode-line-client mode-line-modified mode-line-remote))
</span></span><span style=display:flex><span>                mode-line-frame-identification
</span></span><span style=display:flex><span>                mode-line-buffer-identification
</span></span><span style=display:flex><span>                mode-line-position
</span></span><span style=display:flex><span>                <span style=color:#007f7f>;; (:eval (propertize &#34; %I &#34; &#39;face &#39;font-lock-constant-face))</span>
</span></span><span style=display:flex><span>                <span style=color:#0ff;font-weight:700>&#34;  &#34;</span>
</span></span><span style=display:flex><span>                (vc-mode vc-mode)
</span></span><span style=display:flex><span>                (<span style=color:#fff;font-weight:700>:eval</span> (<span style=color:#fff;font-weight:700>when</span> buffer-read-only
</span></span><span style=display:flex><span>                         (concat <span style=color:#0ff;font-weight:700>&#34;  &#34;</span>  (propertize <span style=color:#0ff;font-weight:700>&#34;RO&#34;</span>
</span></span><span style=display:flex><span>                                                   <span style=color:#0ff;font-weight:700>&#39;face</span> <span style=color:#0ff;font-weight:700>&#39;font-lock-type-face</span>
</span></span><span style=display:flex><span>                                                   <span style=color:#0ff;font-weight:700>&#39;help-echo</span> <span style=color:#0ff;font-weight:700>&#34;Buffer is read-only&#34;</span>))))
</span></span><span style=display:flex><span>                (<span style=color:#fff;font-weight:700>:eval</span> (my/mode-line-padding))
</span></span><span style=display:flex><span>                mode-line-end-spaces))
</span></span></code></pre></div><p>上式中的 <code>%e</code> 等说明如下：<a href=http://emacs-fu.blogspot.com/2011/08/customizing-mode-line.html>emacs-fu: customizing the mode-line</a>.</p><blockquote><p>%b &ndash; print buffer name. %f &ndash; print visited file name.
%F &ndash; print frame name.
%* &ndash; print %, * or hyphen. %+ &ndash; print <strong>, % or hyphen.
%& is like %</strong>, but ignore read-only-ness.
% means buffer is read-only and * means it is modified.
For a modified read-only buffer, %* gives % and %+ gives *.
%s &ndash; print process status. %l &ndash; print the current line number.
%c &ndash; print the current column number (this makes editing slower).
To make the column number update correctly in all cases,
`column-number-mode&rsquo; must be non-nil.
%i &ndash; print the size of the buffer.
%I &ndash; like %i, but use k, M, G, etc., to abbreviate.
%p &ndash; print percent of buffer above top of window, or Top, Bot or All.
%P &ndash; print percent of buffer above bottom of window, perhaps plus Top,
or print Bottom or All.
%n &ndash; print Narrow if appropriate.
%t &ndash; visited file is text or binary (if OS supports this distinction).
%z &ndash; print mnemonics of keyboard, terminal, and buffer coding systems.
%Z &ndash; like %z, but including the end-of-line format.
%e &ndash; print error message about full memory.
%@ &ndash; print @ or hyphen. @ means that default-directory is on a
remote machine.
%[ &ndash; print one [ for each recursive editing level. %] similar.
%% &ndash; print %. %- &ndash; print infinitely many dashes.
Decimal digits after the % specify field width to which to pad.</p></blockquote><h4 id=mode-line-bell>mode-line-bell</h4><p><a href=https://github.com/purcell/mode-line-bell>purcell/mode-line-bell: Flash the Emacs mode line instead of ringing the bell</a> 如题。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> mode-line-bell
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (on-first-buffer . mode-line-bell-mode))
</span></span></code></pre></div><h3 id=rainbow-mode>rainbow-mode</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> rainbow-mode
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (prog-mode . rainbow-mode))
</span></span></code></pre></div><h3 id=rainbow-delimiters>rainbow-delimiters</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> rainbow-delimiters
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (prog-mode . rainbow-delimiters-mode))
</span></span></code></pre></div><h3 id=pulse>pulse</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> pulse-line (<span style=color:#fff;font-weight:700>&amp;rest</span> _)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Pulse the current line.&#34;</span>
</span></span><span style=display:flex><span>  (pulse-momentary-highlight-one-line (point)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>dolist</span> (command &#39;(evil-paste-after
</span></span><span style=display:flex><span>                   evil-paste-pop
</span></span><span style=display:flex><span>                   evil-paste-before
</span></span><span style=display:flex><span>                   evil-delete
</span></span><span style=display:flex><span>                   evil-delete-line))
</span></span><span style=display:flex><span>  (advice-add command <span style=color:#fff;font-weight:700>:after</span> #&#39;pulse-line))
</span></span></code></pre></div><h3 id=color-identifiers-mode>color-identifiers-mode</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> color-identifiers-mode
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (on-first-file . global-color-identifiers-mode))
</span></span></code></pre></div><h3 id=page-break-lines>page-break-lines</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> page-break-lines
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (org-mode . global-page-break-lines-mode))
</span></span></code></pre></div><h3 id=footer>Footer</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>provide</span> <span style=color:#0ff;font-weight:700>&#39;init-ui</span>)
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; init-ui.el ends here.</span>
</span></span></code></pre></div><h2 id=powerful-emacs-equipped-with-builtin-packages>Powerful Emacs Equipped with Builtin Packages</h2><p>Emacs 内置了很多有用的 mode, 详细内容请参考仓库：<a href=https://github.com/condy0919/emacs-newbie>condy0919/emacs-newbie: Introduction to Emacs</a>. 初学者可以看看。</p><h3 id=header>Header</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#007f7f>;; init-builtin.el --- Builtin *- lexical-binding: t; no-byte-compile: t -*-</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Commentary:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Code:</span>
</span></span></code></pre></div><h3 id=better-default>Better default</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> frame-inhibit-implied-resize t)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> use-file-dialog nil)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> use-dialog-box nil)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq-default</span> ring-bell-function <span style=color:#0ff;font-weight:700>&#39;ignore</span>
</span></span><span style=display:flex><span>              use-short-answers t
</span></span><span style=display:flex><span>              read-process-output-max <span style=color:#ff0;font-weight:700>#x10000</span>
</span></span><span style=display:flex><span>              message-kill-buffer-on-exit t
</span></span><span style=display:flex><span>              message-kill-buffer-query nil
</span></span><span style=display:flex><span>              indent-tabs-mode nil
</span></span><span style=display:flex><span>              tab-width <span style=color:#ff0;font-weight:700>4</span>
</span></span><span style=display:flex><span>              make-backup-files nil
</span></span><span style=display:flex><span>              create-lockfiles nil
</span></span><span style=display:flex><span>              confirm-kill-processes nil
</span></span><span style=display:flex><span>              confirm-kill-emacs nil
</span></span><span style=display:flex><span>              recenter-redisplay nil
</span></span><span style=display:flex><span>              load-prefer-newer t
</span></span><span style=display:flex><span>              mark-ring-max <span style=color:#ff0;font-weight:700>128</span>
</span></span><span style=display:flex><span>              next-screen-context-lines <span style=color:#ff0;font-weight:700>5</span>
</span></span><span style=display:flex><span>              inhibit-default-init t
</span></span><span style=display:flex><span>              inhibit-startup-message t
</span></span><span style=display:flex><span>              inhibit-splash-screen t
</span></span><span style=display:flex><span>              inhibit-compacting-font-caches t
</span></span><span style=display:flex><span>              <span style=color:#007f7f>;; inhibit-quit nil</span>
</span></span><span style=display:flex><span>              fast-but-imprecise-scrolling t
</span></span><span style=display:flex><span>              scroll-preserve-screen-position t
</span></span><span style=display:flex><span>              auto-save-default nil
</span></span><span style=display:flex><span>              auto-save-list-file-name nil
</span></span><span style=display:flex><span>              kill-do-not-save-duplicates t
</span></span><span style=display:flex><span>              kill-ring-max (* kill-ring-max <span style=color:#ff0;font-weight:700>2</span>)
</span></span><span style=display:flex><span>              history-delete-duplicates t
</span></span><span style=display:flex><span>              view-read-only t
</span></span><span style=display:flex><span>              kill-read-only-ok t
</span></span><span style=display:flex><span>              async-shell-command-display-buffer nil
</span></span><span style=display:flex><span>              <span style=color:#007f7f>;; Improve the performance of rendering long lines.</span>
</span></span><span style=display:flex><span>              bidi-display-reordering nil)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> ffap-machine-p-known <span style=color:#0ff;font-weight:700>&#39;reject</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> auto-save-list-file-prefix (expand-file-name <span style=color:#0ff;font-weight:700>&#34;cache/auto-save-list/.saves-&#34;</span> user-emacs-directory))
</span></span></code></pre></div><h3 id=system-coding>system coding</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(prefer-coding-system <span style=color:#0ff;font-weight:700>&#39;utf-8</span>)
</span></span><span style=display:flex><span>(set-default-coding-systems <span style=color:#0ff;font-weight:700>&#39;utf-8</span>)
</span></span><span style=display:flex><span>(set-terminal-coding-system <span style=color:#0ff;font-weight:700>&#39;utf-8</span>)
</span></span><span style=display:flex><span>(set-keyboard-coding-system <span style=color:#0ff;font-weight:700>&#39;utf-8</span>)
</span></span></code></pre></div><h3 id=profiler>profiler</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(add-hook <span style=color:#0ff;font-weight:700>&#39;profiler-report-mode-hook</span> #&#39;hl-line-mode)
</span></span></code></pre></div><h3 id=buffer>buffer</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> switch-to-buffer-in-dedicated-window <span style=color:#0ff;font-weight:700>&#39;pop</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> switch-to-buffer-obey-display-actions t)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(my/space-leader-def
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;b&#34;</span> &#39;(<span style=color:#fff;font-weight:700>:ignore</span> t <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Buffer/Bookmark&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;be&#34;</span> &#39;(eval-buffer <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Eval buffer&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;bk&#34;</span> &#39;(kill-this-buffer <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Kill This Buffer&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>with-eval-after-load</span> <span style=color:#0ff;font-weight:700>&#39;evil</span>
</span></span><span style=display:flex><span>  (evil-define-key <span style=color:#0ff;font-weight:700>&#39;normal</span> <span style=color:#0ff;font-weight:700>&#39;global</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;gB&#34;</span> <span style=color:#0ff;font-weight:700>&#39;switch-to-prev-buffer</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;gb&#34;</span> <span style=color:#0ff;font-weight:700>&#39;switch-to-buffer</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;zx&#34;</span> <span style=color:#0ff;font-weight:700>&#39;kill-current-buffer</span>))
</span></span></code></pre></div><h3 id=calculator>calculator</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> calc
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> ((calc-trail-mode . (<span style=color:#fff;font-weight:700>lambda</span> ()
</span></span><span style=display:flex><span>                              (<span style=color:#fff;font-weight:700>setq-local</span> mode-line-format nil)))
</span></span><span style=display:flex><span>         (calc-mode . (<span style=color:#fff;font-weight:700>lambda</span> ()
</span></span><span style=display:flex><span>                        (<span style=color:#fff;font-weight:700>setq-local</span> mode-line-format nil))))
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> calc-window-height <span style=color:#ff0;font-weight:700>15</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(my/space-leader-def
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;C&#34;</span> &#39;(calc <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;calc&#34;</span>))
</span></span></code></pre></div><h3 id=column-number-mode>column-number-mode</h3><p>作用是在 modeline 中显示当前光标竖向处的位置。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(add-hook <span style=color:#0ff;font-weight:700>&#39;prog-mode-hook</span> <span style=color:#0ff;font-weight:700>&#39;column-number-mode</span>)
</span></span></code></pre></div><h3 id=size-indication-mode>size-indication-mode</h3><p>作用是在 modeline 中显示文件的大小。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(add-hook <span style=color:#0ff;font-weight:700>&#39;find-file-hook</span> <span style=color:#0ff;font-weight:700>&#39;size-indication-mode</span>)
</span></span></code></pre></div><h3 id=delete-selection-mode>delete-selection-mode</h3><p>作用是当选中区域后输入字符会删除选中的区域，大部份软件都是这种行为。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(add-hook <span style=color:#0ff;font-weight:700>&#39;on-first-input-hook</span> <span style=color:#0ff;font-weight:700>&#39;delete-selection-mode</span>)
</span></span></code></pre></div><h3 id=winner-mode>winner-mode</h3><p>进行窗口管理。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq-default</span> winner-dont-bind-my-keys t)
</span></span><span style=display:flex><span>(add-hook <span style=color:#0ff;font-weight:700>&#39;on-first-buffer-hook</span> <span style=color:#0ff;font-weight:700>&#39;winner-mode</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> winner-boring-buffers &#39;(<span style=color:#0ff;font-weight:700>&#34;*Completions*&#34;</span>
</span></span><span style=display:flex><span>                              <span style=color:#0ff;font-weight:700>&#34;*Compile-Log*&#34;</span>
</span></span><span style=display:flex><span>                              <span style=color:#0ff;font-weight:700>&#34;*inferior-lisp*&#34;</span>
</span></span><span style=display:flex><span>                              <span style=color:#0ff;font-weight:700>&#34;*Fuzzy Completions*&#34;</span>
</span></span><span style=display:flex><span>                              <span style=color:#0ff;font-weight:700>&#34;*Apropos*&#34;</span>
</span></span><span style=display:flex><span>                              <span style=color:#0ff;font-weight:700>&#34;*Help*&#34;</span>
</span></span><span style=display:flex><span>                              <span style=color:#0ff;font-weight:700>&#34;*cvs*&#34;</span>
</span></span><span style=display:flex><span>                              <span style=color:#0ff;font-weight:700>&#34;*Buffer List*&#34;</span>
</span></span><span style=display:flex><span>                              <span style=color:#0ff;font-weight:700>&#34;*Ibuffer*&#34;</span>
</span></span><span style=display:flex><span>                              <span style=color:#0ff;font-weight:700>&#34;*esh command on file*&#34;</span>))
</span></span></code></pre></div><h3 id=auto-revert-mode>auto-revert-mode</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(add-hook <span style=color:#0ff;font-weight:700>&#39;on-first-file-hook</span> <span style=color:#0ff;font-weight:700>&#39;global-auto-revert-mode</span>)
</span></span></code></pre></div><h3 id=tab-bar-mode>tab-bar-mode</h3><p>可以将 mode-line 上的一些信息显示在 tab-bar 之上。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>(setq tab-bar-format &#39;(tab-bar-format-history
</span></span><span style=display:flex><span>                       tab-bar-format-tabs
</span></span><span style=display:flex><span>                       tab-bar-format-align-right
</span></span><span style=display:flex><span>                       tab-bar-format-global))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> tab-bar
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (on-first-file . tab-bar-mode)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> tab-bar-close-button-show nil)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> tab-bar-tab-hints nil)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> tab-bar-show nil))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> tabspaces
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:after</span> tab-bar
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (tab-bar-mode . tabspaces-mode)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> tabspaces-session-file
</span></span><span style=display:flex><span>    (expand-file-name <span style=color:#0ff;font-weight:700>&#34;cache/tabsession.el&#34;</span> user-emacs-directory))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> tabspaces-use-filtered-buffers-as-default t))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>with-eval-after-load</span> <span style=color:#0ff;font-weight:700>&#39;evil</span>
</span></span><span style=display:flex><span>  (evil-define-key <span style=color:#0ff;font-weight:700>&#39;normal</span> <span style=color:#0ff;font-weight:700>&#39;global</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;gs&#34;</span> <span style=color:#0ff;font-weight:700>&#39;tab-switch</span>)
</span></span><span style=display:flex><span>  (evil-define-key <span style=color:#0ff;font-weight:700>&#39;motion</span> org-agenda-mode-map
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;gs&#34;</span> <span style=color:#0ff;font-weight:700>&#39;tab-switch</span>))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(add-to-list <span style=color:#0ff;font-weight:700>&#39;display-buffer-alist</span>
</span></span><span style=display:flex><span>             &#39;((<span style=color:#fff;font-weight:700>or</span> (derived-mode . text-mode)
</span></span><span style=display:flex><span>                   (derived-mode . ekg-notes-mode))
</span></span><span style=display:flex><span>               (display-buffer-in-tab)
</span></span><span style=display:flex><span>               (tab-name . <span style=color:#0ff;font-weight:700>&#34;Edit&#34;</span>) (tab-group . <span style=color:#0ff;font-weight:700>&#34;Edit&#34;</span>)
</span></span><span style=display:flex><span>               (select . t)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(add-to-list <span style=color:#0ff;font-weight:700>&#39;display-buffer-alist</span>
</span></span><span style=display:flex><span>             &#39;((derived-mode . prog-mode)
</span></span><span style=display:flex><span>               (display-buffer-in-tab)
</span></span><span style=display:flex><span>               (tab-name . <span style=color:#0ff;font-weight:700>&#34;Porg&#34;</span>) (tab-group . <span style=color:#0ff;font-weight:700>&#34;Prog&#34;</span>)
</span></span><span style=display:flex><span>               (select . t)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(add-to-list <span style=color:#0ff;font-weight:700>&#39;display-buffer-alist</span>
</span></span><span style=display:flex><span>             &#39;((<span style=color:#fff;font-weight:700>or</span> (derived-mode . dired-mode)
</span></span><span style=display:flex><span>                   (derived-mode . dirvish-mode))
</span></span><span style=display:flex><span>               (display-buffer-in-tab)
</span></span><span style=display:flex><span>               (tab-name . <span style=color:#0ff;font-weight:700>&#34;Dired&#34;</span>)
</span></span><span style=display:flex><span>               (tab-group . <span style=color:#0ff;font-weight:700>&#34;Dired&#34;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(add-to-list <span style=color:#0ff;font-weight:700>&#39;display-buffer-alist</span>
</span></span><span style=display:flex><span>             `(,(<span style=color:#fff;font-weight:700>rx</span> (| <span style=color:#0ff;font-weight:700>&#34;*dashboard*&#34;</span>
</span></span><span style=display:flex><span>                       <span style=color:#0ff;font-weight:700>&#34;*Messages*&#34;</span>))
</span></span><span style=display:flex><span>               (display-buffer-in-tab)
</span></span><span style=display:flex><span>               (tab-name . <span style=color:#0ff;font-weight:700>&#34;Home&#34;</span>)
</span></span><span style=display:flex><span>               (tab-group . <span style=color:#0ff;font-weight:700>&#34;Home&#34;</span>)
</span></span><span style=display:flex><span>               (window-parameters . ((mode-line-format . none)
</span></span><span style=display:flex><span>                                     (no-other-window . t)))))
</span></span></code></pre></div><h3 id=savehist-mode>savehist-mode</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> savehist
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (on-first-file . savehist-mode)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> savehist-file (expand-file-name <span style=color:#0ff;font-weight:700>&#34;cache/history&#34;</span> user-emacs-directory))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> history-length <span style=color:#ff0;font-weight:700>1000</span>
</span></span><span style=display:flex><span>        savehist-save-minibuffer-history <span style=color:#ff0;font-weight:700>1</span>
</span></span><span style=display:flex><span>        savehist-additional-variables &#39;(kill-ring
</span></span><span style=display:flex><span>                                        search-ring
</span></span><span style=display:flex><span>                                        regexp-search-ring)
</span></span><span style=display:flex><span>        history-delete-duplicates t))
</span></span></code></pre></div><h3 id=save-place-mode>save-place-mode</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> saveplace
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (on-first-file . save-place-mode)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> save-place-file (expand-file-name <span style=color:#0ff;font-weight:700>&#34;cache/places&#34;</span> user-emacs-directory)))
</span></span><span style=display:flex><span>(add-hook <span style=color:#0ff;font-weight:700>&#39;on-first-buffer-hook</span> <span style=color:#0ff;font-weight:700>&#39;save-place-mode</span>)
</span></span></code></pre></div><h3 id=midnight-mode>midnight-mode</h3><p>作用是半夜的时候自动清理 buffer。
<del>怀疑这个导致 mu4e 出现 error code 1 的错误，先关闭试试。</del> 可能的原因是 emacs-plus 的问题，自编译的版本没有出现这种问题。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(add-hook <span style=color:#0ff;font-weight:700>&#39;on-first-buffer-hook</span> <span style=color:#0ff;font-weight:700>&#39;midnight-mode</span>)
</span></span></code></pre></div><h3 id=so-long-mode>so-long-mode</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(add-hook <span style=color:#0ff;font-weight:700>&#39;text-mode-hook</span> <span style=color:#0ff;font-weight:700>&#39;global-so-long-mode</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq-default</span> large-file-warning-threshold nil)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>when</span> (fboundp <span style=color:#0ff;font-weight:700>&#39;so-long-enable</span>)
</span></span><span style=display:flex><span>  (add-hook <span style=color:#0ff;font-weight:700>&#39;on-first-file-hook</span> <span style=color:#0ff;font-weight:700>&#39;so-long-enable</span>))
</span></span></code></pre></div><h3 id=electric-pair-mode>electric-pair-mode</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(add-hook <span style=color:#0ff;font-weight:700>&#39;prog-mode-hook</span> <span style=color:#0ff;font-weight:700>&#39;electric-pair-mode</span>)
</span></span><span style=display:flex><span>(add-hook <span style=color:#0ff;font-weight:700>&#39;org-mode-hook</span> <span style=color:#0ff;font-weight:700>&#39;electric-pair-mode</span>)
</span></span></code></pre></div><h3 id=prettify-symbols-mode>prettify-symbols-mode</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> prettify-symbols-alist &#39;((<span style=color:#0ff;font-weight:700>&#34;lambda&#34;</span> . <span style=color:#0ff;font-weight:700>?λ</span>)
</span></span><span style=display:flex><span>                               (<span style=color:#0ff;font-weight:700>&#34;function&#34;</span> . <span style=color:#0ff;font-weight:700>?𝑓</span>)))
</span></span><span style=display:flex><span>(add-hook <span style=color:#0ff;font-weight:700>&#39;prog-mode-hook</span> <span style=color:#0ff;font-weight:700>&#39;prettify-symbols-mode</span>)
</span></span><span style=display:flex><span>(add-hook <span style=color:#0ff;font-weight:700>&#39;LaTeX-mode-hook</span> <span style=color:#0ff;font-weight:700>&#39;prettify-symbols-mode</span>)
</span></span></code></pre></div><h3 id=hippie-expand>hippie-expand</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> hippie-expand-try-functions-list &#39;(try-complete-file-name-partially
</span></span><span style=display:flex><span>                                         try-complete-file-name
</span></span><span style=display:flex><span>                                         try-expand-all-abbrevs
</span></span><span style=display:flex><span>                                         try-expand-dabbrev
</span></span><span style=display:flex><span>                                         try-expand-dabbrev-all-buffers
</span></span><span style=display:flex><span>                                         try-expand-dabbrev-from-kill
</span></span><span style=display:flex><span>                                         try-complete-lisp-symbol-partially
</span></span><span style=display:flex><span>                                         try-complete-lisp-symbol))
</span></span><span style=display:flex><span>(global-set-key [remap dabbrev-expand] <span style=color:#0ff;font-weight:700>&#39;hippie-expand</span>)
</span></span></code></pre></div><h3 id=outline-minor-mode>outline-minor-mode</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(add-hook <span style=color:#0ff;font-weight:700>&#39;prog-mode-hook</span> <span style=color:#0ff;font-weight:700>&#39;outline-minor-mode</span>)
</span></span></code></pre></div><h3 id=pixel-scroll-precision-mode>pixel-scroll-precision-mode</h3><p>这个 mode 不好用，使用触摸板大幅度滚动屏幕后，会自动回到原先的位置。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> loaddefs
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (on-first-file . pixel-scroll-precision-mode))
</span></span></code></pre></div><h3 id=recentf-mode>recentf-mode</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> recentf
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (after-init . recentf-mode)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> recentf-save-file (expand-file-name <span style=color:#0ff;font-weight:700>&#34;cache/recentf&#34;</span> user-emacs-directory))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> recentf-auto-cleanup <span style=color:#ff0;font-weight:700>300</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> recentf-max-saved-items <span style=color:#ff0;font-weight:700>1000</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(my/space-leader-def
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;fr&#34;</span> &#39;(recentf-open-files <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Recentf&#34;</span>))
</span></span></code></pre></div><h3 id=visual-line-mode>visual-line-mode</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(add-hook <span style=color:#0ff;font-weight:700>&#39;org-mode-hook</span> <span style=color:#0ff;font-weight:700>&#39;turn-on-visual-line-mode</span>)
</span></span><span style=display:flex><span>(add-hook <span style=color:#0ff;font-weight:700>&#39;org-roam-mode-hook</span> <span style=color:#0ff;font-weight:700>&#39;turn-on-visual-line-mode</span>)
</span></span><span style=display:flex><span>(add-hook <span style=color:#0ff;font-weight:700>&#39;LaTeX-mode-hook</span> #&#39;turn-on-visual-line-mode)
</span></span></code></pre></div><h3 id=word-wrap-whitespace-mode>word-wrap-whitespace-mode</h3><p>这个是 Emacs 29 中的功能，具体见：<a href=https://github.com/emacs-mirror/emacs/commit/c789430331948e76b38091aa95bb9a9602a08289>Add new minor mode word-wrap-whitespace-mode · emacs-mirror/emacs@c789430</a></p><p>如果你使用 emacs 29 以下的版本，将这个文件保存到本地可以使用。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(add-hook <span style=color:#0ff;font-weight:700>&#39;org-mode-hook</span> <span style=color:#0ff;font-weight:700>&#39;word-wrap-whitespace-mode</span>)
</span></span><span style=display:flex><span>(add-hook <span style=color:#0ff;font-weight:700>&#39;org-roam-mode-hook</span> <span style=color:#0ff;font-weight:700>&#39;word-wrap-whitespace-mode</span>)
</span></span></code></pre></div><h3 id=dired>dired</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> dired
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:bind</span> (<span style=color:#0ff;font-weight:700>&#34;C-x d&#34;</span> . dired)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (dired-mode . dired-hide-details-mode)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> insert-directory-program <span style=color:#0ff;font-weight:700>&#34;/opt/homebrew/bin/gls&#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> dired-use-ls-dired t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> dired-dwim-target t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> dired-auto-revert-buffer #&#39;dired-buffer-stale-p)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> dired-recursive-copies <span style=color:#0ff;font-weight:700>&#39;always</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> dired-recursive-deletes <span style=color:#0ff;font-weight:700>&#39;top</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> dired-listing-switches
</span></span><span style=display:flex><span>        <span style=color:#0ff;font-weight:700>&#34;-l --almost-all --human-readable --group-directories-first --no-group&#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> dired-auto-revert-buffer t))
</span></span></code></pre></div><h4 id=dired-hide-dotfiles>dired-hide-dotfiles</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> dired-hide-dotfiles
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (dired-mode . dired-hide-dotfiles-mode)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:bind</span> (<span style=color:#fff;font-weight:700>:map</span> dired-mode-map
</span></span><span style=display:flex><span>              (<span style=color:#0ff;font-weight:700>&#34;s-.&#34;</span> . dired-hide-dotfiles-mode)))
</span></span></code></pre></div><h4 id=consult-dir>consult-dir</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> consult-dir
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:bind</span> ((<span style=color:#0ff;font-weight:700>&#34;C-x C-d&#34;</span> . consult-dir)
</span></span><span style=display:flex><span>         (<span style=color:#fff;font-weight:700>:map</span> minibuffer-mode-map
</span></span><span style=display:flex><span>               (<span style=color:#0ff;font-weight:700>&#34;C-x C-d&#34;</span> . consult-dir)
</span></span><span style=display:flex><span>               (<span style=color:#0ff;font-weight:700>&#34;C-x C-j&#34;</span> . consult-dir-jump-file))))
</span></span></code></pre></div><h3 id=window-divider-mode>window-divider-mode</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> frame
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (face-spec-set <span style=color:#0ff;font-weight:700>&#39;window-divider</span>
</span></span><span style=display:flex><span>                 &#39;((((background light))
</span></span><span style=display:flex><span>                    <span style=color:#fff;font-weight:700>:foreground</span> <span style=color:#0ff;font-weight:700>&#34;#000000&#34;</span>)
</span></span><span style=display:flex><span>                   (t
</span></span><span style=display:flex><span>                    <span style=color:#fff;font-weight:700>:foreground</span> <span style=color:#0ff;font-weight:700>&#34;#FFFFFF&#34;</span>))
</span></span><span style=display:flex><span>                 <span style=color:#0ff;font-weight:700>&#39;face-override-spec</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> window-divider-default-bottom-width <span style=color:#ff0;font-weight:700>1</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> window-divider-default-places <span style=color:#0ff;font-weight:700>&#39;bottom-only</span>)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (after-init . window-divider-mode))
</span></span></code></pre></div><h3 id=doc-view>doc-view</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> doc-view-mupdf-use-svg t)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> doc-view-imenu-flatten t)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> doc-view-continuous t)
</span></span></code></pre></div><h3 id=abbrev-mode>abbrev-mode</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq-default</span> abbrev-mode t)
</span></span></code></pre></div><h3 id=bookmark>bookmark</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> bookmark
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> bookmark-default-file (expand-file-name <span style=color:#0ff;font-weight:700>&#34;cache/bookmarks&#34;</span> user-emacs-directory)))
</span></span><span style=display:flex><span>(my/space-leader-def
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;ba&#34;</span> <span style=color:#0ff;font-weight:700>&#39;bookmark-set</span>
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;br&#34;</span> <span style=color:#0ff;font-weight:700>&#39;bookmark-rename</span>
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;bd&#34;</span> <span style=color:#0ff;font-weight:700>&#39;bookmark-delete</span>
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;bj&#34;</span> <span style=color:#0ff;font-weight:700>&#39;bookmark-jump</span>)
</span></span></code></pre></div><h3 id=clipboard>clipboard</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> select-enable-primary t)
</span></span></code></pre></div><h3 id=files>files</h3><p><a href=https://emacsredux.com/blog/2022/06/12/auto-create-missing-directories/>Auto-create Missing Directories | Emacs Redux</a>.</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> my/auto-create-missing-dirs ()
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>let</span> ((target-dir (file-name-directory buffer-file-name)))
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>unless</span> (file-exists-p target-dir)
</span></span><span style=display:flex><span>      (make-directory target-dir t))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(add-to-list <span style=color:#0ff;font-weight:700>&#39;find-file-not-found-functions</span> #&#39;my/auto-create-missing-dirs)
</span></span></code></pre></div><h3 id=ibuffer>ibuffer</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(global-set-key (kbd <span style=color:#0ff;font-weight:700>&#34;C-x C-b&#34;</span>) <span style=color:#0ff;font-weight:700>&#39;ibuffer</span>)
</span></span></code></pre></div><h3 id=url>URL</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> url
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> url-configuration-directory (expand-file-name <span style=color:#0ff;font-weight:700>&#34;cache/url&#34;</span> user-emacs-directory)))
</span></span></code></pre></div><h3 id=multisession>multisession</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> multisession
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> multisession-directory (expand-file-name <span style=color:#0ff;font-weight:700>&#34;cache/multisession&#34;</span> user-emacs-directory)))
</span></span></code></pre></div><h3 id=footer>Footer</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>provide</span> <span style=color:#0ff;font-weight:700>&#39;init-builtin</span>)
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; init-builtin.el ends here.</span>
</span></span></code></pre></div><h3 id=server>Server</h3><p>启用 Server 后可以使用 emacsclient 打开文件进行编辑，而不是新开一个 Emacs.</p><p>在 Mac 上使用 emacsclient 需要通过 automator 创建一个 application. 新建一个 run shell script 填入以下的内容。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>/opt/homebrew/bin/emacsclient -n -a -c <span style=color:#0ff;font-weight:700>&#34;</span>$@<span style=color:#0ff;font-weight:700>&#34;</span>
</span></span></code></pre></div><h4 id=header>Header</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#007f7f>;; init.el --- auto-save *- lexical-binding: t; no-byte-compile: t -*-</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Commentary:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Code:</span>
</span></span></code></pre></div><h4 id=server>Server</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> server
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (on-first-input . server-start)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>defun</span> my/start-server ()
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>if</span> (not (server-running-p))
</span></span><span style=display:flex><span>        (server-start))
</span></span><span style=display:flex><span>    (message <span style=color:#0ff;font-weight:700>&#34;Server has started&#34;</span>)))
</span></span></code></pre></div><p><a href=https://github.com/iqbalansari/restart-emacs>iqbalansari/restart-emacs: A simple emacs package to restart emacs from within emacs</a> Emacs 29 中 restart-emacs 己是 builtin function。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(my/space-leader-def
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;q&#34;</span> &#39;(<span style=color:#fff;font-weight:700>:ignore</span> t <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Quit/Restart&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;qR&#34;</span> &#39;(restart-emacs <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Restart emacs&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;qq&#34;</span> &#39;(server-force-delete <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Server Delete&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;qs&#34;</span> &#39;(my/start-server <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Server Delete&#34;</span>))
</span></span></code></pre></div><h4 id=footer>Footer</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>provide</span> <span style=color:#0ff;font-weight:700>&#39;init-server</span>)
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; init-server.el ends here.</span>
</span></span></code></pre></div><h2 id=awesome-emacs-equipped-with-third-party-packages>Awesome Emacs Equipped with Third-Party Packages</h2><h3 id=auto-save>auto-save</h3><p><a href=https://github.com/manateelazycat/auto-save>auto-save/auto-save.el at master · manateelazycat/auto-save</a> 我使用这个包进行文件的自动保存，Emacs 自带 `auto-save-visited-mode&rsquo;, 但是没有 auto-save 这个包好用。</p><p>主要的问题是 auto-save-visited-mode 在 org-capture 当中不能关闭自动删除空格。</p><h4 id=header>Header</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#007f7f>;; init-auto-save.el --- auto-save *- lexical-binding: t; no-byte-compile: t -*-</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Commentary:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Code:</span>
</span></span></code></pre></div><h4 id=auto-save>auto-save</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> auto-save
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (on-first-file . auto-save-enable)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> auto-save-silent t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> auto-save-delete-trailing-whitespace t))
</span></span></code></pre></div><h4 id=footer>Footer</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>provide</span> <span style=color:#0ff;font-weight:700>&#39;init-auto-save</span>)
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; init-beanchmark.el ends here.</span>
</span></span></code></pre></div><h3 id=magit>Magit</h3><p><a href=https://github.com/magit/magit>magit/magit: It&rsquo;s Magit! A Git Porcelain inside Emacs.</a> 是 Emacs 上的一大杀器应用，相对于命令行的方式使用 git 友好的很多。</p><p>通过 borg 安装 Magit 需要增加两行 load-path 的配置。使用时通过 <code>C-x g</code> 即可调用 Magit.</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>[submodule <span style=color:#0ff;font-weight:700>&#34;magit&#34;</span>]
</span></span><span style=display:flex><span>    path = lib/magit
</span></span><span style=display:flex><span>    url = git@github.com:magit/magit.git
</span></span><span style=display:flex><span>    load-path = .
</span></span><span style=display:flex><span>    load-path = ./lisp
</span></span></code></pre></div><h4 id=header>Header</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#007f7f>;; init-git.el --- GIT *- lexical-binding: t; no-byte-compile: t -*-</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Commentary:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Code:</span>
</span></span></code></pre></div><h4 id=magit>Magit</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> magit
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:commands</span> (magit magit-status magit-submodule-add)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:bind</span> (<span style=color:#0ff;font-weight:700>&#34;C-x g&#34;</span> . magit)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (magit-add-section-hook <span style=color:#0ff;font-weight:700>&#39;magit-status-sections-hook</span>
</span></span><span style=display:flex><span>                          <span style=color:#0ff;font-weight:700>&#39;magit-insert-modules</span>
</span></span><span style=display:flex><span>                          <span style=color:#0ff;font-weight:700>&#39;magit-insert-unpulled-from-upstream</span>)
</span></span><span style=display:flex><span>  (remove-hook <span style=color:#0ff;font-weight:700>&#39;magit-module-sections-hook</span> <span style=color:#0ff;font-weight:700>&#39;magit-insert-modules-overview</span>)
</span></span><span style=display:flex><span>  (remove-hook <span style=color:#0ff;font-weight:700>&#39;magit-module-sections-hook</span> <span style=color:#0ff;font-weight:700>&#39;magit-insert-modules-unpulled-from-pushremote</span>)
</span></span><span style=display:flex><span>  (remove-hook <span style=color:#0ff;font-weight:700>&#39;magit-module-sections-hook</span> <span style=color:#0ff;font-weight:700>&#39;magit-insert-modules-unpushed-to-upstream</span>)
</span></span><span style=display:flex><span>  (remove-hook <span style=color:#0ff;font-weight:700>&#39;magit-module-sections-hook</span> <span style=color:#0ff;font-weight:700>&#39;magit-insert-modules-unpushed-to-pushremote</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> transient
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> transient-levels-file (expand-file-name <span style=color:#0ff;font-weight:700>&#34;cache/transient/levels.el&#34;</span> user-emacs-directory))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> transient-values-file (expand-file-name <span style=color:#0ff;font-weight:700>&#34;cache/transient/values.el&#34;</span> user-emacs-directory))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> transient-history-file (expand-file-name <span style=color:#0ff;font-weight:700>&#34;cache/transient/history.el&#34;</span> user-emacs-directory)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> forge
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:after</span> magit
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> forge-database-file (expand-file-name <span style=color:#0ff;font-weight:700>&#34;cache/forge-database.sqlite&#34;</span> user-emacs-directory)))
</span></span></code></pre></div><h4 id=browse-at-remote>browse-at-remote</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> browse-at-remote
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:commands</span> browse-at-remote)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(my/space-leader-def
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;or&#34;</span> &#39;(browse-at-remote <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Open remote&#34;</span>))
</span></span></code></pre></div><h4 id=footer>Footer</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>provide</span> <span style=color:#0ff;font-weight:700>&#39;init-git</span>)
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; init-git.el ends here.</span>
</span></span></code></pre></div><h3 id=header>Header</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#007f7f>;; init-edit.el --- better edit *- lexical-binding: t; no-byte-compile: t -*-</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Commentary:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Code:</span>
</span></span></code></pre></div><h3 id=gc-buffers>gc-buffers</h3><p>作用是自动删除 buffers.</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> gc-buffers
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (on-first-buffer . gc-buffers-mode))
</span></span></code></pre></div><h3 id=ace-window>ace-window</h3><p>作用是方便进行窗口的跳转，对于笔记本这种不大的屏幕不怎么需要，如果是较大的屏幕很有用。可以结合 winner 进行使用。</p><p>对于同一 buffer 中位置的跳转，想要回到之前的位置可以使用 <code>evil-jump-backward</code>.</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> ace-window
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:bind</span> (<span style=color:#0ff;font-weight:700>&#34;C-x o&#34;</span> . ace-window))
</span></span></code></pre></div><h3 id=expand-region>expand-region</h3><p>这个用于扩展选区，有时候比 Evil 的 Visual 好用。最新的配置中己经使用 <code>v</code> 替代了 <code>C-=</code> 这个快捷键。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> expand-region
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:commands</span> er/expand-region)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>with-eval-after-load</span> <span style=color:#0ff;font-weight:700>&#39;evil</span>
</span></span><span style=display:flex><span>    (evil-define-key <span style=color:#0ff;font-weight:700>&#39;visual</span> <span style=color:#0ff;font-weight:700>&#39;evil-visual-state-map</span>
</span></span><span style=display:flex><span>      <span style=color:#0ff;font-weight:700>&#34;v&#34;</span> <span style=color:#0ff;font-weight:700>&#39;er/expand-region</span>))
</span></span></code></pre></div><h3 id=bicycle>bicycle</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>with-eval-after-load</span> <span style=color:#0ff;font-weight:700>&#39;outline</span>
</span></span><span style=display:flex><span>  (define-key outline-minor-mode-map (kbd <span style=color:#0ff;font-weight:700>&#34;C-&lt;tab&gt;&#34;</span>) <span style=color:#0ff;font-weight:700>&#39;bicycle-cycle</span>)
</span></span><span style=display:flex><span>  (define-key outline-minor-mode-map (kbd <span style=color:#0ff;font-weight:700>&#34;S-&lt;tab&gt;&#34;</span>) <span style=color:#0ff;font-weight:700>&#39;bicycle-cycle-global</span>))
</span></span></code></pre></div><h3 id=footer>Footer</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>provide</span> <span style=color:#0ff;font-weight:700>&#39;init-edit</span>)
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; init-edit.el ends here.</span>
</span></span></code></pre></div><h3 id=minibuffer-and-completion>Minibuffer and completion</h3><h4 id=header>Header</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#007f7f>;; init-completion.el --- Minibuffer and completion *- lexical-binding: t; no-byte-compile: t -*-</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Commentary:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Code:</span>
</span></span></code></pre></div><h4 id=minibuffer>minibuffer</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> read-buffer-completion-ignore-case t)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> completion-ignore-case t)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> minibuffer-prompt-properties
</span></span><span style=display:flex><span>      &#39;(read-only t cursor-intangible t face minibuffer-prompt))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> simple
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq-default</span> read-extended-command-predicate #&#39;command-completion-default-include-p))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> minibuffer
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> completion-category-overrides &#39;((file (styles basic partial-completion))))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> read-file-name-completion-ignore-case t)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq-local</span> completion-in-region-function
</span></span><span style=display:flex><span>              (<span style=color:#fff;font-weight:700>lambda</span> (<span style=color:#fff;font-weight:700>&amp;rest</span> args)
</span></span><span style=display:flex><span>                (apply (<span style=color:#fff;font-weight:700>if</span> vertico-mode
</span></span><span style=display:flex><span>                           #&#39;consult-completion-in-region
</span></span><span style=display:flex><span>                         #&#39;completion--in-region)
</span></span><span style=display:flex><span>                       args))))
</span></span></code></pre></div><h4 id=orderless>orderless</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> tab-always-indent <span style=color:#0ff;font-weight:700>&#39;complete</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> orderless
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> completion-styles &#39;(orderless partial-completion)))
</span></span></code></pre></div><h4 id=vertico>vertico</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> vertico
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:load-path</span> <span style=color:#0ff;font-weight:700>&#34;~/.emacs.d/packages/vertico&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (after-init . vertico-mode)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> vertico-cycle t)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:bind</span> (<span style=color:#fff;font-weight:700>:map</span> vertico-map
</span></span><span style=display:flex><span>      (<span style=color:#0ff;font-weight:700>&#34;C-j&#34;</span> . vertico-next)
</span></span><span style=display:flex><span>      (<span style=color:#0ff;font-weight:700>&#34;C-k&#34;</span> . vertico-previous)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> vertico-directory
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:after</span> vertico
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:bind</span> (<span style=color:#fff;font-weight:700>:map</span> vertico-map
</span></span><span style=display:flex><span>        (<span style=color:#0ff;font-weight:700>&#34;C-u&#34;</span> . vertico-directory-up)))
</span></span></code></pre></div><h4 id=marginalia>marginalia</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> marginalia
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> ((minibuffer-setup . marginalia-mode)))
</span></span></code></pre></div><h4 id=embark>embark</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> embark
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:bind</span> ((<span style=color:#0ff;font-weight:700>&#34;C-.&#34;</span> . embark-act)
</span></span><span style=display:flex><span>         (<span style=color:#0ff;font-weight:700>&#34;M-.&#34;</span> . embark-dwim)
</span></span><span style=display:flex><span>         (<span style=color:#fff;font-weight:700>:map</span> vertico-map
</span></span><span style=display:flex><span>               (<span style=color:#0ff;font-weight:700>&#34;C-c C-o&#34;</span> . embark-export)
</span></span><span style=display:flex><span>               (<span style=color:#0ff;font-weight:700>&#34;C-c C-c&#34;</span> . embark-act)))
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:init</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> prefix-help-command #&#39;embark-prefix-help-command)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (add-to-list <span style=color:#0ff;font-weight:700>&#39;display-buffer-alist</span>
</span></span><span style=display:flex><span>               &#39;(<span style=color:#0ff;font-weight:700>&#34;\\`\\*Embark Collect \\(Live\\|Completions\\)\\*&#34;</span>
</span></span><span style=display:flex><span>                 nil
</span></span><span style=display:flex><span>                 (window-parameters (mode-line-format . none)))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(my/space-leader-def
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;oe&#34;</span> &#39;(embark-open-externally <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Open externally&#34;</span>))
</span></span></code></pre></div><h4 id=consult>consult</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> consult
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:commands</span> consult-outline
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (completion-list-mode . consult-preview-at-point-mode)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:bind</span> (([remap apropos] . consult-apropos)
</span></span><span style=display:flex><span>         ([remap bookmark-jump] . consult-bookmark)
</span></span><span style=display:flex><span>         ([remap goto-line] . consult-line)
</span></span><span style=display:flex><span>         ([remap imenu] . consult-imenu)
</span></span><span style=display:flex><span>         ([remap locate] . consult-locate)
</span></span><span style=display:flex><span>         ([remap load-theme] . consult-theme)
</span></span><span style=display:flex><span>         ([remap man] . consult-man)
</span></span><span style=display:flex><span>         ([remap recentf-open-files] . consult-recent-file)
</span></span><span style=display:flex><span>         ([remap switch-to-buffer] . consult-buffer)
</span></span><span style=display:flex><span>         ([remap switch-to-buffer-other-window] . consult-buffer-other-window)
</span></span><span style=display:flex><span>         ([remap switch-to-buffer-other-frame] . consult-buffer-other-frame)
</span></span><span style=display:flex><span>         ([remap yank-pop] . consult-yank-pop)
</span></span><span style=display:flex><span>         <span style=color:#fff;font-weight:700>:map</span> minibuffer-mode-map
</span></span><span style=display:flex><span>         (<span style=color:#0ff;font-weight:700>&#34;C-r&#34;</span> . consult-history)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>with-eval-after-load</span> <span style=color:#0ff;font-weight:700>&#39;evil</span>
</span></span><span style=display:flex><span>  (evil-declare-key <span style=color:#0ff;font-weight:700>&#39;normal</span> org-mode-map
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;gh&#34;</span> <span style=color:#0ff;font-weight:700>&#39;consult-outline</span>)
</span></span><span style=display:flex><span>  (evil-declare-key <span style=color:#0ff;font-weight:700>&#39;normal</span> LaTeX-mode-map
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;gh&#34;</span> <span style=color:#0ff;font-weight:700>&#39;consult-outline</span>))
</span></span></code></pre></div><h4 id=corfu>corfu</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> corfu
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> corfu-cycle t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> corfu-auto t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> corfu-auto-prefix <span style=color:#ff0;font-weight:700>2</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> corfu-auto-delay <span style=color:#ff0;font-weight:700>0.0</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> corfu-preselect <span style=color:#0ff;font-weight:700>&#39;valid</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq-default</span> corfu-quit-no-match <span style=color:#0ff;font-weight:700>&#39;separator</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>defun</span> corfu-enable-always-in-minibuffer ()
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;Enable Corfu in the minibuffer if Vertico/Mct are not active.&#34;</span>
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>unless</span> (<span style=color:#fff;font-weight:700>or</span> (bound-and-true-p mct--active)
</span></span><span style=display:flex><span>                (bound-and-true-p vertico--input)
</span></span><span style=display:flex><span>                (eq (current-local-map) read-passwd-map))
</span></span><span style=display:flex><span>      (<span style=color:#fff;font-weight:700>setq-local</span> corfu-auto nil) <span style=color:#007f7f>;; Enable/disable auto completion</span>
</span></span><span style=display:flex><span>      (<span style=color:#fff;font-weight:700>setq-local</span> corfu-echo-delay nil <span style=color:#007f7f>;; Disable automatic echo and popup</span>
</span></span><span style=display:flex><span>                  corfu-popupinfo-delay nil)
</span></span><span style=display:flex><span>      (corfu-mode <span style=color:#ff0;font-weight:700>1</span>)))
</span></span><span style=display:flex><span>  (add-to-list <span style=color:#0ff;font-weight:700>&#39;corfu-margin-formatters</span> #&#39;kind-icon-margin-formatter)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (after-init . global-corfu-mode))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> corfu-echo
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (corfu-mode . corfu-echo-mode))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> corfu-popupinfo
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (corfu-mode . corfu-popupinfo-mode))
</span></span></code></pre></div><h4 id=kind-icon>kind-icon</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> kind-icon
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:commands</span> kind-icon-margin-formatter
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> kind-icon-use-icons t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> kind-icon-default-face <span style=color:#0ff;font-weight:700>&#39;corfu-default</span>))
</span></span></code></pre></div><h4 id=cape>cape</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> cape
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:bind</span> ((<span style=color:#0ff;font-weight:700>&#34;C-c p p&#34;</span> . completion-at-point) <span style=color:#007f7f>;; capf</span>
</span></span><span style=display:flex><span>         (<span style=color:#0ff;font-weight:700>&#34;C-c p t&#34;</span> . complete-tag)        <span style=color:#007f7f>;; etags</span>
</span></span><span style=display:flex><span>         (<span style=color:#0ff;font-weight:700>&#34;C-c p d&#34;</span> . cape-dabbrev)        <span style=color:#007f7f>;; or dabbrev-completion</span>
</span></span><span style=display:flex><span>         (<span style=color:#0ff;font-weight:700>&#34;C-c p h&#34;</span> . cape-history)
</span></span><span style=display:flex><span>         (<span style=color:#0ff;font-weight:700>&#34;C-c p f&#34;</span> . cape-file)
</span></span><span style=display:flex><span>         (<span style=color:#0ff;font-weight:700>&#34;C-c p k&#34;</span> . cape-keyword)
</span></span><span style=display:flex><span>         (<span style=color:#0ff;font-weight:700>&#34;C-c p s&#34;</span> . cape-symbol)
</span></span><span style=display:flex><span>         (<span style=color:#0ff;font-weight:700>&#34;C-c p a&#34;</span> . cape-abbrev)
</span></span><span style=display:flex><span>         (<span style=color:#0ff;font-weight:700>&#34;C-c p i&#34;</span> . cape-ispell)
</span></span><span style=display:flex><span>         (<span style=color:#0ff;font-weight:700>&#34;C-c p l&#34;</span> . cape-line)
</span></span><span style=display:flex><span>         (<span style=color:#0ff;font-weight:700>&#34;C-c p w&#34;</span> . cape-dict)
</span></span><span style=display:flex><span>         (<span style=color:#0ff;font-weight:700>&#34;C-c p \\&#34;</span> . cape-tex)
</span></span><span style=display:flex><span>         (<span style=color:#0ff;font-weight:700>&#34;C-c p _&#34;</span> . cape-tex)
</span></span><span style=display:flex><span>         (<span style=color:#0ff;font-weight:700>&#34;C-c p ^&#34;</span> . cape-tex)
</span></span><span style=display:flex><span>         (<span style=color:#0ff;font-weight:700>&#34;C-c p &amp;&#34;</span> . cape-sgml)
</span></span><span style=display:flex><span>         (<span style=color:#0ff;font-weight:700>&#34;C-c p r&#34;</span> . cape-rfc1345))
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:init</span>
</span></span><span style=display:flex><span>  (add-to-list <span style=color:#0ff;font-weight:700>&#39;completion-at-point-functions</span> #&#39;cape-dabbrev)
</span></span><span style=display:flex><span>  (add-to-list <span style=color:#0ff;font-weight:700>&#39;completion-at-point-functions</span> #&#39;cape-file)
</span></span><span style=display:flex><span>  <span style=color:#007f7f>;;(add-to-list &#39;completion-at-point-functions #&#39;cape-history)</span>
</span></span><span style=display:flex><span>  <span style=color:#007f7f>;;(add-to-list &#39;completion-at-point-functions #&#39;cape-keyword)</span>
</span></span><span style=display:flex><span>  <span style=color:#007f7f>;;(add-to-list &#39;completion-at-point-functions #&#39;cape-tex)</span>
</span></span><span style=display:flex><span>  <span style=color:#007f7f>;;(add-to-list &#39;completion-at-point-functions #&#39;cape-sgml)</span>
</span></span><span style=display:flex><span>  <span style=color:#007f7f>;;(add-to-list &#39;completion-at-point-functions #&#39;cape-rfc1345)</span>
</span></span><span style=display:flex><span>  <span style=color:#007f7f>;;(add-to-list &#39;completion-at-point-functions #&#39;cape-abbrev)</span>
</span></span><span style=display:flex><span>  (add-to-list <span style=color:#0ff;font-weight:700>&#39;completion-at-point-functions</span> #&#39;cape-ispell)
</span></span><span style=display:flex><span>  (add-to-list <span style=color:#0ff;font-weight:700>&#39;completion-at-point-functions</span> #&#39;cape-dict)
</span></span><span style=display:flex><span>  <span style=color:#007f7f>;;(add-to-list &#39;completion-at-point-functions #&#39;cape-symbol)</span>
</span></span><span style=display:flex><span>  <span style=color:#007f7f>;;(add-to-list &#39;completion-at-point-functions #&#39;cape-line)</span>
</span></span><span style=display:flex><span>  )
</span></span></code></pre></div><p><a href=https://github.com/SystemCrafters/crafted-emacs/blob/master/modules/crafted-completion.el>crafted-emacs/crafted-completion.el at master · SystemCrafters/crafted-emacs</a></p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#007f7f>;; Ensure that pcomplete does not write to the buffer</span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;; and behaves as a pure `completion-at-point-function&#39;.</span>
</span></span><span style=display:flex><span>(advice-add <span style=color:#0ff;font-weight:700>&#39;pcomplete-completions-at-point</span> <span style=color:#fff;font-weight:700>:around</span> #&#39;cape-wrap-purify)
</span></span></code></pre></div><h4 id=prescient>prescient</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(autoload <span style=color:#0ff;font-weight:700>&#39;prescient-persist-mode</span> <span style=color:#0ff;font-weight:700>&#34;prescient&#34;</span> <span style=color:#0ff;font-weight:700>&#34;&#34;</span> t)
</span></span><span style=display:flex><span>(add-hook <span style=color:#0ff;font-weight:700>&#39;after-init-hook</span> <span style=color:#0ff;font-weight:700>&#39;prescient-persist-mode</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> prescient-save-file (expand-file-name <span style=color:#0ff;font-weight:700>&#34;cache/prescient-save.el&#34;</span> user-emacs-directory))
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> vertico-prescient
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (vertico-mode . vertico-prescient-mode))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> corfu-prescient
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (corfu-mode . corfu-prescient-mode)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> vertico-prescient-completion-styles &#39;(orderless prescient partial-completion)))
</span></span></code></pre></div><h4 id=footer>Footer</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>provide</span> <span style=color:#0ff;font-weight:700>&#39;init-completion</span>)
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; init-git.el ends here.</span>
</span></span></code></pre></div><h3 id=undo>Undo</h3><p>Emacs 自带 undo 和 undo-redo 功能。这里使用了 <code>undo-fu</code> 和 <code>undo-fu-session</code> 以及 <code>vundo</code> 这三个包。</p><p>Evil 模式编辑需要设置 undo system.</p><h4 id=header>Header</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#007f7f>;; init-undo.el --- undo system*- lexical-binding: t; no-byte-compile: t -*-</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Commentary:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Code:</span>
</span></span></code></pre></div><h4 id=undo>undo</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> undo-fu)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> undo-fu-session
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:after</span> undo-fu
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (on-first-file . undo-fu-session-global-mode)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> undo-fu-session-directory (expand-file-name <span style=color:#0ff;font-weight:700>&#34;cache/undo-fu-session&#34;</span> user-emacs-directory)))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> vundo
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> vundo-glyph-alist vundo-unicode-symbols)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:bind</span> (<span style=color:#0ff;font-weight:700>&#34;C-x u&#34;</span> . vundo))
</span></span></code></pre></div><h4 id=footer>Footer</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>provide</span> <span style=color:#0ff;font-weight:700>&#39;init-undo</span>)
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; init-undo.el ends here.</span>
</span></span></code></pre></div><h3 id=helpful>Helpful</h3><h4 id=header>Header</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#007f7f>;; init-helpful.el --- helpful *- lexical-binding: t; no-byte-compile: t -*-</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Commentary:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Code:</span>
</span></span></code></pre></div><h4 id=helpful>helpful</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> helpful
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:commands</span> helpful-update
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:bind</span> (([remap describe-function] . helpful-callable)
</span></span><span style=display:flex><span>         ([remap describe-variable] . helpful-variable)
</span></span><span style=display:flex><span>         ([remap describe-key] . helpful-key))
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:init</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> help-window-select <span style=color:#0ff;font-weight:700>&#39;always</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> help-window-keep-selected t)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (add-to-list <span style=color:#0ff;font-weight:700>&#39;display-buffer-alist</span>
</span></span><span style=display:flex><span>               &#39;((<span style=color:#fff;font-weight:700>or</span> (derived-mode . help-mode)
</span></span><span style=display:flex><span>                     (derived-mode . helpful-mode))
</span></span><span style=display:flex><span>                 (display-buffer-reuse-mode-window display-buffer-in-side-window)
</span></span><span style=display:flex><span>                 (window-width . <span style=color:#ff0;font-weight:700>0.5</span>)
</span></span><span style=display:flex><span>                 (side . right)
</span></span><span style=display:flex><span>                 (slot . <span style=color:#ff0;font-weight:700>0</span>))))
</span></span></code></pre></div><h4 id=elisp-demos>elisp-demos</h4><p><a href=https://github.com/xuchunyang/elisp-demos>xuchunyang/elisp-demos: Demonstrate Emacs Lisp APIs</a> 用于查查函数的用法很方便。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(autoload #&#39;elisp-demos-advice-helpful-update <span style=color:#0ff;font-weight:700>&#34;elisp-demos&#34;</span> nil t)
</span></span><span style=display:flex><span>(advice-add <span style=color:#0ff;font-weight:700>&#39;helpful-update</span> <span style=color:#fff;font-weight:700>:after</span> #&#39;elisp-demos-advice-helpful-update)
</span></span></code></pre></div><h4 id=footer>Footer</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>provide</span> <span style=color:#0ff;font-weight:700>&#39;init-helpful</span>)
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; init-helpful.el ends here.</span>
</span></span></code></pre></div><h3 id=better-search>Better search</h3><h4 id=header>Header</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#007f7f>;; init-search.el --- Better search *- lexical-binding: t; no-byte-compile: t -*-</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Commentary:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Code:</span>
</span></span></code></pre></div><h4 id=ctrlf>ctrlf</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> ctrlf
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:after</span> evil
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (on-first-buffer . ctrlf-mode)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (evil-global-set-key <span style=color:#0ff;font-weight:700>&#39;normal</span> (kbd <span style=color:#0ff;font-weight:700>&#34;/&#34;</span>) <span style=color:#0ff;font-weight:700>&#39;ctrlf-forward-default</span>))
</span></span></code></pre></div><h4 id=rg>rg</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> rg
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (on-first-input . rg-enable-default-bindings)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> rg-group-result t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> rg-show-columns t))
</span></span></code></pre></div><h4 id=footer>Footer</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>provide</span> <span style=color:#0ff;font-weight:700>&#39;init-search</span>)
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; init-search.el ends here.</span>
</span></span></code></pre></div><h3 id=del>DEL</h3><h4 id=header>Header</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#007f7f>;; init-del.el --- delete *- lexical-binding: t; no-byte-compile: t -*-</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Commentary:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Code:</span>
</span></span></code></pre></div><h4 id=delete>delete</h4><p>关于 Emacs 中的删除，一个是 <code>delete-selection-mode</code>, <code>hungry-delelte</code> 以及是否使用系统垃圾桶。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> delete-by-moving-to-trash t)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> trash-directory <span style=color:#0ff;font-weight:700>&#34;~/.Trash&#34;</span>)
</span></span></code></pre></div><h4 id=hungry-delete>hungry-delete</h4><p><a href=https://github.com/nflath/hungry-delete>nflath/hungry-delete: Enables hungry deletion in all modes.</a></p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> hungry-delete
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:custom</span>
</span></span><span style=display:flex><span>  (hungry-delete-chars-to-skip <span style=color:#0ff;font-weight:700>&#34; \t\n\r\f\v&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> ((text-mode . hungry-delete-mode)
</span></span><span style=display:flex><span>         (prog-mode . hungry-delete-mode)
</span></span><span style=display:flex><span>         (org-mode . hungry-delete-mode)))
</span></span></code></pre></div><h4 id=whitespace-cleanup-mode>whitespace-cleanup-mode</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> whitespace-cleanup-mode
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (on-first-file . whitespace-cleanup-mode))
</span></span></code></pre></div><h4 id=footer>Footer</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>provide</span> <span style=color:#0ff;font-weight:700>&#39;init-del</span>)
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; init-del.el ends here.</span>
</span></span></code></pre></div><h3 id=rime>rime</h3><p>进行 Evil 的 insert 状态时自动的切换中英文输入法的状态，结合 rime 的 predicates 使用。</p><p><a href=https://github.com/colawithsauce/rime-regexp.el/tree/main/>rime-regexp-mode</a>, 通过此包可以使用输入法进行文件的检索，若使用拼音输入法则可以通过拼音进行文件名的检索。我使用三郑输入法，则可以使用形码进行检索。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#007f7f>;; init-rime.el --- rime *- lexical-binding: t; no-byte-compile: t -*-</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Commentary:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Code:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> rime
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:init</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> rime-title <span style=color:#0ff;font-weight:700>&#34;𝐑 &#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> rime-user-data-dir <span style=color:#0ff;font-weight:700>&#34;~/Library/Rime/&#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> rime-emacs-module-header-root <span style=color:#0ff;font-weight:700>&#34;/Applications/Emacs.app/Contents/Resources/include/&#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> rime-librime-root (expand-file-name <span style=color:#0ff;font-weight:700>&#34;librime/dist&#34;</span> user-emacs-directory))
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> default-input-method <span style=color:#0ff;font-weight:700>&#34;rime&#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> rime-show-candidate <span style=color:#0ff;font-weight:700>&#39;minibuffer</span>)
</span></span><span style=display:flex><span>  <span style=color:#007f7f>;; (setq rime-posframe-properties &#39;(:internal-border-width 0))</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> rime-disable-predicates &#39;(rime-predicate-prog-in-code-p
</span></span><span style=display:flex><span>                                  rime-predicate-org-in-src-block-p
</span></span><span style=display:flex><span>                                  rime-predicate-org-latex-mode-p
</span></span><span style=display:flex><span>                                  rime-predicate-tex-math-or-command-p))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> rime-inline-predicates &#39;(rime-predicate-space-after-cc-p
</span></span><span style=display:flex><span>                                 rime-predicate-after-alphabet-char-p))
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:bind</span> (<span style=color:#fff;font-weight:700>:map</span> rime-mode-map
</span></span><span style=display:flex><span>              (<span style=color:#0ff;font-weight:700>&#34;M-j&#34;</span> . rime-force-enable))
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> ((evil-insert-state-entry . (<span style=color:#fff;font-weight:700>lambda</span> ()
</span></span><span style=display:flex><span>                                      (<span style=color:#fff;font-weight:700>if</span> (<span style=color:#fff;font-weight:700>and</span> (not (rime--should-inline-ascii-p))
</span></span><span style=display:flex><span>                                               (eq major-mode <span style=color:#0ff;font-weight:700>&#39;org-mode</span>)
</span></span><span style=display:flex><span>                                               (not (org-at-clock-log-p))
</span></span><span style=display:flex><span>                                               (not (org-at-table-p))
</span></span><span style=display:flex><span>                                               (not (org-at-timestamp-p))
</span></span><span style=display:flex><span>                                               (not (<span style=color:#fff;font-weight:700>and</span> (bolp) (org-on-heading-p))))
</span></span><span style=display:flex><span>                                          (activate-input-method <span style=color:#0ff;font-weight:700>&#34;rime&#34;</span>))))
</span></span><span style=display:flex><span>         (evil-insert-state-exit .  #&#39;evil-deactivate-input-method)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> rime-regexp
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (on-first-input . rime-regexp-mode))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>provide</span> <span style=color:#0ff;font-weight:700>&#39;init-rime</span>)
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; init-rime.el ends here.</span>
</span></span></code></pre></div><h3 id=template>template</h3><h4 id=header>Header</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#007f7f>;; init-template.el --- template system *- lexical-binding: t; no-byte-compile: t -*-</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Commentary:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Code:</span>
</span></span></code></pre></div><h4 id=tempel>tempel</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> tempel
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:bind</span> ((<span style=color:#0ff;font-weight:700>&#34;M-+&#34;</span> . tempel-complete)
</span></span><span style=display:flex><span>         (<span style=color:#0ff;font-weight:700>&#34;M-*&#34;</span> . tempel-insert))
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> tempel-path `(<span style=color:#0ff;font-weight:700>&#34;~/.emacs.d/template/tempel&#34;</span>
</span></span><span style=display:flex><span>                      ,(expand-file-name <span style=color:#0ff;font-weight:700>&#34;template/tempel&#34;</span> my-galaxy))))
</span></span></code></pre></div><h4 id=yasnippet>yasnippet</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> yasnippet
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (on-first-file . yas-global-mode)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>use-package</span> yasnippet-snippets
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>:after</span> yasnippet))
</span></span></code></pre></div><h4 id=footer>Footer</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>provide</span> <span style=color:#0ff;font-weight:700>&#39;init-template</span>)
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; init-template.el ends here.</span>
</span></span></code></pre></div><h2 id=emacs-works-with-multiple-language-piece-of-cake>Emacs Works with Multiple Language, Piece of Cake</h2><p>Emacs 在英文的学习、使用方面具有很大的帮助。</p><p>使用 Emacs 写文档可以自动检查拼写，需要用到的有 <code>ispell</code>, <code>flyspell</code> 或者 <code>wucuo-mode</code>. 对于具有错误的单词会有下划线提示，使用 <code>flyspell-correct</code> 进行修正。</p><p>对于不认识的单词可以使用 <code>sdcv</code> 或者 <code>osx-dictionary</code> 查询，对于读不懂的单词可以使用 <code>go-translate</code> 或者 <code>lingva</code> 或者 <code>google-translate</code> 进行中英文的互译。当然其他的语言也是可以的。</p><p>此外还可以使用 dictionary-overlay 直接渲染整个 buffer, 不认识的单词会直接显示中文意思。这个功能结合 <code>eww</code> 或者 <code>elfeed</code> 阅读网页的时候使用。</p><p>当不知道英文单词怎么写时可以使用 <code>lsp-bridge-toggle-sdcv-helper</code>, 通过输入拼音来输入英语单词。对于想要查询近意词等时可以使用 <code>powerthesaurus-lookup-dwim</code> 来查找。</p><p>学习英语单词还可以结合 <a href=https://gitlab.com/phillord/org-drill>org-drll</a> 或者 <a href=https://github.com/eyeinsky/org-anki>org-anki</a> 进行，这里使用到的概念是 <a href=https://en.wikipedia.org/wiki/Forgetting_curve>Forgetting curve</a>.</p><h3 id=spell>Spell</h3><h4 id=header>Header</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#007f7f>;; init-spell.el --- spell *- lexical-binding: t; no-byte-compile: t -*-</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Commentary:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Code:</span>
</span></span></code></pre></div><h4 id=ispell>Ispell</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> ispell
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> ispell-program-name <span style=color:#0ff;font-weight:700>&#34;/opt/homebrew/bin/aspell&#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> ispell-extra-args &#39;(<span style=color:#0ff;font-weight:700>&#34;--sug-mode=ultra&#34;</span> <span style=color:#0ff;font-weight:700>&#34;--lang=en_US&#34;</span> <span style=color:#0ff;font-weight:700>&#34;--run-together&#34;</span>))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> ispell-aspell-dict-dir
</span></span><span style=display:flex><span>        (ispell-get-aspell-config-value <span style=color:#0ff;font-weight:700>&#34;dict-dir&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> ispell-aspell-data-dir
</span></span><span style=display:flex><span>        (ispell-get-aspell-config-value <span style=color:#0ff;font-weight:700>&#34;data-dir&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> ispell-personal-dictionary (expand-file-name <span style=color:#0ff;font-weight:700>&#34;config/ispell/.aspell.en.pws&#34;</span> my-galaxy))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq-default</span> ispell-following-word t
</span></span><span style=display:flex><span>                ispell-quietly t))
</span></span></code></pre></div><p>这里使用了<a href=https://github.com/cask/shut-up>cask/shut-up: Emacs, shut up would you!</a> 来关闭一些错误提示。虽然其只是显示在 Message buffer 当中，但是看起来还是很不爽。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#007f7f>;; Suppress start looking process.</span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;; https://github.com/company-mode/company-mode/issues/912</span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;; shut-up</span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>with-eval-after-load</span> <span style=color:#0ff;font-weight:700>&#39;ispell</span>
</span></span><span style=display:flex><span>  (advice-add <span style=color:#0ff;font-weight:700>&#39;ispell-lookup-words</span> <span style=color:#fff;font-weight:700>:around</span>
</span></span><span style=display:flex><span>              (<span style=color:#fff;font-weight:700>lambda</span> (orig <span style=color:#fff;font-weight:700>&amp;rest</span> args)
</span></span><span style=display:flex><span>                (shut-up (apply orig args)))))
</span></span></code></pre></div><h4 id=flyspell>flyspell</h4><p>Wucuo 在某个版本有提示 warning, 不知道产生的原因是什么。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> flyspell
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (org-mode . flyspell-mode))
</span></span></code></pre></div><h4 id=flyspell-correct>flyspell-correct</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> flyspell-correct
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:commands</span> flyspell-correct-wrapper
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:bind</span> ([remap flyspell-auto-correct-previous-word] . flyspell-correct-wrapper))
</span></span></code></pre></div><h4 id=footer>Footer</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>provide</span> <span style=color:#0ff;font-weight:700>&#39;init-spell</span>)
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; init-spell.el ends here.</span>
</span></span></code></pre></div><h3 id=translate>Translate</h3><h4 id=header>Header</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#007f7f>;; init-translate.el --- translate *- lexical-binding: t; no-byte-compile: t -*-</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Commentary:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Code:</span>
</span></span></code></pre></div><h4 id=langtool>langtool</h4><p>MacOS 上使用需要安装 languagetool.</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> langtool
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:commands</span> langtool-check-buffer
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> langtool-http-server-host <span style=color:#0ff;font-weight:700>&#34;localhost&#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> langtool-http-server-port <span style=color:#ff0;font-weight:700>8081</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> langtool-autoshow-message-function #&#39;langtool-popup-autoshow))
</span></span></code></pre></div><h4 id=dictionary>dictionary</h4><p>Emacs 内置了 dictionary，默认是查询的 dict.org。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(add-to-list <span style=color:#0ff;font-weight:700>&#39;display-buffer-alist</span>
</span></span><span style=display:flex><span>             &#39;(<span style=color:#0ff;font-weight:700>&#34;^\\*Dictionary\\*&#34;</span>
</span></span><span style=display:flex><span>               (display-buffer-in-side-window)
</span></span><span style=display:flex><span>               (side . right)
</span></span><span style=display:flex><span>               (window-width . <span style=color:#ff0;font-weight:700>70</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(global-set-key (kbd <span style=color:#0ff;font-weight:700>&#34;M-#&#34;</span>) <span style=color:#0ff;font-weight:700>&#39;dictionary-lookup-definition</span>)
</span></span></code></pre></div><h4 id=go-translate>go-translate</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> go-translate
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:commands</span> gts-do-translate
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> gts-buffer-follow-p t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> gts-translate-list &#39;((<span style=color:#0ff;font-weight:700>&#34;en&#34;</span> <span style=color:#0ff;font-weight:700>&#34;zh&#34;</span>)))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> gts-default-translator (gts-translator
</span></span><span style=display:flex><span>                <span style=color:#fff;font-weight:700>:picker</span> (gts-noprompt-picker)
</span></span><span style=display:flex><span>                <span style=color:#fff;font-weight:700>:engines</span> (list
</span></span><span style=display:flex><span>                      (gts-google-engine <span style=color:#fff;font-weight:700>:parser</span> (gts-google-summary-parser)))
</span></span><span style=display:flex><span>                <span style=color:#fff;font-weight:700>:render</span> (gts-buffer-render))))
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>with-eval-after-load</span> <span style=color:#0ff;font-weight:700>&#39;evil</span>
</span></span><span style=display:flex><span>  (evil-define-key &#39;(normal visual) <span style=color:#0ff;font-weight:700>&#39;global</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;gll&#34;</span> <span style=color:#0ff;font-weight:700>&#39;gts-do-translate</span>))
</span></span></code></pre></div><h4 id=lingva>lingva</h4><p>go-translate 的备用。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> lingva
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:commands</span> lingva-translate
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> lingva-target <span style=color:#0ff;font-weight:700>&#34;zh&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>with-eval-after-load</span> <span style=color:#0ff;font-weight:700>&#39;evil</span>
</span></span><span style=display:flex><span>  (evil-define-key &#39;(normal visual) <span style=color:#0ff;font-weight:700>&#39;global</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;glL&#34;</span> <span style=color:#0ff;font-weight:700>&#39;lingva-translate</span>))
</span></span></code></pre></div><h4 id=sdcv>sdcv</h4><p>此 sdcv 来自 <a href=https://github.com/manateelazycat/sdcv/tree/master/>manateelazycat/sdcv: Emacs interface for sdcv (Stardict console version)</a> 而不是 Melpa 上的。</p><p>关于 sdcv 的词典可以去这下载：<a href=http://download.huzheng.org/dict.org/>dictd-www.dict.org Dictionaries</a></p><p>默认的颜色不喜欢可以通过 <code>face-spec-set</code> 函数进行设置。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> sdcv
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:commands</span> sdcv-search-pointer sdcv-search-input+
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (face-spec-set <span style=color:#0ff;font-weight:700>&#39;sdcv-tooltip-face</span>
</span></span><span style=display:flex><span>                 &#39;((((background light))
</span></span><span style=display:flex><span>                    <span style=color:#fff;font-weight:700>:foreground</span> <span style=color:#0ff;font-weight:700>&#34;#000000&#34;</span> <span style=color:#fff;font-weight:700>:background</span> <span style=color:#0ff;font-weight:700>&#34;#ffffff&#34;</span>)
</span></span><span style=display:flex><span>                   (t
</span></span><span style=display:flex><span>                    <span style=color:#fff;font-weight:700>:foreground</span> <span style=color:#0ff;font-weight:700>&#34;#ffffff&#34;</span> <span style=color:#fff;font-weight:700>:background</span> <span style=color:#0ff;font-weight:700>&#34;#000000&#34;</span>))
</span></span><span style=display:flex><span>                 <span style=color:#0ff;font-weight:700>&#39;face-override-spec</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> sdcv-tooltip-border-width <span style=color:#ff0;font-weight:700>2</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> sdcv-dictionary-data-dir (expand-file-name <span style=color:#0ff;font-weight:700>&#34;sdcv-dict&#34;</span> user-emacs-directory))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> sdcv-program <span style=color:#0ff;font-weight:700>&#34;/opt/homebrew/bin/sdcv&#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> sdcv-dictionary-simple-list    <span style=color:#007f7f>;星际译王屏幕取词词典, 简单, 快速</span>
</span></span><span style=display:flex><span>        &#39;(<span style=color:#0ff;font-weight:700>&#34;懒虫简明英汉词典&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#0ff;font-weight:700>&#34;懒虫简明汉英词典&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#0ff;font-weight:700>&#34;KDic11万英汉词典&#34;</span>))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> sdcv-dictionary-complete-list     <span style=color:#007f7f>;星际译王的词典, 完全, 详细</span>
</span></span><span style=display:flex><span>        &#39;(<span style=color:#0ff;font-weight:700>&#34;牛津英汉双解美化版&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#0ff;font-weight:700>&#34;懒虫简明英汉词典&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#0ff;font-weight:700>&#34;英汉汉英专业词典&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#0ff;font-weight:700>&#34;XDICT英汉辞典&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#0ff;font-weight:700>&#34;stardict1.3英汉辞典&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#0ff;font-weight:700>&#34;WordNet&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#0ff;font-weight:700>&#34;XDICT汉英辞典&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#0ff;font-weight:700>&#34;Jargon&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#0ff;font-weight:700>&#34;懒虫简明汉英词典&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#0ff;font-weight:700>&#34;FOLDOC&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#0ff;font-weight:700>&#34;新世纪英汉科技大词典&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#0ff;font-weight:700>&#34;KDic11万英汉词典&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#0ff;font-weight:700>&#34;朗道汉英字典5.0&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#0ff;font-weight:700>&#34;CDICT5英汉辞典&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#0ff;font-weight:700>&#34;新世纪汉英科技大词典&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#0ff;font-weight:700>&#34;21世纪双语科技词典&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#0ff;font-weight:700>&#34;quick_eng-zh_CN&#34;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>with-eval-after-load</span> <span style=color:#0ff;font-weight:700>&#39;evil-collection</span>
</span></span><span style=display:flex><span>    (evil-define-key &#39;(normal visual) <span style=color:#0ff;font-weight:700>&#39;global</span>
</span></span><span style=display:flex><span>      <span style=color:#0ff;font-weight:700>&#34;glp&#34;</span> <span style=color:#0ff;font-weight:700>&#39;sdcv-search-pointer</span>
</span></span><span style=display:flex><span>      <span style=color:#0ff;font-weight:700>&#34;gli&#34;</span> <span style=color:#0ff;font-weight:700>&#39;sdcv-search-input+</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (evil-collection-define-key <span style=color:#0ff;font-weight:700>&#39;normal</span> <span style=color:#0ff;font-weight:700>&#39;sdcv-mode-map</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;q&#34;</span> <span style=color:#0ff;font-weight:700>&#39;quit-window</span>))
</span></span></code></pre></div><h4 id=osx-dictionary>osx-dictionary</h4><p><a href=https://github.com/xuchunyang/osx-dictionary.el>xuchunyang/osx-dictionary.el: Mac OS X Dictionary.app interface for Emacs</a></p><p>这个是使用 MacOS 上自带的 dictionary 进行单词的查询，需要让 dictionary 后台运行，否则无结果显示。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> osx-dictionary
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:commands</span> osx-dictionary-search-pointer)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>with-eval-after-load</span> <span style=color:#0ff;font-weight:700>&#39;evil</span>
</span></span><span style=display:flex><span>  (evil-define-key &#39;(normal visual) <span style=color:#0ff;font-weight:700>&#39;global</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;gld&#34;</span> <span style=color:#0ff;font-weight:700>&#39;osx-dictionary-search-pointer</span>))
</span></span></code></pre></div><h4 id=powerthesaurus>powerthesaurus</h4><p>这个的好处是可以用于查询同义词、反义词等等，用于替换单词比较方便。</p><p>需要实时在线查询，有时候结果返回的较慢。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> powerthesaurus
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:commands</span> (powerthesaurus-lookup-dwim
</span></span><span style=display:flex><span>             powerthesaurus-lookup-related-dwim
</span></span><span style=display:flex><span>             powerthesaurus-lookup-synonyms-dwim
</span></span><span style=display:flex><span>             powerthesaurus-lookup-antonyms-dwim
</span></span><span style=display:flex><span>             powerthesaurus-lookup-definitions-dwim
</span></span><span style=display:flex><span>             powerthesaurus-lookup-sentences-dwim))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>with-eval-after-load</span> <span style=color:#0ff;font-weight:700>&#39;evil</span>
</span></span><span style=display:flex><span>  (evil-define-key &#39;(normal visual) <span style=color:#0ff;font-weight:700>&#39;global</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;glt&#34;</span> <span style=color:#0ff;font-weight:700>&#39;powerthesaurus-lookup-dwim</span>))
</span></span></code></pre></div><h4 id=dictionary-overlay>dictionary-overlay</h4><p><a href=https://github.com/ginqi7/websocket-bridge>websocket-bridge</a> and <a href=https://github.com/ginqi7/dictionary-overlay>dictionary-overlay</a> can be used to learn English words.</p><p>我的日常使用流程是使用 <code>SPC b r</code> 来渲染 buffer, 使用 <code>SPC l k</code> 标记不认识的单词，使用 <code>SPC l K</code> 将单词标记为己知。</p><p>若通过单词查询的单词也自动标记为未知，下次渲染 buffer 时就会自动标出其词意。</p><p>这个功能在阅读 RSS 的时候十分的方便。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> dictionary-overlay
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:defer</span> <span style=color:#ff0;font-weight:700>5</span>
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:load-path</span> <span style=color:#0ff;font-weight:700>&#34;~/.emacs.d/packages/dictionary-overlay/&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> dictionary-overlay-translators &#39;(<span style=color:#0ff;font-weight:700>&#34;local&#34;</span> <span style=color:#0ff;font-weight:700>&#34;darwin&#34;</span> <span style=color:#0ff;font-weight:700>&#34;sdcv&#34;</span> <span style=color:#0ff;font-weight:700>&#34;web&#34;</span>))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> dictionary-overlay-user-data-directory
</span></span><span style=display:flex><span>        (expand-file-name <span style=color:#0ff;font-weight:700>&#34;cache/dictionary-overlay&#34;</span> user-emacs-directory))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> dictionary-overlay-python <span style=color:#0ff;font-weight:700>&#34;/opt/homebrew/bin/python3.10&#34;</span>)
</span></span><span style=display:flex><span>  (dictionary-overlay-start))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>with-eval-after-load</span> <span style=color:#0ff;font-weight:700>&#39;evil</span>
</span></span><span style=display:flex><span>  (evil-define-key &#39;(normal visual) <span style=color:#0ff;font-weight:700>&#39;global</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;glr&#34;</span> <span style=color:#0ff;font-weight:700>&#39;dictionary-overlay-render-buffer</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;glk&#34;</span> <span style=color:#0ff;font-weight:700>&#39;dictionary-overlay-mark-word-unknown</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;glK&#34;</span> <span style=color:#0ff;font-weight:700>&#39;dictionary-overlay-mark-word-known</span>))
</span></span></code></pre></div><h4 id=flycheck>flycheck</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> flycheck
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (prog-mode . flycheck-mode))
</span></span></code></pre></div><h4 id=flycheck-grammarly>flycheck-grammarly</h4><p>langtool 也可以检查语法，相比较 grammarly，不需要连网，所以速度较快。
自动开启此功能导致在文档较大时有明显的卡顿感，手动开启语法检查较好。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> flycheck-grammarly
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:after</span> flycheck
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:commands</span> flycheck-grammarly-setup)
</span></span></code></pre></div><h4 id=siri-translate-with-shortcut>siri-translate with shortcut</h4><p>在 MacOS 可以调用 shortcut 使用系统翻译功能。</p><p>此处仅做记录，我不怎么使用。具体的见 <a href=https://emacs-china.org/t/emacs-macos/23268>Emacs+macOS 最简单也最强大的中英互译设置，不只英语 - Emacs-general - Emacs China</a>.</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(add-to-list <span style=color:#0ff;font-weight:700>&#39;display-buffer-alist</span>
</span></span><span style=display:flex><span>             (cons
</span></span><span style=display:flex><span>              <span style=color:#0ff;font-weight:700>&#34;\\*Async Shell Command\\*.*&#34;</span>
</span></span><span style=display:flex><span>              (cons #&#39;display-buffer-no-window nil)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> my/siri-translate ()
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>let</span> ((tempfile (make-temp-file <span style=color:#0ff;font-weight:700>&#34;siri-translate-&#34;</span> nil <span style=color:#0ff;font-weight:700>&#34;.txt&#34;</span>)))
</span></span><span style=display:flex><span>    (write-region
</span></span><span style=display:flex><span>     (format <span style=color:#0ff;font-weight:700>&#34;%s&#34;</span> (thing-at-point <span style=color:#0ff;font-weight:700>&#39;paragraph</span>)) nil tempfile)
</span></span><span style=display:flex><span>    (end-of-paragraph-text)
</span></span><span style=display:flex><span>    (shell-command (format <span style=color:#0ff;font-weight:700>&#34;shortcuts run \&#34;Translate File\&#34; -i %s &amp;&#34;</span> tempfile)))
</span></span><span style=display:flex><span>  (shell-command <span style=color:#0ff;font-weight:700>&#34;open -b org.gnu.Emacs&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> my/siri-translate2english ()
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>let</span> ((tempfile (make-temp-file <span style=color:#0ff;font-weight:700>&#34;siri-translate-&#34;</span> nil <span style=color:#0ff;font-weight:700>&#34;.txt&#34;</span>)))
</span></span><span style=display:flex><span>    (write-region
</span></span><span style=display:flex><span>     (format <span style=color:#0ff;font-weight:700>&#34;%s&#34;</span> (thing-at-point <span style=color:#0ff;font-weight:700>&#39;paragraph</span>)) nil tempfile)
</span></span><span style=display:flex><span>    (end-of-paragraph-text)
</span></span><span style=display:flex><span>    (shell-command (format <span style=color:#0ff;font-weight:700>&#34;shortcuts run \&#34;Translate File 2 English\&#34; -i %s &amp;&#34;</span> tempfile)))
</span></span><span style=display:flex><span>  (shell-command <span style=color:#0ff;font-weight:700>&#34;open -b org.gnu.Emacs&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> language-to-zh-or-zh-to-english ()
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>let</span> ((string (thing-at-point <span style=color:#0ff;font-weight:700>&#39;paragraph</span>)))
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>if</span> (eq (string-match <span style=color:#0ff;font-weight:700>&#34;\\cC&#34;</span> string) nil)
</span></span><span style=display:flex><span>        (my/siri-translate)
</span></span><span style=display:flex><span>      (my/siri-translate2english))))
</span></span></code></pre></div><h4 id=footer>Footer</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>provide</span> <span style=color:#0ff;font-weight:700>&#39;init-translate</span>)
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; init-translate.el ends here.</span>
</span></span></code></pre></div><h3 id=lsp-and-programming-language>LSP and programming language</h3><h4 id=header>Header</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#007f7f>;; init-language.el --- lsp and programming language *- lexical-binding: t; no-byte-compile: t -*-</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Commentary:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Code:</span>
</span></span></code></pre></div><h4 id=markdown>markdown</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> markdown-mode
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:mode</span> ((<span style=color:#0ff;font-weight:700>&#34;\\.\\(?:md\\|markdown\\|mkd\\|mdown\\|mkdn\\|mdwn\\)\\&#39;&#34;</span> . markdown-mode)
</span></span><span style=display:flex><span>         (<span style=color:#0ff;font-weight:700>&#34;README\\.md\\&#39;&#34;</span> . gfm-mode))
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:init</span> (<span style=color:#fff;font-weight:700>setq</span> markdown-command <span style=color:#0ff;font-weight:700>&#34;multimarkdown&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:bind</span> (<span style=color:#fff;font-weight:700>:map</span> markdown-mode-map
</span></span><span style=display:flex><span>         (<span style=color:#0ff;font-weight:700>&#34;C-c C-e&#34;</span> . markdown-do)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;; (with-eval-after-load &#39;whitespace-cleanup-mode</span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;   (add-to-list &#39;whitespace-cleanup-mode-ignore-modes &#39;markdown-mode))</span>
</span></span></code></pre></div><h4 id=python>Python</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(add-to-list <span style=color:#0ff;font-weight:700>&#39;auto-mode-alist</span> &#39;(<span style=color:#0ff;font-weight:700>&#34;poetry\\.lock\\&#39;&#34;</span> . toml-mode))
</span></span></code></pre></div><h4 id=yaml-mode>yaml-mode</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> yaml-mode
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:mode</span> (<span style=color:#0ff;font-weight:700>&#34;\\.yaml\\&#39;&#34;</span> . yaml-mode))
</span></span><span style=display:flex><span>  <span style=color:#007f7f>;; :config</span>
</span></span><span style=display:flex><span>  <span style=color:#007f7f>;; (add-to-list &#39;auto-mode-alist &#39;(&#34;\\.yml\\&#39;&#34; . yaml-mode))</span>
</span></span><span style=display:flex><span>  <span style=color:#007f7f>;; (add-to-list &#39;auto-mode-alist &#39;(&#34;\\.yaml\\&#39;&#34; . yaml-mode)))</span>
</span></span></code></pre></div><h4 id=footer>Footer</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>provide</span> <span style=color:#0ff;font-weight:700>&#39;init-language</span>)
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; init-language.el ends here.</span>
</span></span></code></pre></div><h2 id=organize-life-with-plain-text-high-effective-system>Organize Life with Plain Text, High Effective System</h2><h3 id=org-mode>Org-mode</h3><h4 id=header>Header</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#007f7f>;; init-org.el --- org-mode *- lexical-binding: t; no-byte-compile: t -*-</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Commentary:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Code:</span>
</span></span></code></pre></div><h4 id=basic-of-org-mode>Basic of org-mode</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> org
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-ellipsis <span style=color:#0ff;font-weight:700>&#34; ⇲&#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-modules &#39;()
</span></span><span style=display:flex><span>        org-imenu-depth <span style=color:#ff0;font-weight:700>4</span>
</span></span><span style=display:flex><span>        org-return-follows-link t
</span></span><span style=display:flex><span>        org-image-actual-width nil
</span></span><span style=display:flex><span>        org-display-remote-inline-images <span style=color:#0ff;font-weight:700>&#39;download</span>
</span></span><span style=display:flex><span>        org-log-into-drawer t
</span></span><span style=display:flex><span>        org-fast-tag-selection-single-key <span style=color:#0ff;font-weight:700>&#39;expert</span>
</span></span><span style=display:flex><span>        org-adapt-indentation nil
</span></span><span style=display:flex><span>        org-fontify-quote-and-verse-blocks t
</span></span><span style=display:flex><span>        org-support-shift-select t
</span></span><span style=display:flex><span>        org-treat-S-cursor-todo-selection-as-state-change nil
</span></span><span style=display:flex><span>        org-hide-leading-stars nil
</span></span><span style=display:flex><span>        org-startup-with-inline-images t
</span></span><span style=display:flex><span>        org-image-actual-width &#39;(<span style=color:#ff0;font-weight:700>500</span>)
</span></span><span style=display:flex><span>        org-use-speed-commands t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-enforce-todo-dependencies t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-enforce-todo-checkbox-dependencies t)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-todo-repeat-to-state t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-todo-keywords
</span></span><span style=display:flex><span>        &#39;((sequence <span style=color:#0ff;font-weight:700>&#34;TODO(t)&#34;</span> <span style=color:#0ff;font-weight:700>&#34;NEXT(n)&#34;</span> <span style=color:#0ff;font-weight:700>&#34;INPROGRESS(i)&#34;</span> <span style=color:#0ff;font-weight:700>&#34;|&#34;</span> <span style=color:#0ff;font-weight:700>&#34;WAIT(w@)&#34;</span> <span style=color:#0ff;font-weight:700>&#34;SOMEDAY(s@)&#34;</span> <span style=color:#0ff;font-weight:700>&#34;CNCL(c@/!)&#34;</span> <span style=color:#0ff;font-weight:700>&#34;DONE(d)&#34;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-todo-keyword-faces
</span></span><span style=display:flex><span>        &#39;((<span style=color:#0ff;font-weight:700>&#34;NEXT&#34;</span> . &#39;(success org-todo))
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;TODO&#34;</span> . <span style=color:#0ff;font-weight:700>&#39;org-todo</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;CNCL&#34;</span> . &#39;(region org-todo))
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;WAIT&#34;</span> . &#39;(bold org-todo))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-priority-faces
</span></span><span style=display:flex><span>        &#39;((<span style=color:#0ff;font-weight:700>?A</span> . &#39;(bold org-priority))
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>?B</span> . org-priority)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>?C</span> . &#39;(shadow org-priority))))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-todo-state-tags-triggers
</span></span><span style=display:flex><span>        (<span style=color:#fff;font-weight:700>quote</span> ((<span style=color:#0ff;font-weight:700>&#34;CNCL&#34;</span> (<span style=color:#0ff;font-weight:700>&#34;CNCL&#34;</span> . t))
</span></span><span style=display:flex><span>                (<span style=color:#0ff;font-weight:700>&#34;WAIT&#34;</span> (<span style=color:#0ff;font-weight:700>&#34;WAIT&#34;</span> . t))
</span></span><span style=display:flex><span>                (<span style=color:#0ff;font-weight:700>&#34;SOMEDAY&#34;</span> (<span style=color:#0ff;font-weight:700>&#34;WAIT&#34;</span>) (<span style=color:#0ff;font-weight:700>&#34;SOMEDAY&#34;</span> . t))
</span></span><span style=display:flex><span>                (done (<span style=color:#0ff;font-weight:700>&#34;WAIT&#34;</span>) (<span style=color:#0ff;font-weight:700>&#34;SOMEDAY&#34;</span>))
</span></span><span style=display:flex><span>                (<span style=color:#0ff;font-weight:700>&#34;TODO&#34;</span> (<span style=color:#0ff;font-weight:700>&#34;WAIT&#34;</span>) (<span style=color:#0ff;font-weight:700>&#34;CNCL&#34;</span>) (<span style=color:#0ff;font-weight:700>&#34;SOMEDAY&#34;</span>))
</span></span><span style=display:flex><span>                (<span style=color:#0ff;font-weight:700>&#34;NEXT&#34;</span> (<span style=color:#0ff;font-weight:700>&#34;WAIT&#34;</span>) (<span style=color:#0ff;font-weight:700>&#34;CNCL&#34;</span>) (<span style=color:#0ff;font-weight:700>&#34;SOMEDAY&#34;</span>))
</span></span><span style=display:flex><span>                (<span style=color:#0ff;font-weight:700>&#34;DONE&#34;</span> (<span style=color:#0ff;font-weight:700>&#34;WAIT&#34;</span>) (<span style=color:#0ff;font-weight:700>&#34;CNCL&#34;</span>) (<span style=color:#0ff;font-weight:700>&#34;SOMEDAY&#34;</span>)))))
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:bind</span> (<span style=color:#fff;font-weight:700>:map</span> org-mode-map
</span></span><span style=display:flex><span>              (<span style=color:#0ff;font-weight:700>&#34;C-c l&#34;</span> . org-store-link)))
</span></span><span style=display:flex><span><span style=color:#007f7f>;; (&#34;&lt;return&gt;&#34; . org-return)))</span>
</span></span></code></pre></div><ul><li><p>org-babel</p><p>以下配置来源：<a href=https://emacs-china.org/t/org-babel/18699>https://emacs-china.org/t/org-babel/18699</a></p><p>禁用 org babel 加载的语言可以有效的提高 Emacs 的启动速度。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>(org-babel-do-load-languages
</span></span><span style=display:flex><span> &#39;org-babel-load-languages
</span></span><span style=display:flex><span> &#39;((emacs-lisp . t)))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> ob-core
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:after</span> org
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>defun</span> my/org-babel-execute-src-block (<span style=color:#fff;font-weight:700>&amp;optional</span> _arg info _params)
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;Load language if needed&#34;</span>
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>let*</span> ((lang (nth <span style=color:#ff0;font-weight:700>0</span> info))
</span></span><span style=display:flex><span>           (sym (<span style=color:#fff;font-weight:700>if</span> (member (downcase lang) &#39;(<span style=color:#0ff;font-weight:700>&#34;c&#34;</span> <span style=color:#0ff;font-weight:700>&#34;cpp&#34;</span> <span style=color:#0ff;font-weight:700>&#34;c++&#34;</span>)) <span style=color:#0ff;font-weight:700>&#39;C</span> (intern lang)))
</span></span><span style=display:flex><span>           (backup-languages org-babel-load-languages))
</span></span><span style=display:flex><span>      (<span style=color:#fff;font-weight:700>unless</span> (assoc sym backup-languages)
</span></span><span style=display:flex><span>        (<span style=color:#fff;font-weight:700>condition-case</span> err
</span></span><span style=display:flex><span>            (<span style=color:#fff;font-weight:700>progn</span>
</span></span><span style=display:flex><span>              (org-babel-do-load-languages <span style=color:#0ff;font-weight:700>&#39;org-babel-load-languages</span> (list (cons sym t)))
</span></span><span style=display:flex><span>              (<span style=color:#fff;font-weight:700>setq-default</span> org-babel-load-languages (append (list (cons sym t)) backup-languages)))
</span></span><span style=display:flex><span>          (file-missing
</span></span><span style=display:flex><span>           (<span style=color:#fff;font-weight:700>setq-default</span> org-babel-load-languages backup-languages)
</span></span><span style=display:flex><span>           err)))))
</span></span><span style=display:flex><span>  (advice-add <span style=color:#0ff;font-weight:700>&#39;org-babel-execute-src-block</span> <span style=color:#fff;font-weight:700>:before</span> <span style=color:#0ff;font-weight:700>&#39;my/org-babel-execute-src-block</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-confirm-babel-evaluate nil))
</span></span></code></pre></div><ul><li><p>dotsk</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>require</span> <span style=color:#0ff;font-weight:700>&#39;org-macs</span>)
</span></span><span style=display:flex><span>(org-assert-version)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defvar</span> org-babel-default-header-args:dotsk
</span></span><span style=display:flex><span>  &#39;((<span style=color:#fff;font-weight:700>:results</span> . <span style=color:#0ff;font-weight:700>&#34;file&#34;</span>) (<span style=color:#fff;font-weight:700>:exports</span> . <span style=color:#0ff;font-weight:700>&#34;results&#34;</span>))
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Default arguments to use when evaluating a dot source block.&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> org-babel-expand-body:dotsk (body params)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Expand BODY according to PARAMS, return the expanded body.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>let</span> ((vars (org-babel--get-vars params)))
</span></span><span style=display:flex><span>    (mapc
</span></span><span style=display:flex><span>     (<span style=color:#fff;font-weight:700>lambda</span> (pair)
</span></span><span style=display:flex><span>       (<span style=color:#fff;font-weight:700>let</span> ((name (symbol-name (car pair)))
</span></span><span style=display:flex><span>             (value (cdr pair)))
</span></span><span style=display:flex><span>         (<span style=color:#fff;font-weight:700>setq</span> body
</span></span><span style=display:flex><span>               (replace-regexp-in-string
</span></span><span style=display:flex><span>                (concat <span style=color:#0ff;font-weight:700>&#34;$&#34;</span> (regexp-quote name))
</span></span><span style=display:flex><span>                (<span style=color:#fff;font-weight:700>if</span> (stringp value) value (format <span style=color:#0ff;font-weight:700>&#34;%S&#34;</span> value))
</span></span><span style=display:flex><span>                body
</span></span><span style=display:flex><span>                t
</span></span><span style=display:flex><span>                t))))
</span></span><span style=display:flex><span>     vars)
</span></span><span style=display:flex><span>    body))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> org-babel-execute:dotsk (body params)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34; This function is called by </span><span style=color:#0ff;font-weight:700>`org-babel-execute-src-block&#39;</span><span style=color:#0ff;font-weight:700>.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>let*</span> ((out-file (cdr (<span style=color:#fff;font-weight:700>or</span> (assq <span style=color:#fff;font-weight:700>:file</span> params)
</span></span><span style=display:flex><span>                            (error <span style=color:#0ff;font-weight:700>&#34;You need to specify a :file parameter&#34;</span>))))
</span></span><span style=display:flex><span>         (cmdline (<span style=color:#fff;font-weight:700>or</span> (cdr (assq <span style=color:#fff;font-weight:700>:cmdline</span> params))))
</span></span><span style=display:flex><span>         (cmd (<span style=color:#fff;font-weight:700>or</span> (cdr (assq <span style=color:#fff;font-weight:700>:cmd</span> params)) (concat <span style=color:#0ff;font-weight:700>&#34;node &#34;</span> user-emacs-directory <span style=color:#0ff;font-weight:700>&#34;packages/sketchviz/sketch.js&#34;</span>))
</span></span><span style=display:flex><span>              (coding-system-for-read <span style=color:#0ff;font-weight:700>&#39;utf-8</span>) <span style=color:#007f7f>;use utf-8 with sub-processes</span>
</span></span><span style=display:flex><span>              (coding-system-for-write <span style=color:#0ff;font-weight:700>&#39;utf-8</span>)
</span></span><span style=display:flex><span>              (in-file (org-babel-temp-file <span style=color:#0ff;font-weight:700>&#34;dotsk-&#34;</span>)))
</span></span><span style=display:flex><span>         (<span style=color:#fff;font-weight:700>with-temp-file</span> in-file
</span></span><span style=display:flex><span>           (insert (org-babel-expand-body:dotsk body params)))
</span></span><span style=display:flex><span>         (org-babel-eval
</span></span><span style=display:flex><span>          (concat cmd
</span></span><span style=display:flex><span>                  <span style=color:#0ff;font-weight:700>&#34; &#34;</span> (org-babel-process-file-name in-file)
</span></span><span style=display:flex><span>                  <span style=color:#0ff;font-weight:700>&#34; &#34;</span> cmdline
</span></span><span style=display:flex><span>                  <span style=color:#0ff;font-weight:700>&#34; &#34;</span> (org-babel-process-file-name out-file)) <span style=color:#0ff;font-weight:700>&#34;&#34;</span>)
</span></span><span style=display:flex><span>         nil)) <span style=color:#007f7f>;; signal that output has already been written to file</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>defun</span> org-babel-prep-session:dotsk (_session _params)
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;Return an error because Dot does not support sessions.&#34;</span>
</span></span><span style=display:flex><span>    (error <span style=color:#0ff;font-weight:700>&#34;Dot does not support sessions&#34;</span>))
</span></span></code></pre></div></li></ul></li></ul><ul><li><p>org-capture</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> org-capture
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:after</span> org
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:bind</span> (<span style=color:#fff;font-weight:700>:map</span> org-capture-mode-map
</span></span><span style=display:flex><span>              ([remap evil-save-and-close] . org-capture-finalize)
</span></span><span style=display:flex><span>              ([remap evil-save-modified-and-close] . org-capture-finalize)
</span></span><span style=display:flex><span>              ([remap evil-quit] . org-capture-kill)
</span></span><span style=display:flex><span>              (<span style=color:#0ff;font-weight:700>&#34;RET&#34;</span> . org-capture-finalize))
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-capture-templates
</span></span><span style=display:flex><span>        &#39;((<span style=color:#0ff;font-weight:700>&#34;i&#34;</span> <span style=color:#0ff;font-weight:700>&#34;GTD Inbox&#34;</span>
</span></span><span style=display:flex><span>           entry (file (<span style=color:#fff;font-weight:700>lambda</span> () (concat my-galaxy <span style=color:#0ff;font-weight:700>&#34;/todos/inbox.org&#34;</span>)))
</span></span><span style=display:flex><span>           <span style=color:#0ff;font-weight:700>&#34;* %?\n%U\n&#34;</span> <span style=color:#fff;font-weight:700>:time-prompt</span> t <span style=color:#fff;font-weight:700>:tree-type</span> week)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;I&#34;</span> <span style=color:#0ff;font-weight:700>&#34;NC Inbox&#34;</span>
</span></span><span style=display:flex><span>           plain (file+olp+datetree (<span style=color:#fff;font-weight:700>lambda</span> () (concat my-galaxy <span style=color:#0ff;font-weight:700>&#34;/inbox/inbox.org&#34;</span>)))
</span></span><span style=display:flex><span>           <span style=color:#0ff;font-weight:700>&#34;**** %?\n%U\n&#34;</span> <span style=color:#fff;font-weight:700>:time-prompt</span> t <span style=color:#fff;font-weight:700>:tree-type</span> week)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;p&#34;</span> <span style=color:#0ff;font-weight:700>&#34;Daily Plan&#34;</span>
</span></span><span style=display:flex><span>           plain (file+olp+datetree (<span style=color:#fff;font-weight:700>lambda</span> () (concat my-galaxy <span style=color:#0ff;font-weight:700>&#34;/inbox/plan.org&#34;</span>)))
</span></span><span style=display:flex><span>           <span style=color:#0ff;font-weight:700>&#34;- [ ] %?\n%U\n&#34;</span> <span style=color:#fff;font-weight:700>:time-prompt</span> t <span style=color:#fff;font-weight:700>:tree-type</span> week)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;r&#34;</span> <span style=color:#0ff;font-weight:700>&#34;Reflection&#34;</span>
</span></span><span style=display:flex><span>           plain
</span></span><span style=display:flex><span>           (file+olp+datetree (<span style=color:#fff;font-weight:700>lambda</span> () (concat my-galaxy <span style=color:#0ff;font-weight:700>&#34;/roam/main/reflection.org&#34;</span>)))
</span></span><span style=display:flex><span>           (file <span style=color:#0ff;font-weight:700>&#34;~/.emacs.d/template/tpl-daily-reflection&#34;</span>)
</span></span><span style=display:flex><span>           <span style=color:#fff;font-weight:700>:time-prompt</span> t <span style=color:#fff;font-weight:700>:tree-type</span> week)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;a&#34;</span> <span style=color:#0ff;font-weight:700>&#34;Anki Deck&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;ae&#34;</span> <span style=color:#0ff;font-weight:700>&#34;Deck: English&#34;</span>
</span></span><span style=display:flex><span>           entry (file (<span style=color:#fff;font-weight:700>lambda</span> ()
</span></span><span style=display:flex><span>                         (concat my-galaxy <span style=color:#0ff;font-weight:700>&#34;/anki/anki_english.org&#34;</span>)))
</span></span><span style=display:flex><span>           <span style=color:#0ff;font-weight:700>&#34;* %?\n&#34;</span> <span style=color:#fff;font-weight:700>:jump-to-captured</span> t)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;ac&#34;</span> <span style=color:#0ff;font-weight:700>&#34;Deck: Civil Engineering&#34;</span>
</span></span><span style=display:flex><span>           entry (file (<span style=color:#fff;font-weight:700>lambda</span> ()
</span></span><span style=display:flex><span>                         (concat my-galaxy <span style=color:#0ff;font-weight:700>&#34;/anki/anki_engineering.org&#34;</span>)))
</span></span><span style=display:flex><span>           <span style=color:#0ff;font-weight:700>&#34;* %?\n&#34;</span> <span style=color:#fff;font-weight:700>:jump-to-captured</span> t)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;s&#34;</span> <span style=color:#0ff;font-weight:700>&#34;Code snippets&#34;</span>
</span></span><span style=display:flex><span>           entry (file (<span style=color:#fff;font-weight:700>lambda</span> ()
</span></span><span style=display:flex><span>                         (concat my-galaxy <span style=color:#0ff;font-weight:700>&#34;/scripts/snippets.org&#34;</span>)))
</span></span><span style=display:flex><span>           <span style=color:#0ff;font-weight:700>&#34;* %?\t%^g\n#+BEGIN_SRC %^{language}\n\n#+END_SRC&#34;</span>)
</span></span><span style=display:flex><span>          <span style=color:#007f7f>;; (&#34;l&#34; &#34;Lists&#34;)</span>
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;m&#34;</span> <span style=color:#0ff;font-weight:700>&#34;Movie&#34;</span>
</span></span><span style=display:flex><span>           entry (file+headline (<span style=color:#fff;font-weight:700>lambda</span> () (concat my-galaxy <span style=color:#0ff;font-weight:700>&#34;/roam/main/watchlist.org&#34;</span>)) <span style=color:#0ff;font-weight:700>&#34;Watching Lists&#34;</span>)
</span></span><span style=display:flex><span>           <span style=color:#0ff;font-weight:700>&#34;* %?
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>:PROPERTIES:
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>:GENRE: %^{Film genre|Action|Adventure|Comedy|Drama|Fantasy|Horror|Musicals|Mystery|Romance|Science fiction|Sports|Thriller}
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>:COUNTRY:
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>:SCORE:
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>:PLOT: %^{PLOT}
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>:END:&#34;</span>))))
</span></span></code></pre></div><p>由于使用了 org-roam 的自动弹出功能，导致 org-capture 的时候光标未能正常的跳转到 org-capture 的窗口当中，使用下面的方法来规避这个问题。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> my/org-capture ()
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Make a new frame to do org-capture staff.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>  (make-frame)
</span></span><span style=display:flex><span>  (org-capture))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(add-hook <span style=color:#0ff;font-weight:700>&#39;org-capture-after-finalize-hook</span> <span style=color:#0ff;font-weight:700>&#39;delete-frame</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;; (add-to-list &#39;display-buffer-alist &#39;(&#34;\\*Org Select\\*&#34;</span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;                                      (display-buffer-pop-up-frame)</span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;                                      (window-parameters</span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;                                       (no-other-window . t)</span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;                                       (mode-line-format . none)</span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;                                       (no-delete-other-windows . t))))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(global-set-key (kbd <span style=color:#0ff;font-weight:700>&#34;&lt;f10&gt;&#34;</span>) <span style=color:#0ff;font-weight:700>&#39;my/org-capture</span>)
</span></span></code></pre></div></li></ul><ul><li><p>org-attach</p><p>POST：<a href=https://fuco1.github.io/2023-02-08-Visit-the-org-headline-from-the-attach-dired-buffer.html>Visit the org headline from the attach dired buffer</a>
通常不需要管理附件在文件夹中是怎么存放的，找到 heading 就可以找到对应的附件。
或者当在 <code>dired</code> 中查看 <code>attach</code> 文件夹中的附件时，可以使用 <code>my/org-attach-visit-heading-from-dired</code> 函数跳转到对应的 heading 位置。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> org-attach
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-attach-id-dir (expand-file-name <span style=color:#0ff;font-weight:700>&#34;attach&#34;</span> my-galaxy))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>defun</span> my/org-attach-visit-headline-from-dired ()
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;Go to the headline corresponding to this org-attach directory.&#34;</span>
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>let*</span> ((id-parts (last (split-string default-directory <span style=color:#0ff;font-weight:700>&#34;/&#34;</span> t) <span style=color:#ff0;font-weight:700>2</span>))
</span></span><span style=display:flex><span>           (id (apply #&#39;concat id-parts)))
</span></span><span style=display:flex><span>      (<span style=color:#fff;font-weight:700>let</span> ((m (org-id-find id <span style=color:#0ff;font-weight:700>&#39;marker</span>)))
</span></span><span style=display:flex><span>        (<span style=color:#fff;font-weight:700>unless</span> m (user-error <span style=color:#0ff;font-weight:700>&#34;Cannot find entry with ID \&#34;%s\&#34;&#34;</span> id))
</span></span><span style=display:flex><span>        (pop-to-buffer (marker-buffer m))
</span></span><span style=display:flex><span>        (goto-char m)
</span></span><span style=display:flex><span>        (move-marker m nil)
</span></span><span style=display:flex><span>        (org-fold-show-context))))
</span></span><span style=display:flex><span>  (add-to-list <span style=color:#0ff;font-weight:700>&#39;display-buffer-alist</span>
</span></span><span style=display:flex><span>               &#39;(<span style=color:#0ff;font-weight:700>&#34;\\*Org Attach\\*&#34;</span>
</span></span><span style=display:flex><span>                 (display-buffer-pop-up-frame)
</span></span><span style=display:flex><span>                 (side . right)
</span></span><span style=display:flex><span>                 (slot . <span style=color:#ff0;font-weight:700>0</span>)
</span></span><span style=display:flex><span>                 (window-width . <span style=color:#ff0;font-weight:700>0.5</span>)
</span></span><span style=display:flex><span>                 (window-parameters . ((no-other-window . t)
</span></span><span style=display:flex><span>                                       (no-delete-other-windows . t)))))
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:bind</span> (<span style=color:#fff;font-weight:700>:map</span> dired-mode-map
</span></span><span style=display:flex><span>              (<span style=color:#0ff;font-weight:700>&#34;C-&#39;&#34;</span> . my/org-attach-visit-headline-from-dired)))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> my/copy-or-move-file-to-buffer-dir
</span></span><span style=display:flex><span>    (file-name <span style=color:#fff;font-weight:700>&amp;optional</span> arg)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Copy or move the FILE-NAME to the directory of the buffer&#39;s file.\n
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>With prefix argument ARG, copy the file instead of moving it.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span> <span style=color:#0ff;font-weight:700>&#34;FFile to move: \nP&#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>let</span> ((new-file-name (concat (file-name-directory (buffer-file-name))
</span></span><span style=display:flex><span>                               (file-name-nondirectory file-name))))
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>if</span> (not (file-exists-p file-name))
</span></span><span style=display:flex><span>        (error <span style=color:#0ff;font-weight:700>&#34;File does not exist: %s&#34;</span> file-name)
</span></span><span style=display:flex><span>      (<span style=color:#fff;font-weight:700>if</span> (file-exists-p new-file-name)
</span></span><span style=display:flex><span>          (error <span style=color:#0ff;font-weight:700>&#34;File already exists: %s&#34;</span> new-file-name)
</span></span><span style=display:flex><span>        (<span style=color:#fff;font-weight:700>progn</span>
</span></span><span style=display:flex><span>          (<span style=color:#fff;font-weight:700>let</span> ((command (<span style=color:#fff;font-weight:700>if</span> arg <span style=color:#0ff;font-weight:700>&#39;copy-file</span> <span style=color:#0ff;font-weight:700>&#39;rename-file</span> )))
</span></span><span style=display:flex><span>            (funcall command file-name new-file-name t))
</span></span><span style=display:flex><span>          (<span style=color:#fff;font-weight:700>if</span> arg
</span></span><span style=display:flex><span>              (find-file-noselect new-file-name)
</span></span><span style=display:flex><span>            (<span style=color:#fff;font-weight:700>progn</span>
</span></span><span style=display:flex><span>                (kill-buffer (current-buffer))
</span></span><span style=display:flex><span>                (delete-file file-name)))
</span></span><span style=display:flex><span>          (message <span style=color:#0ff;font-weight:700>&#34;File %s to %s&#34;</span>
</span></span><span style=display:flex><span>                   (<span style=color:#fff;font-weight:700>if</span> arg <span style=color:#0ff;font-weight:700>&#34;moved&#34;</span> <span style=color:#0ff;font-weight:700>&#34;copied&#34;</span>)
</span></span><span style=display:flex><span>                   new-file-name))))))
</span></span></code></pre></div></li></ul><ul><li><p>org-habit</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> org-habit
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:after</span> org-agenda
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (add-to-list <span style=color:#0ff;font-weight:700>&#39;org-modules</span> <span style=color:#0ff;font-weight:700>&#39;org-habit</span> t))
</span></span></code></pre></div></li></ul><ul><li><p>org-id</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> org-id
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:after</span> org
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-id-locations-file (expand-file-name <span style=color:#0ff;font-weight:700>&#34;cache/.org-id-locations&#34;</span> user-emacs-directory))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-id-method <span style=color:#0ff;font-weight:700>&#39;ts</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-id-link-to-org-use-id <span style=color:#0ff;font-weight:700>&#39;create-if-interactive</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> my/copy-idlink ()
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Copy idlink to clipboard.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>when</span> (eq major-mode <span style=color:#0ff;font-weight:700>&#39;org-agenda-mode</span>) <span style=color:#007f7f>;switch to orgmode</span>
</span></span><span style=display:flex><span>    (org-agenda-show)
</span></span><span style=display:flex><span>    (org-agenda-goto))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>when</span> (eq major-mode <span style=color:#0ff;font-weight:700>&#39;org-mode</span>) <span style=color:#007f7f>; do this only in org-mode buffers</span>
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>let*</span> ((mytmphead (nth <span style=color:#ff0;font-weight:700>4</span> (org-heading-components)))
</span></span><span style=display:flex><span>           (mytmpid (funcall <span style=color:#0ff;font-weight:700>&#39;org-id-get-create</span>))
</span></span><span style=display:flex><span>           (mytmplink (format <span style=color:#0ff;font-weight:700>&#34;- [ ] [[id:%s][%s]]&#34;</span> mytmpid mytmphead)))
</span></span><span style=display:flex><span>      (kill-new mytmplink)
</span></span><span style=display:flex><span>      (message <span style=color:#0ff;font-weight:700>&#34;Copied %s to killring (clipboard)&#34;</span> mytmplink))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(global-set-key (kbd <span style=color:#0ff;font-weight:700>&#34;&lt;f7&gt;&#34;</span>) <span style=color:#0ff;font-weight:700>&#39;my/copy-idlink</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(my/space-leader-def
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;oi&#34;</span> &#39;(org-id-get-create <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Create ID&#34;</span>))
</span></span></code></pre></div></li></ul><ul><li><p>org-src</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> org-src
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:after</span> org
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-src-window-setup <span style=color:#0ff;font-weight:700>&#39;current-window</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-src-ask-before-returning-to-edit-buffer nil))
</span></span></code></pre></div></li></ul><ul><li><p>org-refile</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> org-refile
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:after</span> org
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-refile-targets &#39;((nil <span style=color:#fff;font-weight:700>:maxlevel</span> . <span style=color:#ff0;font-weight:700>9</span>)
</span></span><span style=display:flex><span>                             (org-agenda-files <span style=color:#fff;font-weight:700>:maxlevel</span> . <span style=color:#ff0;font-weight:700>9</span>)))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-refile-use-outline-path t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-outline-path-complete-in-steps nil)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-refile-allow-creating-parent-nodes <span style=color:#0ff;font-weight:700>&#39;confirm</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-refile-use-outline-path <span style=color:#0ff;font-weight:700>&#39;file</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-refile-active-region-within-subtree t))
</span></span></code></pre></div></li></ul><ul><li><p>org-emphasis-alist</p><p>此处的设置来源：<a href=https://protesilaos.com/emacs/modus-themes>https://protesilaos.com/emacs/modus-themes</a></p><p>若升级 modus-themes 到 4.0 的版本，可能需要修改。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> org
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>defface</span> my-org-emphasis-bold
</span></span><span style=display:flex><span>    &#39;((default <span style=color:#fff;font-weight:700>:inherit</span> bold)
</span></span><span style=display:flex><span>      (((class color) (min-colors <span style=color:#ff0;font-weight:700>88</span>) (background light))
</span></span><span style=display:flex><span>       <span style=color:#fff;font-weight:700>:foreground</span> <span style=color:#0ff;font-weight:700>&#34;#a60000&#34;</span>)
</span></span><span style=display:flex><span>      (((class color) (min-colors <span style=color:#ff0;font-weight:700>88</span>) (background dark))
</span></span><span style=display:flex><span>       <span style=color:#fff;font-weight:700>:foreground</span> <span style=color:#0ff;font-weight:700>&#34;#ff8059&#34;</span>))
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;My bold emphasis for Org.&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>defface</span> my-org-emphasis-italic
</span></span><span style=display:flex><span>    &#39;((default <span style=color:#fff;font-weight:700>:inherit</span> italic)
</span></span><span style=display:flex><span>      (((class color) (min-colors <span style=color:#ff0;font-weight:700>88</span>) (background light))
</span></span><span style=display:flex><span>       <span style=color:#fff;font-weight:700>:foreground</span> <span style=color:#0ff;font-weight:700>&#34;#005e00&#34;</span>)
</span></span><span style=display:flex><span>      (((class color) (min-colors <span style=color:#ff0;font-weight:700>88</span>) (background dark))
</span></span><span style=display:flex><span>       <span style=color:#fff;font-weight:700>:foreground</span> <span style=color:#0ff;font-weight:700>&#34;#44bc44&#34;</span>))
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;My italic emphasis for Org.&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>defface</span> my-org-emphasis-underline
</span></span><span style=display:flex><span>    &#39;((default <span style=color:#fff;font-weight:700>:inherit</span> underline)
</span></span><span style=display:flex><span>      (((class color) (min-colors <span style=color:#ff0;font-weight:700>88</span>) (background light))
</span></span><span style=display:flex><span>       <span style=color:#fff;font-weight:700>:foreground</span> <span style=color:#0ff;font-weight:700>&#34;#813e00&#34;</span>)
</span></span><span style=display:flex><span>      (((class color) (min-colors <span style=color:#ff0;font-weight:700>88</span>) (background dark))
</span></span><span style=display:flex><span>       <span style=color:#fff;font-weight:700>:foreground</span> <span style=color:#0ff;font-weight:700>&#34;#d0bc00&#34;</span>))
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;My underline emphasis for Org.&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>defface</span> my-org-emphasis-strike-through
</span></span><span style=display:flex><span>    &#39;((default <span style=color:#fff;font-weight:700>:strike-through</span> t)
</span></span><span style=display:flex><span>      (((class color) (min-colors <span style=color:#ff0;font-weight:700>88</span>) (background light))
</span></span><span style=display:flex><span>       <span style=color:#fff;font-weight:700>:foreground</span> <span style=color:#0ff;font-weight:700>&#34;#505050&#34;</span>)
</span></span><span style=display:flex><span>      (((class color) (min-colors <span style=color:#ff0;font-weight:700>88</span>) (background dark))
</span></span><span style=display:flex><span>       <span style=color:#fff;font-weight:700>:foreground</span> <span style=color:#0ff;font-weight:700>&#34;#a8a8a8&#34;</span>))
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;My strike-through emphasis for Org.&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>defface</span> my-org-emphasis-strike-through
</span></span><span style=display:flex><span>    &#39;((((class color) (min-colors <span style=color:#ff0;font-weight:700>88</span>) (background light))
</span></span><span style=display:flex><span>       <span style=color:#fff;font-weight:700>:strike-through</span> <span style=color:#0ff;font-weight:700>&#34;#972500&#34;</span> <span style=color:#fff;font-weight:700>:foreground</span> <span style=color:#0ff;font-weight:700>&#34;#505050&#34;</span>)
</span></span><span style=display:flex><span>      (((class color) (min-colors <span style=color:#ff0;font-weight:700>88</span>) (background dark))
</span></span><span style=display:flex><span>       <span style=color:#fff;font-weight:700>:strike-through</span> <span style=color:#0ff;font-weight:700>&#34;#ef8b50&#34;</span> <span style=color:#fff;font-weight:700>:foreground</span> <span style=color:#0ff;font-weight:700>&#34;#a8a8a8&#34;</span>))
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;My strike-through emphasis for Org.&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-emphasis-alist
</span></span><span style=display:flex><span>        &#39;((<span style=color:#0ff;font-weight:700>&#34;*&#34;</span> my-org-emphasis-bold)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;/&#34;</span> my-org-emphasis-italic)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;_&#34;</span> my-org-emphasis-underline)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;=&#34;</span> org-verbatim verbatim)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;~&#34;</span> org-code verbatim)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;+&#34;</span> my-org-emphasis-strike-through))))
</span></span></code></pre></div></li></ul><ul><li><p>org-clock</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> org-clock
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:after</span> org
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (org-clock-persistence-insinuate)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-clock-persist-file (expand-file-name <span style=color:#0ff;font-weight:700>&#34;cache/org-clock-save.el&#34;</span> user-emacs-directory))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-clock-history-length <span style=color:#ff0;font-weight:700>23</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-clock-in-resume t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-clock-into-drawer <span style=color:#0ff;font-weight:700>&#34;LOGCLOCK&#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-clock-out-remove-zero-time-clocks t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-clock-out-when-done t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-clock-persist t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-clock-clocktable-default-properties &#39;(<span style=color:#fff;font-weight:700>:maxlevel</span> <span style=color:#ff0;font-weight:700>5</span> <span style=color:#fff;font-weight:700>:link</span> t <span style=color:#fff;font-weight:700>:tags</span> t))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-clock-persist-query-resume nil)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-clock-report-include-clocking-task t))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(my/space-leader-def
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;oc&#34;</span> &#39;(<span style=color:#fff;font-weight:700>:ignore</span> t <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Clock&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;ocj&#34;</span> &#39;(org-clock-goto <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Clock goto&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;oci&#34;</span> &#39;(org-clock-in <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Clock In&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;oco&#34;</span> &#39;(org-clock-out <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Clock Out&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;ocl&#34;</span> &#39;(org-clock-in-last <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Clock In Last&#34;</span>))
</span></span></code></pre></div><p>Punch in or out.</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> bh/keep-clock-running nil)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> bh/is-task-p ()
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Any task with a todo keyword and no subtask.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>save-restriction</span>
</span></span><span style=display:flex><span>    (widen)
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>let</span> ((has-subtask)
</span></span><span style=display:flex><span>          (subtree-end (<span style=color:#fff;font-weight:700>save-excursion</span> (org-end-of-subtree t)))
</span></span><span style=display:flex><span>          (is-a-task (member (nth <span style=color:#ff0;font-weight:700>2</span> (org-heading-components)) org-todo-keywords-1)))
</span></span><span style=display:flex><span>      (<span style=color:#fff;font-weight:700>save-excursion</span>
</span></span><span style=display:flex><span>        (forward-line <span style=color:#ff0;font-weight:700>1</span>)
</span></span><span style=display:flex><span>        (<span style=color:#fff;font-weight:700>while</span> (<span style=color:#fff;font-weight:700>and</span> (not has-subtask)
</span></span><span style=display:flex><span>                    (&lt; (point) subtree-end)
</span></span><span style=display:flex><span>                    (re-search-forward <span style=color:#0ff;font-weight:700>&#34;^\*+ &#34;</span> subtree-end t))
</span></span><span style=display:flex><span>          (<span style=color:#fff;font-weight:700>when</span> (member (org-get-todo-state) org-todo-keywords-1)
</span></span><span style=display:flex><span>            (<span style=color:#fff;font-weight:700>setq</span> has-subtask t))))
</span></span><span style=display:flex><span>      (<span style=color:#fff;font-weight:700>and</span> is-a-task (not has-subtask)))))
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> bh/is-project-p ()
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Any task with a todo keyword subtask.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>save-restriction</span>
</span></span><span style=display:flex><span>    (widen)
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>let</span> ((has-subtask)
</span></span><span style=display:flex><span>          (subtree-end (<span style=color:#fff;font-weight:700>save-excursion</span> (org-end-of-subtree t)))
</span></span><span style=display:flex><span>          (is-a-task (member (nth <span style=color:#ff0;font-weight:700>2</span> (org-heading-components)) org-todo-keywords-1)))
</span></span><span style=display:flex><span>      (<span style=color:#fff;font-weight:700>save-excursion</span>
</span></span><span style=display:flex><span>        (forward-line <span style=color:#ff0;font-weight:700>1</span>)
</span></span><span style=display:flex><span>        (<span style=color:#fff;font-weight:700>while</span> (<span style=color:#fff;font-weight:700>and</span> (not has-subtask)
</span></span><span style=display:flex><span>                    (&lt; (point) subtree-end)
</span></span><span style=display:flex><span>                    (re-search-forward <span style=color:#0ff;font-weight:700>&#34;^\*+ &#34;</span> subtree-end t))
</span></span><span style=display:flex><span>          (<span style=color:#fff;font-weight:700>when</span> (member (org-get-todo-state) org-todo-keywords-1)
</span></span><span style=display:flex><span>            (<span style=color:#fff;font-weight:700>setq</span> has-subtask t))))
</span></span><span style=display:flex><span>      (<span style=color:#fff;font-weight:700>and</span> is-a-task has-subtask))))
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> bh/find-project-task ()
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Move point to the parent (project) task if any.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>save-restriction</span>
</span></span><span style=display:flex><span>    (widen)
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>let</span> ((parent-task (<span style=color:#fff;font-weight:700>save-excursion</span> (org-back-to-heading <span style=color:#0ff;font-weight:700>&#39;invisible-ok</span>) (point))))
</span></span><span style=display:flex><span>      (<span style=color:#fff;font-weight:700>while</span> (org-up-heading-safe)
</span></span><span style=display:flex><span>        (<span style=color:#fff;font-weight:700>when</span> (member (nth <span style=color:#ff0;font-weight:700>2</span> (org-heading-components)) org-todo-keywords-1)
</span></span><span style=display:flex><span>          (<span style=color:#fff;font-weight:700>setq</span> parent-task (point))))
</span></span><span style=display:flex><span>      (goto-char parent-task)
</span></span><span style=display:flex><span>      parent-task)))
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> bh/is-project-subtree-p ()
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Any task with a todo keyword that is in a project subtree.
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700> Callers of this function already widen the buffer view.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>let</span> ((task (<span style=color:#fff;font-weight:700>save-excursion</span> (org-back-to-heading <span style=color:#0ff;font-weight:700>&#39;invisible-ok</span>)
</span></span><span style=display:flex><span>                              (point))))
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>save-excursion</span>
</span></span><span style=display:flex><span>      (bh/find-project-task)
</span></span><span style=display:flex><span>      (<span style=color:#fff;font-weight:700>if</span> (equal (point) task)
</span></span><span style=display:flex><span>          nil
</span></span><span style=display:flex><span>        t))))
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> bh/clock-in-to-next (kw) <span style=color:#007f7f>;; kw should not been deleted.</span>
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Switch a task from TODO to NEXT when clocking in.
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700> Skips capture tasks, projects, and subprojects.
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700> Switch projects and subprojects from NEXT back to TODO&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>when</span> (not (<span style=color:#fff;font-weight:700>and</span> (boundp <span style=color:#0ff;font-weight:700>&#39;org-capture-mode</span>) org-capture-mode))
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>cond</span>
</span></span><span style=display:flex><span>     ((<span style=color:#fff;font-weight:700>and</span> (member (org-get-todo-state) (list <span style=color:#0ff;font-weight:700>&#34;TODO&#34;</span>))
</span></span><span style=display:flex><span>           (bh/is-task-p))
</span></span><span style=display:flex><span>      <span style=color:#0ff;font-weight:700>&#34;NEXT&#34;</span>)
</span></span><span style=display:flex><span>     ((<span style=color:#fff;font-weight:700>and</span> (member (org-get-todo-state) (list <span style=color:#0ff;font-weight:700>&#34;NEXT&#34;</span>))
</span></span><span style=display:flex><span>           (bh/is-project-p))
</span></span><span style=display:flex><span>      <span style=color:#0ff;font-weight:700>&#34;TODO&#34;</span>))))
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> bh/punch-in (arg)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Start continuous clocking and set the default task to the selected task.
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700> If </span><span style=color:#0ff;font-weight:700>`ARG&#39;</span><span style=color:#0ff;font-weight:700> is nil, set the Organization task
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700> as the default task.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span> <span style=color:#0ff;font-weight:700>&#34;p&#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> bh/keep-clock-running t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>if</span> (equal major-mode <span style=color:#0ff;font-weight:700>&#39;org-agenda-mode</span>)
</span></span><span style=display:flex><span>      <span style=color:#007f7f>;;</span>
</span></span><span style=display:flex><span>      <span style=color:#007f7f>;; We&#39;re in the agenda</span>
</span></span><span style=display:flex><span>      <span style=color:#007f7f>;;</span>
</span></span><span style=display:flex><span>      (<span style=color:#fff;font-weight:700>let*</span> ((marker (org-get-at-bol <span style=color:#0ff;font-weight:700>&#39;org-hd-marker</span>))
</span></span><span style=display:flex><span>             (tags (org-with-point-at marker (org-get-tags))))
</span></span><span style=display:flex><span>        (<span style=color:#fff;font-weight:700>if</span> (<span style=color:#fff;font-weight:700>and</span> (eq arg <span style=color:#ff0;font-weight:700>4</span>) tags)
</span></span><span style=display:flex><span>            (org-agenda-clock-in &#39;(<span style=color:#ff0;font-weight:700>16</span>))
</span></span><span style=display:flex><span>          (bh/clock-in-default-task-as-default)))
</span></span><span style=display:flex><span>    <span style=color:#007f7f>;;</span>
</span></span><span style=display:flex><span>    <span style=color:#007f7f>;; We are not in the agenda</span>
</span></span><span style=display:flex><span>    <span style=color:#007f7f>;;</span>
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>save-restriction</span>
</span></span><span style=display:flex><span>      (widen)
</span></span><span style=display:flex><span>                                        <span style=color:#007f7f>; Find the tags on the current task</span>
</span></span><span style=display:flex><span>      (<span style=color:#fff;font-weight:700>if</span> (<span style=color:#fff;font-weight:700>and</span> (equal major-mode <span style=color:#0ff;font-weight:700>&#39;org-mode</span>) (not (org-before-first-heading-p)) (eq arg <span style=color:#ff0;font-weight:700>4</span>))
</span></span><span style=display:flex><span>          (org-clock-in &#39;(<span style=color:#ff0;font-weight:700>16</span>))
</span></span><span style=display:flex><span>        (bh/clock-in-default-task-as-default)))))
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> bh/punch-out ()
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Punch out.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> bh/keep-clock-running nil)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>when</span> (org-clock-is-active)
</span></span><span style=display:flex><span>    (org-clock-out))
</span></span><span style=display:flex><span>  (org-agenda-remove-restriction-lock))
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> bh/clock-in-default-task ()
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Clock In default task with specific ID.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>save-excursion</span>
</span></span><span style=display:flex><span>    (org-with-point-at org-clock-default-task
</span></span><span style=display:flex><span>      (org-clock-in))))
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> bh/clock-in-parent-task ()
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Move point to the parent (project) task if any and clock in.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>let</span> ((parent-task))
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>save-excursion</span>
</span></span><span style=display:flex><span>      (<span style=color:#fff;font-weight:700>save-restriction</span>
</span></span><span style=display:flex><span>        (widen)
</span></span><span style=display:flex><span>        (<span style=color:#fff;font-weight:700>while</span> (<span style=color:#fff;font-weight:700>and</span> (not parent-task) (org-up-heading-safe))
</span></span><span style=display:flex><span>          (<span style=color:#fff;font-weight:700>when</span> (member (nth <span style=color:#ff0;font-weight:700>2</span> (org-heading-components)) org-todo-keywords-1)
</span></span><span style=display:flex><span>            (<span style=color:#fff;font-weight:700>setq</span> parent-task (point))))
</span></span><span style=display:flex><span>        (<span style=color:#fff;font-weight:700>if</span> parent-task
</span></span><span style=display:flex><span>            (org-with-point-at parent-task
</span></span><span style=display:flex><span>              (org-clock-in))
</span></span><span style=display:flex><span>          (<span style=color:#fff;font-weight:700>when</span> bh/keep-clock-running
</span></span><span style=display:flex><span>            (bh/clock-in-default-task)))))))
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defvar</span> bh/default-task-id <span style=color:#0ff;font-weight:700>&#34;20230307T170734.341755&#34;</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> bh/clock-in-default-task-as-default ()
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Clock in default task.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>  (org-with-point-at (org-id-find bh/default-task-id <span style=color:#0ff;font-weight:700>&#39;marker</span>)
</span></span><span style=display:flex><span>    (org-clock-in &#39;(<span style=color:#ff0;font-weight:700>16</span>))))
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> bh/clock-out-maybe ()
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Clock out.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>when</span> (<span style=color:#fff;font-weight:700>and</span> bh/keep-clock-running
</span></span><span style=display:flex><span>             (not org-clock-clocking-in)
</span></span><span style=display:flex><span>             (marker-buffer org-clock-default-task)
</span></span><span style=display:flex><span>             (not org-clock-resolving-clocks-due-to-idleness))
</span></span><span style=display:flex><span>    (bh/clock-in-parent-task)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(add-hook <span style=color:#0ff;font-weight:700>&#39;org-clock-out-hook</span> <span style=color:#0ff;font-weight:700>&#39;bh/clock-out-maybe</span> <span style=color:#0ff;font-weight:700>&#39;append</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> bh/clock-in-last-task (arg)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Clock in the interrupted task if there is one.
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700> Skip the default task and get the next one.
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700> A prefix </span><span style=color:#0ff;font-weight:700>`ARG&#39;</span><span style=color:#0ff;font-weight:700> forces clock in of the default task.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span> <span style=color:#0ff;font-weight:700>&#34;p&#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>let</span> ((clock-in-to-task
</span></span><span style=display:flex><span>         (<span style=color:#fff;font-weight:700>cond</span>
</span></span><span style=display:flex><span>          ((eq arg <span style=color:#ff0;font-weight:700>4</span>) org-clock-default-task)
</span></span><span style=display:flex><span>          ((<span style=color:#fff;font-weight:700>and</span> (org-clock-is-active)
</span></span><span style=display:flex><span>                (equal org-clock-default-task (cadr org-clock-history)))
</span></span><span style=display:flex><span>           (caddr org-clock-history))
</span></span><span style=display:flex><span>          ((org-clock-is-active) (cadr org-clock-history))
</span></span><span style=display:flex><span>          ((equal org-clock-default-task (car org-clock-history)) (cadr org-clock-history))
</span></span><span style=display:flex><span>          (t (car org-clock-history)))))
</span></span><span style=display:flex><span>    (widen)
</span></span><span style=display:flex><span>    (org-with-point-at clock-in-to-task
</span></span><span style=display:flex><span>      (org-clock-in nil))))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> my/toggle-punch-in-or-out ()
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Start clock or stop it when there is a clocking.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>if</span> (org-clocking-p)
</span></span><span style=display:flex><span>      (<span style=color:#fff;font-weight:700>progn</span>
</span></span><span style=display:flex><span>        (bh/punch-out)
</span></span><span style=display:flex><span>        (alert <span style=color:#0ff;font-weight:700>&#34;Wish you have a good day!&#34;</span> <span style=color:#fff;font-weight:700>:title</span> <span style=color:#0ff;font-weight:700>&#34;Punch Out&#34;</span>))
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>progn</span>
</span></span><span style=display:flex><span>      (bh/punch-in nil)
</span></span><span style=display:flex><span>      (alert <span style=color:#0ff;font-weight:700>&#34;Start Working: Fighting&#34;</span> <span style=color:#fff;font-weight:700>:title</span> <span style=color:#0ff;font-weight:700>&#34;Punch In&#34;</span> ))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>with-eval-after-load</span> <span style=color:#0ff;font-weight:700>&#39;evil</span>
</span></span><span style=display:flex><span>  (evil-define-key &#39;(normal visual) <span style=color:#0ff;font-weight:700>&#39;global</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;gp&#34;</span> <span style=color:#0ff;font-weight:700>&#39;my/toggle-punch-in-or-out</span>))
</span></span></code></pre></div></li></ul><ul><li><p>org buffer</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(add-to-list <span style=color:#0ff;font-weight:700>&#39;display-buffer-alist</span>
</span></span><span style=display:flex><span>             &#39;(<span style=color:#0ff;font-weight:700>&#34;\\*Org Note\\*&#34;</span>
</span></span><span style=display:flex><span>               (display-buffer-in-side-window)
</span></span><span style=display:flex><span>               (side . right)
</span></span><span style=display:flex><span>               (slot . <span style=color:#ff0;font-weight:700>0</span>)
</span></span><span style=display:flex><span>               (window-width . <span style=color:#ff0;font-weight:700>0.5</span>)
</span></span><span style=display:flex><span>               (window-parameters . ((no-other-window . t)
</span></span><span style=display:flex><span>                                     (no-delete-other-windows . t)))))
</span></span></code></pre></div></li></ul><ul><li><p>org table or report</p><ul><li><p>Auto calc clock tables</p><p>这个用于 clocktable 进行任务时间的汇总比较，目前我用它来统计一年的读书时长计录，及一年读了哪些书。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#007f7f>;; https://200ok.ch/posts/2022-12-07_streamline_your_org_mode_workflow_with_automatic_clock_table_recalculation.html</span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;; Need add #+AUTOCALC_CLOCK_TABLES to org file.</span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>with-eval-after-load</span> <span style=color:#0ff;font-weight:700>&#39;org</span>
</span></span><span style=display:flex><span>  (add-to-list <span style=color:#0ff;font-weight:700>&#39;org-options-keywords</span> <span style=color:#0ff;font-weight:700>&#34;AUTOCALC_CLOCK_TABLES:&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> autocalc-clocktable ()
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Auto update clock table.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>when</span> (derived-mode-p <span style=color:#0ff;font-weight:700>&#39;org-mode</span>)
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>save-excursion</span>
</span></span><span style=display:flex><span>      (goto-char <span style=color:#ff0;font-weight:700>0</span>)
</span></span><span style=display:flex><span>      (<span style=color:#fff;font-weight:700>if</span> (string-equal (car
</span></span><span style=display:flex><span>                         (cdr
</span></span><span style=display:flex><span>                          (car
</span></span><span style=display:flex><span>                           (org-collect-keywords &#39;(<span style=color:#0ff;font-weight:700>&#34;AUTOCALC_CLOCK_TABLES&#34;</span>)))))
</span></span><span style=display:flex><span>                        <span style=color:#0ff;font-weight:700>&#34;t&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#fff;font-weight:700>progn</span>
</span></span><span style=display:flex><span>            (goto-char (search-forward <span style=color:#0ff;font-weight:700>&#34;clocktable&#34;</span>))
</span></span><span style=display:flex><span>            (org-ctrl-c-ctrl-c))))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(add-hook <span style=color:#0ff;font-weight:700>&#39;before-save-hook</span> <span style=color:#0ff;font-weight:700>&#39;autocalc-clocktable</span>)
</span></span></code></pre></div></li></ul><ul><li><p>Auto update DATE</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> my/org-find-time-file-property (property <span style=color:#fff;font-weight:700>&amp;optional</span> anywhere)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Return the position of the time file PROPERTY if it exists.
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>When ANYWHERE is non-nil, search beyond the preamble.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>save-excursion</span>
</span></span><span style=display:flex><span>    (goto-char (point-min))
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>let</span> ((first-heading
</span></span><span style=display:flex><span>           (<span style=color:#fff;font-weight:700>save-excursion</span>
</span></span><span style=display:flex><span>             (re-search-forward org-outline-regexp-bol nil t))))
</span></span><span style=display:flex><span>      (<span style=color:#fff;font-weight:700>when</span> (re-search-forward (format <span style=color:#0ff;font-weight:700>&#34;^#\\+%s:&#34;</span> property)
</span></span><span style=display:flex><span>                               (<span style=color:#fff;font-weight:700>if</span> anywhere nil first-heading)
</span></span><span style=display:flex><span>                               t)
</span></span><span style=display:flex><span>        (point)))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> my/org-set-time-file-property (property <span style=color:#fff;font-weight:700>&amp;optional</span> anywhere pos)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Set the time file PROPERTY in the preamble.
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>When ANYWHERE is non-nil, search beyond the preamble.
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>If the position of the file PROPERTY has already been computed,
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>it can be passed in POS.
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>https://github.com/zaeph/.emacs.d/blob/615ac37be6bd78c37e967fdb43d28897a4116583/lisp/zp-org.el#L194&#34;</span>
</span></span><span style=display:flex><span>  (when-let ((pos (<span style=color:#fff;font-weight:700>or</span> pos
</span></span><span style=display:flex><span>                      (my/org-find-time-file-property property))))
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>save-excursion</span>
</span></span><span style=display:flex><span>      (goto-char pos)
</span></span><span style=display:flex><span>      (<span style=color:#fff;font-weight:700>if</span> (looking-at-p <span style=color:#0ff;font-weight:700>&#34; &#34;</span>)
</span></span><span style=display:flex><span>          (forward-char)
</span></span><span style=display:flex><span>        (insert <span style=color:#0ff;font-weight:700>&#34; &#34;</span>))
</span></span><span style=display:flex><span>      (delete-region (point) (line-end-position))
</span></span><span style=display:flex><span>      (<span style=color:#fff;font-weight:700>let*</span> ((now (format-time-string <span style=color:#0ff;font-weight:700>&#34;[%Y-%m-%d %a %H:%M]&#34;</span>)))
</span></span><span style=display:flex><span>        (insert now)))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> my/org-set-date ()
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Update the LAST_MODIFIED file property in the preamble.
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>https://github.com/zaeph/.emacs.d/blob/615ac37be6bd78c37e967fdb43d28897a4116583/lisp/zp-org.el#L212&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>when</span> (<span style=color:#fff;font-weight:700>and</span> (derived-mode-p <span style=color:#0ff;font-weight:700>&#39;org-mode</span>)
</span></span><span style=display:flex><span>             (buffer-modified-p))
</span></span><span style=display:flex><span>    (my/org-set-time-file-property <span style=color:#0ff;font-weight:700>&#34;DATE&#34;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(add-hook <span style=color:#0ff;font-weight:700>&#39;before-save-hook</span> <span style=color:#0ff;font-weight:700>&#39;my/org-set-date</span>)
</span></span></code></pre></div></li></ul><ul><li><p>Reading Report</p><p>我使用 <a href=#calibredb>Calibredb</a> 管理书籍，使用 org-roam 下的 books 文件夹管理读书笔记内容。凡是读书必建立对应的笔记内容，在笔记内容中会使用 org-clock 的功能记录读书的时长。</p><p>读书笔记通过 org-roam-capture 中的 books 一项创建。</p><p>然后在读书记录笔记中可以通过 org report 功能生成一年的读书记录。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>#+BEGIN: clocktable :scope my/reading-list :maxlevel 9 :emphasize t :fileskip0 t :hidefiles t :block 2023
</span></span><span style=display:flex><span>#+END:
</span></span></code></pre></div><p>clocktable 中的 scope 可以是自定义的函数，下面的函数将 books 下的所有读书笔记纳入统计范围。生成的表格中包括了书名及阅读本书所花的时间。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#007f7f>;; Get reading list from books directory for org-clock report.</span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;; The org-clock report scope can be a function.</span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> my/reading-list ()
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Get reading list.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>let</span> (reading-list)
</span></span><span style=display:flex><span>    (append reading-list
</span></span><span style=display:flex><span>            (file-expand-wildcards (expand-file-name <span style=color:#0ff;font-weight:700>&#34;denote/books/*.org&#34;</span> my-galaxy)))))
</span></span></code></pre></div></li></ul></li></ul><h4 id=footer>Footer</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>provide</span> <span style=color:#0ff;font-weight:700>&#39;init-org</span>)
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; init-org.el ends here.</span>
</span></span></code></pre></div><h3 id=note-taking>Note taking</h3><h4 id=header>Header</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#007f7f>;; init-taking.el --- note taking *- lexical-binding: t; no-byte-compile: t -*-</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Commentary:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Code:</span>
</span></span></code></pre></div><h4 id=note-taking>Note taking</h4><ul><li><p>ekg</p><p>轻度尝试，目前还有很多的不足，日常使用不太够。
和其他的模块不能很好的合作，如 org-agenda，math-preview。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> ekg
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:commands</span> (ekg-show-notes-in-trash
</span></span><span style=display:flex><span>             ekg-show-notes-for-today
</span></span><span style=display:flex><span>             ekg-show-notes-with-tag
</span></span><span style=display:flex><span>             ekg-show-notes-with-all-tags
</span></span><span style=display:flex><span>             ekg-show-notes-with-any-tags
</span></span><span style=display:flex><span>             ekg-show-rename-tag
</span></span><span style=display:flex><span>             ekg-browse-url)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:bind</span> ((<span style=color:#0ff;font-weight:700>&#34;&lt;f9&gt;&#34;</span> . ekg-capture)
</span></span><span style=display:flex><span>         (<span style=color:#0ff;font-weight:700>&#34;C-&lt;f9&gt;&#34;</span> . ekg-capture-url)
</span></span><span style=display:flex><span>         (<span style=color:#fff;font-weight:700>:map</span> ekg-notes-mode-map
</span></span><span style=display:flex><span>               (<span style=color:#0ff;font-weight:700>&#34;q&#34;</span> . quit-window)))
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> triples-default-database-filename (expand-file-name <span style=color:#0ff;font-weight:700>&#34;ekg/triples.db&#34;</span> my-galaxy)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(add-to-list <span style=color:#0ff;font-weight:700>&#39;display-buffer-alist</span> &#39;(<span style=color:#0ff;font-weight:700>&#34;\\*EKG&#34;</span>
</span></span><span style=display:flex><span>                                     (display-buffer-pop-up-frame)
</span></span><span style=display:flex><span>                                     (window-parameters
</span></span><span style=display:flex><span>                                      (no-other-window . t)
</span></span><span style=display:flex><span>                                      (mode-line-format . none)
</span></span><span style=display:flex><span>                                      (no-delete-other-windows . t))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>with-eval-after-load</span> <span style=color:#0ff;font-weight:700>&#39;evil</span>
</span></span><span style=display:flex><span>  (evil-define-key &#39;(normal visual) <span style=color:#0ff;font-weight:700>&#39;global</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;ged&#34;</span> <span style=color:#0ff;font-weight:700>&#39;ekg-show-notes-for-today</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;gee&#34;</span> <span style=color:#0ff;font-weight:700>&#39;ekg-show-notes-with-tag</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;gea&#34;</span> <span style=color:#0ff;font-weight:700>&#39;ekg-show-notes-with-any-tags</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;geA&#34;</span> <span style=color:#0ff;font-weight:700>&#39;ekg-show-notes-with-all-tags</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;geb&#34;</span> <span style=color:#0ff;font-weight:700>&#39;ekg-browse-url</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;ger&#34;</span> <span style=color:#0ff;font-weight:700>&#39;ekg-rename-tag</span>)
</span></span><span style=display:flex><span>  (evil-define-key <span style=color:#0ff;font-weight:700>&#39;normal</span> ekg-notes-mode-map
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;A&#34;</span> <span style=color:#0ff;font-weight:700>&#39;ekg-notes-any-tags</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;B&#34;</span> <span style=color:#0ff;font-weight:700>&#39;ekg-notes-select-and-browse-url</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;a&#34;</span> <span style=color:#0ff;font-weight:700>&#39;ekg-notes-any-note-tags</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;b&#34;</span> <span style=color:#0ff;font-weight:700>&#39;ekg-notes-browse</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;c&#34;</span> <span style=color:#0ff;font-weight:700>&#39;ekg-notes-create</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;d&#34;</span> <span style=color:#0ff;font-weight:700>&#39;ekg-notes-delete</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;n&#34;</span> <span style=color:#0ff;font-weight:700>&#39;ekg-notes-next</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;o&#34;</span> <span style=color:#0ff;font-weight:700>&#39;ekg-notes-open</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;p&#34;</span> <span style=color:#0ff;font-weight:700>&#39;ekg-notes-previous</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;r&#34;</span> <span style=color:#0ff;font-weight:700>&#39;ekg-notes-remove</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;t&#34;</span> <span style=color:#0ff;font-weight:700>&#39;ekg-notes-tag</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;q&#34;</span> <span style=color:#0ff;font-weight:700>&#39;quit-window</span>))
</span></span></code></pre></div></li></ul><ul><li><p>denote</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> denote
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:commands</span> (denote-signature denote-subdirectory denote-rename-file-using-front-matter
</span></span><span style=display:flex><span>                              denote-rename-file
</span></span><span style=display:flex><span>                              denote-link-or-create)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (dired-mode . denote-dired-mode)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> denote-directory (expand-file-name <span style=color:#0ff;font-weight:700>&#34;denote&#34;</span> my-galaxy)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>with-eval-after-load</span> <span style=color:#0ff;font-weight:700>&#39;evil</span>
</span></span><span style=display:flex><span>  (evil-define-key &#39;(normal visual) <span style=color:#0ff;font-weight:700>&#39;global</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;gnbl&#34;</span> <span style=color:#0ff;font-weight:700>&#39;denote-org-dblock-insert-links</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;gnbb&#34;</span> <span style=color:#0ff;font-weight:700>&#39;denote-org-dblock-insert-backlinks</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;gns&#34;</span> <span style=color:#0ff;font-weight:700>&#39;denote-signature</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;gnd&#34;</span> <span style=color:#0ff;font-weight:700>&#39;denote-subdirectory</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;gnr&#34;</span> <span style=color:#0ff;font-weight:700>&#39;denote-rename-file-using-front-matter</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;gnR&#34;</span> <span style=color:#0ff;font-weight:700>&#39;denote-rename-file</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;gnl&#34;</span> <span style=color:#0ff;font-weight:700>&#39;denote-link-or-create</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> denote-org-dblock
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:after</span> denote org)
</span></span></code></pre></div></li></ul><ul><li><p>consult-notes</p><p>这个包结合 denote 比较好用，不需要结合 org-roam 使用。</p><p>因为我己经不使用 deft 而是使用 consult-notes 来管理自己写的博客。使用下面的函数来创建新的文章， consult-notes 只能用于查询，无新建文件的功能。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> consult-notes
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:commands</span> consult-notes
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> consult-notes-file-dir-sources
</span></span><span style=display:flex><span>        `((<span style=color:#0ff;font-weight:700>&#34;Articles&#34;</span>  <span style=color:#0ff;font-weight:700>?a</span>  ,(concat my-galaxy <span style=color:#0ff;font-weight:700>&#34;/articles&#34;</span>))
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;Denote Notes&#34;</span>  <span style=color:#0ff;font-weight:700>?d</span> ,(expand-file-name <span style=color:#0ff;font-weight:700>&#34;denote&#34;</span> my-galaxy))
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;Book Reading&#34;</span>  <span style=color:#0ff;font-weight:700>?b</span> ,(expand-file-name <span style=color:#0ff;font-weight:700>&#34;denote/books&#34;</span> my-galaxy)))))
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> my/new-article (article)
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>interactive</span> <span style=color:#0ff;font-weight:700>&#34;sTitle: &#34;</span>)
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>let</span> ((filename (format <span style=color:#0ff;font-weight:700>&#34;%s&#34;</span> article))
</span></span><span style=display:flex><span>          (ext <span style=color:#0ff;font-weight:700>&#34;.org&#34;</span>))
</span></span><span style=display:flex><span>      (find-file (concat my-galaxy <span style=color:#0ff;font-weight:700>&#34;/articles/&#34;</span> filename ext))
</span></span><span style=display:flex><span>      (insert <span style=color:#0ff;font-weight:700>&#34;#+TITLE: &#34;</span> article <span style=color:#0ff;font-weight:700>&#34;\n&#34;</span>)
</span></span><span style=display:flex><span>      (tempel-insert <span style=color:#0ff;font-weight:700>&#39;hugo</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>with-eval-after-load</span> <span style=color:#0ff;font-weight:700>&#39;evil</span>
</span></span><span style=display:flex><span>  (evil-define-key &#39;(normal visual) <span style=color:#0ff;font-weight:700>&#39;global</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;gnn&#34;</span> <span style=color:#0ff;font-weight:700>&#39;consult-notes</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;gna&#34;</span> <span style=color:#0ff;font-weight:700>&#39;my/new-article</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;; (use-package consult-notes-org-roam</span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;   :commands consult-notes-org-roam-find-node-relation)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;; (my/space-leader-def</span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;     &#34;nv&#34; &#39;(consult-notes-org-roam-find-node-relation :wk &#34;Node navigation&#34;))</span>
</span></span></code></pre></div></li></ul><ul><li><p>org-transclusion</p><p>这里需要结合 <a href=#fringe-mode>fringe-mode</a> 使用，不能完全隐藏 fringe, 否则会没有效果。我设置的是 minimal.</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> org-transclusion
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:commands</span> (org-transclusion-make-from-link org-transclusion-add org-transclusion-add-all)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (face-spec-set <span style=color:#0ff;font-weight:700>&#39;org-transclusion-fringe</span>
</span></span><span style=display:flex><span>                 &#39;((((background light))
</span></span><span style=display:flex><span>                    <span style=color:#fff;font-weight:700>:foreground</span> <span style=color:#0ff;font-weight:700>&#34;black&#34;</span>)
</span></span><span style=display:flex><span>                   (t
</span></span><span style=display:flex><span>                    <span style=color:#fff;font-weight:700>:foreground</span> <span style=color:#0ff;font-weight:700>&#34;white&#34;</span>))
</span></span><span style=display:flex><span>                 <span style=color:#0ff;font-weight:700>&#39;face-override-spec</span>)
</span></span><span style=display:flex><span>  (face-spec-set <span style=color:#0ff;font-weight:700>&#39;org-transclusion-source-fringe</span>
</span></span><span style=display:flex><span>                 &#39;((((background light))
</span></span><span style=display:flex><span>                    <span style=color:#fff;font-weight:700>:foreground</span> <span style=color:#0ff;font-weight:700>&#34;black&#34;</span>)
</span></span><span style=display:flex><span>                   (t
</span></span><span style=display:flex><span>                    <span style=color:#fff;font-weight:700>:foreground</span> <span style=color:#0ff;font-weight:700>&#34;white&#34;</span>))
</span></span><span style=display:flex><span>                 <span style=color:#0ff;font-weight:700>&#39;face-override-spec</span>))
</span></span><span style=display:flex><span>(my/space-leader-def
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;t&#34;</span> &#39;(<span style=color:#fff;font-weight:700>:ignore</span> t <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Transclusion&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;ta&#34;</span> &#39;(org-transclusion-add <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Add&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;tA&#34;</span> &#39;(org-transclusion-add-all <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Add all&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;tr&#34;</span> &#39;(org-transclusion-remove <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Remove&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;tR&#34;</span> &#39;(org-transclusion-remove-all <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Remove all&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;tg&#34;</span> &#39;(org-transclusion-refresh <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Refresh&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;tm&#34;</span> &#39;(org-transclusion-make-from-link <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Make link&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;to&#34;</span> &#39;(org-transclusion-open-source <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Open source&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;te&#34;</span> &#39;(org-transclusion-live-sync-start <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Edit live&#34;</span>))
</span></span></code></pre></div></li></ul><h4 id=footer>Footer</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>provide</span> <span style=color:#0ff;font-weight:700>&#39;init-note-taking</span>)
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; init-note-taking.el ends here.</span>
</span></span></code></pre></div><h3 id=gtd>GTD</h3><h4 id=header>Header</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#007f7f>;; init-gtd.el --- GTD system*- lexical-binding: t; no-byte-compile: t -*-</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Commentary:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Code:</span>
</span></span></code></pre></div><h4 id=gtd-manage>GTD Manage</h4><ul><li><p>org-agenda</p><p>转到使用 <code>org-gtd</code> 处理 GTD 任务，它的 <code>org-gtd-engage</code> 比我定制的 <code>org-agenda-custom-commands</code> 看起来更简洁。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> org-agenda-custom-commands
</span></span><span style=display:flex><span>        &#39;((<span style=color:#0ff;font-weight:700>&#34;R&#34;</span> <span style=color:#0ff;font-weight:700>&#34;Review projects&#34;</span> tags-todo <span style=color:#0ff;font-weight:700>&#34;-CANCELLED/&#34;</span>
</span></span><span style=display:flex><span>           ((org-agenda-overriding-header <span style=color:#0ff;font-weight:700>&#34;Reviews Scheduled&#34;</span>)
</span></span><span style=display:flex><span>            (org-agenda-skip-function <span style=color:#0ff;font-weight:700>&#39;org-review-agenda-skip</span>)
</span></span><span style=display:flex><span>            (org-agenda-cmp-user-defined <span style=color:#0ff;font-weight:700>&#39;org-review-compare</span>)))
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;A&#34;</span> <span style=color:#0ff;font-weight:700>&#34;Archive&#34;</span>
</span></span><span style=display:flex><span>           ((todo <span style=color:#0ff;font-weight:700>&#34;DONE|CNCL&#34;</span>
</span></span><span style=display:flex><span>                  ((org-agenda-prefix-format <span style=color:#0ff;font-weight:700>&#34; %i&#34;</span>)
</span></span><span style=display:flex><span>                   (org-agenda-hide-tags-regexp <span style=color:#0ff;font-weight:700>&#34;project&#34;</span>)
</span></span><span style=display:flex><span>                   (org-agenda-overriding-header <span style=color:#0ff;font-weight:700>&#34;Archive&#34;</span>)))))
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34; &#34;</span> <span style=color:#0ff;font-weight:700>&#34;GTD Lists: Daily agenda and tasks&#34;</span>
</span></span><span style=display:flex><span>           ((agenda <span style=color:#0ff;font-weight:700>&#34;&#34;</span> ((org-agenda-span <span style=color:#ff0;font-weight:700>2</span>)
</span></span><span style=display:flex><span>                        (org-deadline-warning-days <span style=color:#ff0;font-weight:700>3</span>)
</span></span><span style=display:flex><span>                        (org-agenda-block-separator nil)
</span></span><span style=display:flex><span>                        (org-scheduled-past-days <span style=color:#ff0;font-weight:700>365</span>)
</span></span><span style=display:flex><span>                        (org-agenda-hide-tags-regexp <span style=color:#0ff;font-weight:700>&#34;project&#34;</span>)
</span></span><span style=display:flex><span>                        (org-agenda-day-face-function (<span style=color:#fff;font-weight:700>lambda</span> (date) <span style=color:#0ff;font-weight:700>&#39;org-agenda-date</span>))
</span></span><span style=display:flex><span>                        (org-agenda-format-date <span style=color:#0ff;font-weight:700>&#34;%A %-e %B %Y&#34;</span>)
</span></span><span style=display:flex><span>                        (org-agenda-prefix-format <span style=color:#0ff;font-weight:700>&#34; %i %?-12t% s&#34;</span>)
</span></span><span style=display:flex><span>                        (org-agenda-overriding-header <span style=color:#0ff;font-weight:700>&#34;Today&#39;s agenda&#34;</span>)))
</span></span><span style=display:flex><span>            (tags-todo <span style=color:#0ff;font-weight:700>&#34;*&#34;</span>
</span></span><span style=display:flex><span>                       ((org-agenda-skip-function
</span></span><span style=display:flex><span>                         `(org-agenda-skip-entry-if <span style=color:#0ff;font-weight:700>&#39;deadline</span>
</span></span><span style=display:flex><span>                                                    <span style=color:#0ff;font-weight:700>&#39;schedule</span>
</span></span><span style=display:flex><span>                                                    <span style=color:#0ff;font-weight:700>&#39;timestamp</span>
</span></span><span style=display:flex><span>                                                    <span style=color:#0ff;font-weight:700>&#39;notregexp</span> ,(format <span style=color:#0ff;font-weight:700>&#34;\\[#%s\\]&#34;</span> (char-to-string org-priority-highest))))
</span></span><span style=display:flex><span>                        (org-agenda-hide-tags-regexp <span style=color:#0ff;font-weight:700>&#34;project&#34;</span>)
</span></span><span style=display:flex><span>                        (org-agenda-prefix-format <span style=color:#0ff;font-weight:700>&#34; %i&#34;</span>)
</span></span><span style=display:flex><span>                        (org-agenda-overriding-header <span style=color:#0ff;font-weight:700>&#34;Important tasks without a date&#34;</span>)))
</span></span><span style=display:flex><span>            (todo <span style=color:#0ff;font-weight:700>&#34;NEXT&#34;</span>
</span></span><span style=display:flex><span>                  ((org-agenda-skip-function &#39;(org-agenda-skip-if nil &#39;(timestamp)))
</span></span><span style=display:flex><span>                   (org-agenda-prefix-format <span style=color:#0ff;font-weight:700>&#34; %i&#34;</span>)
</span></span><span style=display:flex><span>                   (org-agenda-block-separator nil)
</span></span><span style=display:flex><span>                   (org-agenda-hide-tags-regexp <span style=color:#0ff;font-weight:700>&#34;project&#34;</span>)
</span></span><span style=display:flex><span>                   (org-agenda-overriding-header <span style=color:#0ff;font-weight:700>&#34;Next tasks list&#34;</span>)))
</span></span><span style=display:flex><span>            (tags-todo <span style=color:#0ff;font-weight:700>&#34;-Reading/INPROGRESS&#34;</span>
</span></span><span style=display:flex><span>                       ((org-agenda-block-separator nil)
</span></span><span style=display:flex><span>                        (org-agenda-skip-function &#39;(org-agenda-skip-if nil &#39;(timestamp)))
</span></span><span style=display:flex><span>                        (org-agenda-prefix-format <span style=color:#0ff;font-weight:700>&#34; %i&#34;</span>)
</span></span><span style=display:flex><span>                        (org-agenda-hide-tags-regexp <span style=color:#0ff;font-weight:700>&#34;project&#34;</span>)
</span></span><span style=display:flex><span>                        (org-agenda-overriding-header <span style=color:#0ff;font-weight:700>&#34;Inprogress tasks list&#34;</span>)))
</span></span><span style=display:flex><span>            (tags-todo <span style=color:#0ff;font-weight:700>&#34;-Computer-Emacs-Reading/TODO&#34;</span>
</span></span><span style=display:flex><span>                       ((org-agenda-skip-function
</span></span><span style=display:flex><span>                         `(org-agenda-skip-entry-if <span style=color:#0ff;font-weight:700>&#39;deadline</span>
</span></span><span style=display:flex><span>                                                    <span style=color:#0ff;font-weight:700>&#39;schedule</span>
</span></span><span style=display:flex><span>                                                    <span style=color:#0ff;font-weight:700>&#39;timestamp</span>
</span></span><span style=display:flex><span>                                                    <span style=color:#0ff;font-weight:700>&#39;regexp</span> ,(format <span style=color:#0ff;font-weight:700>&#34;\\[#%s\\]&#34;</span> (char-to-string org-priority-highest))))
</span></span><span style=display:flex><span>                        (org-agenda-prefix-format <span style=color:#0ff;font-weight:700>&#34; %i&#34;</span>)
</span></span><span style=display:flex><span>                        (org-agenda-hide-tags-regexp <span style=color:#0ff;font-weight:700>&#34;project&#34;</span>)
</span></span><span style=display:flex><span>                        (org-agenda-block-separator nil)
</span></span><span style=display:flex><span>                        (org-agenda-overriding-header <span style=color:#0ff;font-weight:700>&#34;Todo tasks list&#34;</span>)))
</span></span><span style=display:flex><span>            (tags-todo <span style=color:#0ff;font-weight:700>&#34;Emacs|Computer&#34;</span>
</span></span><span style=display:flex><span>                       ((org-agenda-block-separator nil)
</span></span><span style=display:flex><span>                        (org-agenda-skip-function &#39;(org-agenda-skip-if nil &#39;(timestamp)))
</span></span><span style=display:flex><span>                        (org-agenda-prefix-format <span style=color:#0ff;font-weight:700>&#34; %i&#34;</span>)
</span></span><span style=display:flex><span>                        (org-agenda-hide-tags-regexp <span style=color:#0ff;font-weight:700>&#34;project&#34;</span>)
</span></span><span style=display:flex><span>                        (org-agenda-overriding-header <span style=color:#0ff;font-weight:700>&#34;Computer science&#34;</span>)))
</span></span><span style=display:flex><span>            (tags-todo <span style=color:#0ff;font-weight:700>&#34;Family&#34;</span>
</span></span><span style=display:flex><span>                       ((org-agenda-skip-function &#39;(org-agenda-skip-if nil &#39;(timestamp)))
</span></span><span style=display:flex><span>                        (org-agenda-prefix-format <span style=color:#0ff;font-weight:700>&#34; %i&#34;</span>)
</span></span><span style=display:flex><span>                        (org-agenda-hide-tags-regexp <span style=color:#0ff;font-weight:700>&#34;project&#34;</span>)
</span></span><span style=display:flex><span>                        (org-agenda-block-separator nil)
</span></span><span style=display:flex><span>                        (org-agenda-overriding-header <span style=color:#0ff;font-weight:700>&#34;Family&#34;</span>)))
</span></span><span style=display:flex><span>            (tags-todo <span style=color:#0ff;font-weight:700>&#34;Reading&#34;</span>
</span></span><span style=display:flex><span>                       ((org-agenda-skip-function &#39;(org-agenda-skip-if nil &#39;(timestamp)))
</span></span><span style=display:flex><span>                        (org-agenda-prefix-format <span style=color:#0ff;font-weight:700>&#34; %i&#34;</span>)
</span></span><span style=display:flex><span>                        (org-agenda-hide-tags-regexp <span style=color:#0ff;font-weight:700>&#34;project&#34;</span>)
</span></span><span style=display:flex><span>                        (org-agenda-block-separator nil)
</span></span><span style=display:flex><span>                        (org-agenda-overriding-header <span style=color:#0ff;font-weight:700>&#34;Reading Lists&#34;</span>)))
</span></span><span style=display:flex><span>            (todo <span style=color:#0ff;font-weight:700>&#34;WAIT|SOMEDAY&#34;</span>
</span></span><span style=display:flex><span>                  ((org-agenda-block-separator nil)
</span></span><span style=display:flex><span>                   (org-agenda-prefix-format <span style=color:#0ff;font-weight:700>&#34; %i&#34;</span>)
</span></span><span style=display:flex><span>                   (org-agenda-hide-tags-regexp <span style=color:#0ff;font-weight:700>&#34;project&#34;</span>)
</span></span><span style=display:flex><span>                   (org-agenda-overriding-header <span style=color:#0ff;font-weight:700>&#34;Tasks on hold&#34;</span>)))))))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> org-agenda
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:bind</span> (<span style=color:#0ff;font-weight:700>&#34;C-&lt;f12&gt;&#34;</span> . org-agenda)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (org-agenda-finalize . #&#39;org-agenda-find-same-or-today-or-agenda)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-agenda-files (directory-files-recursively (expand-file-name <span style=color:#0ff;font-weight:700>&#34;todos&#34;</span> my-galaxy) <span style=color:#0ff;font-weight:700>&#34;org$&#34;</span>))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-agenda-dim-blocked-tasks t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-agenda-compact-blocks t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-agenda-window-setup <span style=color:#0ff;font-weight:700>&#39;other-tab</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-agenda-align-tags-to-column <span style=color:#ff0;font-weight:700>-120</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>with-eval-after-load</span> <span style=color:#0ff;font-weight:700>&#39;all-the-icons</span>
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>setq</span> org-agenda-category-icon-alist
</span></span><span style=display:flex><span>          `((<span style=color:#0ff;font-weight:700>&#34;\\</span><span style=color:#0ff;font-weight:700>`gtd\\&#39;</span><span style=color:#0ff;font-weight:700>&#34;</span>
</span></span><span style=display:flex><span>             (#(<span style=color:#0ff;font-weight:700>&#34; &#34;</span> <span style=color:#ff0;font-weight:700>0</span> <span style=color:#ff0;font-weight:700>1</span> (rear-nonsticky t display (raise <span style=color:#ff0;font-weight:700>0.0</span>)
</span></span><span style=display:flex><span>                                         font-lock-face
</span></span><span style=display:flex><span>                                         (<span style=color:#fff;font-weight:700>:family</span> <span style=color:#0ff;font-weight:700>&#34;FontAwesome&#34;</span> <span style=color:#fff;font-weight:700>:height</span> <span style=color:#ff0;font-weight:700>1.0</span>)
</span></span><span style=display:flex><span>                                         face
</span></span><span style=display:flex><span>                                         (<span style=color:#fff;font-weight:700>:family</span> <span style=color:#0ff;font-weight:700>&#34;FontAwesome&#34;</span> <span style=color:#fff;font-weight:700>:height</span> <span style=color:#ff0;font-weight:700>1.0</span>))))
</span></span><span style=display:flex><span>             nil nil <span style=color:#fff;font-weight:700>:ascent</span> center)
</span></span><span style=display:flex><span>            (<span style=color:#0ff;font-weight:700>&#34;\\\cc\\\|[a-zA-z0-9]*&#34;</span>
</span></span><span style=display:flex><span>             (#(<span style=color:#0ff;font-weight:700>&#34; &#34;</span> <span style=color:#ff0;font-weight:700>0</span> <span style=color:#ff0;font-weight:700>1</span> (rear-nonsticky t display (raise <span style=color:#ff0;font-weight:700>0.0</span>)
</span></span><span style=display:flex><span>                                         font-lock-face
</span></span><span style=display:flex><span>                                         (<span style=color:#fff;font-weight:700>:family</span> <span style=color:#0ff;font-weight:700>&#34;FontAwesome&#34;</span> <span style=color:#fff;font-weight:700>:height</span> <span style=color:#ff0;font-weight:700>1.0</span>)
</span></span><span style=display:flex><span>                                         face
</span></span><span style=display:flex><span>                                         (<span style=color:#fff;font-weight:700>:family</span> <span style=color:#0ff;font-weight:700>&#34;FontAwesome&#34;</span> <span style=color:#fff;font-weight:700>:height</span> <span style=color:#ff0;font-weight:700>1.0</span>))))
</span></span><span style=display:flex><span>             nil nil <span style=color:#fff;font-weight:700>:ascent</span> center)))))
</span></span></code></pre></div><p>使用 <code>C-f12</code> 打开 <code>org-agenda</code> 然后执行相应的操作比使用快捷键的方式心智负担小一些。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> my/org-agenda ()
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Open my </span><span style=color:#0ff;font-weight:700>`org-agenda&#39;</span><span style=color:#0ff;font-weight:700>.
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>Run </span><span style=color:#0ff;font-weight:700>`org-roam-db-sync&#39;</span><span style=color:#0ff;font-weight:700> to get full lists of org agenda files.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>if</span> (eq major-mode <span style=color:#0ff;font-weight:700>&#39;org-agenda-mode</span>)
</span></span><span style=display:flex><span>      (org-agenda-redo-all)
</span></span><span style=display:flex><span>    (org-agenda <span style=color:#0ff;font-weight:700>&#34;&#34;</span> <span style=color:#0ff;font-weight:700>&#34; &#34;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> my/org-agenda-query ()
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Open my </span><span style=color:#0ff;font-weight:700>`org-agenda&#39;</span><span style=color:#0ff;font-weight:700> and </span><span style=color:#0ff;font-weight:700>`m&#39;</span><span style=color:#0ff;font-weight:700>.
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>  Run </span><span style=color:#0ff;font-weight:700>`org-roam-db-sync&#39;</span><span style=color:#0ff;font-weight:700> to get full lists of org agenda files.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>  (org-roam-db-sync)
</span></span><span style=display:flex><span>  (org-agenda <span style=color:#0ff;font-weight:700>&#34;&#34;</span> <span style=color:#0ff;font-weight:700>&#34;m&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> my/org-inprogress-tasks ()
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>  (org-todo-list <span style=color:#0ff;font-weight:700>&#34;INPROGRESS&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(my/space-leader-def
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;o&#34;</span> &#39;(<span style=color:#fff;font-weight:700>:ignore</span> t <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Org&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;oa&#34;</span> &#39;(<span style=color:#fff;font-weight:700>:ignore</span> t <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Agenda&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;oaa&#34;</span> &#39;(my/org-agenda <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Agenda&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;oaq&#34;</span> &#39;(my/org-agenda-query <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Query&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;oat&#34;</span> &#39;(org-todo-list <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Todo list&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;oav&#34;</span> &#39;(org-search-view <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;View search&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;oai&#34;</span> &#39;(my/org-inprogress-tasks <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Inprogess tasks&#34;</span>))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>with-eval-after-load</span> <span style=color:#0ff;font-weight:700>&#39;evil</span>
</span></span><span style=display:flex><span>  (evil-set-initial-state <span style=color:#0ff;font-weight:700>&#39;org-agenda-mode</span> <span style=color:#0ff;font-weight:700>&#39;motion</span>)
</span></span><span style=display:flex><span>  (evil-define-key <span style=color:#0ff;font-weight:700>&#39;motion</span> org-agenda-mode-map
</span></span><span style=display:flex><span>    (kbd <span style=color:#0ff;font-weight:700>&#34;RET&#34;</span>) <span style=color:#0ff;font-weight:700>&#39;org-agenda-switch-to</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;SPC&#34;</span> <span style=color:#0ff;font-weight:700>&#39;nil</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;gj&#34;</span> <span style=color:#0ff;font-weight:700>&#39;org-agenda-next-item</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;gr&#34;</span> <span style=color:#0ff;font-weight:700>&#39;org-agenda-redo</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;gR&#34;</span> <span style=color:#0ff;font-weight:700>&#39;org-agenda-redo-all</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;t&#34;</span> <span style=color:#0ff;font-weight:700>&#39;org-agenda-todo</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;u&#34;</span> <span style=color:#0ff;font-weight:700>&#39;org-agenda-undo</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;I&#34;</span> <span style=color:#0ff;font-weight:700>&#39;org-agenda-clock-in</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;O&#34;</span> <span style=color:#0ff;font-weight:700>&#39;org-agenda-clock-out</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;cg&#34;</span> <span style=color:#0ff;font-weight:700>&#39;org-agenda-clock-goto</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;cc&#34;</span> <span style=color:#0ff;font-weight:700>&#39;org-agenda-clock-cancel</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;cr&#34;</span> <span style=color:#0ff;font-weight:700>&#39;org-agenda-clockreport-mode</span>))
</span></span></code></pre></div></li></ul><ul><li><p>org-gtd</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> my/gtd-file ()
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>  (find-file (expand-file-name <span style=color:#0ff;font-weight:700>&#34;todos/org-gtd-tasks.org&#34;</span> my-galaxy)))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> org-gtd
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:bind</span> (<span style=color:#0ff;font-weight:700>&#34;&lt;f12&gt;&#34;</span> . org-gtd-engage)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:commands</span> org-gtd-capture org-gtd-engage org-gtd-process-inbox org-gtd-show-all-next org-gtd-show-stuck-projects
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:init</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-gtd-update-ack <span style=color:#0ff;font-weight:700>&#34;2.1.0&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:custom</span>
</span></span><span style=display:flex><span>  (org-gtd-directory (expand-file-name <span style=color:#0ff;font-weight:700>&#34;todos&#34;</span> my-galaxy))
</span></span><span style=display:flex><span>  (org-agenda-property-list &#39;(<span style=color:#0ff;font-weight:700>&#34;DELEGATED_TO&#34;</span>))
</span></span><span style=display:flex><span>  (org-edna-use-inheritance t)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (add-to-list <span style=color:#0ff;font-weight:700>&#39;org-agenda-files</span> (expand-file-name <span style=color:#0ff;font-weight:700>&#34;todos/org-gtd-tasks.org&#34;</span> my-galaxy))
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:bind</span> (<span style=color:#fff;font-weight:700>:map</span> org-gtd-process-map
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;C-c c&#34;</span> . org-gtd-choose)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(my/space-leader-def
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;d&#34;</span> &#39;(<span style=color:#fff;font-weight:700>:ignore</span> t <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Org gtd&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;dp&#34;</span> &#39;(org-gtd-process-inbox <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Process&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;da&#34;</span> &#39;(org-agenda-list <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Agenda list&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;de&#34;</span> &#39;(org-gtd-engage <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Engage&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;dn&#34;</span> &#39;(org-gtd-show-all-next <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Next tasks&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;ds&#34;</span> &#39;(org-gtd-show-stuck-projects <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Stuck projects&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> org-edna
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:after</span> org-gtd
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (org-edna-load))
</span></span></code></pre></div></li></ul><ul><li><p>calendar and appt</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> calendar
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:commands</span> calendar
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> calendar-view-diary-initially-flag t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> calendar-mark-diary-entries-flag t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> calendar-mode-line-format nil)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> calendar-date-style <span style=color:#0ff;font-weight:700>&#39;iso</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> calendar-date-display-form calendar-iso-date-display-form)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> calendar-time-display-form
</span></span><span style=display:flex><span>        &#39;(24-hours <span style=color:#0ff;font-weight:700>&#34;:&#34;</span> minutes
</span></span><span style=display:flex><span>                   (<span style=color:#fff;font-weight:700>when</span> time-zone
</span></span><span style=display:flex><span>                     (format <span style=color:#0ff;font-weight:700>&#34;(%s)&#34;</span> time-zone))))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> diary-date-forms diary-iso-date-forms)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (calendar-today-visible . #&#39;calendar-mark-today))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(my/space-leader-def
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;c&#34;</span> &#39;(calendar <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Calendar&#34;</span>))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> appt
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:after</span> calendar
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> appt-display-diary nil)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> appt-disp-window-function #&#39;appt-disp-window)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> appt-display-mode-line t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> appt-display-interval <span style=color:#ff0;font-weight:700>3</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> appt-audible nil)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> appt-warning-time-regexp <span style=color:#0ff;font-weight:700>&#34;appt \\([0-9]+\\)&#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> appt-message-warning-time <span style=color:#ff0;font-weight:700>6</span>)
</span></span><span style=display:flex><span>  (add-hook <span style=color:#0ff;font-weight:700>&#39;diary-mode-hook</span> #&#39;appt-activate))
</span></span></code></pre></div><p>Use diary-lib to write diary. 关于这个的使用可以见：<a href="https://www.youtube.com/watch?v=NkhgIB64zgc">Emacs: Diary and Calendar - YouTube</a></p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> diary-lib
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:after</span> calendar
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (add-hook <span style=color:#0ff;font-weight:700>&#39;diary-list-entries-hook</span> #&#39;diary-sort-entries)
</span></span><span style=display:flex><span>  (add-hook <span style=color:#0ff;font-weight:700>&#39;diary-mode-hook</span> #&#39;goto-address-mode)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> diary-display-function #&#39;diary-fancy-display)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> diary-header-line-format nil)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> diary-list-include-blanks nil)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> diary-abbreviated-year-flag nil)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> diary-number-of-entries <span style=color:#ff0;font-weight:700>7</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> diary-comment-start <span style=color:#0ff;font-weight:700>&#34;);;&#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> diary-comment-end <span style=color:#0ff;font-weight:700>&#34;&#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> diary-nonmarking-symbol <span style=color:#0ff;font-weight:700>&#34;!&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> diary-file (expand-file-name <span style=color:#0ff;font-weight:700>&#34;diary/diary.org&#34;</span> my-galaxy)))
</span></span></code></pre></div></li></ul><ul><li><p>alarm-clock</p><p>如其名，在 Emacs 中设置闹钟的。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> alarm-clock
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:commands</span> (alarm-clock-set alarm-clock-list-view)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> alarm-clock-cache-file (expand-file-name <span style=color:#0ff;font-weight:700>&#34;var/.alarm-clock.cache&#34;</span> user-emacs-directory)))
</span></span></code></pre></div></li></ul><ul><li><p>alert</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> alert
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:commands</span> alert
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> alert-default-style <span style=color:#0ff;font-weight:700>&#39;osx-notifier</span>))
</span></span></code></pre></div></li></ul><ul><li><p>org-alert</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> org-alert
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (on-first-file . org-alert-enable)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-alert-interval <span style=color:#ff0;font-weight:700>300</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-alert-notify-cutoff <span style=color:#ff0;font-weight:700>10</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-alert-notify-after-event-cutoff <span style=color:#ff0;font-weight:700>10</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-alert-notification-title <span style=color:#0ff;font-weight:700>&#34;Org Agenda Reminder!&#34;</span>))
</span></span></code></pre></div></li></ul><ul><li><p>pomm</p><p>Emacs 中执行 Pomodoro 哲学。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> pomm
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:commands</span> pomm
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> pomm-state-file-location (expand-file-name <span style=color:#0ff;font-weight:700>&#34;cache/pomm&#34;</span> user-emacs-directory))
</span></span><span style=display:flex><span>  (pomm-mode-line-mode <span style=color:#ff0;font-weight:700>1</span>))
</span></span></code></pre></div></li></ul><h4 id=footer>Footer</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>provide</span> <span style=color:#0ff;font-weight:700>&#39;init-gtd</span>)
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; init-gtd.el ends here.</span>
</span></span></code></pre></div><h3 id=finance-management>Finance Management</h3><h4 id=header>Header</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#007f7f>;; init-finance.el --- finance *- lexical-binding: t; no-byte-compile: t -*-</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Commentary:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Code:</span>
</span></span></code></pre></div><h4 id=beancount>beancount</h4><p>Beancount has more plugin than ledger-cli.</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> beancount
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:mode</span> (<span style=color:#0ff;font-weight:700>&#34;.bean&#34;</span> . beancount-mode)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> ((beancount-mode . (<span style=color:#fff;font-weight:700>lambda</span> ()
</span></span><span style=display:flex><span>                             (<span style=color:#fff;font-weight:700>setq-local</span> electric-indent-chars nil)))
</span></span><span style=display:flex><span>         (beancount-mode . outline-minor-mode))
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (evil-define-key <span style=color:#0ff;font-weight:700>&#39;normal</span> <span style=color:#0ff;font-weight:700>&#39;beancount-mode-map</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;zf&#34;</span> <span style=color:#0ff;font-weight:700>&#39;beancount-fava</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#007f7f>;; insert whole transaction instead of only insert date.</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>defun</span> my/beancount-insert-transaction (<span style=color:#fff;font-weight:700>&amp;optional</span> days)
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;Start a new timestamped directive with date shifted by DAYS from today.&#34;</span>
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>interactive</span> <span style=color:#0ff;font-weight:700>&#34;P&#34;</span>)
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>unless</span> (bolp) (newline))
</span></span><span style=display:flex><span>    (insert (beancount--shift-current-date days) <span style=color:#0ff;font-weight:700>&#34; * \&#34;\&#34; \&#34;\&#34;&#34;</span>)
</span></span><span style=display:flex><span>    (evil-backward-char <span style=color:#ff0;font-weight:700>3</span>)
</span></span><span style=display:flex><span>    (evil-insert <span style=color:#ff0;font-weight:700>0</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (advice-add <span style=color:#0ff;font-weight:700>&#39;beancount-insert-date</span> <span style=color:#fff;font-weight:700>:override</span> <span style=color:#0ff;font-weight:700>&#39;my/beancount-insert-transaction</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#007f7f>;; Auto open browser after beancount-fava started.</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>defun</span> my/browser-beancount-fava ()
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>if</span> beancount--fava-process
</span></span><span style=display:flex><span>        (browse-url <span style=color:#0ff;font-weight:700>&#34;http://127.0.0.1:5000&#34;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (advice-add <span style=color:#0ff;font-weight:700>&#39;beancount-fava</span> <span style=color:#fff;font-weight:700>:after</span> <span style=color:#0ff;font-weight:700>&#39;my/browser-beancount-fava</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#007f7f>;; auto align transaction before save file.</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>defun</span> my/beancount-align-transaction ()
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;Align visible region in current buffer.&#34;</span>
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>save-excursion</span>
</span></span><span style=display:flex><span>      (indent-region (window-start) (window-end))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (add-hook <span style=color:#0ff;font-weight:700>&#39;before-save-hook</span> (<span style=color:#fff;font-weight:700>lambda</span> ()
</span></span><span style=display:flex><span>                                (<span style=color:#fff;font-weight:700>if</span> (eq major-mode <span style=color:#0ff;font-weight:700>&#39;beancount-mode</span>)
</span></span><span style=display:flex><span>                                    (my/beancount-align-transaction))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#007f7f>;; If cursor in &#34;&#34;, activate input method rime.</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>defun</span> my/beancount-activate-input-method ()
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>when</span> (eq major-mode <span style=color:#0ff;font-weight:700>&#39;beancount-mode</span>)
</span></span><span style=display:flex><span>      (<span style=color:#fff;font-weight:700>if</span> (not (bounds-of-thing-at-point <span style=color:#0ff;font-weight:700>&#39;whitespace</span>))
</span></span><span style=display:flex><span>          (<span style=color:#fff;font-weight:700>if</span> (bounds-of-thing-at-point <span style=color:#0ff;font-weight:700>&#39;string</span>)
</span></span><span style=display:flex><span>              (activate-input-method <span style=color:#0ff;font-weight:700>&#34;rime&#34;</span>)))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (add-hook <span style=color:#0ff;font-weight:700>&#39;evil-insert-state-entry-hook</span> #&#39;my/beancount-activate-input-method))
</span></span></code></pre></div><h4 id=achive>Achive</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> achive
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:commands</span> achive
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> achive-language <span style=color:#0ff;font-weight:700>&#39;zh</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> achive-cache-path (expand-file-name <span style=color:#0ff;font-weight:700>&#34;chche/.achive&#34;</span> user-emacs-directory)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(my/space-leader-def
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;ms&#34;</span> &#39;(achive <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Share&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(add-to-list <span style=color:#0ff;font-weight:700>&#39;display-buffer-alist</span> &#39;(<span style=color:#0ff;font-weight:700>&#34;\\*A Chive\\*&#34;</span>
</span></span><span style=display:flex><span>                                     (display-buffer-in-new-tab)
</span></span><span style=display:flex><span>                                     (tab-name . <span style=color:#0ff;font-weight:700>&#34;Share&#34;</span>)
</span></span><span style=display:flex><span>                                     (tab-group . <span style=color:#0ff;font-weight:700>&#34;Misc&#34;</span>)))
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>with-eval-after-load</span> <span style=color:#0ff;font-weight:700>&#39;evil-collection</span>
</span></span><span style=display:flex><span>  (evil-collection-define-key <span style=color:#0ff;font-weight:700>&#39;normal</span> <span style=color:#0ff;font-weight:700>&#39;achive-visual-mode-map</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;q&#34;</span> <span style=color:#0ff;font-weight:700>&#39;quit-window</span>))
</span></span></code></pre></div><h4 id=footer>Footer</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>provide</span> <span style=color:#0ff;font-weight:700>&#39;init-finance</span>)
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; init-finance.el ends here.</span>
</span></span></code></pre></div><h3 id=bibtex-management>Bibtex management</h3><p>文献管理涉及到的内容比较多，文献的查找、管理、阅读与引用等等。</p><p>Emacs 进行文献管理需要用到的包有 org-cite,bibtex-completion,citar</p><h4 id=header>Header</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#007f7f>;; init-bib.el --- bib management *- lexical-binding: t; no-byte-compile: t -*-</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Commentary:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Code:</span>
</span></span></code></pre></div><h4 id=bibtex-management>Bibtex management</h4><ul><li><p>org-cite</p><p>Org-cite 目前是 org 内置的进行文献引用的包。</p><p>关于 org-cite 的使用见：<a href=https://blog.tecosaur.com/tmio/2021-07-31-citations.html>https://blog.tecosaur.com/tmio/2021-07-31-citations.html</a> 或 <a href=https://kristofferbalintona.me/posts/202206141852/>Citations in org-mode: Org-cite and Citar | Kristoffer Balintona</a>.</p><p>己经说的比较详细。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> oc
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:after</span> org
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-cite-global-bibliography `(,(concat my-galaxy <span style=color:#0ff;font-weight:700>&#34;/bibtexs/References.bib&#34;</span>))))
</span></span></code></pre></div></li></ul><ul><li><p>citar</p><p>为什么使用 citar? 是因为 org-cite 的提示界面看起来不咋地，而 citar 提供的界面就很友好。</p><p>我通常使用 <code>citar-open-files</code> / <code>SPC n r p</code> 来打开想要阅读的文献 PDF 文件。</p><p>阅读文献使用的是 <a href=#pdf-tools>pdf-tools</a> ，更好用的是 <a href=https://github.com/emacs-eaf/eaf-pdf-viewer>emacs-eaf/eaf-pdf-viewer: Fastest PDF Viewer in Emacs</a>.</p><p>eaf-pdf-viewer 存在的问题还是安装较难，对于系统环境要求较高，如 Emacs 29 上就不能使用，存在问题。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> citar
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:commands</span> citar-open citar-open-entry citar-open-files citar-open-notes citar-open-links
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> citar-bibliography org-cite-global-bibliography)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> citar-notes-paths `(,(expand-file-name <span style=color:#0ff;font-weight:700>&#34;references&#34;</span> my-galaxy)))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> citar-library-file-extensions &#39;(<span style=color:#0ff;font-weight:700>&#34;pdf&#34;</span> <span style=color:#0ff;font-weight:700>&#34;jpg&#34;</span> <span style=color:#0ff;font-weight:700>&#34;epub&#34;</span>))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> citar-templates &#39;((main . <span style=color:#0ff;font-weight:700>&#34;${author editor:30} ${date year issued:4} ${title:48}&#34;</span>)
</span></span><span style=display:flex><span>                          (suffix . <span style=color:#0ff;font-weight:700>&#34;${=key= id:15} ${=type=:12} ${tags keywords:*}&#34;</span>)
</span></span><span style=display:flex><span>                          (preview . <span style=color:#0ff;font-weight:700>&#34;${author editor} (${year issued date}) ${title}, ${journal journaltitle publisher container-title collection-title}.\n&#34;</span>)
</span></span><span style=display:flex><span>                          (note . <span style=color:#0ff;font-weight:700>&#34;${title}&#34;</span>)))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> citar-symbol-separator <span style=color:#0ff;font-weight:700>&#34;  &#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> citar-file-additional-files-separator <span style=color:#0ff;font-weight:700>&#34;-&#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> citar-at-point-function <span style=color:#0ff;font-weight:700>&#39;embark-act</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>with-eval-after-load</span> <span style=color:#0ff;font-weight:700>&#39;all-the-icons</span>
</span></span><span style=display:flex><span>   (<span style=color:#fff;font-weight:700>setq</span> citar-symbols
</span></span><span style=display:flex><span>        `((file ,(all-the-icons-faicon <span style=color:#0ff;font-weight:700>&#34;file-pdf-o&#34;</span> <span style=color:#fff;font-weight:700>:face</span> <span style=color:#0ff;font-weight:700>&#39;all-the-icons-dred</span> <span style=color:#fff;font-weight:700>:v-adjust</span> <span style=color:#ff0;font-weight:700>-0.1</span>) . <span style=color:#0ff;font-weight:700>&#34; &#34;</span>)
</span></span><span style=display:flex><span>          (note ,(all-the-icons-material <span style=color:#0ff;font-weight:700>&#34;speaker_notes&#34;</span> <span style=color:#fff;font-weight:700>:face</span> <span style=color:#0ff;font-weight:700>&#39;all-the-icons-blue</span> <span style=color:#fff;font-weight:700>:v-adjust</span> <span style=color:#ff0;font-weight:700>-0.3</span>) . <span style=color:#0ff;font-weight:700>&#34; &#34;</span>)
</span></span><span style=display:flex><span>          (link ,(all-the-icons-octicon <span style=color:#0ff;font-weight:700>&#34;link&#34;</span> <span style=color:#fff;font-weight:700>:face</span> <span style=color:#0ff;font-weight:700>&#39;all-the-icons-orange</span> <span style=color:#fff;font-weight:700>:v-adjust</span> <span style=color:#ff0;font-weight:700>0.01</span>) . <span style=color:#0ff;font-weight:700>&#34; &#34;</span>)))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> citar-latex
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:after</span> citar)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> citar-capf
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> ((LaTeX-mode . citar-capf-setup)
</span></span><span style=display:flex><span>         (org-mode . citar-capf-setup)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> citar-org
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:after</span> citar
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-cite-insert-processor <span style=color:#0ff;font-weight:700>&#39;citar</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-cite-follow-processor <span style=color:#0ff;font-weight:700>&#39;citar</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-cite-activate-processor <span style=color:#0ff;font-weight:700>&#39;citar</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>with-eval-after-load</span> <span style=color:#0ff;font-weight:700>&#39;citar-org</span>
</span></span><span style=display:flex><span>    (define-key citar-org-citation-map (kbd <span style=color:#0ff;font-weight:700>&#34;RET&#34;</span>) <span style=color:#0ff;font-weight:700>&#39;org-open-at-point</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> citar-embark
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:commands</span> citar-embark-mode
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (org-mode . citar-embark-mode))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(my/space-leader-def
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;re&#34;</span> &#39;(citar-open-entry <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Open entry&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;rp&#34;</span> &#39;(citar-open-files <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Open files&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;ri&#34;</span> &#39;(citar-insert-citation <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Insert citation&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;rn&#34;</span> &#39;(citar-open-notes <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Open/Create note&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;rl&#34;</span> &#39;(citar-open-links <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Open links&#34;</span>))
</span></span></code></pre></div></li></ul><ul><li><p>citar-denote</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> citar-denote
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:after</span> citar
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>defun</span> my/citar-open-notes (citekeys)
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;Open notes associated with the CITEKEYS.&#34;</span>
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>interactive</span> (list (citar-select-refs <span style=color:#fff;font-weight:700>:filter</span> (citar-denote-has-notes))))
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>pcase</span> (<span style=color:#fff;font-weight:700>let</span> ((embark-default-action-overrides
</span></span><span style=display:flex><span>                  (cons (cons t #&#39;citar--open-resource)
</span></span><span style=display:flex><span>                        (bound-and-true-p embark-default-action-overrides))))
</span></span><span style=display:flex><span>             (citar--select-resource citekeys <span style=color:#fff;font-weight:700>:notes</span> t <span style=color:#fff;font-weight:700>:create-notes</span> t))
</span></span><span style=display:flex><span>      (`(note . ,note) (citar-open-note note))
</span></span><span style=display:flex><span>      (`(create-note . ,citekey) (citar-create-note citekey))))
</span></span><span style=display:flex><span>  (advice-add <span style=color:#0ff;font-weight:700>&#39;citar-denote-open-note</span> <span style=color:#fff;font-weight:700>:override</span> <span style=color:#0ff;font-weight:700>&#39;my/citar-open-notes</span>))
</span></span></code></pre></div></li></ul><ul><li><p>bibtex-completion</p><p>bibtex-completion 这个包是 org-roam-bibtex 的依赖。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> bibtex-completion
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:after</span> org-roam-bibtex
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> bibtex-completion-bibliography org-cite-global-bibliography)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> bibtex-completion-notes-path (expand-file-name <span style=color:#0ff;font-weight:700>&#34;roam/ref&#34;</span> my-galaxy))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> bibtex-completion-pdf-field <span style=color:#0ff;font-weight:700>&#34;File&#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> bibtex-completion-additional-search-fields &#39;(keywords journal booktitle))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> bibtex-completion-pdf-symbol <span style=color:#0ff;font-weight:700>&#34;P&#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> bibtex-completion-notes-symbol <span style=color:#0ff;font-weight:700>&#34;N&#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> bibtex-completion-display-formats &#39;((article . <span style=color:#0ff;font-weight:700>&#34;${=has-pdf=:1} ${=has-note=:1} ${year:4} ${author:36} ${title:*} ${journal:40}&#34;</span>)
</span></span><span style=display:flex><span>                                            (inbook . <span style=color:#0ff;font-weight:700>&#34;${=has-pdf=:1} ${=has-note=:1} ${year:4} ${author:36} ${title:*} Chapter ${chapter:32}&#34;</span>)
</span></span><span style=display:flex><span>                                            (incollection . <span style=color:#0ff;font-weight:700>&#34;${=has-pdf=:1} ${=has-note=:1} ${year:4} ${author:36} ${title:*} ${booktitle:40}&#34;</span>)
</span></span><span style=display:flex><span>                                            (inproceedings . <span style=color:#0ff;font-weight:700>&#34;${=has-pdf=:1} ${=has-note=:1} ${year:4} ${author:36} ${title:*} ${booktitle:40}&#34;</span>)
</span></span><span style=display:flex><span>                                            (t . <span style=color:#0ff;font-weight:700>&#34;${=has-pdf=:1} ${=has-note=:1} ${year:4} ${author:36} ${title:*}&#34;</span>))))
</span></span></code></pre></div></li></ul><ul><li><p>ebib</p><p>Ebib 是 Emacs 中的文献管理软件，类似于 zotero, 但是我感觉 Zotero 更强一些，但是 Zotero 占用的内存实在是大，MacOS 上约有一个G.</p><p>相比较而言，Emacs 整个占用的内存才几百兆。</p><p>我保留 Ebib 的原因是它可以从主 bibtex 文件中提取文章需要的文献内容。</p><p>具体的使用见：<a href=https://joostkremers.github.io/ebib/ebib-manual.html#main-and-dependent-databases>Ebib Manual</a></p><p>首先创建一个 dependent database <code>M c</code>, 然后使用 <code>M a</code> 把 main database 中的引文添加到 dependent database 中。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> ebib
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:bind</span> (<span style=color:#0ff;font-weight:700>&#34;&lt;f2&gt;&#34;</span> . ebib)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> ebib-preload-bib-files org-cite-global-bibliography)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> ebib-keywords (concat org-roam-directory <span style=color:#0ff;font-weight:700>&#34;/bibtexs/keywords.txt&#34;</span>))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> ebib-notes-directory (concat org-roam-directory <span style=color:#0ff;font-weight:700>&#34;/ref&#34;</span>))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> ebib-filters-default-file (concat org-roam-directory <span style=color:#0ff;font-weight:700>&#34;/bibtexs/ebib-filters&#34;</span>))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> ebib-reading-list-file (concat org-roam-directory <span style=color:#0ff;font-weight:700>&#34;/bibtexs/reading_list.org&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> ebib-keywords-field-keep-sorted t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> ebib-keywords-file-save-on-exit <span style=color:#0ff;font-weight:700>&#39;always</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> ebib-index-columns
</span></span><span style=display:flex><span>        &#39;((<span style=color:#0ff;font-weight:700>&#34;Entry Key&#34;</span> <span style=color:#ff0;font-weight:700>30</span> t) (<span style=color:#0ff;font-weight:700>&#34;Note&#34;</span> <span style=color:#ff0;font-weight:700>1</span> nil) (<span style=color:#0ff;font-weight:700>&#34;Year&#34;</span> <span style=color:#ff0;font-weight:700>6</span> t) (<span style=color:#0ff;font-weight:700>&#34;Title&#34;</span> <span style=color:#ff0;font-weight:700>50</span> t)))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> ebib-file-associations &#39;((<span style=color:#0ff;font-weight:700>&#34;ps&#34;</span> . <span style=color:#0ff;font-weight:700>&#34;gv&#34;</span>))))
</span></span></code></pre></div></li></ul><ul><li><p>scihub</p><p>当有了 DOI 之后想要下载文献，可以使用 scihub 这个通过 scihub 下载。若没有源的话再想其他的方式。</p><p>使用 scihub 需要提供 DOI 或者完整的文献题目。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> scihub
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:commands</span> scihub
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> scihub-download-directory <span style=color:#0ff;font-weight:700>&#34;~/Downloads/&#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> scihub-open-after-download t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> scihub-fetch-domain <span style=color:#0ff;font-weight:700>&#39;scihub-fetch-domains-lovescihub</span>))
</span></span></code></pre></div></li></ul><ul><li><p>biblio</p><p>文献的查找目前有多种方式，如可以使用 biblio 进行查找，常用的有 crossfer-lookup.</p><p>我默认使用 crossref 作为后端，通过 <code>SPC n r d</code> 调用，若要使用其他的后端，通过 <code>M-x biblio-lookup</code> 进行。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> biblio
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:commands</span> biblio-lookup
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:general</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>:states</span> <span style=color:#0ff;font-weight:700>&#39;normal</span>
</span></span><span style=display:flex><span>           <span style=color:#0ff;font-weight:700>&#34;SPC rd&#34;</span> <span style=color:#0ff;font-weight:700>&#39;my/biblio-lookup-crossref</span> <span style=color:#fff;font-weight:700>:no-autoload</span> t)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:preface</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>defun</span> my/biblio-lookup-crossref ()
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>    (biblio-lookup <span style=color:#0ff;font-weight:700>&#39;biblio-crossref-backend</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(my/space-leader-def
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;rd&#34;</span> &#39;(my/biblio-lookup-crossref <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Get bib from crossfer&#34;</span>))
</span></span></code></pre></div></li></ul><h4 id=footer>Footer</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>provide</span> <span style=color:#0ff;font-weight:700>&#39;init-bib</span>)
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; init-bib.el ends here.</span>
</span></span></code></pre></div><h3 id=latex>Latex</h3><p>参考资料：<a href=https://gist.github.com/karthink/7d89df35ee9b7ac0c93d0177b862dadb>fast latex input</a>.</p><p>Latex 可以结合 eglot 使用，有多个 server 可以使用， <code>digestif</code> 和 =texlab=，我使用前者。</p><h4 id=header>Header</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#007f7f>;; init-latex.el --- latex *- lexical-binding: t; no-byte-compile: t -*-</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Commentary:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Code:</span>
</span></span></code></pre></div><h4 id=auctex>auctex</h4><p>Auctex 若通过源文件安装，需要先将其克隆到本地，然后执行：</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>./autogen.sh
</span></span><span style=display:flex><span>./configure
</span></span><span style=display:flex><span>make
</span></span><span style=display:flex><span>sudo make install
</span></span></code></pre></div><p>emacs 上有 <code>latex-mode</code> 和 <code>LaTeX-mode</code> 两个，使用哪个取决于是否安装了 <code>auctex</code> 这个包。若有，使用 <code>LaTex-mode</code> 就好。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> tex
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:mode</span> (<span style=color:#0ff;font-weight:700>&#34;.tex&#34;</span> . LaTeX-mode)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:init</span>
</span></span><span style=display:flex><span>  (load <span style=color:#0ff;font-weight:700>&#34;auctex.el&#34;</span> nil t t)
</span></span><span style=display:flex><span>  (load <span style=color:#0ff;font-weight:700>&#34;preview-latex.el&#34;</span> nil t t)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> TeX-auto-save t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> TeX-parse-self t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> TeX-save-query nil)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> TeX-electric-sub-and-superscript t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> TeX-auto-local <span style=color:#0ff;font-weight:700>&#34;.auctex-auto&#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> TeX-style-local <span style=color:#0ff;font-weight:700>&#34;.auctex-style&#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> TeX-source-correlate-mode t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> TeX-source-correlate-method <span style=color:#0ff;font-weight:700>&#39;synctex</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> TeX-source-correlate-start-server nil)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq-default</span> TeX-master t)
</span></span><span style=display:flex><span>  (add-to-list <span style=color:#0ff;font-weight:700>&#39;TeX-command-list</span> &#39;(<span style=color:#0ff;font-weight:700>&#34;XeLaTeX&#34;</span> <span style=color:#0ff;font-weight:700>&#34;%`xelatex%(mode)%&#39; %t&#34;</span> TeX-run-TeX nil t))
</span></span><span style=display:flex><span>  (add-to-list <span style=color:#0ff;font-weight:700>&#39;TeX-view-program-selection</span> &#39;(output-pdf <span style=color:#0ff;font-weight:700>&#34;PDF Tools&#34;</span>))
</span></span><span style=display:flex><span>  (add-to-list <span style=color:#0ff;font-weight:700>&#39;TeX-view-program-list</span> &#39;(<span style=color:#0ff;font-weight:700>&#34;PDF Tools&#34;</span> TeX-pdf-tools-sync-view))
</span></span><span style=display:flex><span>  (add-hook <span style=color:#0ff;font-weight:700>&#39;TeX-after-compilation-finished-functions</span> #&#39;TeX-revert-document-buffer))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> latex
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:bind</span> (<span style=color:#fff;font-weight:700>:map</span> LaTeX-mode-map
</span></span><span style=display:flex><span>              (<span style=color:#0ff;font-weight:700>&#34;C-c h&#34;</span> . TeX-doc)))
</span></span></code></pre></div><h4 id=auctex-latexmk>auctex-latexmk</h4><p><a href=https://github.com/tom-tan/auctex-latexmk>tom-tan/auctex-latexmk: This library adds LatexMk support to AUCTeX.</a>
最新的 auctex 不能使用此处的包文件，需要使用 <a href=https://github.com/emacsmirror/auctex-latexmk>emacsmirror/auctex-latexmk: Add LatexMk support to AUCTeX</a> 替代。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> auctex-latexmk
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (LaTeX-mode . auctex-latexmk-setup))
</span></span></code></pre></div><h4 id=reftex>reftex</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> reftex
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> ((LaTeX-mode . turn-on-reftex)
</span></span><span style=display:flex><span>         (reftex-toc-mode . menu-bar--visual-line-mode-enable))
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> reftex-toc-split-windows-horizontally t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> reftex-toc-split-windows-fraction <span style=color:#ff0;font-weight:700>0.25</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(add-to-list <span style=color:#0ff;font-weight:700>&#39;display-buffer-alist</span> &#39;(<span style=color:#0ff;font-weight:700>&#34;\\*toc\\*&#34;</span>
</span></span><span style=display:flex><span>                                     (display-buffer-reuse-window)
</span></span><span style=display:flex><span>                                     (side . left)
</span></span><span style=display:flex><span>                                     (window-parameters
</span></span><span style=display:flex><span>                                      (mode-line-format . none)
</span></span><span style=display:flex><span>                                      (delete-other-windows . t))))
</span></span></code></pre></div><h4 id=cdlatex>cdlatex</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> cdlatex
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> ((LaTeX-mode . turn-on-cdlatex)
</span></span><span style=display:flex><span>         (org-mode . org-cdlatex-mode)))
</span></span></code></pre></div><h4 id=ox-latex>ox-latex</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> org
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-highlight-latex-and-related &#39;(latex script)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> ox-latex
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:defer</span> <span style=color:#ff0;font-weight:700>3</span>
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-latex-src-block-backend <span style=color:#0ff;font-weight:700>&#39;minted</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-latex-minted-options &#39;((<span style=color:#0ff;font-weight:700>&#34;breaklines&#34;</span> <span style=color:#0ff;font-weight:700>&#34;true&#34;</span>)
</span></span><span style=display:flex><span>                                   (<span style=color:#0ff;font-weight:700>&#34;breakanywhere&#34;</span> <span style=color:#0ff;font-weight:700>&#34;true&#34;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-latex-classes nil)
</span></span><span style=display:flex><span>  (add-to-list <span style=color:#0ff;font-weight:700>&#39;org-latex-classes</span>
</span></span><span style=display:flex><span>               &#39;(<span style=color:#0ff;font-weight:700>&#34;book&#34;</span>
</span></span><span style=display:flex><span>                 <span style=color:#0ff;font-weight:700>&#34;\\documentclass[UTF8,twoside,a4paper,12pt,openright]{ctexrep}
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>                   [NO-DEFAULT-PACKAGES]
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>                   [NO-PACKAGES]
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>                   [EXTRA]&#34;</span>
</span></span><span style=display:flex><span>                 (<span style=color:#0ff;font-weight:700>&#34;\\chapter{%s}&#34;</span> . <span style=color:#0ff;font-weight:700>&#34;\\chapter*{%s}&#34;</span>)
</span></span><span style=display:flex><span>                 (<span style=color:#0ff;font-weight:700>&#34;\\section{%s}&#34;</span> . <span style=color:#0ff;font-weight:700>&#34;\\section*{%s}&#34;</span>)
</span></span><span style=display:flex><span>                 (<span style=color:#0ff;font-weight:700>&#34;\\subsection{%s}&#34;</span> . <span style=color:#0ff;font-weight:700>&#34;\\subsection*{%s}&#34;</span>)
</span></span><span style=display:flex><span>                 (<span style=color:#0ff;font-weight:700>&#34;\\subsubsection{%s}&#34;</span> . <span style=color:#0ff;font-weight:700>&#34;\\subsubsection*{%s}&#34;</span>)
</span></span><span style=display:flex><span>                 (<span style=color:#0ff;font-weight:700>&#34;\\paragraph{%s}&#34;</span> . <span style=color:#0ff;font-weight:700>&#34;\\paragraph*{%s}&#34;</span>)
</span></span><span style=display:flex><span>                 (<span style=color:#0ff;font-weight:700>&#34;\\subparagraph{%s}&#34;</span> . <span style=color:#0ff;font-weight:700>&#34;\\subparagraph*{%s}&#34;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (add-to-list <span style=color:#0ff;font-weight:700>&#39;org-latex-classes</span> &#39;(<span style=color:#0ff;font-weight:700>&#34;article-cn&#34;</span> <span style=color:#0ff;font-weight:700>&#34;\\documentclass{ctexart}
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>                                      [NO-DEFAULT-PACKAGES]
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>                                      [NO-PACKAGES]
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>                                      [EXTRA]&#34;</span>
</span></span><span style=display:flex><span>                                    (<span style=color:#0ff;font-weight:700>&#34;\\section{%s}&#34;</span> . <span style=color:#0ff;font-weight:700>&#34;\\section*{%s}&#34;</span>)
</span></span><span style=display:flex><span>                                    (<span style=color:#0ff;font-weight:700>&#34;\\subsection{%s}&#34;</span> . <span style=color:#0ff;font-weight:700>&#34;\\subsection*{%s}&#34;</span>)
</span></span><span style=display:flex><span>                                    (<span style=color:#0ff;font-weight:700>&#34;\\subsubsection{%s}&#34;</span> . <span style=color:#0ff;font-weight:700>&#34;\\subsubsection*{%s}&#34;</span>)
</span></span><span style=display:flex><span>                                    (<span style=color:#0ff;font-weight:700>&#34;\\paragraph{%s}&#34;</span> . <span style=color:#0ff;font-weight:700>&#34;\\paragraph*{%s}&#34;</span>)
</span></span><span style=display:flex><span>                                    (<span style=color:#0ff;font-weight:700>&#34;\\subparagraph{%s}&#34;</span> . <span style=color:#0ff;font-weight:700>&#34;\\subparagraph*{%s}&#34;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (add-to-list <span style=color:#0ff;font-weight:700>&#39;org-latex-classes</span> &#39;(<span style=color:#0ff;font-weight:700>&#34;article&#34;</span> <span style=color:#0ff;font-weight:700>&#34;\\documentclass[11pt]{article}
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>                                      [NO-DEFAULT-PACKAGES]
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>                                      [NO-PACKAGES]
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>                                      [EXTRA]&#34;</span>
</span></span><span style=display:flex><span>                                    (<span style=color:#0ff;font-weight:700>&#34;\\section{%s}&#34;</span> . <span style=color:#0ff;font-weight:700>&#34;\\section*{%s}&#34;</span>)
</span></span><span style=display:flex><span>                                    (<span style=color:#0ff;font-weight:700>&#34;\\subsection{%s}&#34;</span> . <span style=color:#0ff;font-weight:700>&#34;\\subsection*{%s}&#34;</span>)
</span></span><span style=display:flex><span>                                    (<span style=color:#0ff;font-weight:700>&#34;\\subsubsection{%s}&#34;</span> . <span style=color:#0ff;font-weight:700>&#34;\\subsubsection*{%s}&#34;</span>)
</span></span><span style=display:flex><span>                                    (<span style=color:#0ff;font-weight:700>&#34;\\paragraph{%s}&#34;</span> . <span style=color:#0ff;font-weight:700>&#34;\\paragraph*{%s}&#34;</span>)
</span></span><span style=display:flex><span>                                    (<span style=color:#0ff;font-weight:700>&#34;\\subparagraph{%s}&#34;</span> . <span style=color:#0ff;font-weight:700>&#34;\\subparagraph*{%s}&#34;</span>)))
</span></span><span style=display:flex><span>  (add-to-list <span style=color:#0ff;font-weight:700>&#39;org-latex-classes</span> &#39;(<span style=color:#0ff;font-weight:700>&#34;beamer&#34;</span> <span style=color:#0ff;font-weight:700>&#34;\\documentclass[presentation]{beamer}
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>                                      [DEFAULT-PACKAGES]
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>                                      [PACKAGES]
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>                                      [EXTRA]&#34;</span>
</span></span><span style=display:flex><span>                                    (<span style=color:#0ff;font-weight:700>&#34;\\section{%s}&#34;</span> . <span style=color:#0ff;font-weight:700>&#34;\\section*{%s}&#34;</span>)
</span></span><span style=display:flex><span>                                    (<span style=color:#0ff;font-weight:700>&#34;\\subsection{%s}&#34;</span> . <span style=color:#0ff;font-weight:700>&#34;\\subsection*{%s}&#34;</span>)
</span></span><span style=display:flex><span>                                    (<span style=color:#0ff;font-weight:700>&#34;\\subsubsection{%s}&#34;</span> . <span style=color:#0ff;font-weight:700>&#34;\\subsubsection*{%s}&#34;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-latex-pdf-process
</span></span><span style=display:flex><span>        &#39;(<span style=color:#0ff;font-weight:700>&#34;xelatex -8bit --shell-escape  -interaction=nonstopmode -output-directory %o %f&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#0ff;font-weight:700>&#34;bibtex -shell-escape %b&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#0ff;font-weight:700>&#34;xelatex -8bit --shell-escape  -interaction=nonstopmode -output-directory %o %f&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#0ff;font-weight:700>&#34;xelatex -8bit --shell-escape  -interaction=nonstopmode -output-directory %o %f&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#0ff;font-weight:700>&#34;rm -fr %b.out %b.log %b.tex %b.brf %b.bbl&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-latex-logfiles-extensions &#39;(<span style=color:#0ff;font-weight:700>&#34;lof&#34;</span> <span style=color:#0ff;font-weight:700>&#34;lot&#34;</span> <span style=color:#0ff;font-weight:700>&#34;tex~&#34;</span> <span style=color:#0ff;font-weight:700>&#34;aux&#34;</span> <span style=color:#0ff;font-weight:700>&#34;idx&#34;</span> <span style=color:#0ff;font-weight:700>&#34;log&#34;</span>
</span></span><span style=display:flex><span>                                        <span style=color:#0ff;font-weight:700>&#34;out&#34;</span> <span style=color:#0ff;font-weight:700>&#34;toc&#34;</span> <span style=color:#0ff;font-weight:700>&#34;nav&#34;</span> <span style=color:#0ff;font-weight:700>&#34;snm&#34;</span> <span style=color:#0ff;font-weight:700>&#34;vrb&#34;</span> <span style=color:#0ff;font-weight:700>&#34;dvi&#34;</span>
</span></span><span style=display:flex><span>                                        <span style=color:#0ff;font-weight:700>&#34;fdb_latexmk&#34;</span> <span style=color:#0ff;font-weight:700>&#34;blg&#34;</span> <span style=color:#0ff;font-weight:700>&#34;brf&#34;</span> <span style=color:#0ff;font-weight:700>&#34;fls&#34;</span>
</span></span><span style=display:flex><span>                                        <span style=color:#0ff;font-weight:700>&#34;entoc&#34;</span> <span style=color:#0ff;font-weight:700>&#34;ps&#34;</span> <span style=color:#0ff;font-weight:700>&#34;spl&#34;</span> <span style=color:#0ff;font-weight:700>&#34;bbl&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-latex-prefer-user-labels t))
</span></span></code></pre></div><h4 id=ox-beamer>ox-beamer</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> ox-beamer
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:defer</span> <span style=color:#ff0;font-weight:700>3</span>
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:after</span> org)
</span></span></code></pre></div><h4 id=fontification>fontification</h4><p><a href=https://tex.stackexchange.com/questions/85849/auctex-new-commands-recognized-as-such/86119#86119>macros - AUCTeX – new commands recognized as such - TeX - LaTeX Stack Exchange</a>.</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> font-latex
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:after</span> tex
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> font-latex-match-reference-keywords
</span></span><span style=display:flex><span>        &#39;(<span style=color:#007f7f>;; BibLaTeX.</span>
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;printbibliography&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;addbibresource&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          <span style=color:#007f7f>;; Standard commands.</span>
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;cite&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;citep&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;citet&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;Cite&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;parencite&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;Parencite&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;footcite&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;footcitetext&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          <span style=color:#007f7f>;; Style-specific commands.</span>
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;textcite&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;Textcite&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;smartcite&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;Smartcite&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;cite*&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;parencite*&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;supercite&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          <span style=color:#007f7f>;; Qualified citation lists.</span>
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;cites&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;Cites&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;parencites&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;Parencites&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;footcites&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;footcitetexts&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;smartcites&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;Smartcites&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;textcites&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;Textcites&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;supercites&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          <span style=color:#007f7f>;; Style-independent commands.</span>
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;autocite&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;Autocite&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;autocite*&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;Autocite*&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;autocites&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;Autocites&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          <span style=color:#007f7f>;; Text commands.</span>
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;citeauthor&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;Citeauthor&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;citetitle&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;citetitle*&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;citeyear&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;citedate&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;citeurl&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          <span style=color:#007f7f>;; Special commands.</span>
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;fullcite&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          <span style=color:#007f7f>;; Cleveref.</span>
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;cref&#34;</span> <span style=color:#0ff;font-weight:700>&#34;{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;Cref&#34;</span> <span style=color:#0ff;font-weight:700>&#34;{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;cpageref&#34;</span> <span style=color:#0ff;font-weight:700>&#34;{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;Cpageref&#34;</span> <span style=color:#0ff;font-weight:700>&#34;{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;cpagerefrange&#34;</span> <span style=color:#0ff;font-weight:700>&#34;{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;Cpagerefrange&#34;</span> <span style=color:#0ff;font-weight:700>&#34;{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;crefrange&#34;</span> <span style=color:#0ff;font-weight:700>&#34;{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;Crefrange&#34;</span> <span style=color:#0ff;font-weight:700>&#34;{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;labelcref&#34;</span> <span style=color:#0ff;font-weight:700>&#34;{&#34;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> font-latex-match-textual-keywords
</span></span><span style=display:flex><span>        &#39;(<span style=color:#007f7f>;; BibLaTeX brackets.</span>
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;parentext&#34;</span> <span style=color:#0ff;font-weight:700>&#34;{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;brackettext&#34;</span> <span style=color:#0ff;font-weight:700>&#34;{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;hybridblockquote&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          <span style=color:#007f7f>;; Auxiliary commands.</span>
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;textelp&#34;</span> <span style=color:#0ff;font-weight:700>&#34;{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;textelp*&#34;</span> <span style=color:#0ff;font-weight:700>&#34;{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;textins&#34;</span> <span style=color:#0ff;font-weight:700>&#34;{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;textins*&#34;</span> <span style=color:#0ff;font-weight:700>&#34;{&#34;</span>)
</span></span><span style=display:flex><span>          <span style=color:#007f7f>;; Subcaption.</span>
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;subcaption&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> font-latex-match-variable-keywords
</span></span><span style=display:flex><span>        &#39;(<span style=color:#007f7f>;; Amsmath.</span>
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;numberwithin&#34;</span> <span style=color:#0ff;font-weight:700>&#34;{&#34;</span>)
</span></span><span style=display:flex><span>          <span style=color:#007f7f>;; Enumitem.</span>
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;setlist&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;setlist*&#34;</span> <span style=color:#0ff;font-weight:700>&#34;[{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;newlist&#34;</span> <span style=color:#0ff;font-weight:700>&#34;{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;renewlist&#34;</span> <span style=color:#0ff;font-weight:700>&#34;{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;setlistdepth&#34;</span> <span style=color:#0ff;font-weight:700>&#34;{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;restartlist&#34;</span> <span style=color:#0ff;font-weight:700>&#34;{&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;crefname&#34;</span> <span style=color:#0ff;font-weight:700>&#34;{&#34;</span>))))
</span></span></code></pre></div><h4 id=footer>Footer</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>provide</span> <span style=color:#0ff;font-weight:700>&#39;init-latex</span>)
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; init-latex.el ends here.</span>
</span></span></code></pre></div><h3 id=blog>Blog</h3><p>使用 org-mode 写 blog 有两个方法，一个是使用 ox-hugo, 另外一个就是使用 org-publish.</p><p>这两个都可以基于 github 建立自己的博客。</p><p>使用 deft 管理自己的写作，原先想使用 denote 进行，但是 denote 创建的文件名过长，会导致 <a href=https://codeberg.org/ideasman42/emacs-undo-fu-session>undo-fu-session</a> 报 <code>file name too long</code> 的错误。</p><p>发现使用 <a href=#consult-notes>consult-notes</a> 比 deft 好用。Deft 默认创建的文件名是一串日期格式，没有直接使用 title 直观。虽然可以使用 deft 提供的界面查找文件，但是不能结合 vertico 直接使用拼音进行中文的检索。</p><h4 id=header>Header</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#007f7f>;; init-blog.el --- blog *- lexical-binding: t; no-byte-compile: t -*-</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Commentary:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Code:</span>
</span></span></code></pre></div><h4 id=ox-hugo>ox-hugo</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> ox-hugo
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:defer</span> <span style=color:#ff0;font-weight:700>3</span>
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:after</span> ox)
</span></span></code></pre></div><h4 id=ox-html>ox-html</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> ox-html
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:after</span> ox
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-html-preamble t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-html-preamble-format
</span></span><span style=display:flex><span>        &#39;((<span style=color:#0ff;font-weight:700>&#34;en&#34;</span> <span style=color:#0ff;font-weight:700>&#34;&lt;a href=\&#34;/index.html\&#34; class=\&#34;button\&#34;&gt;Home&lt;/a&gt;
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>               &lt;a href=\&#34;/notes/index.html\&#34; class=\&#34;button\&#34;&gt;Notes&lt;/a&gt;
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>               &lt;a href=\&#34;/engineering/index.html\&#34; class=\&#34;button\&#34;&gt;Engineering&lt;/a&gt;
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>               &lt;a href=\&#34;/movies/index.html\&#34; class=\&#34;button\&#34;&gt;Movies&lt;/a&gt;
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>               &lt;a href=\&#34;/books/index.html\&#34; class=\&#34;button\&#34;&gt;Books&lt;/a&gt;
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>               &lt;a href=\&#34;/about.html\&#34; class=\&#34;button\&#34;&gt;About&lt;/a&gt;
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>               &lt;hr&gt;&#34;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-html-postamble t)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-html-postamble-format
</span></span><span style=display:flex><span>        &#39;((<span style=color:#0ff;font-weight:700>&#34;en&#34;</span> <span style=color:#0ff;font-weight:700>&#34;&lt;hr&gt;&lt;div class=\&#34;generated\&#34;&gt;Created with %c on MacOS&lt;/div&gt;&#34;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-html-head-include-default-style nil)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-html-head
</span></span><span style=display:flex><span>        <span style=color:#0ff;font-weight:700>&#34;&lt;link rel=\&#34;stylesheet\&#34; type=\&#34;text/css\&#34; href=\&#34;../css/style.css\&#34; /&gt;&#34;</span>))
</span></span></code></pre></div><h4 id=ox-publish>ox-publish</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> ox-publish
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:after</span> ox
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>defvar</span> my/publish-directory <span style=color:#0ff;font-weight:700>&#34;~/shuyi.github.io&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-publish-project-alist
</span></span><span style=display:flex><span>        `((<span style=color:#0ff;font-weight:700>&#34;site&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#fff;font-weight:700>:base-directory</span> ,website-directory
</span></span><span style=display:flex><span>           <span style=color:#fff;font-weight:700>:base-extension</span> <span style=color:#0ff;font-weight:700>&#34;org&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#fff;font-weight:700>:recursive</span> nil
</span></span><span style=display:flex><span>           <span style=color:#fff;font-weight:700>:publishing-directory</span> ,my/publish-directory
</span></span><span style=display:flex><span>           <span style=color:#fff;font-weight:700>:publishing-function</span> org-html-publish-to-html)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;notes&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#fff;font-weight:700>:base-directory</span> ,(expand-file-name <span style=color:#0ff;font-weight:700>&#34;notes&#34;</span> website-directory)
</span></span><span style=display:flex><span>           <span style=color:#fff;font-weight:700>:base-extension</span> <span style=color:#0ff;font-weight:700>&#34;org&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#fff;font-weight:700>:publishing-directory</span> ,(expand-file-name <span style=color:#0ff;font-weight:700>&#34;notes&#34;</span> my/publish-directory)
</span></span><span style=display:flex><span>           <span style=color:#fff;font-weight:700>:publishing-function</span> org-html-publish-to-html
</span></span><span style=display:flex><span>           <span style=color:#fff;font-weight:700>:auto-sitemap</span> t
</span></span><span style=display:flex><span>           <span style=color:#fff;font-weight:700>:sitemap-filename</span> <span style=color:#0ff;font-weight:700>&#34;index.org&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#fff;font-weight:700>:sitemap-title</span> <span style=color:#0ff;font-weight:700>&#34;Notes&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#fff;font-weight:700>:sitemap-sort-files</span> anti-chronologically)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;books&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#fff;font-weight:700>:base-directory</span> ,(expand-file-name <span style=color:#0ff;font-weight:700>&#34;books&#34;</span> website-directory)
</span></span><span style=display:flex><span>           <span style=color:#fff;font-weight:700>:base-extension</span> <span style=color:#0ff;font-weight:700>&#34;org&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#fff;font-weight:700>:publishing-directory</span> ,(expand-file-name <span style=color:#0ff;font-weight:700>&#34;books&#34;</span> my/publish-directory)
</span></span><span style=display:flex><span>           <span style=color:#fff;font-weight:700>:publishing-function</span> org-html-publish-to-html
</span></span><span style=display:flex><span>           <span style=color:#fff;font-weight:700>:auto-sitemap</span> t
</span></span><span style=display:flex><span>           <span style=color:#fff;font-weight:700>:sitemap-filename</span> <span style=color:#0ff;font-weight:700>&#34;index.org&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#fff;font-weight:700>:sitemap-title</span> <span style=color:#0ff;font-weight:700>&#34;Books&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#fff;font-weight:700>:sitemap-sort-files</span> anti-chronologically)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;movies&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#fff;font-weight:700>:base-directory</span> ,(expand-file-name <span style=color:#0ff;font-weight:700>&#34;movies&#34;</span> website-directory)
</span></span><span style=display:flex><span>           <span style=color:#fff;font-weight:700>:base-extension</span> <span style=color:#0ff;font-weight:700>&#34;org&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#fff;font-weight:700>:publishing-directory</span> ,(expand-file-name <span style=color:#0ff;font-weight:700>&#34;movies&#34;</span> my/publish-directory)
</span></span><span style=display:flex><span>           <span style=color:#fff;font-weight:700>:publishing-function</span> org-html-publish-to-html
</span></span><span style=display:flex><span>           <span style=color:#fff;font-weight:700>:auto-sitemap</span> t
</span></span><span style=display:flex><span>           <span style=color:#fff;font-weight:700>:sitemap-filename</span> <span style=color:#0ff;font-weight:700>&#34;index.org&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#fff;font-weight:700>:sitemap-title</span> <span style=color:#0ff;font-weight:700>&#34;Movies&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#fff;font-weight:700>:sitemap-sort-files</span> anti-chronologically)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;engineering&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#fff;font-weight:700>:base-directory</span> ,(expand-file-name <span style=color:#0ff;font-weight:700>&#34;engineering&#34;</span> website-directory)
</span></span><span style=display:flex><span>           <span style=color:#fff;font-weight:700>:base-extension</span> <span style=color:#0ff;font-weight:700>&#34;org&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#fff;font-weight:700>:publishing-directory</span> ,(expand-file-name <span style=color:#0ff;font-weight:700>&#34;engineering&#34;</span> my/publish-directory)
</span></span><span style=display:flex><span>           <span style=color:#fff;font-weight:700>:publishing-function</span> org-html-publish-to-html
</span></span><span style=display:flex><span>           <span style=color:#fff;font-weight:700>:auto-sitemap</span> t
</span></span><span style=display:flex><span>           <span style=color:#fff;font-weight:700>:sitemap-filename</span> <span style=color:#0ff;font-weight:700>&#34;index.org&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#fff;font-weight:700>:sitemap-title</span> <span style=color:#0ff;font-weight:700>&#34;Engineering&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#fff;font-weight:700>:sitemap-sort-files</span> anti-chronologically)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;static&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#fff;font-weight:700>:base-directory</span> ,website-directory
</span></span><span style=display:flex><span>           <span style=color:#fff;font-weight:700>:base-extension</span> <span style=color:#0ff;font-weight:700>&#34;css\\|txt\\|jpg\\|gif\\|png&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#fff;font-weight:700>:recursive</span> t
</span></span><span style=display:flex><span>           <span style=color:#fff;font-weight:700>:publishing-directory</span>  ,my/publish-directory
</span></span><span style=display:flex><span>           <span style=color:#fff;font-weight:700>:publishing-function</span> org-publish-attachment)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;personal-website&#34;</span> <span style=color:#fff;font-weight:700>:components</span> (<span style=color:#0ff;font-weight:700>&#34;site&#34;</span> <span style=color:#0ff;font-weight:700>&#34;notes&#34;</span> <span style=color:#0ff;font-weight:700>&#34;books&#34;</span>
</span></span><span style=display:flex><span>                                           <span style=color:#0ff;font-weight:700>&#34;movies&#34;</span> <span style=color:#0ff;font-weight:700>&#34;engineering&#34;</span> <span style=color:#0ff;font-weight:700>&#34;static&#34;</span>)))))
</span></span></code></pre></div><h4 id=footer>Footer</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>provide</span> <span style=color:#0ff;font-weight:700>&#39;init-blog</span>)
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; init-blog.el ends here.</span>
</span></span></code></pre></div><h3 id=better-org-with-third-packages>Better org with third packages</h3><h4 id=header>Header</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#007f7f>;; init-org+.el --- org-mode+ *- lexical-binding: t; no-byte-compile: t -*-</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Commentary:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Code:</span>
</span></span></code></pre></div><h4 id=olivetti-mode>olivetti-mode</h4><p>Zen Mode 或者叫禅模式，其目的是为了降低不相关因素对于心智的干挠。将自己的视野集中于可见的区域，不需要移动脑袋。</p><p>在 Emacs 上有两个相关的包，一个是 <code>olivetti</code>, 另外一个是 <code>writeroom-mode</code>. <code>olivetti</code> 的功能更单一一些，但是足够使用。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> olivetti
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:commands</span> olivetti-mode)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>with-eval-after-load</span> <span style=color:#0ff;font-weight:700>&#39;evil</span>
</span></span><span style=display:flex><span>  (evil-define-key <span style=color:#0ff;font-weight:700>&#39;normal</span> org-mode-map
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;zw&#34;</span> <span style=color:#0ff;font-weight:700>&#39;olivetti-mode</span>))
</span></span></code></pre></div><h4 id=toc>TOC</h4><p>在 Org 文件的顶部生成目录。<a href=https://github.com/snosov1/toc-org>snosov1/toc-org: toc-org is an Emacs utility to have an up-to-date table of contents in the org files without exporting (useful primarily for readme files on GitHub)</a></p><p>需要在文件的头部新建一个 heading 并加上 tag：toc.</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> toc-org
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (org-mode . toc-org-mode))
</span></span></code></pre></div><h4 id=org-super-star>org-super-star</h4><p><a href=https://github.com/integral-dw/org-superstar-mode>integral-dw/org-superstar-mode: Make org-mode stars a little more super</a></p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> org-superstar
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (org-mode . org-superstar-mode)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-superstar-headline-bullets-list &#39;(<span style=color:#0ff;font-weight:700>&#34;❶&#34;</span> <span style=color:#0ff;font-weight:700>&#34;❷&#34;</span> <span style=color:#0ff;font-weight:700>&#34;❸&#34;</span> <span style=color:#0ff;font-weight:700>&#34;❹&#34;</span> <span style=color:#0ff;font-weight:700>&#34;❺&#34;</span> <span style=color:#0ff;font-weight:700>&#34;❻&#34;</span> <span style=color:#0ff;font-weight:700>&#34;❼&#34;</span>))
</span></span><span style=display:flex><span>  <span style=color:#007f7f>;; (setq org-superstar-headline-bullets-list &#39;(&#34;1&#34; &#34;2&#34; &#34;3&#34; &#34;4&#34; &#34;5&#34; &#34;6&#34; &#34;7&#34;))</span>
</span></span><span style=display:flex><span>  <span style=color:#007f7f>;; (setq org-superstar-headline-bullets-list &#39;(&#34;①&#34; &#34;②&#34; &#34;③&#34; &#34;④&#34; &#34;⑤&#34; &#34;⑥&#34;))</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-hide-leading-stars t))
</span></span></code></pre></div><h4 id=org-rainbow-tags>org-rainbow-tags</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> org-rainbow-tags
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (org-mode . org-rainbow-tags-mode))
</span></span></code></pre></div><h4 id=org-appear>org-appear</h4><p>在 org 中经常使用链接，使 Org 元素的不可见部分显示为可见。结合 Evil 使用，对于链接的编辑很方便。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> org-appear
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-appear-autolinks t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-appear-trigger <span style=color:#0ff;font-weight:700>&#39;manual</span>)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> ((org-mode . (<span style=color:#fff;font-weight:700>lambda</span> ()
</span></span><span style=display:flex><span>                       (add-hook <span style=color:#0ff;font-weight:700>&#39;evil-insert-state-entry-hook</span>
</span></span><span style=display:flex><span>                                 #&#39;org-appear-manual-start
</span></span><span style=display:flex><span>                                 nil
</span></span><span style=display:flex><span>                                 t)
</span></span><span style=display:flex><span>                       (add-hook <span style=color:#0ff;font-weight:700>&#39;evil-insert-state-exit-hook</span>
</span></span><span style=display:flex><span>                                 #&#39;org-appear-manual-stop
</span></span><span style=display:flex><span>                                 nil
</span></span><span style=display:flex><span>                                 t)))
</span></span><span style=display:flex><span>         (org-mode . org-appear-mode)))
</span></span></code></pre></div><h4 id=math-preview>math-preview</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> math-preview
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:commands</span> (math-preview-all math-preview-at-point)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> math-preview-scale <span style=color:#ff0;font-weight:700>1.1</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> math-preview-raise <span style=color:#ff0;font-weight:700>0.3</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> math-preview-margin &#39;(<span style=color:#ff0;font-weight:700>1</span> . <span style=color:#ff0;font-weight:700>0</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(my/space-leader-def
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;p&#34;</span> &#39;(<span style=color:#fff;font-weight:700>:ignore</span> t <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Preview&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;pa&#34;</span> &#39;(math-preview-all <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;All&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;pA&#34;</span> &#39;(math-preview-clear-all <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Clear All&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;pp&#34;</span> &#39;(math-preview-at-point <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Point&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;pP&#34;</span> &#39;(math-preview-clear-at-point <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Clear Point&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;pr&#34;</span> &#39;(math-preview-region <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Region&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;pR&#34;</span> &#39;(math-preview-clear-region <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Clear Region&#34;</span>))
</span></span></code></pre></div><h4 id=org-download>org-download</h4><p>用于管理图片。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> org-download
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:commands</span> org-download-enable
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (org-mode . org-download-enable)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:init</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-download-image-dir (expand-file-name <span style=color:#0ff;font-weight:700>&#34;pictures&#34;</span> my-galaxy))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-download-heading-lvl nil)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-download-screenshot-method <span style=color:#0ff;font-weight:700>&#39;screencapture</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-download-abbreviate-filename-function <span style=color:#0ff;font-weight:700>&#39;expand-file-name</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-download-timestamp <span style=color:#0ff;font-weight:700>&#34;%Y%m%d%H%M%S&#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-download-display-inline-images nil)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-download-annotate-function (<span style=color:#fff;font-weight:700>lambda</span> (_link) <span style=color:#0ff;font-weight:700>&#34;&#34;</span>))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> org-download-image-attr-list &#39;(<span style=color:#0ff;font-weight:700>&#34;#+NAME: fig: &#34;</span>
</span></span><span style=display:flex><span>                                       <span style=color:#0ff;font-weight:700>&#34;#+CAPTION: &#34;</span>
</span></span><span style=display:flex><span>                                       <span style=color:#0ff;font-weight:700>&#34;#+ATTR_ORG: :width 500px&#34;</span>
</span></span><span style=display:flex><span>                                       <span style=color:#0ff;font-weight:700>&#34;#+ATTR_LATEX: :width 10cm :placement [!htpb]&#34;</span>
</span></span><span style=display:flex><span>                                       <span style=color:#0ff;font-weight:700>&#34;#+ATTR_HTML: :width 600px&#34;</span>))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>defun</span> my/auto-change-file-paths ()
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>save-excursion</span>
</span></span><span style=display:flex><span>      (previous-line)
</span></span><span style=display:flex><span>      (<span style=color:#fff;font-weight:700>while</span> (re-search-forward (expand-file-name <span style=color:#0ff;font-weight:700>&#34;~&#34;</span>) nil t)
</span></span><span style=display:flex><span>        (replace-match <span style=color:#0ff;font-weight:700>&#34;~&#34;</span> t nil))))
</span></span><span style=display:flex><span>  (advice-add <span style=color:#0ff;font-weight:700>&#39;org-download-clipboard</span> <span style=color:#fff;font-weight:700>:after</span> <span style=color:#0ff;font-weight:700>&#39;my/auto-change-file-paths</span>))
</span></span><span style=display:flex><span>(my/space-leader-def
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;od&#34;</span> &#39;(<span style=color:#fff;font-weight:700>:ignore</span> t <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Download&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;odc&#34;</span> &#39;(org-download-clipboard <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Download Clipboard&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;ody&#34;</span> &#39;(org-download-yank <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Download Yank&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;odr&#34;</span> &#39;(org-download-rename-last-file <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Rename last file&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;odR&#34;</span> &#39;(org-download-rename-at-point <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Rename point&#34;</span>))
</span></span></code></pre></div><h4 id=plantuml>plantuml</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> plantuml
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:commands</span> (plantuml-org-to-mindmap-open plantuml-org-to-wbs-open)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> plantuml-jar-path
</span></span><span style=display:flex><span>        (concat (string-trim
</span></span><span style=display:flex><span>                 (shell-command-to-string <span style=color:#0ff;font-weight:700>&#34;readlink -f $(brew --prefix plantuml)&#34;</span>))
</span></span><span style=display:flex><span>                <span style=color:#0ff;font-weight:700>&#34;/libexec/plantuml.jar&#34;</span>)))
</span></span><span style=display:flex><span>(my/space-leader-def
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;pm&#34;</span> &#39;(plantuml-org-to-mindmap-open <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Mindmap&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;ps&#34;</span> &#39;(plantuml-org-to-wbs-open <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Work Breakdown Structure&#34;</span>))
</span></span></code></pre></div><h4 id=pandoc>Pandoc</h4><p>将 org 文档转换为 word 文档，仅支持简单的文档，过于复杂的文档不行。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> org-export-docx ()
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Convert org to docx.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>let</span> ((docx-file (concat (file-name-sans-extension (buffer-file-name)) <span style=color:#0ff;font-weight:700>&#34;.docx&#34;</span>))
</span></span><span style=display:flex><span>        (template-file (expand-file-name <span style=color:#0ff;font-weight:700>&#34;template/template.docx&#34;</span> user-emacs-directory)))
</span></span><span style=display:flex><span>    (shell-command (format <span style=color:#0ff;font-weight:700>&#34;pandoc %s -o %s --reference-doc=%s&#34;</span> (buffer-file-name) docx-file template-file))
</span></span><span style=display:flex><span>    (message <span style=color:#0ff;font-weight:700>&#34;Convert finish: %s&#34;</span> docx-file)))
</span></span></code></pre></div><p>ox-pandoc 增加 org-export 的选项。不过 ox-pandoc 己经不怎么更新。</p><p>此外还有一个 pandoc-mode, 初步尝试后感觉还可以。.</p><p>Pandoc 不怎么使用，时间长了就忘记 pandoc 的使用方法。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#007f7f>;; First, install pandoc with `brew install pandoc&#39;.</span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;; Only for simple file, no cite info, no latex formular.</span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;; Image file has to be absolute path, relative path do not work!</span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> org-pandoc-menu-entry
</span></span><span style=display:flex><span>      &#39;((<span style=color:#0ff;font-weight:700>?m</span> <span style=color:#0ff;font-weight:700>&#34;as md.&#34;</span> org-pandoc-export-as-commonmark)
</span></span><span style=display:flex><span>        (<span style=color:#0ff;font-weight:700>?M</span> <span style=color:#0ff;font-weight:700>&#34;to md and open.&#34;</span> org-pandoc-export-to-commonmark-and-open)
</span></span><span style=display:flex><span>        (<span style=color:#0ff;font-weight:700>?x</span> <span style=color:#0ff;font-weight:700>&#34;to docx.&#34;</span> org-pandoc-export-to-docx)
</span></span><span style=display:flex><span>        (<span style=color:#0ff;font-weight:700>?X</span> <span style=color:#0ff;font-weight:700>&#34;to docx and open.&#34;</span> org-pandoc-export-to-docx-and-open)
</span></span><span style=display:flex><span>        (<span style=color:#0ff;font-weight:700>?e</span> <span style=color:#0ff;font-weight:700>&#34;to epub.&#34;</span> org-pandoc-export-to-epub)
</span></span><span style=display:flex><span>        (<span style=color:#0ff;font-weight:700>?E</span> <span style=color:#0ff;font-weight:700>&#34;to epub and open.&#34;</span> org-pandoc-export-to-epub-and-open)
</span></span><span style=display:flex><span>        (<span style=color:#0ff;font-weight:700>?3</span> <span style=color:#0ff;font-weight:700>&#34;to epub3.&#34;</span> org-pandoc-export-to-epub3)
</span></span><span style=display:flex><span>        (<span style=color:#0ff;font-weight:700>?£</span> <span style=color:#0ff;font-weight:700>&#34;to epub3 and open.&#34;</span> org-pandoc-export-to-epub3-and-open)
</span></span><span style=display:flex><span>        (<span style=color:#0ff;font-weight:700>?j</span> <span style=color:#0ff;font-weight:700>&#34;as json.&#34;</span> org-pandoc-export-as-json)
</span></span><span style=display:flex><span>        (<span style=color:#0ff;font-weight:700>?J</span> <span style=color:#0ff;font-weight:700>&#34;to json and open.&#34;</span> org-pandoc-export-to-json-and-open)
</span></span><span style=display:flex><span>        (<span style=color:#0ff;font-weight:700>?r</span> <span style=color:#0ff;font-weight:700>&#34;as rst.&#34;</span> org-pandoc-export-as-rst)
</span></span><span style=display:flex><span>        (<span style=color:#0ff;font-weight:700>?R</span> <span style=color:#0ff;font-weight:700>&#34;to rst and open.&#34;</span> org-pandoc-export-to-rst-and-open)))
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> org-pandoc-options &#39;((standalone . t)
</span></span><span style=display:flex><span>                           (mathjax . t)
</span></span><span style=display:flex><span>                           (wrap . <span style=color:#0ff;font-weight:700>&#34;preserve&#34;</span>)))
</span></span></code></pre></div><h4 id=footer>Footer</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>provide</span> <span style=color:#0ff;font-weight:700>&#39;init-org+</span>)
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; init-org+.el ends here.</span>
</span></span></code></pre></div><h2 id=applicatons-more-and-more>Applicatons, More and More</h2><h3 id=browser>Browser</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#007f7f>;; init-browser.el --- browser *- lexical-binding: t; no-byte-compile: t -*-</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Commentary:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Code:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;; eww</span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;; Install readability first.</span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;; npm install -g readability-cli</span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;; (setq eww-retrieve-command &#39;(&#34;readable&#34;))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;; Another choice `websearch&#39;.</span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;; Search engine</span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> engine-mode
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (on-first-input . engine-mode)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (defengine google <span style=color:#0ff;font-weight:700>&#34;https://google.com/search?q=%s&#34;</span>
</span></span><span style=display:flex><span>             <span style=color:#fff;font-weight:700>:keybinding</span> <span style=color:#0ff;font-weight:700>&#34;g&#34;</span>
</span></span><span style=display:flex><span>             <span style=color:#fff;font-weight:700>:docstring</span> <span style=color:#0ff;font-weight:700>&#34;Search Google.&#34;</span>)
</span></span><span style=display:flex><span>  (defengine wikipedia <span style=color:#0ff;font-weight:700>&#34;https://en.wikipedia.org/wiki/Special:Search?search=%s&#34;</span>
</span></span><span style=display:flex><span>             <span style=color:#fff;font-weight:700>:keybinding</span> <span style=color:#0ff;font-weight:700>&#34;w&#34;</span>
</span></span><span style=display:flex><span>             <span style=color:#fff;font-weight:700>:docstring</span> <span style=color:#0ff;font-weight:700>&#34;Search Wikipedia.&#34;</span>)
</span></span><span style=display:flex><span>  (defengine github <span style=color:#0ff;font-weight:700>&#34;https://github.com/search?ref=simplesearch&amp;q=%s&#34;</span>
</span></span><span style=display:flex><span>             <span style=color:#fff;font-weight:700>:keybinding</span> <span style=color:#0ff;font-weight:700>&#34;h&#34;</span>
</span></span><span style=display:flex><span>             <span style=color:#fff;font-weight:700>:docstring</span> <span style=color:#0ff;font-weight:700>&#34;Search GitHub.&#34;</span>)
</span></span><span style=display:flex><span>  (defengine youtube <span style=color:#0ff;font-weight:700>&#34;http://www.youtube.com/results?aq=f&amp;oq=&amp;search_query=%s&#34;</span>
</span></span><span style=display:flex><span>             <span style=color:#fff;font-weight:700>:keybinding</span> <span style=color:#0ff;font-weight:700>&#34;y&#34;</span>
</span></span><span style=display:flex><span>             <span style=color:#fff;font-weight:700>:docstring</span> <span style=color:#0ff;font-weight:700>&#34;Search YouTube.&#34;</span>)
</span></span><span style=display:flex><span>  (defengine moviedouban <span style=color:#0ff;font-weight:700>&#34;https://search.douban.com/movie/subject_search?search_text=%s&#34;</span>
</span></span><span style=display:flex><span>             <span style=color:#fff;font-weight:700>:keybinding</span> <span style=color:#0ff;font-weight:700>&#34;m&#34;</span>
</span></span><span style=display:flex><span>             <span style=color:#fff;font-weight:700>:docstring</span> <span style=color:#0ff;font-weight:700>&#34;Search Moive DouBan.&#34;</span>)
</span></span><span style=display:flex><span>  (defengine bookdouban <span style=color:#0ff;font-weight:700>&#34;https://search.douban.com/book/subject_search?search_text=%s&#34;</span>
</span></span><span style=display:flex><span>             <span style=color:#fff;font-weight:700>:keybinding</span> <span style=color:#0ff;font-weight:700>&#34;b&#34;</span>
</span></span><span style=display:flex><span>             <span style=color:#fff;font-weight:700>:docstring</span> <span style=color:#0ff;font-weight:700>&#34;Search Book DouBan.&#34;</span>)
</span></span><span style=display:flex><span>  (defengine zhihu <span style=color:#0ff;font-weight:700>&#34;https://www.zhihu.com/search?type=content&amp;q=%s&#34;</span>
</span></span><span style=display:flex><span>             <span style=color:#fff;font-weight:700>:keybinding</span> <span style=color:#0ff;font-weight:700>&#34;z&#34;</span>
</span></span><span style=display:flex><span>             <span style=color:#fff;font-weight:700>:docstring</span> <span style=color:#0ff;font-weight:700>&#34;Search Zhihu.&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(my/space-leader-def
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;s&#34;</span> &#39;(<span style=color:#fff;font-weight:700>:ignore</span> t <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Search&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;sb&#34;</span> &#39;(engine/search-bookdouban <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Book&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;ss&#34;</span> &#39;(engine/search-google <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Google&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;sg&#34;</span> &#39;(engine/search-github <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Github&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;sw&#34;</span> &#39;(engine/search-wikipedia <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Wiki&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;sm&#34;</span> &#39;(engine/search-moviedouban <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Movie&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;sz&#34;</span> &#39;(engine/search-zhihu <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Zhihu&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;sr&#34;</span> &#39;(rg <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;rg&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;sl&#34;</span> &#39;(consult-git-grep <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;git&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>provide</span> <span style=color:#0ff;font-weight:700>&#39;init-browser</span>)
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; init-browser.el ends here.</span>
</span></span></code></pre></div><h3 id=elfeed>Elfeed</h3><p><a href=https://github.com/skeeto/elfeed>https://github.com/skeeto/elfeed</a></p><h4 id=header>Header</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#007f7f>;; init-elfeed.el --- elfeed, rss reader *- lexical-binding: t; no-byte-compile: t -*-</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Commentary:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Code:</span>
</span></span></code></pre></div><h4 id=elfeed>Elfeed</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> elfeed
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:defer</span> t
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:preface</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>defun</span> elfeed-display-buffer (buf <span style=color:#fff;font-weight:700>&amp;optional</span> act)
</span></span><span style=display:flex><span>    (pop-to-buffer buf &#39;((display-buffer-reuse-window display-buffer-in-side-window)
</span></span><span style=display:flex><span>                         (side . bottom)
</span></span><span style=display:flex><span>                         (window-height . <span style=color:#ff0;font-weight:700>0.8</span>)
</span></span><span style=display:flex><span>                         (reusable-frames . visible)
</span></span><span style=display:flex><span>                         (window-parameters
</span></span><span style=display:flex><span>                          (select . t)
</span></span><span style=display:flex><span>                          (quit . t)
</span></span><span style=display:flex><span>                          (popup . t)))))
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> elfeed-show-entry-switch #&#39;elfeed-display-buffer))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(add-to-list <span style=color:#0ff;font-weight:700>&#39;display-buffer-alist</span>
</span></span><span style=display:flex><span>             `(,(<span style=color:#fff;font-weight:700>rx</span> (| <span style=color:#0ff;font-weight:700>&#34;*elfeed-search*&#34;</span>
</span></span><span style=display:flex><span>                       <span style=color:#0ff;font-weight:700>&#34;*elfeed-summary*&#34;</span>
</span></span><span style=display:flex><span>                       <span style=color:#0ff;font-weight:700>&#34;*elfeed-entry-&#34;</span>))
</span></span><span style=display:flex><span>               (display-buffer-in-tab)
</span></span><span style=display:flex><span>               (tab-name . <span style=color:#0ff;font-weight:700>&#34;RSS&#34;</span>)
</span></span><span style=display:flex><span>               (tab-group . <span style=color:#0ff;font-weight:700>&#34;RSS&#34;</span>)
</span></span><span style=display:flex><span>               (window-parameters . ((mode-line-format . none)))))
</span></span></code></pre></div><h4 id=elfeed-org>elfeed-org</h4><p><a href=https://github.com/remyhonig/elfeed-org>remyhonig/elfeed-org: Configure the Elfeed RSS reader with an Orgmode file</a> 通过 org 集中管理 elfeed 源。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> elfeed-org
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:after</span> elfeed)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> rmh-elfeed-org-files `(,(concat my-galaxy <span style=color:#0ff;font-weight:700>&#34;/rss/elfeed.org&#34;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> my/rss-source ()
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;Open elfeed config file.&#34;</span>
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>    (find-file (car rmh-elfeed-org-files)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(my/space-leader-def
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;fe&#34;</span> &#39;(my/rss-source <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Elfeed file&#34;</span>))
</span></span></code></pre></div><h4 id=elfeed-summary>elfeed-summary</h4><p><a href=https://github.com/SqrtMinusOne/elfeed-summary>SqrtMinusOne/elfeed-summary: Feed summary interface for elfeed</a></p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> elfeed-summary
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:commands</span> elfeed-summary
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> elfeed-summary-other-window t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> elfeed-summary-settings
</span></span><span style=display:flex><span>        &#39;((group (<span style=color:#fff;font-weight:700>:title</span> . <span style=color:#0ff;font-weight:700>&#34;科技&#34;</span>)
</span></span><span style=display:flex><span>                 (<span style=color:#fff;font-weight:700>:elements</span> (query . (<span style=color:#fff;font-weight:700>and</span> tec (not emacs) (not blogs)))
</span></span><span style=display:flex><span>                            (group (<span style=color:#fff;font-weight:700>:title</span> . <span style=color:#0ff;font-weight:700>&#34;Emacs&#34;</span>)
</span></span><span style=display:flex><span>                                   (<span style=color:#fff;font-weight:700>:elements</span> (query . emacs))
</span></span><span style=display:flex><span>                                   (<span style=color:#fff;font-weight:700>:face</span> . org-level-1))
</span></span><span style=display:flex><span>                            (group (<span style=color:#fff;font-weight:700>:title</span> . <span style=color:#0ff;font-weight:700>&#34;Blogs&#34;</span>)
</span></span><span style=display:flex><span>                                   (<span style=color:#fff;font-weight:700>:elements</span> (query . blogs)))))
</span></span><span style=display:flex><span>          (group (<span style=color:#fff;font-weight:700>:title</span> . <span style=color:#0ff;font-weight:700>&#34;News&#34;</span>)
</span></span><span style=display:flex><span>                 (<span style=color:#fff;font-weight:700>:elements</span> (query . news)))
</span></span><span style=display:flex><span>          (group (<span style=color:#fff;font-weight:700>:title</span> . <span style=color:#0ff;font-weight:700>&#34;Books&#34;</span>)
</span></span><span style=display:flex><span>                 (<span style=color:#fff;font-weight:700>:elements</span> (query . book)))
</span></span><span style=display:flex><span>          (group (<span style=color:#fff;font-weight:700>:title</span> . <span style=color:#0ff;font-weight:700>&#34;Finance&#34;</span>)
</span></span><span style=display:flex><span>                 (<span style=color:#fff;font-weight:700>:elements</span> (query . finance)))
</span></span><span style=display:flex><span>          (group (<span style=color:#fff;font-weight:700>:title</span> . <span style=color:#0ff;font-weight:700>&#34;Youtube&#34;</span>)
</span></span><span style=display:flex><span>                 (<span style=color:#fff;font-weight:700>:elements</span> (query . video)))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (advice-add <span style=color:#0ff;font-weight:700>&#39;elfeed-summary</span> <span style=color:#fff;font-weight:700>:after</span> <span style=color:#0ff;font-weight:700>&#39;elfeed-summary-update</span>)
</span></span><span style=display:flex><span>  (advice-add <span style=color:#0ff;font-weight:700>&#39;elfeed-summary</span> <span style=color:#fff;font-weight:700>:before</span> <span style=color:#0ff;font-weight:700>&#39;elfeed-org</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(my/space-leader-def
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;E&#34;</span> &#39;(elfeed-summary <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Elfeed&#34;</span>))
</span></span></code></pre></div><p><a href=https://github.com/karthink/elfeed-tube>karthink/elfeed-tube: Youtube integration for Elfeed, the feed reader for Emacs</a> 不知道为什么不能更新 RSS. 暂时停用了。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>with-eval-after-load</span> <span style=color:#0ff;font-weight:700>&#39;elfeed</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>require</span> <span style=color:#0ff;font-weight:700>&#39;elfeed-tube</span>)
</span></span><span style=display:flex><span>  (elfeed-tube-setup)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (define-key elfeed-show-mode-map (kbd <span style=color:#0ff;font-weight:700>&#34;F&#34;</span>) <span style=color:#0ff;font-weight:700>&#39;elfeed-tube-fetch</span>)
</span></span><span style=display:flex><span>  (define-key elfeed-show-mode-map [remap save-buffer] <span style=color:#0ff;font-weight:700>&#39;elfeed-tube-save</span>)
</span></span><span style=display:flex><span>  (define-key elfeed-search-mode-map (kbd <span style=color:#0ff;font-weight:700>&#34;F&#34;</span>) <span style=color:#0ff;font-weight:700>&#39;elfeed-tube-fetch</span>)
</span></span><span style=display:flex><span>  (define-key elfeed-search-mode-map [remap save-buffer] <span style=color:#0ff;font-weight:700>&#39;elfeed-tube-save</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (require-package <span style=color:#0ff;font-weight:700>&#39;elfeed-tube-mpv</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>with-eval-after-load</span> <span style=color:#0ff;font-weight:700>&#39;elfeed</span>
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>require</span> <span style=color:#0ff;font-weight:700>&#39;elfeed-tube-mpv</span>)
</span></span><span style=display:flex><span>    (define-key elfeed-show-mode-map (kbd <span style=color:#0ff;font-weight:700>&#34;C-c C-f&#34;</span>) <span style=color:#0ff;font-weight:700>&#39;elfeed-tube-mpv-follow-mode</span>)
</span></span><span style=display:flex><span>    (define-key elfeed-show-mode-map (kbd <span style=color:#0ff;font-weight:700>&#34;C-c C-w&#34;</span>) <span style=color:#0ff;font-weight:700>&#39;elfeed-tube-mpv-where</span>)))
</span></span></code></pre></div><h4 id=footer>Footer</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>provide</span> <span style=color:#0ff;font-weight:700>&#39;init-elfeed</span>)
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; init-elfeed.el ends here.</span>
</span></span></code></pre></div><h3 id=reader>Reader</h3><h4 id=header>Header</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#007f7f>;; init-reader.el --- reader, pdf-tools *- lexical-binding: t; no-byte-compile: t -*-</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Commentary:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Code:</span>
</span></span></code></pre></div><h4 id=pdf-tools>pdf-tools</h4><p>升级 pdf-tools 后要重新生成 <code>epdfinfo</code> 文件，最好的方式就是重装 pdf-tools，以免有问题。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> pdf-tools
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> ((doc-view-mode . pdf-tools-install)
</span></span><span style=display:flex><span>         (dirvish-setup . pdf-tools-install)
</span></span><span style=display:flex><span>         (pdf-tools-enabled . pdf-view-themed-minor-mode)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> pdf-view
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:mode</span> (<span style=color:#0ff;font-weight:700>&#34;\\.[pP][dD][fF]\\&#39;&#34;</span> . pdf-view-mode)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:magic</span> (<span style=color:#0ff;font-weight:700>&#34;%PDF&#34;</span> . pdf-view-mode)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (pdf-tools-install t nil t nil)
</span></span><span style=display:flex><span>  (evil-declare-key <span style=color:#0ff;font-weight:700>&#39;normal</span> pdf-view-mode-map
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;gh&#34;</span> <span style=color:#0ff;font-weight:700>&#39;pdf-annot-add-highlight-markup-annotation</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;ga&#34;</span> <span style=color:#0ff;font-weight:700>&#39;pdf-annot-add-text-annotation</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;gd&#34;</span> <span style=color:#0ff;font-weight:700>&#39;pdf-annot-delete</span>)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:init</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> pdf-view-display-size <span style=color:#0ff;font-weight:700>&#39;fit-width</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> pdf-view-use-unicode-ligther nil)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> pdf-view-use-scaling t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> pdf-view-use-imagemagick nil)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> pdf-annot-activate-created-annotations nil))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(add-to-list <span style=color:#0ff;font-weight:700>&#39;display-buffer-alist</span> &#39;(<span style=color:#0ff;font-weight:700>&#34;\\.pdf&#34;</span>
</span></span><span style=display:flex><span>                                     (display-buffer-in-tab)
</span></span><span style=display:flex><span>                                     (tab-name . <span style=color:#0ff;font-weight:700>&#34;PDF&#34;</span>)
</span></span><span style=display:flex><span>                                     (tab-group . <span style=color:#0ff;font-weight:700>&#34;PDF&#34;</span>)))
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> pdf-occur
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (pdf-view-mode . pdf-occur-global-minor-mode))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> pdf-history
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (pdf-view-mode . pdf-history-minor-mode))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> pdf-links
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (pdf-view-mode . pdf-links-minor-mode))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> my/get-file-name ()
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Copy pdf file name.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>  (kill-new (file-name-base (buffer-file-name)))
</span></span><span style=display:flex><span>  (message <span style=color:#0ff;font-weight:700>&#34;Copied %s&#34;</span> (file-name-base (buffer-file-name))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> pdf-outline
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (pdf-view-mode . pdf-outline-minor-mode)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:bind</span> (<span style=color:#fff;font-weight:700>:map</span> pdf-outline-buffer-mode-map
</span></span><span style=display:flex><span>              (<span style=color:#0ff;font-weight:700>&#34;RET&#34;</span> . pdf-outline-follow-link-and-quit)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(add-to-list <span style=color:#0ff;font-weight:700>&#39;display-buffer-alist</span> &#39;(<span style=color:#0ff;font-weight:700>&#34;\\*Outline&#34;</span>
</span></span><span style=display:flex><span>                                     (display-buffer-in-side-window)
</span></span><span style=display:flex><span>                                     (side . right)
</span></span><span style=display:flex><span>                                     (window-width . <span style=color:#ff0;font-weight:700>0.5</span>)
</span></span><span style=display:flex><span>                                     (window-parameters
</span></span><span style=display:flex><span>                                      (mode-line-format . none))))
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> pdf-annot
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (pdf-view-mode . pdf-annot-minor-mode)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:bind</span> (<span style=color:#fff;font-weight:700>:map</span> pdf-annot-edit-contents-minor-mode-map
</span></span><span style=display:flex><span>              (<span style=color:#0ff;font-weight:700>&#34;&lt;return&gt;&#34;</span> . pdf-annot-edit-contents-commit)
</span></span><span style=display:flex><span>              (<span style=color:#0ff;font-weight:700>&#34;&lt;S-return&gt;&#34;</span> . newline)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> pdf-sync
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (pdf-view-mode . pdf-sync-minor-mode))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> pdf-cache
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:after</span> pdf-view
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (define-pdf-cache-function pagelabels))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> pdf-misc
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:after</span> pdf-view
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> pdf-misc-print-program-executable <span style=color:#0ff;font-weight:700>&#34;/usr/bin/lp&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>defun</span> mrb/pdf-misc-print-pages(filename pages <span style=color:#fff;font-weight:700>&amp;optional</span> interactive-p)
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;Wrapper for `pdf-misc-print-document` to add page selection support.&#34;</span>
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>interactive</span> (list (pdf-view-buffer-file-name)
</span></span><span style=display:flex><span>                       (read-string <span style=color:#0ff;font-weight:700>&#34;Page range (empty for all pages): &#34;</span>
</span></span><span style=display:flex><span>                                    (number-to-string (pdf-view-current-page)))
</span></span><span style=display:flex><span>                       t) pdf-view-mode)
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>let</span> ((pdf-misc-print-program-args
</span></span><span style=display:flex><span>           (<span style=color:#fff;font-weight:700>if</span> (not (string-blank-p pages))
</span></span><span style=display:flex><span>               (cons (concat <span style=color:#0ff;font-weight:700>&#34;-P &#34;</span> pages) pdf-misc-print-program-args)
</span></span><span style=display:flex><span>             pdf-misc-print-program-args)))
</span></span><span style=display:flex><span>      (pdf-misc-print-document filename)))
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:bind</span> (<span style=color:#fff;font-weight:700>:map</span> pdf-view-mode-map
</span></span><span style=display:flex><span>              ([remap pdf-misc-print-document] . mrb/pdf-misc-print-pages)))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> my/pdf-extract-highlight ()
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Extract highlight to plain text.
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>When it finised, it will jump to note file.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>let*</span> ((pdf-filename (buffer-name))
</span></span><span style=display:flex><span>         (txt-filename (make-temp-file <span style=color:#0ff;font-weight:700>&#34;/tmp/annot-&#34;</span>))
</span></span><span style=display:flex><span>         (org-file (read-file-name <span style=color:#0ff;font-weight:700>&#34;Save extracted highlights to org file: &#34;</span> (expand-file-name <span style=color:#0ff;font-weight:700>&#34;references/&#34;</span> my-galaxy))))
</span></span><span style=display:flex><span>    (async-start
</span></span><span style=display:flex><span>     `(<span style=color:#fff;font-weight:700>lambda</span> ()
</span></span><span style=display:flex><span>        (shell-command-to-string (format <span style=color:#0ff;font-weight:700>&#34;/opt/homebrew/bin/python3.10 ~/pdfannots/pdfannots.py \&#34;%s\&#34;&#34;</span>
</span></span><span style=display:flex><span>                                          ,pdf-filename)))
</span></span><span style=display:flex><span>     `(<span style=color:#fff;font-weight:700>lambda</span> (annot)
</span></span><span style=display:flex><span>        (<span style=color:#fff;font-weight:700>setq</span> annot (replace-regexp-in-string <span style=color:#0ff;font-weight:700>&#34;##&#34;</span> <span style=color:#0ff;font-weight:700>&#34;*&#34;</span> annot))
</span></span><span style=display:flex><span>        (<span style=color:#fff;font-weight:700>with-temp-buffer</span>
</span></span><span style=display:flex><span>          (insert annot)
</span></span><span style=display:flex><span>          (write-region (point-min) (point-max) ,org-file t))
</span></span><span style=display:flex><span>        (find-file ,org-file)))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(my/space-leader-def
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;mh&#34;</span> &#39;(my/pdf-extract-highlight <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Extract highlight&#34;</span>))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> my/dired-pdf-to-png ()
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>let*</span> ((filename (dired-get-filename)))
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>if</span> (string-match <span style=color:#0ff;font-weight:700>&#34;\.pdf&#34;</span> filename)
</span></span><span style=display:flex><span>        (<span style=color:#fff;font-weight:700>let*</span> ((pdf-base-name (file-name-sans-extension (file-name-nondirectory filename)))
</span></span><span style=display:flex><span>               (png (concat pdf-base-name <span style=color:#0ff;font-weight:700>&#34;.png&#34;</span>))
</span></span><span style=display:flex><span>               (pdf-info (shell-command-to-string (format <span style=color:#0ff;font-weight:700>&#34;pdfinfo %s | grep Pages | awk &#39;{print $2}&#39;&#34;</span> filename)))
</span></span><span style=display:flex><span>               (pdf-pages (string-to-number pdf-info)))
</span></span><span style=display:flex><span>          (<span style=color:#fff;font-weight:700>when</span> (file-exists-p png)
</span></span><span style=display:flex><span>            (delete-file png))
</span></span><span style=display:flex><span>          (<span style=color:#fff;font-weight:700>if</span> (= pdf-pages <span style=color:#ff0;font-weight:700>1</span>)
</span></span><span style=display:flex><span>              (start-process-shell-command
</span></span><span style=display:flex><span>               <span style=color:#0ff;font-weight:700>&#34;pdf-to-png&#34;</span>
</span></span><span style=display:flex><span>               nil
</span></span><span style=display:flex><span>               (format <span style=color:#0ff;font-weight:700>&#34;pdftoppm -singlefile -r 600 %s %s -png&#34;</span> filename pdf-base-name))
</span></span><span style=display:flex><span>            (start-process-shell-command
</span></span><span style=display:flex><span>             <span style=color:#0ff;font-weight:700>&#34;pdf-to-png&#34;</span>
</span></span><span style=display:flex><span>             nil
</span></span><span style=display:flex><span>             (format <span style=color:#0ff;font-weight:700>&#34;pdftoppm -r 600 %s %s -png&#34;</span> filename pdf-base-name))))
</span></span><span style=display:flex><span>      (message <span style=color:#0ff;font-weight:700>&#34;Current file is not a PDF file.&#34;</span>))))
</span></span></code></pre></div><h4 id=nov>Nov</h4><p>Nov 用于阅读 epub 文件。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> nov
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:mode</span> (<span style=color:#0ff;font-weight:700>&#34;.epub&#34;</span> . nov-mode)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> nov-unzip-program (executable-find <span style=color:#0ff;font-weight:700>&#34;bsdtar&#34;</span>)
</span></span><span style=display:flex><span>        nov-unzip-args &#39;(<span style=color:#0ff;font-weight:700>&#34;-xC&#34;</span> directory <span style=color:#0ff;font-weight:700>&#34;-f&#34;</span> filename)))
</span></span></code></pre></div><h4 id=calibredb>Calibredb</h4><p>Calibre 用于管理书籍，Calibredb 可以在 Emacs 中管理而不需要打开 Calibre 软件。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#007f7f>;; Export catalog need to use argument: set entry type to mixed, default is book.</span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> calibredb
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:bind</span> ((<span style=color:#0ff;font-weight:700>&#34;&lt;f1&gt;&#34;</span> . calibredb)
</span></span><span style=display:flex><span>         <span style=color:#fff;font-weight:700>:map</span> calibredb-search-mode-map
</span></span><span style=display:flex><span>         (<span style=color:#0ff;font-weight:700>&#34;C-c l&#34;</span> . calibredb-copy-as-org-link))
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> calibredb-root-dir <span style=color:#0ff;font-weight:700>&#34;~/Nextcloud/L.Calibre/&#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> calibredb-db-dir (expand-file-name <span style=color:#0ff;font-weight:700>&#34;metadata.db&#34;</span> calibredb-root-dir))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> calibredb-add-delete-original-file <span style=color:#0ff;font-weight:700>&#34;yes&#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> calibredb-size-show t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> calibredb-format-character-icons t)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> calibredb-ref-default-bibliography (expand-file-name <span style=color:#0ff;font-weight:700>&#34;calibre.bib&#34;</span> calibredb-root-dir))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (evil-set-initial-state <span style=color:#0ff;font-weight:700>&#39;calibredb-search-mode</span> <span style=color:#0ff;font-weight:700>&#39;emacs</span>))
</span></span></code></pre></div><h4 id=footer>Footer</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>provide</span> <span style=color:#0ff;font-weight:700>&#39;init-reader</span>)
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; init-reader.el ends here.</span>
</span></span></code></pre></div><h3 id=vterm>vterm</h3><p>使用<a href=https://github.com/akermu/emacs-libvterm>akermu/emacs-libvterm: Emacs libvterm integration</a> 替代了内置的 eshell.</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#007f7f>;; init-vterm.el --- vterm *- lexical-binding: t; no-byte-compile: t -*-</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Commentary:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Code:</span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> vterm
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:bind</span> (<span style=color:#0ff;font-weight:700>&#34;C-c , v&#34;</span> . toggle-vterm)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> vterm-kill-buffer-on-exit t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> vterm-max-scrollback <span style=color:#ff0;font-weight:700>5000</span>)
</span></span><span style=display:flex><span>  (add-to-list <span style=color:#0ff;font-weight:700>&#39;display-buffer-alist</span>
</span></span><span style=display:flex><span>               &#39;(<span style=color:#0ff;font-weight:700>&#34;\\*vterm\\*&#34;</span>
</span></span><span style=display:flex><span>                 (display-buffer-in-side-window)
</span></span><span style=display:flex><span>                 (window-height . <span style=color:#ff0;font-weight:700>0.35</span>)
</span></span><span style=display:flex><span>                 (side . bottom)
</span></span><span style=display:flex><span>                 (slot . <span style=color:#ff0;font-weight:700>-1</span>)))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>defun</span> toggle-vterm ()
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;Toggle vterm on or off.&#34;</span>
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>if</span> (get-buffer-window <span style=color:#0ff;font-weight:700>&#34;*vterm*&#34;</span>)
</span></span><span style=display:flex><span>        (delete-window (get-buffer-window <span style=color:#0ff;font-weight:700>&#34;*vterm*&#34;</span>))
</span></span><span style=display:flex><span>      (<span style=color:#fff;font-weight:700>progn</span>
</span></span><span style=display:flex><span>        (vterm)
</span></span><span style=display:flex><span>        (evil-insert <span style=color:#ff0;font-weight:700>1</span>)))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(my/space-leader-def
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;v&#34;</span> &#39;(toggle-vterm <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;vterm&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>provide</span> <span style=color:#0ff;font-weight:700>&#39;init-vterm</span>)
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; init-vterm.el ends here.</span>
</span></span></code></pre></div><h3 id=mail>Mail</h3><h4 id=header>Header</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#007f7f>;; init-mail.el --- email *- lexical-binding: t; no-byte-compile: t -*-</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Commentary:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Code:</span>
</span></span></code></pre></div><h4 id=personal-info>Personal Info</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> user-full-name <span style=color:#0ff;font-weight:700>&#34;Duan Ning&#34;</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> user-mail-address <span style=color:#0ff;font-weight:700>&#34;duan_n@outlook.com&#34;</span>)
</span></span></code></pre></div><h4 id=simple>simple</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> simple
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> mail-user-agent <span style=color:#0ff;font-weight:700>&#39;mu4e-user-agent</span>))
</span></span></code></pre></div><h4 id=message>Message</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> message
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> message-sendmail-envelope-from <span style=color:#0ff;font-weight:700>&#39;header</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> message-kill-buffer-query nil)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> message-sendmail-extra-arguments &#39;(<span style=color:#0ff;font-weight:700>&#34;-a&#34;</span> <span style=color:#0ff;font-weight:700>&#34;outlook&#34;</span>))
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> message-send-mail-function <span style=color:#0ff;font-weight:700>&#39;sendmail-send-it</span>))
</span></span></code></pre></div><h4 id=mu4e>Mu4e</h4><p>在 MacOS 上配置 mu 和 mu4e 的教程见：<a href=https://macowners.club/posts/email-emacs-mu4e-macos/>Email setup in Emacs with Mu4e on macOS | macOS & (open-source) Software</a>.</p><p>上述的教程写的很详细，按照步骤进行一定会成功。</p><p>配置 Emacs 时经常要多次重启，这有可能导致 mu 报以下的错误：</p><blockquote><p>error in process sentinel: mu4e&ndash;server-sentinel: Mu server process ended with exit code 1
error in process sentinel: Mu server process ended with exit code 1</p></blockquote><p>这时需要在终端下执行以下的命令来恢复 mu 的状态。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>mu init --maildir=~/.maildir --my-address=your_email_account &amp;&amp; mu index
</span></span></code></pre></div><p>启动 Emacs 时直接启动 mu4e 会导致 Emacs 启动速度变的很慢，当 Emacs 处于 idle 状态时在后台启动。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(add-to-list <span style=color:#0ff;font-weight:700>&#39;load-path</span> <span style=color:#0ff;font-weight:700>&#34;/opt/homebrew/opt/mu/share/emacs/site-lisp/mu/mu4e&#34;</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>unless</span> (fboundp <span style=color:#0ff;font-weight:700>&#39;mu4e</span>)
</span></span><span style=display:flex><span>  (autoload #&#39;mu4e <span style=color:#0ff;font-weight:700>&#34;mu4e&#34;</span> nil t))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(run-with-idle-timer <span style=color:#ff0;font-weight:700>5</span> nil #&#39;(<span style=color:#fff;font-weight:700>lambda</span> () (mu4e <span style=color:#0ff;font-weight:700>&#39;background</span>)))
</span></span></code></pre></div><p>这里有个 <a href=https://github.com/rougier/mu4e-dashboard>rougier/mu4e-dashboard: A dashboard for mu4e (mu for emacs)</a> 看着很好看，但是不实用，不要再尝试。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>with-eval-after-load</span> <span style=color:#0ff;font-weight:700>&#39;mu4e</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> mu4e-mu-binary (executable-find <span style=color:#0ff;font-weight:700>&#34;mu&#34;</span>))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> mu4e-update-interval (* <span style=color:#ff0;font-weight:700>15</span> <span style=color:#ff0;font-weight:700>60</span>))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> mu4e-attachment-dir <span style=color:#0ff;font-weight:700>&#34;~/Downloads/&#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> mu4e-get-mail-command (concat (executable-find <span style=color:#0ff;font-weight:700>&#34;mbsync&#34;</span>) <span style=color:#0ff;font-weight:700>&#34; -a&#34;</span>))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> mu4e-index-update-in-background t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> mu4e-index-update-error-warning t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> mu4e-index-update-error-warning nil)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> mu4e-index-cleanup t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> mu4e-view-show-images t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> mu4e-view-image-max-width <span style=color:#ff0;font-weight:700>800</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> mu4e-view-show-addresses t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> mu4e-confirm-quit nil)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> mu4e-context-policy <span style=color:#0ff;font-weight:700>&#39;pick-first</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>with-eval-after-load</span> <span style=color:#0ff;font-weight:700>&#39;mu4e</span>
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>setq</span> mu4e-sent-folder   <span style=color:#0ff;font-weight:700>&#34;/outlook/Sent&#34;</span>
</span></span><span style=display:flex><span>          mu4e-drafts-folder <span style=color:#0ff;font-weight:700>&#34;/outlook/Drafts&#34;</span>
</span></span><span style=display:flex><span>          mu4e-trash-folder  <span style=color:#0ff;font-weight:700>&#34;/outlook/Deleted&#34;</span>
</span></span><span style=display:flex><span>          mu4e-refile-folder  <span style=color:#0ff;font-weight:700>&#34;/outlook/Archive&#34;</span>))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> mu4e-view-prefer-html nil)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> mu4e-html2text-command <span style=color:#0ff;font-weight:700>&#39;mu4e-shr2text</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> mu4e-main-hide-personal-addresses t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> mu4e-headers-precise-alignment t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> mu4e-headers-include-related t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> mu4e-headers-auto-update t)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> mu4e-headers-date-format <span style=color:#0ff;font-weight:700>&#34;%d/%m/%y&#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> mu4e-headers-time-format <span style=color:#0ff;font-weight:700>&#34;%H:%M&#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> mu4e-headers-fields &#39;((<span style=color:#fff;font-weight:700>:flags</span> . <span style=color:#ff0;font-weight:700>4</span>)
</span></span><span style=display:flex><span>                              (<span style=color:#fff;font-weight:700>:human-date</span> . <span style=color:#ff0;font-weight:700>9</span>)
</span></span><span style=display:flex><span>                              (<span style=color:#fff;font-weight:700>:subject</span> . <span style=color:#ff0;font-weight:700>90</span>)
</span></span><span style=display:flex><span>                              (<span style=color:#fff;font-weight:700>:from-or-to</span> . <span style=color:#ff0;font-weight:700>40</span>)
</span></span><span style=display:flex><span>                              (<span style=color:#fff;font-weight:700>:tags</span> . <span style=color:#ff0;font-weight:700>20</span>)))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> mu4e-bookmarks &#39;((<span style=color:#0ff;font-weight:700>&#34;flag:unread AND NOT flag:trashed&#34;</span> <span style=color:#0ff;font-weight:700>&#34;Unread messages&#34;</span> <span style=color:#0ff;font-weight:700>?u</span>)
</span></span><span style=display:flex><span>                         (<span style=color:#0ff;font-weight:700>&#34;date:today..now&#34;</span> <span style=color:#0ff;font-weight:700>&#34;Today&#39;s messages&#34;</span> <span style=color:#0ff;font-weight:700>?t</span>)
</span></span><span style=display:flex><span>                         (<span style=color:#0ff;font-weight:700>&#34;date:7d..now&#34;</span> <span style=color:#0ff;font-weight:700>&#34;Last 7 days&#34;</span> <span style=color:#0ff;font-weight:700>?w</span>)
</span></span><span style=display:flex><span>                         (<span style=color:#0ff;font-weight:700>&#34;date:1d..now AND NOT list:emacs-orgmode.gnu.org&#34;</span> <span style=color:#0ff;font-weight:700>&#34;Last 1 days&#34;</span> <span style=color:#0ff;font-weight:700>?o</span>)
</span></span><span style=display:flex><span>                         (<span style=color:#0ff;font-weight:700>&#34;date:1d..now AND list:emacs-orgmode.gnu.org&#34;</span> <span style=color:#0ff;font-weight:700>&#34;Last 1 days (org mode)&#34;</span> <span style=color:#0ff;font-weight:700>?m</span>)
</span></span><span style=display:flex><span>                         (<span style=color:#0ff;font-weight:700>&#34;maildir:/drafts&#34;</span> <span style=color:#0ff;font-weight:700>&#34;drafts&#34;</span> <span style=color:#0ff;font-weight:700>?d</span>)
</span></span><span style=display:flex><span>                         (<span style=color:#0ff;font-weight:700>&#34;flag:flagged AND NOT flag:trashed&#34;</span> <span style=color:#0ff;font-weight:700>&#34;flagged&#34;</span> <span style=color:#0ff;font-weight:700>?f</span>)
</span></span><span style=display:flex><span>                         (<span style=color:#0ff;font-weight:700>&#34;mime:image/*&#34;</span> <span style=color:#0ff;font-weight:700>&#34;Messages with images&#34;</span> <span style=color:#0ff;font-weight:700>?p</span>)))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> mu4e-compose-reply-ignore-address &#39;(<span style=color:#0ff;font-weight:700>&#34;no-?reply&#34;</span> <span style=color:#0ff;font-weight:700>&#34;duan_n@outlook.com&#34;</span>))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> mu4e-compose-format-flowed nil)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> mu4e-compose-signature-auto-include nil)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> mu4e-compose-dont-reply-to-self t))
</span></span></code></pre></div><p>若要把 mail 和 org 笔记相结合，可以使用 <code>org-store-link</code> 和 <code>org-insert-link</code> 给合使用，在 org 文件中插入 mail 的链接。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>with-eval-after-load</span> <span style=color:#0ff;font-weight:700>&#39;mu4e</span>
</span></span><span style=display:flex><span>  (define-key mu4e-headers-mode-map (kbd <span style=color:#0ff;font-weight:700>&#34;C-c l&#34;</span>) <span style=color:#0ff;font-weight:700>&#39;org-store-link</span>))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(my/space-leader-def
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;e&#34;</span> &#39;(mu4e <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;MAIL&#34;</span>))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(add-to-list <span style=color:#0ff;font-weight:700>&#39;display-buffer-alist</span>
</span></span><span style=display:flex><span>             `(,(<span style=color:#fff;font-weight:700>rx</span> (| <span style=color:#0ff;font-weight:700>&#34;*mu4e-main*&#34;</span>
</span></span><span style=display:flex><span>                       <span style=color:#0ff;font-weight:700>&#34;*mu4e-headers*&#34;</span>))
</span></span><span style=display:flex><span>               (display-buffer-in-tab)
</span></span><span style=display:flex><span>               (tab-name . <span style=color:#0ff;font-weight:700>&#34;Mail&#34;</span>)
</span></span><span style=display:flex><span>               (tab-group . <span style=color:#0ff;font-weight:700>&#34;Mail&#34;</span>)
</span></span><span style=display:flex><span>               (window-parameters . ((mode-line-format . none)))))
</span></span></code></pre></div><h4 id=mu4e-actions>mu4e-actions</h4><p>Save mail to pdf as backup.</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> extra-email-to-pdf (msg <span style=color:#fff;font-weight:700>&amp;optional</span> args)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Pdf temp file MSG to a new name with ARGS ignored.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>let*</span> ((async-shell-command-display-buffer nil)
</span></span><span style=display:flex><span>         (temp (format-time-string (expand-file-name <span style=color:#0ff;font-weight:700>&#34;%Y-%m-%dT%H:%M.pdf&#34;</span> mail-source-directory)))
</span></span><span style=display:flex><span>         (name (read-string <span style=color:#0ff;font-weight:700>&#34;File name: &#34;</span> temp))
</span></span><span style=display:flex><span>         (html (replace-regexp-in-string (regexp-quote <span style=color:#0ff;font-weight:700>&#34;file://&#34;</span>) <span style=color:#0ff;font-weight:700>&#34;&#34;</span> msg t t)))
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>if</span> args (message <span style=color:#0ff;font-weight:700>&#34;Additional optional argument was ignored when saving to PDF.&#34;</span>))
</span></span><span style=display:flex><span>    (async-shell-command (concat <span style=color:#0ff;font-weight:700>&#34;pandoc &#34;</span> html <span style=color:#0ff;font-weight:700>&#34; -o &#34;</span> name))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> extra-print-email-to-pdf (msg <span style=color:#fff;font-weight:700>&amp;optional</span> skip-headers)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Save current MSG as a pdf if it includes an HTML-part.
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>If SKIP-HEADERS is set, do not show include message headers.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>let*</span> ((browse-url-browser-function  <span style=color:#0ff;font-weight:700>&#39;extra-email-to-pdf</span>))
</span></span><span style=display:flex><span>    (mu4e-action-view-in-browser msg skip-headers)))
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>with-eval-after-load</span> <span style=color:#0ff;font-weight:700>&#39;mu4e</span>
</span></span><span style=display:flex><span>  (add-to-list <span style=color:#0ff;font-weight:700>&#39;mu4e-view-actions</span> &#39;(<span style=color:#0ff;font-weight:700>&#34;print to PDF&#34;</span>  . extra-print-email-to-pdf)))
</span></span></code></pre></div><p>Save mail to html as backup.</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> extra-move-temp-email-location (msg <span style=color:#fff;font-weight:700>&amp;optional</span> args)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Move and rename temp file MSG to a new location with ARGS ignored.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>let*</span> ((temp (format-time-string (expand-file-name <span style=color:#0ff;font-weight:700>&#34;html/%Y-%m-%dT%H:%M.html&#34;</span> mail-source-directory)))
</span></span><span style=display:flex><span>         (name (read-string <span style=color:#0ff;font-weight:700>&#34;File name: &#34;</span> temp))
</span></span><span style=display:flex><span>         (file (replace-regexp-in-string (regexp-quote <span style=color:#0ff;font-weight:700>&#34;file://&#34;</span>) <span style=color:#0ff;font-weight:700>&#34;&#34;</span> msg t t)))
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>if</span> args (message <span style=color:#0ff;font-weight:700>&#34;Additional optional argument was ignored when saving to HTML.&#34;</span>))
</span></span><span style=display:flex><span>    (rename-file file name)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> extra-save-email-html (msg <span style=color:#fff;font-weight:700>&amp;optional</span> skip-headers)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Save current MSG HTML-part.
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>If SKIP-HEADERS is set, do not show include message headers.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>let*</span> ((extra-temp-email-dir (expand-file-name <span style=color:#0ff;font-weight:700>&#34;html&#34;</span> mail-source-directory))
</span></span><span style=display:flex><span>         (browse-url-browser-function  <span style=color:#0ff;font-weight:700>&#39;extra-move-temp-email-location</span>))
</span></span><span style=display:flex><span>    (mu4e-action-view-in-browser msg skip-headers)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>with-eval-after-load</span> <span style=color:#0ff;font-weight:700>&#39;mu4e</span>
</span></span><span style=display:flex><span>  (add-to-list <span style=color:#0ff;font-weight:700>&#39;mu4e-view-actions</span> &#39;(<span style=color:#0ff;font-weight:700>&#34;download as html&#34;</span>  . extra-save-email-html)))
</span></span></code></pre></div><h4 id=icons>Icons</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>with-eval-after-load</span> <span style=color:#0ff;font-weight:700>&#39;all-the-icons</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> display-time-mail-icon `(,(propertize
</span></span><span style=display:flex><span>                                   (all-the-icons-material <span style=color:#0ff;font-weight:700>&#34;mail&#34;</span>)
</span></span><span style=display:flex><span>                                   <span style=color:#0ff;font-weight:700>&#39;face</span> `(<span style=color:#fff;font-weight:700>:family</span> ,(all-the-icons-material-family))))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>with-eval-after-load</span> <span style=color:#0ff;font-weight:700>&#39;mu4e</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> mu4e-use-fancy-chars nil))
</span></span></code></pre></div><h4 id=mu4e-alert>mu4e-alert</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> mu4e-alert
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:after</span> mu4e
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (mu4e-alert-set-default-style <span style=color:#0ff;font-weight:700>&#39;osx-notifier</span>)
</span></span><span style=display:flex><span>  (mu4e-alert-enable-notifications)
</span></span><span style=display:flex><span>  (mu4e-alert-enable-mode-line-display))
</span></span></code></pre></div><h4 id=mu4e-column-faces>mu4e-column-faces</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> mu4e-column-faces
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (mu4e-main-mode . mu4e-column-faces-mode))
</span></span></code></pre></div><h4 id=send-mail>Send mail</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(add-hook <span style=color:#0ff;font-weight:700>&#39;mu4e-main-mode-hook</span>
</span></span><span style=display:flex><span>          (<span style=color:#fff;font-weight:700>lambda</span> ()
</span></span><span style=display:flex><span>            (<span style=color:#fff;font-weight:700>progn</span>
</span></span><span style=display:flex><span>              (<span style=color:#fff;font-weight:700>require</span> <span style=color:#0ff;font-weight:700>&#39;smtpmail-async</span>)
</span></span><span style=display:flex><span>              (<span style=color:#fff;font-weight:700>setq</span> send-mail-function <span style=color:#0ff;font-weight:700>&#39;async-sendmail-send-it</span>)
</span></span><span style=display:flex><span>              (<span style=color:#fff;font-weight:700>setq</span> message-send-mail-function <span style=color:#0ff;font-weight:700>&#39;async-smtpmail-send-it</span>))))
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> sendmail-program (executable-find <span style=color:#0ff;font-weight:700>&#34;msmtp&#34;</span>))
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> mail-specify-envelope-from t)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> mail-envelope-from <span style=color:#0ff;font-weight:700>&#39;header</span>)
</span></span></code></pre></div><ul><li><p>org-msg</p><p>使用 <a href=https://github.com/jeremy-compostella/org-msg>jeremy-compostella/org-msg: OrgMsg is a GNU/Emacs global minor mode mixing up Org mode and Message mode to compose and reply to emails in a Outlook HTML friendly style.</a> 来编写 Email.</p><p>需要添加附件时执行 C-c C-a.</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> org-msg
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (mu4e-main-mode . org-msg-mode)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> org-msg-options <span style=color:#0ff;font-weight:700>&#34;html-preamble:nil html-postamble:nil toc:nil author:nil email:nil&#34;</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> org-msg-greeting-fmt <span style=color:#0ff;font-weight:700>&#34;\nHi%s,\n\n&#34;</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> org-msg-recipient-names `(,user-mail-address . ,user-full-name))
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> org-msg-greeting-name-limit <span style=color:#ff0;font-weight:700>3</span>)
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> org-msg-default-alternatives &#39;((new		. (text html))
</span></span><span style=display:flex><span>                                     (reply-to-html	. (text html))
</span></span><span style=display:flex><span>                                     (reply-to-text	. (text))))
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> org-msg-convert-citation t)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>setq</span> org-msg-signature (concat <span style=color:#0ff;font-weight:700>&#34;Best Regards,\n\n#+begin_signature\n*&#34;</span>
</span></span><span style=display:flex><span>                                user-full-name
</span></span><span style=display:flex><span>                                <span style=color:#0ff;font-weight:700>&#34;*\n\n&#34;</span> (format-time-string <span style=color:#0ff;font-weight:700>&#34;%Y-%m-%d&#34;</span>)
</span></span><span style=display:flex><span>                                <span style=color:#0ff;font-weight:700>&#34;\n#+end_signature&#34;</span>)))
</span></span></code></pre></div></li></ul><h4 id=footer>Footer</h4><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>provide</span> <span style=color:#0ff;font-weight:700>&#39;init-mail</span>)
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; init-mail.el ends here.</span>
</span></span></code></pre></div><h2 id=misc>Misc</h2><h3 id=header>Header</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#007f7f>;; init-misc.el --- Misc *- lexical-binding: t; no-byte-compile: t -*-</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Commentary:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; Code:</span>
</span></span></code></pre></div><h3 id=org-auto-tangle>org-auto-tangle</h3><p>使用 Literate programming 配置 Emacs 文件，使用它可以不用手动 tangle，文件保存后自动执行。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> org-auto-tangle
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (org-mode . org-auto-tangle-mode))
</span></span></code></pre></div><h3 id=epkg>epkg</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> epkg
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:commands</span> (epkg-describe-package)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> epkg-repository (expand-file-name <span style=color:#0ff;font-weight:700>&#34;cache/epkgs&#34;</span> user-emacs-directory)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> epkg-marginalia
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:after</span> (epkg marginalia)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>cl-pushnew</span> <span style=color:#0ff;font-weight:700>&#39;epkg-marginalia-annotate-package</span>
</span></span><span style=display:flex><span>              (alist-get <span style=color:#0ff;font-weight:700>&#39;package</span> marginalia-annotator-registry)))
</span></span></code></pre></div><h3 id=gcmh>gcmh</h3><p>Emacs 的拉圾回收太影响性能，此包的作用是当 Emacs 处于 idle 状态时进行拉圾回收，正常使用的时候设置一个较高的阈值，降低垃圾回收。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> gcmh
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> gcmh-idle-delay <span style=color:#0ff;font-weight:700>&#39;auto</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> gcmh-auto-idle-delay-factor <span style=color:#ff0;font-weight:700>10</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> gcmh-high-cons-threshold <span style=color:#ff0;font-weight:700>#x1000000</span>)
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:hook</span> (after-init . gcmh-mode))
</span></span></code></pre></div><h3 id=grab-mac-link>grab-mac-link</h3><p><a href=https://github.com/xuchunyang/grab-mac-link.el>xuchunyang/grab-mac-link.el: Grab link from Mac Apps and insert it into Emacs</a>. 很方便的在文件中增加当前浏览网页的链接，我使用 MacOS, 常用的是 Safari 浏览器。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> grab-mac-link
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:commands</span> grab-mac-link-dwim
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:preface</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>defun</span> my/link-grab ()
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>    (grab-mac-link-dwim <span style=color:#0ff;font-weight:700>&#39;safari</span>))
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:bind</span> (<span style=color:#0ff;font-weight:700>&#34;&lt;f8&gt;&#34;</span> . my/link-grab))
</span></span></code></pre></div><h3 id=file-info>file-info</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> file-info
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:commands</span> file-info-show
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> hydra-hint-display-type <span style=color:#0ff;font-weight:700>&#39;posframe</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> hydra-posframe-show-params `(<span style=color:#fff;font-weight:700>:poshandler</span> posframe-poshandler-frame-center
</span></span><span style=display:flex><span>                                                 <span style=color:#fff;font-weight:700>:internal-border-width</span> <span style=color:#ff0;font-weight:700>2</span>
</span></span><span style=display:flex><span>                                                 <span style=color:#fff;font-weight:700>:internal-border-color</span> <span style=color:#0ff;font-weight:700>&#34;#61AFEF&#34;</span>
</span></span><span style=display:flex><span>                                                 <span style=color:#fff;font-weight:700>:left-fringe</span> <span style=color:#ff0;font-weight:700>16</span>
</span></span><span style=display:flex><span>                                                 <span style=color:#fff;font-weight:700>:right-fringe</span> <span style=color:#ff0;font-weight:700>16</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(my/space-leader-def
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;mi&#34;</span> &#39;(file-info-show <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;File info&#34;</span>))
</span></span></code></pre></div><h3 id=disk-usage>disk-usage</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> disk-usage
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:bind</span> (<span style=color:#0ff;font-weight:700>&#34;C-c d u&#34;</span> . disk-usage))
</span></span><span style=display:flex><span>(my/space-leader-def
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;m&#34;</span> &#39;(<span style=color:#fff;font-weight:700>:ignore</span> t <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Misc&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;md&#34;</span> &#39;(disk-usage <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Disk usage&#34;</span>))
</span></span></code></pre></div><h3 id=youtube-dl>youtube-dl</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> youtube-dl
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:commands</span> youtube-dl
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:config</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> youtube-dl-directory <span style=color:#0ff;font-weight:700>&#34;~/Downloads/&#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> youtube-dl-program <span style=color:#0ff;font-weight:700>&#34;/opt/homebrew/bin/youtube-dl&#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> youtube-dl-arguments
</span></span><span style=display:flex><span>        &#39;(<span style=color:#0ff;font-weight:700>&#34;--no-mtime&#34;</span> <span style=color:#0ff;font-weight:700>&#34;--restrict-filenames&#34;</span> <span style=color:#0ff;font-weight:700>&#34;--format&#34;</span> <span style=color:#0ff;font-weight:700>&#34;best&#34;</span> <span style=color:#0ff;font-weight:700>&#34;--mark-watched&#34;</span>)))
</span></span></code></pre></div><h3 id=ocr>OCR</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> my/ocr ()
</span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>&#34;OCR with Macos system.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>  (shell-command <span style=color:#0ff;font-weight:700>&#34;shortcuts run \&#34;OCR Selected Area\&#34;&#34;</span>)
</span></span><span style=display:flex><span>  (do-applescript <span style=color:#0ff;font-weight:700>&#34;tell application id \&#34;org.gnu.Emacs\&#34; to activate&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(my/space-leader-def
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;mo&#34;</span> &#39;(my/ocr <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;OCR&#34;</span>))
</span></span></code></pre></div><h3 id=proxy>proxy</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> toggle-proxy ()
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Toggle proxy for the url.el library.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>if</span> url-proxy-services
</span></span><span style=display:flex><span>      (proxy-disable)
</span></span><span style=display:flex><span>    (proxy-enable)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> proxy-enable ()
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Enable proxy.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>setq</span> url-proxy-services
</span></span><span style=display:flex><span>        &#39;((<span style=color:#0ff;font-weight:700>&#34;http&#34;</span> . <span style=color:#0ff;font-weight:700>&#34;127.0.0.1:8118&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;https&#34;</span> . <span style=color:#0ff;font-weight:700>&#34;127.0.0.1:8118&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;socks&#34;</span> . <span style=color:#0ff;font-weight:700>&#34;127.0.0.1:8118&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#0ff;font-weight:700>&#34;no_proxy&#34;</span> . <span style=color:#0ff;font-weight:700>&#34;0.0.0.0&#34;</span>)))
</span></span><span style=display:flex><span>  (message <span style=color:#0ff;font-weight:700>&#34;Proxy enabled! %s&#34;</span> (car url-proxy-services)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> proxy-disable ()
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Disable proxy.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>if</span> url-proxy-services
</span></span><span style=display:flex><span>      (<span style=color:#fff;font-weight:700>setq</span> url-proxy-services nil))
</span></span><span style=display:flex><span>  (message <span style=color:#0ff;font-weight:700>&#34;Proxy disabled!&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(run-with-idle-timer <span style=color:#ff0;font-weight:700>2</span> nil (<span style=color:#fff;font-weight:700>lambda</span> ()
</span></span><span style=display:flex><span>                             (proxy-enable)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(my/space-leader-def
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;mp&#34;</span> &#39;(toggle-proxy <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Proxy&#34;</span>))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(my/comma-leader-def
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;p&#34;</span> &#39;(toggle-proxy <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Proxy&#34;</span>))
</span></span></code></pre></div><h3 id=word-count>word-count</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>use-package</span> advance-words-count
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>:bind</span> (<span style=color:#0ff;font-weight:700>&#34;M-=&#34;</span> . advance-words-count))
</span></span></code></pre></div><h3 id=convert-eps-to-png>Convert eps to png</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> eps-to-png-marked ()
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Convert all marked EPS files in the current Dired buffer to PNG format using ImageMagick&#39;s convert utility.
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>Each input file is converted to a PNG file with the same basename.
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>This function requires ImageMagick&#39;s convert utility to be installed and available in the system&#39;s PATH.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>let</span> ((eps-files (dired-get-marked-files)))
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>when</span> (not eps-files)
</span></span><span style=display:flex><span>      (error <span style=color:#0ff;font-weight:700>&#34;No marked files in Dired buffer.&#34;</span>))
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>let</span> ((n <span style=color:#ff0;font-weight:700>0</span>))
</span></span><span style=display:flex><span>      (message <span style=color:#0ff;font-weight:700>&#34;Converting:\n&#34;</span>)
</span></span><span style=display:flex><span>      (<span style=color:#fff;font-weight:700>dolist</span> (epsfile eps-files)
</span></span><span style=display:flex><span>        (<span style=color:#fff;font-weight:700>let</span> ((pngfile (concat (file-name-sans-extension epsfile) <span style=color:#0ff;font-weight:700>&#34;.png&#34;</span>)))
</span></span><span style=display:flex><span>          (<span style=color:#fff;font-weight:700>setq</span> n (1+ n))
</span></span><span style=display:flex><span>          (message <span style=color:#0ff;font-weight:700>&#34;%d: %s to %s.&#34;</span> n epsfile pngfile)
</span></span><span style=display:flex><span>          (start-process <span style=color:#0ff;font-weight:700>&#34;eps-to-png&#34;</span>
</span></span><span style=display:flex><span>                         <span style=color:#0ff;font-weight:700>&#34;*eps-to-png*&#34;</span>
</span></span><span style=display:flex><span>                         <span style=color:#0ff;font-weight:700>&#34;convert&#34;</span>
</span></span><span style=display:flex><span>                         <span style=color:#0ff;font-weight:700>&#34;-colorspace&#34;</span>
</span></span><span style=display:flex><span>                         <span style=color:#0ff;font-weight:700>&#34;sRGB&#34;</span>
</span></span><span style=display:flex><span>                         <span style=color:#0ff;font-weight:700>&#34;-density&#34;</span>
</span></span><span style=display:flex><span>                         <span style=color:#0ff;font-weight:700>&#34;600x600&#34;</span>
</span></span><span style=display:flex><span>                         epsfile
</span></span><span style=display:flex><span>                         pngfile)))
</span></span><span style=display:flex><span>      (message <span style=color:#0ff;font-weight:700>&#34;\n%d files were converted from EPS to PNG format.&#34;</span> n))))
</span></span></code></pre></div><h3 id=open-app-within-emacs>Open APP within Emacs</h3><p>该配置来源：<a href=https://emacs-china.org/t/emacs-mini-buffer-app-macos-only/23153>[技巧分享] 在 Emacs mini buffer 中选择并打开其他 App【macOS only】 - Emacs-general - Emacs China</a></p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> mac-launchpad/string-ends-with (s ending)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Return non-nil if string S ends with ENDING.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>cond</span> ((&gt;= (length s) (length ending))
</span></span><span style=display:flex><span>         (<span style=color:#fff;font-weight:700>let</span> ((elength (length ending)))
</span></span><span style=display:flex><span>           (string= (substring s (- <span style=color:#ff0;font-weight:700>0</span> elength)) ending)))
</span></span><span style=display:flex><span>        (t nil)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> mac-launchpad/find-mac-apps (folder)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>let*</span> ((files (directory-files folder))
</span></span><span style=display:flex><span>         (without-dots (cl-delete-if (<span style=color:#fff;font-weight:700>lambda</span> (f) (<span style=color:#fff;font-weight:700>or</span> (string= <span style=color:#0ff;font-weight:700>&#34;.&#34;</span> f) (string= <span style=color:#0ff;font-weight:700>&#34;..&#34;</span> f))) files))
</span></span><span style=display:flex><span>         (all-files (mapcar (<span style=color:#fff;font-weight:700>lambda</span> (f) (file-name-as-directory (concat (file-name-as-directory folder) f))) without-dots))
</span></span><span style=display:flex><span>         (result (cl-delete-if-not (<span style=color:#fff;font-weight:700>lambda</span> (s) (mac-launchpad/string-ends-with s <span style=color:#0ff;font-weight:700>&#34;.app/&#34;</span>)) all-files)))
</span></span><span style=display:flex><span>    result))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> mac-launchpad ()
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>let*</span> ((apps (mac-launchpad/find-mac-apps <span style=color:#0ff;font-weight:700>&#34;/Applications&#34;</span>))
</span></span><span style=display:flex><span>         (to-launch (completing-read <span style=color:#0ff;font-weight:700>&#34;launch: &#34;</span> apps)))
</span></span><span style=display:flex><span>    (shell-command (format <span style=color:#0ff;font-weight:700>&#34;defaults read \&#34;%s\&#34;Contents/Info.plist CFBundleIdentifier | xargs open -b&#34;</span> to-launch))))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(my/space-leader-def
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;mj&#34;</span> &#39;(mac-launchpad <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Jump to App&#34;</span>))
</span></span></code></pre></div><h3 id=open-file-with-system-file-manager>Open file with system file manager</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> xah-show-in-desktop ()
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Show current file in desktop.
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>This command can be called when in a file buffer or in </span><span style=color:#0ff;font-weight:700>`dired&#39;</span><span style=color:#0ff;font-weight:700>.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>let</span> (($path (<span style=color:#fff;font-weight:700>if</span> (buffer-file-name) (buffer-file-name) default-directory)))
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>cond</span>
</span></span><span style=display:flex><span>     ((string-equal system-type <span style=color:#0ff;font-weight:700>&#34;windows-nt&#34;</span>)
</span></span><span style=display:flex><span>      (shell-command
</span></span><span style=display:flex><span>       (format <span style=color:#0ff;font-weight:700>&#34;PowerShell -Command Start-Process Explorer -FilePath %s&#34;</span>
</span></span><span style=display:flex><span>               (shell-quote-argument default-directory))))
</span></span><span style=display:flex><span>     ((string-equal system-type <span style=color:#0ff;font-weight:700>&#34;darwin&#34;</span>)
</span></span><span style=display:flex><span>      (<span style=color:#fff;font-weight:700>if</span> (eq major-mode <span style=color:#0ff;font-weight:700>&#39;dired-mode</span>)
</span></span><span style=display:flex><span>          (<span style=color:#fff;font-weight:700>let</span> (($files (dired-get-marked-files )))
</span></span><span style=display:flex><span>            (<span style=color:#fff;font-weight:700>if</span> (eq (length $files) <span style=color:#ff0;font-weight:700>0</span>)
</span></span><span style=display:flex><span>                (shell-command (concat <span style=color:#0ff;font-weight:700>&#34;open &#34;</span> (shell-quote-argument (expand-file-name default-directory ))))
</span></span><span style=display:flex><span>              (shell-command (concat <span style=color:#0ff;font-weight:700>&#34;open -R &#34;</span> (shell-quote-argument (car (dired-get-marked-files )))))))
</span></span><span style=display:flex><span>        (shell-command
</span></span><span style=display:flex><span>         (concat <span style=color:#0ff;font-weight:700>&#34;open -R &#34;</span> (shell-quote-argument $path)))))
</span></span><span style=display:flex><span>     ((string-equal system-type <span style=color:#0ff;font-weight:700>&#34;gnu/linux&#34;</span>)
</span></span><span style=display:flex><span>      (<span style=color:#fff;font-weight:700>let</span> ((process-connection-type nil)
</span></span><span style=display:flex><span>            (openFileProgram (<span style=color:#fff;font-weight:700>if</span> (file-exists-p <span style=color:#0ff;font-weight:700>&#34;/usr/bin/gvfs-open&#34;</span>)
</span></span><span style=display:flex><span>                                 <span style=color:#0ff;font-weight:700>&#34;/usr/bin/gvfs-open&#34;</span>
</span></span><span style=display:flex><span>                               <span style=color:#0ff;font-weight:700>&#34;/usr/bin/xdg-open&#34;</span>)))
</span></span><span style=display:flex><span>        (start-process <span style=color:#0ff;font-weight:700>&#34;&#34;</span> nil openFileProgram (shell-quote-argument $path)))))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(my/space-leader-def
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;of&#34;</span> &#39;(xah-show-in-desktop <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Open Finder&#34;</span>))
</span></span></code></pre></div><h3 id=remove-link>Remove link</h3><p>下面的配置来源：<a href=https://github.com/jeremyf/dotemacs/blob/main/emacs.d/jf-org-mode.el>dotemacs/jf-org-mode.el at main · jeremyf/dotemacs</a>. 作用是移除 org 文件中的链接，仅保留链接的描述内容。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> jf/org-link-remove-link ()
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Remove the link part of an </span><span style=color:#0ff;font-weight:700>`org-mode&#39;</span><span style=color:#0ff;font-weight:700> link at point and keep only the description.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>let</span> ((elem (org-element-context)))
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>when</span> (eq (car elem) <span style=color:#0ff;font-weight:700>&#39;link</span>)
</span></span><span style=display:flex><span>      (<span style=color:#fff;font-weight:700>let*</span> ((content-begin (org-element-property <span style=color:#fff;font-weight:700>:contents-begin</span> elem))
</span></span><span style=display:flex><span>             (content-end  (org-element-property <span style=color:#fff;font-weight:700>:contents-end</span> elem))
</span></span><span style=display:flex><span>             (link-begin (org-element-property <span style=color:#fff;font-weight:700>:begin</span> elem))
</span></span><span style=display:flex><span>             (link-end (org-element-property <span style=color:#fff;font-weight:700>:end</span> elem)))
</span></span><span style=display:flex><span>        (<span style=color:#fff;font-weight:700>when</span> (<span style=color:#fff;font-weight:700>and</span> content-begin content-end)
</span></span><span style=display:flex><span>          (<span style=color:#fff;font-weight:700>let</span> ((content (buffer-substring-no-properties content-begin content-end)))
</span></span><span style=display:flex><span>            (delete-region link-begin link-end)
</span></span><span style=display:flex><span>            (insert content)))))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>with-eval-after-load</span> <span style=color:#0ff;font-weight:700>&#39;evil</span>
</span></span><span style=display:flex><span>  (evil-declare-key <span style=color:#0ff;font-weight:700>&#39;normal</span> <span style=color:#0ff;font-weight:700>&#39;global</span>
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;gX&#34;</span> <span style=color:#0ff;font-weight:700>&#39;jf/org-link-remove-link</span>))
</span></span></code></pre></div><h3 id=add-timestamps-to-youtube-links>Add timestamps to youtube links</h3><p>此配置来源：<a href=https://mbork.pl/2022-10-10_Adding_timestamps_to_youtube_links>Marcin Borkowski: 2022-10-10 Adding timestamps to youtube links</a>.</p><p>这个函数的作用是在 youtube 链接中增加时间，这样可以进行视频内容的精准跳转，当你看了一部份视频内容时记录时间等后期接着看。</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> yt-set-time (time)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Set TIME in the YouTube link at point.)
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>  TIME is number of seconds if called from Lisp, and a string if
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>  called interactively.
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>  Supported formats:
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>  - seconds
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>  - minutes:seconds
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>  - number of seconds with the \&#34;s\&#34; suffix.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span> (list
</span></span><span style=display:flex><span>                (<span style=color:#fff;font-weight:700>if</span> current-prefix-arg
</span></span><span style=display:flex><span>                    (prefix-numeric-value current-prefix-arg)
</span></span><span style=display:flex><span>                  (read-string <span style=color:#0ff;font-weight:700>&#34;Time: &#34;</span>))))
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>let</span> ((url (thing-at-point-url-at-point)))
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>if</span> (<span style=color:#fff;font-weight:700>and</span> url
</span></span><span style=display:flex><span>             (string-match
</span></span><span style=display:flex><span>              (format <span style=color:#0ff;font-weight:700>&#34;^%s&#34;</span>
</span></span><span style=display:flex><span>                      (regexp-opt
</span></span><span style=display:flex><span>                       &#39;(<span style=color:#0ff;font-weight:700>&#34;https://www.youtube.com/&#34;</span>
</span></span><span style=display:flex><span>                         <span style=color:#0ff;font-weight:700>&#34;https://youtu.be/&#34;</span>)
</span></span><span style=display:flex><span>                       <span style=color:#0ff;font-weight:700>&#34;\\(?:&#34;</span>)))
</span></span><span style=display:flex><span>             url))
</span></span><span style=display:flex><span>    (<span style=color:#fff;font-weight:700>let*</span> ((bounds (thing-at-point-bounds-of-url-at-point))
</span></span><span style=display:flex><span>           (time-present-p (string-match <span style=color:#0ff;font-weight:700>&#34;t=[0-9]+&#34;</span> url))
</span></span><span style=display:flex><span>           (question-mark-present-p (string-search <span style=color:#0ff;font-weight:700>&#34;?&#34;</span> url))
</span></span><span style=display:flex><span>           (seconds (<span style=color:#fff;font-weight:700>cond</span>
</span></span><span style=display:flex><span>                     ((numberp time)
</span></span><span style=display:flex><span>                      time)
</span></span><span style=display:flex><span>                     ((string-match
</span></span><span style=display:flex><span>                       <span style=color:#0ff;font-weight:700>&#34;^\\([0-9]+\\):\\([0-9]\\{2\\}\\)$&#34;</span> time)
</span></span><span style=display:flex><span>                      (+ (* <span style=color:#ff0;font-weight:700>60</span> (string-to-number
</span></span><span style=display:flex><span>                                (match-string <span style=color:#ff0;font-weight:700>1</span> time)))
</span></span><span style=display:flex><span>                         (string-to-number (match-string <span style=color:#ff0;font-weight:700>2</span> time))))
</span></span><span style=display:flex><span>                     ((string-match <span style=color:#0ff;font-weight:700>&#34;^\\([0-9]+\\)s?$&#34;</span> time)
</span></span><span style=display:flex><span>                      (string-to-number (match-string <span style=color:#ff0;font-weight:700>1</span> time)))
</span></span><span style=display:flex><span>                     (t (error <span style=color:#0ff;font-weight:700>&#34;Wrong argument format&#34;</span>))))
</span></span><span style=display:flex><span>           (new-url (<span style=color:#fff;font-weight:700>if</span> time-present-p
</span></span><span style=display:flex><span>                        (replace-regexp-in-string
</span></span><span style=display:flex><span>                         <span style=color:#0ff;font-weight:700>&#34;t=[0-9]+&#34;</span>
</span></span><span style=display:flex><span>                         (format <span style=color:#0ff;font-weight:700>&#34;t=%i&#34;</span> seconds)
</span></span><span style=display:flex><span>                         url)
</span></span><span style=display:flex><span>                      (concat url
</span></span><span style=display:flex><span>                              (<span style=color:#fff;font-weight:700>if</span> question-mark-present-p <span style=color:#0ff;font-weight:700>&#34;&amp;&#34;</span> <span style=color:#0ff;font-weight:700>&#34;?&#34;</span>)
</span></span><span style=display:flex><span>                              (format <span style=color:#0ff;font-weight:700>&#34;t=%i&#34;</span> seconds)))))
</span></span><span style=display:flex><span>      (delete-region (car bounds) (cdr bounds))
</span></span><span style=display:flex><span>      (insert new-url))
</span></span><span style=display:flex><span>    (error <span style=color:#0ff;font-weight:700>&#34;Not on a Youtube link&#34;</span>)))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(my/space-leader-def
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;my&#34;</span> &#39;(yt-set-time <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Youtube link time&#34;</span>))
</span></span></code></pre></div><h3 id=self-define-function>self define function</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> switch-to-message ()
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Quick switch to </span><span style=color:#0ff;font-weight:700>`*Message*&#39;</span><span style=color:#0ff;font-weight:700> buffer.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>  (switch-to-buffer <span style=color:#0ff;font-weight:700>&#34;*Messages*&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> switch-to-scratch ()
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Quick switch to </span><span style=color:#0ff;font-weight:700>`*Scratch*&#39;</span><span style=color:#0ff;font-weight:700> buffer.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>  (switch-to-buffer <span style=color:#0ff;font-weight:700>&#34;*scratch*&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(my/space-leader-def
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;bs&#34;</span> &#39;(switch-to-scratch <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;*scratch*&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;bm&#34;</span> &#39;(switch-to-message <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;*message*&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> my/inbox-file ()
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Open inbox file.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>  (find-file (expand-file-name <span style=color:#0ff;font-weight:700>&#34;inbox/inbox.org&#34;</span> my-galaxy)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> my/plan-file ()
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Open plan file.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>  (find-file (expand-file-name <span style=color:#0ff;font-weight:700>&#34;inbox/plan.org&#34;</span> my-galaxy)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> my/index-file ()
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>  (find-file (expand-file-name <span style=color:#0ff;font-weight:700>&#34;roam/main/index.org&#34;</span> my-galaxy)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> my/reflection-file ()
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>  (find-file (expand-file-name <span style=color:#0ff;font-weight:700>&#34;roam/main/reflection.org&#34;</span> my-galaxy)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> my/finance-file ()
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Open finance file.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>  (find-file (expand-file-name <span style=color:#0ff;font-weight:700>&#34;finance/beans/finance.bean&#34;</span> my-galaxy)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> my/reading-record ()
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Open reading record file.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>  (find-file (expand-file-name <span style=color:#0ff;font-weight:700>&#34;denote/books/20230301T211439--Book-lists-and-reading-record__reading.org&#34;</span> my-galaxy)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(my/space-leader-def
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;f&#34;</span> &#39;(<span style=color:#fff;font-weight:700>:ignore</span> t <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Open files&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;fb&#34;</span> &#39;(my/reading-record <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Reading record&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;fi&#34;</span> &#39;(my/inbox-file <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Inbox file&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;fI&#34;</span> &#39;(my/index-file <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Index file&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;fp&#34;</span> &#39;(my/plan-file <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Plan file&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;ff&#34;</span> &#39;(my/finance-file <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Finance file&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;fR&#34;</span> &#39;(my/reflection-file <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;Reflection file&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;fg&#34;</span> &#39;(my/gtd-file <span style=color:#fff;font-weight:700>:wk</span> <span style=color:#0ff;font-weight:700>&#34;GTD file&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> my/start-server ()
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>if</span> (not (server-running-p))
</span></span><span style=display:flex><span>      (server-start))
</span></span><span style=display:flex><span>  (message <span style=color:#0ff;font-weight:700>&#34;Server has started&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> my/scroll-other-windown-down ()
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Scroll other window down.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>  (scroll-other-window-down <span style=color:#ff0;font-weight:700>2</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(global-set-key (kbd <span style=color:#0ff;font-weight:700>&#34;M-p&#34;</span>) <span style=color:#0ff;font-weight:700>&#39;my/scroll-other-windown-down</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#fff;font-weight:700>defun</span> my/scroll-other-windown ()
</span></span><span style=display:flex><span>  <span style=color:#0ff;font-weight:700>&#34;Scroll other window up.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#fff;font-weight:700>interactive</span>)
</span></span><span style=display:flex><span>  (scroll-other-window <span style=color:#ff0;font-weight:700>2</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(global-set-key (kbd <span style=color:#0ff;font-weight:700>&#34;M-n&#34;</span>) <span style=color:#0ff;font-weight:700>&#39;my/scroll-other-windown</span>)
</span></span></code></pre></div><h3 id=footer>Footer</h3><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#fff;font-weight:700>provide</span> <span style=color:#0ff;font-weight:700>&#39;init-misc</span>)
</span></span><span style=display:flex><span><span style=color:#007f7f>;;; init-misc.el ends here.</span>
</span></span></code></pre></div></section><div class=post-tags><nav class="nav tags"><ul class=tags><li><a href=/tags/emacs>Emacs</a></li></ul></nav></div></article></main><footer><div style=display:flex><a class=soc href=https://github.com/Jousimies/.emacs.d rel=me title=GitHub><i data-feather=github></i></a>
<a class=border></a></div><div class=footer-info>2023 <a href=https://github.com/athul/archie>Archie Theme</a> | Built with <a href=https://gohugo.io>Hugo</a></div></footer><script>feather.replace()</script></div></body></html>