<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title class=pjax-title>Personal emacs configuration - 探索世界，践行人生</title><meta name=Description content="Personal emacs configuration"><meta property="og:title" content="Personal emacs configuration"><meta property="og:description" content="Personal emacs configuration"><meta property="og:type" content="article"><meta property="og:url" content="https://jousimies.github.io/posts/emacs/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-02-26T22:02:00+08:00"><meta property="article:modified_time" content="2023-02-26T22:11:59+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Personal emacs configuration"><meta name=twitter:description content="Personal emacs configuration"><meta name=application-name content="探索世界，践行人生"><meta name=apple-mobile-web-app-title content="探索世界，践行人生"><meta name=theme-color content="#f8f8f8"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=canonical href=https://jousimies.github.io/posts/emacs/><link rel=prev href=https://jousimies.github.io/posts/mac-%E4%B8%8A%E4%BD%BF%E7%94%A8-naiveproxy-%E5%8F%8A%E4%BB%A3%E7%90%86%E9%85%8D%E7%BD%AE/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href=/lib/fontawesome-free/all.min.css><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href=/lib/animate/animate.min.css><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Personal emacs configuration","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/jousimies.github.io\/posts\/emacs\/"},"genre":"posts","keywords":"Emacs","wordcount":18937,"url":"https:\/\/jousimies.github.io\/posts\/emacs\/","datePublished":"2023-02-26T22:02:00+08:00","dateModified":"2023-02-26T22:11:59+08:00","publisher":{"@type":"Organization","name":"Jousimies"},"author":{"@type":"Person","name":"Jousimies"},"description":"Personal emacs configuration"}</script></head><body header-desktop header-mobile><script type=text/javascript>function setTheme(e){document.body.setAttribute("theme",e),document.documentElement.style.setProperty("color-scheme",e==="light"?"light":"dark")}function saveTheme(e){window.localStorage&&localStorage.setItem("theme",e)}function getMeta(t){const e=document.getElementsByTagName("meta");for(let n=0;n<e.length;n++)if(e[n].getAttribute("name")===t)return e[n];return''}if(window.localStorage&&localStorage.getItem("theme")){let e=localStorage.getItem("theme");e==="light"||e==="dark"||e==="black"?setTheme(e):window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?setTheme("dark"):setTheme("light")}else"auto"==="light"||"auto"==="dark"||"auto"==="black"?(setTheme("auto"),saveTheme("auto")):(saveTheme("auto"),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?setTheme("dark"):setTheme("light"));let metaColors={light:"#f8f8f8",dark:"#252627",black:"#000000"};getMeta("theme-color").content=metaColors[document.body.getAttribute("theme")]</script><div id=back-to-top></div><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title=探索世界，践行人生>探索世界，践行人生</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>文章 </a><a class=menu-item href=/tags/>标签 </a><a class=menu-item href=/categories/>分类 </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder=搜索文章标题或内容... id=search-input-desktop>
<a href=# onclick=return!1 class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fas fa-search fa-fw"></i></a>
<a href=# onclick=return!1 class="search-button search-clear" id=search-clear-desktop title=清空><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i></span>
</span><a href=# onclick=return!1 class="menu-item theme-switch" title=切换主题><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=探索世界，践行人生>探索世界，践行人生</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容... id=search-input-mobile>
<a href=# onclick=return!1 class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fas fa-search fa-fw"></i></a>
<a href=# onclick=return!1 class="search-button search-clear" id=search-clear-mobile title=清空><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=# onclick=return!1 class=search-cancel id=search-cancel-mobile>取消</a></div><a class=menu-item href=/posts/ title>文章</a><a class=menu-item href=/tags/ title>标签</a><a class=menu-item href=/categories/ title>分类</a><a href=# onclick=return!1 class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>目录</h2><div class=toc-content id=toc-content-auto><nav id=TableOfContents><ul><li><a href=#early-init>Early Init</a></li><li><a href=#start-lexical-binding>Start, Lexical Binding</a></li><li><a href=#rudimentary-configuration>Rudimentary Configuration</a><ul><li><a href=#speedup>Speedup</a></li><li><a href=#benchmark>Benchmark</a></li><li><a href=#path>PATH</a></li><li><a href=#utility-hooks-and-functions>Utility Hooks and Functions</a></li><li><a href=#variables>Variables</a></li><li><a href=#evil-modal-edit>Evil modal edit</a></li><li><a href=#epkg>epkg</a></li><li><a href=#auto-save>auto-save</a></li><li><a href=#auto-tangle>Auto tangle</a></li><li><a href=#server>Server</a></li><li><a href=#magit>Magit</a></li><li><a href=#custom>Custom</a></li></ul></li><li><a href=#emacs-user-interface-delicious>Emacs User Interface, Delicious</a><ul><li><a href=#fonts>Fonts</a></li><li><a href=#themes>Themes</a></li><li><a href=#all-the-icons>all-the-icons</a></li><li><a href=#fringe-mode>fringe-mode</a></li><li><a href=#hl-line-mode>hl-line-mode</a></li><li><a href=#line-numbers>line numbers</a></li><li><a href=#scroll-bar-mode>scroll-bar-mode</a></li><li><a href=#fill-column-indicator>fill column indicator</a></li><li><a href=#paren>Paren</a></li><li><a href=#cursor-and-color>Cursor and color</a></li><li><a href=#frame>Frame</a></li><li><a href=#modeline>modeline</a></li><li><a href=#rainbow-mode>rainbow-mode</a></li><li><a href=#rainbow-delimiters>rainbow-delimiters</a></li><li><a href=#pulse>pulse</a></li><li><a href=#dashboard>dashboard</a></li><li><a href=#color-identifiers-mode>color-identifiers-mode</a></li></ul></li><li><a href=#powerful-emacs-equipped-with-builtin-packages>Powerful Emacs Equipped with Builtin Packages</a><ul><li><a href=#better-default>Better default</a></li><li><a href=#system-coding>system coding</a></li><li><a href=#profiler>profiler</a></li><li><a href=#buffer>buffer</a></li><li><a href=#calculator>calculator</a></li><li><a href=#column-number-mode>column-number-mode</a></li><li><a href=#size-indication-mode>size-indication-mode</a></li><li><a href=#delete-selection-mode>delete-selection-mode</a></li><li><a href=#winner-mode>winner-mode</a></li><li><a href=#auto-revert-mode>auto-revert-mode</a></li><li><a href=#tab-bar-mode>tab-bar-mode</a></li><li><a href=#savehist-mode>savehist-mode</a></li><li><a href=#save-place-mode>save-place-mode</a></li><li><a href=#midnight-mode>midnight-mode</a></li><li><a href=#so-long-mode>so-long-mode</a></li><li><a href=#electric-pair-mode>electric-pair-mode</a></li><li><a href=#prettify-symbols-mode>prettify-symbols-mode</a></li><li><a href=#hippie-expand>hippie-expand</a></li><li><a href=#outline-minor-mode>outline-minor-mode</a></li><li><a href=#pixel-scroll-precision-mode>pixel-scroll-precision-mode</a></li><li><a href=#recentf-mode>recentf-mode</a></li><li><a href=#visual-line-mode>visual-line-mode</a></li><li><a href=#word-wrap-whitespace-mode>word-wrap-whitespace-mode</a></li><li><a href=#dired>dired</a></li><li><a href=#scratch>scratch</a></li><li><a href=#window-divider-mode>window-divider-mode</a></li><li><a href=#doc-view>doc-view</a></li><li><a href=#abbrev-mode>abbrev-mode</a></li><li><a href=#bookmark>bookmark</a></li><li><a href=#clipboard>clipboard</a></li><li><a href=#files>files</a></li></ul></li><li><a href=#awesome-emacs-equipped-with-third-party-packages>Awesome Emacs Equipped with Third-Party Packages</a><ul><li><a href=#undo>undo</a></li><li><a href=#delete>delete</a></li><li><a href=#gc-buffers>gc-buffers</a></li><li><a href=#rime>rime</a></li><li><a href=#helpful>helpful</a></li><li><a href=#expand-region>expand-region</a></li><li><a href=#ctrlf>ctrlf</a></li><li><a href=#avy>avy</a></li><li><a href=#whitespace-cleanup-mode>whitespace-cleanup-mode</a></li><li><a href=#elisp-demos>elisp-demos</a></li><li><a href=#tempel>tempel</a></li><li><a href=#yasnippet>yasnippet</a></li><li><a href=#rg>rg</a></li><li><a href=#minibuffer-and-completion>Minibuffer and completion</a></li></ul></li><li><a href=#misc>Misc</a><ul><li><a href=#gcmh>gcmh</a></li><li><a href=#file-info>file-info</a></li><li><a href=#disk-usage>disk-usage</a></li><li><a href=#youtube-dl>youtube-dl</a></li><li><a href=#ocr>OCR</a></li><li><a href=#proxy>proxy</a></li></ul></li><li><a href=#emacs-works-with-multiple-language-piece-of-cake>Emacs Works with Multiple Language, Piece of Cake</a><ul><li><a href=#ispell>Ispell</a></li><li><a href=#flyspell>flyspell</a></li><li><a href=#flyspell-correct>flyspell-correct</a></li><li><a href=#langtool>langtool</a></li><li><a href=#dictionary>dictionary</a></li><li><a href=#go-translate>go-translate</a></li><li><a href=#lingva>lingva</a></li><li><a href=#sdcv>sdcv</a></li><li><a href=#osx-dictionary>osx-dictionary</a></li><li><a href=#powerthesaurus>powerthesaurus</a></li><li><a href=#flycheck>flycheck</a></li><li><a href=#flycheck-grammarly>flycheck-grammarly</a></li><li><a href=#shortcut>shortcut</a></li><li><a href=#lsp>LSP</a></li><li><a href=#markdown>markdown</a></li></ul></li><li><a href=#organize-life-with-plain-text-high-effective-system>Organize Life with Plain Text, High Effective System</a><ul><li><a href=#org-mode>org-mode</a></li><li><a href=#ekg>ekg</a></li><li><a href=#org-roam>org-roam</a></li><li><a href=#dynamic-org-agenda>dynamic org-agenda</a></li><li><a href=#calendar-and-appt>calendar and appt</a></li><li><a href=#zen>Zen</a></li><li><a href=#toc>TOC</a></li><li><a href=#org-super-star>org-super-star</a></li><li><a href=#org-download>org-download</a></li><li><a href=#org-appear>org-appear</a></li><li><a href=#math-preview>math-preview</a></li><li><a href=#plantuml>plantuml</a></li><li><a href=#org-rainbow-tags>org-rainbow-tags</a></li><li><a href=#alarm-clock>alarm-clock</a></li><li><a href=#pomm>pomm</a></li><li><a href=#pandoc>Pandoc</a></li><li><a href=#beancount-mode>beancount-mode</a></li><li><a href=#bibtex-management>Bibtex management</a></li><li><a href=#latex>latex</a></li><li><a href=#blog>Blog</a></li></ul></li><li><a href=#applications>Applications</a><ul><li><a href=#browser>Browser</a></li><li><a href=#elfeed>Elfeed</a></li><li><a href=#reader>Reader</a></li><li><a href=#vterm>vterm</a></li><li><a href=#mail>Mail</a></li><li><a href=#report>Report</a></li><li><a href=#achive>Achive</a></li></ul></li><li><a href=#easy-use-code-snippets>Easy use, Code snippets</a><ul><li><a href=#open-app-within-emacs>Open APP within Emacs</a></li><li><a href=#open-file-with-system-file-manager>Open file with system file manager</a></li><li><a href=#remove-link>Remove link</a></li><li><a href=#add-timestamps-to-youtube-links>Add timestamps to youtube links</a></li><li><a href=#self-define-function>self define function</a></li></ul></li><li><a href=#end>End</a></li></ul></nav></div></div><script>document.getElementsByTagName("main")[0].setAttribute("pageStyle","normal")</script><script>document.getElementsByTagName("main")[0].setAttribute("autoTOC","true")</script><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Personal emacs configuration</h1><div class=post-meta><div class=post-meta-line><span class=post-author><i class="author fas fa-user-circle fa-fw"></i><a href=/ title=Author rel=author class=author>Jousimies</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2023-02-26>2023-02-26</time>&nbsp;<i class="far fa-edit fa-fw"></i>&nbsp;<time datetime=2023-02-26>2023-02-26</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 18937 字&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 38 分钟&nbsp;</div></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#early-init>Early Init</a></li><li><a href=#start-lexical-binding>Start, Lexical Binding</a></li><li><a href=#rudimentary-configuration>Rudimentary Configuration</a><ul><li><a href=#speedup>Speedup</a></li><li><a href=#benchmark>Benchmark</a></li><li><a href=#path>PATH</a></li><li><a href=#utility-hooks-and-functions>Utility Hooks and Functions</a></li><li><a href=#variables>Variables</a></li><li><a href=#evil-modal-edit>Evil modal edit</a></li><li><a href=#epkg>epkg</a></li><li><a href=#auto-save>auto-save</a></li><li><a href=#auto-tangle>Auto tangle</a></li><li><a href=#server>Server</a></li><li><a href=#magit>Magit</a></li><li><a href=#custom>Custom</a></li></ul></li><li><a href=#emacs-user-interface-delicious>Emacs User Interface, Delicious</a><ul><li><a href=#fonts>Fonts</a></li><li><a href=#themes>Themes</a></li><li><a href=#all-the-icons>all-the-icons</a></li><li><a href=#fringe-mode>fringe-mode</a></li><li><a href=#hl-line-mode>hl-line-mode</a></li><li><a href=#line-numbers>line numbers</a></li><li><a href=#scroll-bar-mode>scroll-bar-mode</a></li><li><a href=#fill-column-indicator>fill column indicator</a></li><li><a href=#paren>Paren</a></li><li><a href=#cursor-and-color>Cursor and color</a></li><li><a href=#frame>Frame</a></li><li><a href=#modeline>modeline</a></li><li><a href=#rainbow-mode>rainbow-mode</a></li><li><a href=#rainbow-delimiters>rainbow-delimiters</a></li><li><a href=#pulse>pulse</a></li><li><a href=#dashboard>dashboard</a></li><li><a href=#color-identifiers-mode>color-identifiers-mode</a></li></ul></li><li><a href=#powerful-emacs-equipped-with-builtin-packages>Powerful Emacs Equipped with Builtin Packages</a><ul><li><a href=#better-default>Better default</a></li><li><a href=#system-coding>system coding</a></li><li><a href=#profiler>profiler</a></li><li><a href=#buffer>buffer</a></li><li><a href=#calculator>calculator</a></li><li><a href=#column-number-mode>column-number-mode</a></li><li><a href=#size-indication-mode>size-indication-mode</a></li><li><a href=#delete-selection-mode>delete-selection-mode</a></li><li><a href=#winner-mode>winner-mode</a></li><li><a href=#auto-revert-mode>auto-revert-mode</a></li><li><a href=#tab-bar-mode>tab-bar-mode</a></li><li><a href=#savehist-mode>savehist-mode</a></li><li><a href=#save-place-mode>save-place-mode</a></li><li><a href=#midnight-mode>midnight-mode</a></li><li><a href=#so-long-mode>so-long-mode</a></li><li><a href=#electric-pair-mode>electric-pair-mode</a></li><li><a href=#prettify-symbols-mode>prettify-symbols-mode</a></li><li><a href=#hippie-expand>hippie-expand</a></li><li><a href=#outline-minor-mode>outline-minor-mode</a></li><li><a href=#pixel-scroll-precision-mode>pixel-scroll-precision-mode</a></li><li><a href=#recentf-mode>recentf-mode</a></li><li><a href=#visual-line-mode>visual-line-mode</a></li><li><a href=#word-wrap-whitespace-mode>word-wrap-whitespace-mode</a></li><li><a href=#dired>dired</a></li><li><a href=#scratch>scratch</a></li><li><a href=#window-divider-mode>window-divider-mode</a></li><li><a href=#doc-view>doc-view</a></li><li><a href=#abbrev-mode>abbrev-mode</a></li><li><a href=#bookmark>bookmark</a></li><li><a href=#clipboard>clipboard</a></li><li><a href=#files>files</a></li></ul></li><li><a href=#awesome-emacs-equipped-with-third-party-packages>Awesome Emacs Equipped with Third-Party Packages</a><ul><li><a href=#undo>undo</a></li><li><a href=#delete>delete</a></li><li><a href=#gc-buffers>gc-buffers</a></li><li><a href=#rime>rime</a></li><li><a href=#helpful>helpful</a></li><li><a href=#expand-region>expand-region</a></li><li><a href=#ctrlf>ctrlf</a></li><li><a href=#avy>avy</a></li><li><a href=#whitespace-cleanup-mode>whitespace-cleanup-mode</a></li><li><a href=#elisp-demos>elisp-demos</a></li><li><a href=#tempel>tempel</a></li><li><a href=#yasnippet>yasnippet</a></li><li><a href=#rg>rg</a></li><li><a href=#minibuffer-and-completion>Minibuffer and completion</a></li></ul></li><li><a href=#misc>Misc</a><ul><li><a href=#gcmh>gcmh</a></li><li><a href=#file-info>file-info</a></li><li><a href=#disk-usage>disk-usage</a></li><li><a href=#youtube-dl>youtube-dl</a></li><li><a href=#ocr>OCR</a></li><li><a href=#proxy>proxy</a></li></ul></li><li><a href=#emacs-works-with-multiple-language-piece-of-cake>Emacs Works with Multiple Language, Piece of Cake</a><ul><li><a href=#ispell>Ispell</a></li><li><a href=#flyspell>flyspell</a></li><li><a href=#flyspell-correct>flyspell-correct</a></li><li><a href=#langtool>langtool</a></li><li><a href=#dictionary>dictionary</a></li><li><a href=#go-translate>go-translate</a></li><li><a href=#lingva>lingva</a></li><li><a href=#sdcv>sdcv</a></li><li><a href=#osx-dictionary>osx-dictionary</a></li><li><a href=#powerthesaurus>powerthesaurus</a></li><li><a href=#flycheck>flycheck</a></li><li><a href=#flycheck-grammarly>flycheck-grammarly</a></li><li><a href=#shortcut>shortcut</a></li><li><a href=#lsp>LSP</a></li><li><a href=#markdown>markdown</a></li></ul></li><li><a href=#organize-life-with-plain-text-high-effective-system>Organize Life with Plain Text, High Effective System</a><ul><li><a href=#org-mode>org-mode</a></li><li><a href=#ekg>ekg</a></li><li><a href=#org-roam>org-roam</a></li><li><a href=#dynamic-org-agenda>dynamic org-agenda</a></li><li><a href=#calendar-and-appt>calendar and appt</a></li><li><a href=#zen>Zen</a></li><li><a href=#toc>TOC</a></li><li><a href=#org-super-star>org-super-star</a></li><li><a href=#org-download>org-download</a></li><li><a href=#org-appear>org-appear</a></li><li><a href=#math-preview>math-preview</a></li><li><a href=#plantuml>plantuml</a></li><li><a href=#org-rainbow-tags>org-rainbow-tags</a></li><li><a href=#alarm-clock>alarm-clock</a></li><li><a href=#pomm>pomm</a></li><li><a href=#pandoc>Pandoc</a></li><li><a href=#beancount-mode>beancount-mode</a></li><li><a href=#bibtex-management>Bibtex management</a></li><li><a href=#latex>latex</a></li><li><a href=#blog>Blog</a></li></ul></li><li><a href=#applications>Applications</a><ul><li><a href=#browser>Browser</a></li><li><a href=#elfeed>Elfeed</a></li><li><a href=#reader>Reader</a></li><li><a href=#vterm>vterm</a></li><li><a href=#mail>Mail</a></li><li><a href=#report>Report</a></li><li><a href=#achive>Achive</a></li></ul></li><li><a href=#easy-use-code-snippets>Easy use, Code snippets</a><ul><li><a href=#open-app-within-emacs>Open APP within Emacs</a></li><li><a href=#open-file-with-system-file-manager>Open file with system file manager</a></li><li><a href=#remove-link>Remove link</a></li><li><a href=#add-timestamps-to-youtube-links>Add timestamps to youtube links</a></li><li><a href=#self-define-function>self define function</a></li></ul></li><li><a href=#end>End</a></li></ul></nav></div></div><div class=content id=content><h2 id=early-init class=headerLink><a href=#early-init class=header-mark></a>Early Init</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=c1>;;; early-init.el --- Early Init File -*- lexical-binding: t; no-byte-compile: t -*-</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>;; Profiling since here when in debug-mode</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>when</span> <span class=nv>init-file-debug</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>profiler-start</span> <span class=ss>&#39;cpu</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;window-setup-hook</span> <span class=nf>#&#39;</span><span class=nv>profiler-stop</span> <span class=mi>0</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>;; Defer garbage collection further back in the startup process</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>gc-cons-threshold</span> <span class=nv>most-positive-fixnum</span>
</span></span><span class=line><span class=cl>      <span class=nv>gc-cons-percentage</span> <span class=mf>1.0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>;; Prevent the glimpse of un-styled Emacs by disabling these UI elements early.</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>push</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>menu-bar-lines</span> <span class=o>.</span> <span class=mi>0</span><span class=p>)</span> <span class=nv>default-frame-alist</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>push</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>tool-bar-lines</span> <span class=o>.</span> <span class=mi>0</span><span class=p>)</span> <span class=nv>default-frame-alist</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>push</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>vertical-scroll-bars</span> <span class=o>.</span> <span class=mi>0</span><span class=p>)</span> <span class=nv>default-frame-alist</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>push</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>undecorated</span> <span class=o>.</span> <span class=no>t</span><span class=p>)</span> <span class=nv>default-frame-alist</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>push</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>fullscreen</span> <span class=o>.</span> <span class=nv>maximized</span><span class=p>)</span> <span class=nv>initial-frame-alist</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>;; (setq-default initial-major-mode &#39;fundamental-mode)</span>
</span></span><span class=line><span class=cl><span class=c1>;; Disable mode-line when emacs startup.</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq-default</span> <span class=nv>mode-line-format</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>byte-compile-warnings</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>;;; early-init.el ends here</span>
</span></span></code></pre></div><h2 id=start-lexical-binding class=headerLink><a href=#start-lexical-binding class=header-mark></a>Start, Lexical Binding</h2><p>关于 lexical-binding 的作用见 <a href=https://nullprogram.com/blog/2016/12/22/ target=_blank rel="noopener noreffer">Make Emacs run (slightly) faster with lexical binding</a> . 或者 <a href=http://www.yinwang.org/blog-cn/2013/03/26/lisp-dead-alive target=_blank rel="noopener noreffer">Lisp 已死，Lisp 万岁！</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=c1>;; init.el --- Personal Emacs Configuration -*- lexical-binding: t; no-byte-compile: t -*-</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>;;; Commentary:</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>;;; Code:</span>
</span></span></code></pre></div><h2 id=rudimentary-configuration class=headerLink><a href=#rudimentary-configuration class=header-mark></a>Rudimentary Configuration</h2><h3 id=speedup class=headerLink><a href=#speedup class=header-mark></a>Speedup</h3><p>这部份的内容来源：<a href=https://github.com/seagle0128/.emacs.d/blob/master/init.el target=_blank rel="noopener noreffer">.emacs.d/init.el at master · seagle0128/.emacs.d</a>
可以加快 Emacs 的启动速度。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>auto-mode-case-fold</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>unless</span> <span class=p>(</span><span class=nb>or</span> <span class=p>(</span><span class=nf>daemonp</span><span class=p>)</span> <span class=nv>noninteractive</span> <span class=nv>init-file-debug</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>old-file-name-handler-alist</span> <span class=nv>file-name-handler-alist</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>setq</span> <span class=nv>file-name-handler-alist</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;emacs-startup-hook</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>                <span class=s>&#34;Recover file name handlers.&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=nb>setq</span> <span class=nv>file-name-handler-alist</span>
</span></span><span class=line><span class=cl>                      <span class=p>(</span><span class=nv>delete-dups</span> <span class=p>(</span><span class=nf>append</span> <span class=nv>file-name-handler-alist</span>
</span></span><span class=line><span class=cl>                                           <span class=nv>old-file-name-handler-alist</span><span class=p>)))))))</span>
</span></span></code></pre></div><h3 id=benchmark class=headerLink><a href=#benchmark class=header-mark></a>Benchmark</h3><p>可以使用的配置：<a href=https://github.com/purcell/emacs.d/blob/master/lisp/init-benchmarking.el target=_blank rel="noopener noreffer">emacs.d/init-benchmarking.el at master · purcell/emacs.d</a></p><p>Emacs 进行性检检测还可以使用<a href=https://github.com/dholm/benchmark-init-el target=_blank rel="noopener noreffer">dholm/benchmark-init-el: Benchmark your Emacs initialization</a> 或者<a href=https://github.com/jschaf/esup target=_blank rel="noopener noreffer">jschaf/esup: ESUP - Emacs Start Up Profiler</a>.</p><p>相比较与使用 Emacs 内置的 <code>package.el</code>, 使用 borg 管理包，Emacs 的启动时间有一个明显的优化。</p><p>为了提高 Emacs 的启动速度，需要做的几个方面包括：<a href=#speedup rel>Speedup</a>, <a href=#path rel>PATH</a>, <a href=#early-init rel>Early Init</a>, 以及使用 gcmh 管理使用时的 Garbage collection 行为。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;window-setup-hook</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nf>garbage-collect</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>curtime</span> <span class=p>(</span><span class=nf>current-time</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nf>message</span> <span class=s>&#34;Times: init:%.06f total:%.06f gc-done:%d&#34;</span>
</span></span><span class=line><span class=cl>                       <span class=p>(</span><span class=nf>float-time</span> <span class=p>(</span><span class=nf>time-subtract</span> <span class=nv>after-init-time</span> <span class=nv>before-init-time</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                       <span class=p>(</span><span class=nf>float-time</span> <span class=p>(</span><span class=nf>time-subtract</span> <span class=nv>curtime</span> <span class=nv>before-init-time</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                       <span class=nv>gcs-done</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>          <span class=mi>90</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>sanityinc/time-subtract-millis</span> <span class=p>(</span><span class=nv>b</span> <span class=nv>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>*</span> <span class=mf>1000.0</span> <span class=p>(</span><span class=nf>float-time</span> <span class=p>(</span><span class=nf>time-subtract</span> <span class=nv>b</span> <span class=nv>a</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defvar</span> <span class=nv>sanityinc/require-times</span> <span class=no>nil</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;A list of (FEATURE LOAD-START-TIME LOAD-DURATION).
</span></span></span><span class=line><span class=cl><span class=s>LOAD-DURATION is the time taken in milliseconds to load FEATURE.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>sanityinc/require-times-wrapper</span> <span class=p>(</span><span class=nv>orig</span> <span class=nv>feature</span> <span class=kp>&amp;rest</span> <span class=nv>args</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Note in </span><span class=ss>`sanityinc/require-times&#39;</span><span class=s> the time taken to require each feature.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let*</span> <span class=p>((</span><span class=nv>already-loaded</span> <span class=p>(</span><span class=nf>memq</span> <span class=nv>feature</span> <span class=nv>features</span><span class=p>))</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>require-start-time</span> <span class=p>(</span><span class=nb>and</span> <span class=p>(</span><span class=nv>not</span> <span class=nv>already-loaded</span><span class=p>)</span> <span class=p>(</span><span class=nf>current-time</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>prog1</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nf>apply</span> <span class=nv>orig</span> <span class=nv>feature</span> <span class=nv>args</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nb>and</span> <span class=p>(</span><span class=nv>not</span> <span class=nv>already-loaded</span><span class=p>)</span> <span class=p>(</span><span class=nf>memq</span> <span class=nv>feature</span> <span class=nv>features</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>time</span> <span class=p>(</span><span class=nv>sanityinc/time-subtract-millis</span> <span class=p>(</span><span class=nf>current-time</span><span class=p>)</span> <span class=nv>require-start-time</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;sanityinc/require-times</span>
</span></span><span class=line><span class=cl>                       <span class=p>(</span><span class=nf>list</span> <span class=nv>feature</span> <span class=nv>require-start-time</span> <span class=nv>time</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                       <span class=no>t</span><span class=p>))))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>advice-add</span> <span class=ss>&#39;require</span> <span class=nb>:around</span> <span class=ss>&#39;sanityinc/require-times-wrapper</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>define-derived-mode</span> <span class=nv>sanityinc/require-times-mode</span> <span class=nv>tabulated-list-mode</span> <span class=s>&#34;Require-Times&#34;</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Show times taken to </span><span class=ss>`require&#39;</span><span class=s> packages.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>tabulated-list-format</span>
</span></span><span class=line><span class=cl>        <span class=p>[(</span><span class=s>&#34;Start time (ms)&#34;</span> <span class=mi>20</span> <span class=nv>sanityinc/require-times-sort-by-start-time-pred</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=s>&#34;Feature&#34;</span> <span class=mi>30</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=s>&#34;Time (ms)&#34;</span> <span class=mi>12</span> <span class=nv>sanityinc/require-times-sort-by-load-time-pred</span><span class=p>)])</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>tabulated-list-sort-key</span> <span class=p>(</span><span class=nf>cons</span> <span class=s>&#34;Start time (ms)&#34;</span> <span class=no>nil</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=c1>;; (setq tabulated-list-padding 2)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>tabulated-list-entries</span> <span class=nf>#&#39;</span><span class=nv>sanityinc/require-times-tabulated-list-entries</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>tabulated-list-init-header</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nf>fboundp</span> <span class=ss>&#39;tablist-minor-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>tablist-minor-mode</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>sanityinc/require-times-sort-by-start-time-pred</span> <span class=p>(</span><span class=nv>entry1</span> <span class=nv>entry2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>&lt;</span> <span class=p>(</span><span class=nf>string-to-number</span> <span class=p>(</span><span class=nf>elt</span> <span class=p>(</span><span class=nf>nth</span> <span class=mi>1</span> <span class=nv>entry1</span><span class=p>)</span> <span class=mi>0</span><span class=p>))</span>
</span></span><span class=line><span class=cl>     <span class=p>(</span><span class=nf>string-to-number</span> <span class=p>(</span><span class=nf>elt</span> <span class=p>(</span><span class=nf>nth</span> <span class=mi>1</span> <span class=nv>entry2</span><span class=p>)</span> <span class=mi>0</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>sanityinc/require-times-sort-by-load-time-pred</span> <span class=p>(</span><span class=nv>entry1</span> <span class=nv>entry2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>&gt;</span> <span class=p>(</span><span class=nf>string-to-number</span> <span class=p>(</span><span class=nf>elt</span> <span class=p>(</span><span class=nf>nth</span> <span class=mi>1</span> <span class=nv>entry1</span><span class=p>)</span> <span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl>     <span class=p>(</span><span class=nf>string-to-number</span> <span class=p>(</span><span class=nf>elt</span> <span class=p>(</span><span class=nf>nth</span> <span class=mi>1</span> <span class=nv>entry2</span><span class=p>)</span> <span class=mi>2</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>sanityinc/require-times-tabulated-list-entries</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>cl-loop</span> <span class=nv>for</span> <span class=p>(</span><span class=nv>feature</span> <span class=nv>start-time</span> <span class=nv>millis</span><span class=p>)</span> <span class=nv>in</span> <span class=nv>sanityinc/require-times</span>
</span></span><span class=line><span class=cl>           <span class=nv>with</span> <span class=nv>order</span> <span class=nf>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>           <span class=nb>do</span> <span class=p>(</span><span class=nb>cl-incf</span> <span class=nv>order</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=nv>collect</span> <span class=p>(</span><span class=nf>list</span> <span class=nv>order</span>
</span></span><span class=line><span class=cl>                         <span class=p>(</span><span class=nf>vector</span>
</span></span><span class=line><span class=cl>                          <span class=p>(</span><span class=nf>format</span> <span class=s>&#34;%.3f&#34;</span> <span class=p>(</span><span class=nv>sanityinc/time-subtract-millis</span> <span class=nv>start-time</span> <span class=nv>before-init-time</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                          <span class=p>(</span><span class=nf>symbol-name</span> <span class=nv>feature</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                          <span class=p>(</span><span class=nf>format</span> <span class=s>&#34;%.3f&#34;</span> <span class=nv>millis</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>sanityinc/require-times</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Show a tabular view of how long various libraries took to load.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>with-current-buffer</span> <span class=p>(</span><span class=nf>get-buffer-create</span> <span class=s>&#34;*Require Times*&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>sanityinc/require-times-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>tabulated-list-revert</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>display-buffer</span> <span class=p>(</span><span class=nf>current-buffer</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>sanityinc/show-init-time</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>message</span> <span class=s>&#34;init completed in %.2fms&#34;</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>sanityinc/time-subtract-millis</span> <span class=nv>after-init-time</span> <span class=nv>before-init-time</span><span class=p>)))</span>
</span></span></code></pre></div><h3 id=path class=headerLink><a href=#path class=header-mark></a>PATH</h3><p>如果使用 emacs-plus, 会自动的添加到 path 当中，或者使用<a href=https://github.com/purcell/exec-path-from-shell target=_blank rel="noopener noreffer">purcell/exec-path-from-shell: Make Emacs use the $PATH set up by the user&rsquo;s shell</a>. 或者使用下面的配置.</p><p>这部份的配置来源：<a href=https://www.emacswiki.org/emacs/ExecPath target=_blank rel="noopener noreffer">EmacsWiki: Exec Path</a></p><p>不设置 <code>exec-path</code>, 在 MacOS 上有可能会提示找不到程序。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>set-exec-path-from-shell-PATH</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;This is particularly useful under Mac OS X and macOS.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>path-from-shell</span> <span class=p>(</span><span class=nv>replace-regexp-in-string</span>
</span></span><span class=line><span class=cl>                          <span class=s>&#34;[ \t\n]*$&#34;</span> <span class=s>&#34;&#34;</span> <span class=p>(</span><span class=nv>shell-command-to-string</span>
</span></span><span class=line><span class=cl>                                          <span class=s>&#34;$SHELL --login -c &#39;echo $PATH&#39;&#34;</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>setenv</span> <span class=s>&#34;PATH&#34;</span> <span class=nv>path-from-shell</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>setq</span> <span class=nv>exec-path</span> <span class=p>(</span><span class=nv>split-string</span> <span class=nv>path-from-shell</span> <span class=nv>path-separator</span><span class=p>))))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>set-exec-path-from-shell-PATH</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>require</span> <span class=ss>&#39;cl-lib</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>add-subdirs-to-load-path</span> <span class=p>(</span><span class=nv>search-dir</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let*</span> <span class=p>((</span><span class=nv>dir</span> <span class=p>(</span><span class=nf>file-name-as-directory</span> <span class=nv>search-dir</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>dolist</span> <span class=p>(</span><span class=nv>subdir</span>
</span></span><span class=line><span class=cl>         <span class=c1>;; 过滤出不必要的目录，提升Emacs启动速度</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>cl-remove-if</span>
</span></span><span class=line><span class=cl>      <span class=nf>#&#39;</span><span class=p>(</span><span class=nb>lambda</span> <span class=p>(</span><span class=nv>subdir</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nb>or</span>
</span></span><span class=line><span class=cl>           <span class=c1>;; 不是目录的文件都移除</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>not</span> <span class=p>(</span><span class=nf>file-directory-p</span> <span class=p>(</span><span class=nf>concat</span> <span class=nv>dir</span> <span class=nv>subdir</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>           <span class=c1>;; 父目录、 语言相关和版本控制目录都移除</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nf>member</span> <span class=nv>subdir</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;.&#34;</span> <span class=s>&#34;..&#34;</span>
</span></span><span class=line><span class=cl>                    <span class=s>&#34;dist&#34;</span> <span class=s>&#34;node_modules&#34;</span> <span class=s>&#34;__pycache__&#34;</span>
</span></span><span class=line><span class=cl>                    <span class=s>&#34;RCS&#34;</span> <span class=s>&#34;CVS&#34;</span> <span class=s>&#34;rcs&#34;</span> <span class=s>&#34;cvs&#34;</span> <span class=s>&#34;.git&#34;</span> <span class=s>&#34;.github&#34;</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nf>directory-files</span> <span class=nv>dir</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>subdir-path</span> <span class=p>(</span><span class=nf>concat</span> <span class=nv>dir</span> <span class=p>(</span><span class=nf>file-name-as-directory</span> <span class=nv>subdir</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>    <span class=c1>;; 目录下有 .el .so .dll 文件的路径才添加到 `load-path&#39; 中，提升Emacs启动速度</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nv>cl-some</span> <span class=nf>#&#39;</span><span class=p>(</span><span class=nb>lambda</span> <span class=p>(</span><span class=nv>subdir-file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nb>and</span> <span class=p>(</span><span class=nf>file-regular-p</span> <span class=p>(</span><span class=nf>concat</span> <span class=nv>subdir-path</span> <span class=nv>subdir-file</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=c1>;; .so .dll 文件指非Elisp语言编写的Emacs动态库</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=nf>member</span> <span class=p>(</span><span class=nv>file-name-extension</span> <span class=nv>subdir-file</span><span class=p>)</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;el&#34;</span> <span class=s>&#34;so&#34;</span> <span class=s>&#34;dll&#34;</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nf>directory-files</span> <span class=nv>subdir-path</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=c1>;; 注意：`add-to-list&#39; 函数的第三个参数必须为 t ，表示加到列表末尾</span>
</span></span><span class=line><span class=cl>      <span class=c1>;; 这样Emacs会从父目录到子目录的顺序搜索Elisp插件，顺序反过来会导致Emacs无法正常启动</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;load-path</span> <span class=nv>subdir-path</span> <span class=no>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>;; 继续递归搜索子目录</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>add-subdirs-to-load-path</span> <span class=nv>subdir-path</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-subdirs-to-load-path</span> <span class=s>&#34;~/.emacs.d/packages&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>;; (add-to-list &#39;load-path &#34;~/.emacs.d/packages&#34;)</span>
</span></span></code></pre></div><h3 id=utility-hooks-and-functions class=headerLink><a href=#utility-hooks-and-functions class=header-mark></a>Utility Hooks and Functions</h3><p>这个 <a href=https://github.com/ajgrf/on.el/tree/master/ target=_blank rel="noopener noreffer">ajgrf/on.el: Hooks for faster Emacs startup – GitHub mirror</a> 增加了一些有用的 hook，可以控制包的启动时机。</p><p>更多参见：<a href=https://github.com/emacs-magus target=_blank rel="noopener noreffer">emacs-magus</a>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>on</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=variables class=headerLink><a href=#variables class=header-mark></a>Variables</h3><p>定义一些变量，方便配置文件位置或针对特定系统进行相关设定。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defvar</span> <span class=nv>my-cloud</span> <span class=s>&#34;~/Nextcloud&#34;</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;This folder is My cloud.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>;; L.Personal.Galaxy location may change, but folders in this directory never change.</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defvar</span> <span class=nv>my-galaxy</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;L.Personal.Galaxy&#34;</span> <span class=nv>my-cloud</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;This folder stores all the plain text files of my life.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defvar</span> <span class=nv>website-directory</span> <span class=s>&#34;~/Nextcloud/L.Personal.Galaxy/website&#34;</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;The source folder of my blog.&#34;</span><span class=p>)</span>
</span></span></code></pre></div><p><a href=https://github.com/emacscollective/no-littering target=_blank rel="noopener noreffer">https://github.com/emacscollective/no-littering</a>, 会将一些包产生的文件集中放置到 etc 和 var 两个文件夹中，而不是散落在 user-emacs-directory 当中。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>no-littering</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=evil-modal-edit class=headerLink><a href=#evil-modal-edit class=header-mark></a>Evil modal edit</h3><p>在经历了多种尝试之后，我最终选择了 Evil 模式编辑，其他的模式编辑有 <a href=https://github.com/meow-edit/meow target=_blank rel="noopener noreffer">meow-edit/meow: Yet another modal editing on Emacs / 猫态编辑</a>.</p><p>我不使用 Meow 是因为它只能在 Emacs 中使用。</p><p>也曾经长时间使用过 Emacs 的原生按键方式，该体验在 Mac 系统上具有较好的一致性，但是原生按键方式有点费手。</p><h4 id=evil class=headerLink><a href=#evil class=header-mark></a>evil</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>evil</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span> <span class=p>(</span><span class=nb>:map</span> <span class=nv>evil-insert-state-map</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=s>&#34;C-e&#34;</span> <span class=o>.</span> <span class=nv>move-end-of-line</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=s>&#34;C-k&#34;</span> <span class=o>.</span> <span class=nv>kill-line</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>((</span><span class=nv>after-init</span> <span class=o>.</span> <span class=nv>evil-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>after-change-major-mode</span> <span class=o>.</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>                                      <span class=p>(</span><span class=nb>setq-local</span> <span class=nv>evil-shift-width</span> <span class=nv>tab-width</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>  <span class=nb>:init</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>evil-want-keybinding</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>evil-undo-system</span> <span class=ss>&#39;undo-fu</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>evil-respect-visual-line-mode</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>evil-visual-state-cursor</span> <span class=ss>&#39;hollow</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>evil-normal-state-tag</span> <span class=s>&#34; 𝐍 &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>evil-insert-state-tag</span> <span class=s>&#34; 𝐈 &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>evil-motion-state-tag</span> <span class=s>&#34; 𝐌 &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>evil-visual-state-tag</span> <span class=s>&#34; 𝐕 &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>evil-replace-state-tag</span> <span class=s>&#34; 𝐑 &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>evil-operator-state-tag</span> <span class=s>&#34; O &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>evil-emacs-state-tag</span> <span class=s>&#34; E &#34;</span><span class=p>))</span>
</span></span></code></pre></div><p>下面的配置来源：<a href=https://github.com/redguardtoo/emacs.d/blob/master/lisp/init-evil.el target=_blank rel="noopener noreffer">emacs.d/init-evil.el at master · redguardtoo/emacs.d</a></p><h4 id=evil-collection class=headerLink><a href=#evil-collection class=header-mark></a>evil-collection</h4><p><a href=https://github.com/emacs-evil/evil-collection target=_blank rel="noopener noreffer">emacs-evil/evil-collection: A set of keybindings for evil-mode</a> 设置 Major mode 下的按键绑定，比自己一一设置要方便。若没有你使用的，可以提 PR.</p><p>我使用 <code>SPC</code> 作为 <code>leader key</code>, 这个键在 evil-collection 的 major mode 中被配置成了其他的功能，可以通过设置 <code>evil-collection-key-blacklist</code> 禁用 <code>SPC</code> 键。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=c1>;; (with-eval-after-load &#39;evil</span>
</span></span><span class=line><span class=cl><span class=c1>;;   (evil-collection-init))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>evil-collection</span>
</span></span><span class=line><span class=cl>  <span class=nb>:after</span> <span class=nv>evil</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>evil-collection-key-blacklist</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;SPC&#34;</span> <span class=s>&#34;,&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>forge-add-default-bindings</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>evil-collection-init</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=evil-commentary class=headerLink><a href=#evil-commentary class=header-mark></a>evil-commentary</h4><p><a href=https://github.com/linktohack/evil-commentary target=_blank rel="noopener noreffer">linktohack/evil-commentary: Comment stuff out. A port of vim-commentary</a> 通过使用 <code>gcc</code> 添加注释，在 Mac 上可以通过使用 <code>s-/</code> 进行。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>evil-commentary</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>on-first-file</span> <span class=o>.</span> <span class=nv>evil-commentary-mode</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=evil-surround class=headerLink><a href=#evil-surround class=header-mark></a>evil-surround</h4><p><a href=https://github.com/emacs-evil/evil-surround target=_blank rel="noopener noreffer">emacs-evil/evil-surround: you will be surrounded (surround.vim for evil, the extensible vi layer)</a> 可以在指定的区域添加成对的符号，具体使用参见以上页面。</p><p>具体的使用是对于 visual 状态，使用 <code>S =</code> 来插入成对的等于号，其他的符号同理。若要修改的话，使用 <code>cs = *</code> 来将等于号改为星号，其他的符号同理。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>evil-surround</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>on-first-file</span> <span class=o>.</span> <span class=nv>global-evil-surround-mode</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=evil-embrace class=headerLink><a href=#evil-embrace class=header-mark></a>evil-embrace</h4><p><a href=https://github.com/cute-jumper/evil-embrace.el target=_blank rel="noopener noreffer">cute-jumper/evil-embrace.el: Evil integration of embrace.el</a> 具有和 evil-surround 相似的功能。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>evil-embrace</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>((</span><span class=nv>org-mode</span> <span class=o>.</span> <span class=nv>embrace-org-mode-hook</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>evil-embrace-enable-evil-surround-integration</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=which-key-mode class=headerLink><a href=#which-key-mode class=header-mark></a>which-key-mode</h4><p><a href=https://github.com/justbur/emacs-which-key target=_blank rel="noopener noreffer">justbur/emacs-which-key: Emacs package that displays available keybindings in popup</a> 可以提示按键，对于不常使用的按键序列，有时想不起来，有提示还是很方便的。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>which-key</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>on-first-input</span> <span class=o>.</span> <span class=nv>which-key-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>which-key-show-early-on-C-h</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>which-key-idle-delay</span> <span class=mi>10000</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>which-key-idle-secondary-delay</span> <span class=mf>0.05</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=general class=headerLink><a href=#general class=header-mark></a>general</h4><p><a href=https://github.com/noctuid/general.el target=_blank rel="noopener noreffer">noctuid/general.el: More convenient key definitions in emacs</a> 结合 Evil 可以设置一系列的按键绑定，相对于 Emacs 原生的按键方式，序列化的按键比较友好。</p><p>具体的使用方式见 package 的 README 文件。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>general</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>general-create-definer</span> <span class=nv>my/space-leader-def</span>
</span></span><span class=line><span class=cl>              <span class=nb>:prefix</span> <span class=s>&#34;SPC&#34;</span>
</span></span><span class=line><span class=cl>              <span class=nb>:non-normal-prefix</span> <span class=s>&#34;M-SPC&#34;</span>
</span></span><span class=line><span class=cl>              <span class=nb>:states</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>normal</span> <span class=nv>visual</span> <span class=nf>insert</span> <span class=nv>emacs</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>general-create-definer</span> <span class=nv>my/comma-leader-def</span>
</span></span><span class=line><span class=cl>              <span class=nb>:prefix</span> <span class=s>&#34;,&#34;</span>
</span></span><span class=line><span class=cl>              <span class=nb>:non-normal-prefix</span> <span class=s>&#34;M-,&#34;</span>
</span></span><span class=line><span class=cl>              <span class=nb>:states</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>normal</span> <span class=nv>visual</span> <span class=nf>insert</span> <span class=nv>emacs</span><span class=p>)))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my/emacs-config</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;My literate Emacs configuration.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>find-file</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;emacs.org&#34;</span> <span class=nv>user-emacs-directory</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>my/space-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;f&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nb>:ignore</span> <span class=no>t</span> <span class=nb>:wk</span> <span class=s>&#34;Files&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;fi&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>my/emacs-config</span> <span class=nb>:wk</span> <span class=s>&#34;Emacs configuration&#34;</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=epkg class=headerLink><a href=#epkg class=header-mark></a>epkg</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>epkg</span>
</span></span><span class=line><span class=cl>  <span class=nb>:commands</span> <span class=p>(</span><span class=nv>epkg-describe-package</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>my/space-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;p&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nb>:ignore</span> <span class=no>t</span> <span class=nb>:wk</span> <span class=s>&#34;Package management&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;pp&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>epkg-describe-package</span> <span class=nb>:wk</span> <span class=s>&#34;Epkg describe package&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>epkg-marginalia</span>
</span></span><span class=line><span class=cl>  <span class=nb>:after</span> <span class=p>(</span><span class=nv>epkg</span> <span class=nv>marginalia</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>cl-pushnew</span> <span class=ss>&#39;epkg-marginalia-annotate-package</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nv>alist-get</span> <span class=ss>&#39;package</span> <span class=nv>marginalia-annotator-registry</span><span class=p>)))</span>
</span></span></code></pre></div><h3 id=auto-save class=headerLink><a href=#auto-save class=header-mark></a>auto-save</h3><p><a href=https://github.com/manateelazycat/auto-save target=_blank rel="noopener noreffer">auto-save/auto-save.el at master · manateelazycat/auto-save</a> 我使用这个包进行文件的自动保存，Emacs 自带 `auto-save-visited-mode&rsquo;, 但是没有 auto-save 这个包好用。</p><p>主要的问题是 auto-save-visited-mode 在 org-capture 当中不能关闭自动删除空格。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>auto-save</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>on-first-file</span> <span class=o>.</span> <span class=nv>auto-save-enable</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>auto-save-silent</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>auto-save-delete-trailing-whitespace</span> <span class=no>t</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=auto-tangle class=headerLink><a href=#auto-tangle class=header-mark></a>Auto tangle</h3><p>使用 Literate programming 配置 Emacs 文件，使用它可以不用手动 tangle，文件保存后自动执行。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>org-auto-tangle</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>org-mode</span> <span class=o>.</span> <span class=nv>org-auto-tangle-mode</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=server class=headerLink><a href=#server class=header-mark></a>Server</h3><p>启用 Server 后可以使用 emacsclient 打开文件进行编辑，而不是新开一个 Emacs.</p><p>在 Mac 上使用 emacsclient 需要通过 automator 创建一个 application. 新建一个 run shell script 填入以下的内容。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>/opt/homebrew/bin/emacsclient -n -a -c <span class=s2>&#34;</span><span class=nv>$@</span><span class=s2>&#34;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>server</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>on-first-input</span> <span class=o>.</span> <span class=nv>server-start</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>defun</span> <span class=nv>my/start-server</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nv>not</span> <span class=p>(</span><span class=nv>server-running-p</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>server-start</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>message</span> <span class=s>&#34;Server has started&#34;</span><span class=p>)))</span>
</span></span></code></pre></div><p><a href=https://github.com/iqbalansari/restart-emacs target=_blank rel="noopener noreffer">iqbalansari/restart-emacs: A simple emacs package to restart emacs from within emacs</a> Emacs 29 中 restart-emacs 己是 builtin function。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>my/space-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;q&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nb>:ignore</span> <span class=no>t</span> <span class=nb>:wk</span> <span class=s>&#34;Quit/Restart&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;qR&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>restart-emacs</span> <span class=nb>:wk</span> <span class=s>&#34;Restart emacs&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;qq&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>server-force-delete</span> <span class=nb>:wk</span> <span class=s>&#34;Server Delete&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;qs&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>my/start-server</span> <span class=nb>:wk</span> <span class=s>&#34;Server Delete&#34;</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=magit class=headerLink><a href=#magit class=header-mark></a>Magit</h3><p><a href=https://github.com/magit/magit target=_blank rel="noopener noreffer">magit/magit: It&rsquo;s Magit! A Git Porcelain inside Emacs.</a> 是 Emacs 上的一大杀器应用，相对于命令行的方式使用 git 友好的很多。</p><p>通过 borg 安装 Magit 需要增加两行 load-path 的配置。使用时通过 <code>C-x g</code> 即可调用 Magit.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>[</span>submodule <span class=s2>&#34;magit&#34;</span><span class=o>]</span>
</span></span><span class=line><span class=cl>    <span class=nv>path</span> <span class=o>=</span> lib/magit
</span></span><span class=line><span class=cl>    <span class=nv>url</span> <span class=o>=</span> git@github.com:magit/magit.git
</span></span><span class=line><span class=cl>    load-path <span class=o>=</span> .
</span></span><span class=line><span class=cl>    load-path <span class=o>=</span> ./lisp
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>magit</span>
</span></span><span class=line><span class=cl>  <span class=nb>:commands</span> <span class=p>(</span><span class=nv>magit</span> <span class=nv>magit-status</span> <span class=nv>magit-submodule-add</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span> <span class=p>(</span><span class=s>&#34;C-x g&#34;</span> <span class=o>.</span> <span class=nv>magit</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:general</span> <span class=p>(</span><span class=nb>:keymaps</span> <span class=ss>&#39;with-editor-mode-map</span>
</span></span><span class=line><span class=cl>             <span class=s>&#34;RET&#34;</span> <span class=s>&#34;C-c C-c&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>magit-status-mode</span> <span class=o>.</span> <span class=nv>hide-mode-line-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>magit-add-section-hook</span> <span class=ss>&#39;magit-status-sections-hook</span>
</span></span><span class=line><span class=cl>              <span class=ss>&#39;magit-insert-modules</span>
</span></span><span class=line><span class=cl>              <span class=ss>&#39;magit-insert-unpulled-from-upstream</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>remove-hook</span> <span class=ss>&#39;magit-module-sections-hook</span> <span class=ss>&#39;magit-insert-modules-overview</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>remove-hook</span> <span class=ss>&#39;magit-module-sections-hook</span> <span class=ss>&#39;magit-insert-modules-unpulled-from-pushremote</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>remove-hook</span> <span class=ss>&#39;magit-module-sections-hook</span> <span class=ss>&#39;magit-insert-modules-unpushed-to-upstream</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>remove-hook</span> <span class=ss>&#39;magit-module-sections-hook</span> <span class=ss>&#39;magit-insert-modules-unpushed-to-pushremote</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>forge</span>
</span></span><span class=line><span class=cl>  <span class=nb>:after</span> <span class=nv>magit</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=browse-at-remote class=headerLink><a href=#browse-at-remote class=header-mark></a>browse-at-remote</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>browse-at-remote</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span> <span class=p>(</span><span class=s>&#34;C-c f b&#34;</span> <span class=o>.</span> <span class=nv>browse-at-remote</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>my/space-leader-def</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fb&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>browse-at-remote</span> <span class=nb>:wk</span> <span class=s>&#34;Browse remote&#34;</span><span class=p>)))</span>
</span></span></code></pre></div><h3 id=custom class=headerLink><a href=#custom class=header-mark></a>Custom</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>custom-file</span> <span class=p>(</span><span class=nv>locate-user-emacs-file</span> <span class=s>&#34;custom.el&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nf>file-exists-p</span> <span class=nv>custom-file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>load</span> <span class=nv>custom-file</span><span class=p>))</span>
</span></span></code></pre></div><h2 id=emacs-user-interface-delicious class=headerLink><a href=#emacs-user-interface-delicious class=header-mark></a>Emacs User Interface, Delicious</h2><h3 id=fonts class=headerLink><a href=#fonts class=header-mark></a>Fonts</h3><p><code>Insevka Fixed</code> 和 <code>Source Han Serif SC</code> 这两个字体等宽，在 org-mode 中可以对齐表格。</p><p>尝试过 <code>variable-pitch-mode</code> 和 <code>fixed-pitch-mode</code>, 不好用。</p><p>不设置 charset，在 MacOS 上默认使用 <code>PingFanc SC</code> 字体，看起来也可以。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>set-face-attribute</span> <span class=ss>&#39;default</span> <span class=no>nil</span> <span class=nb>:font</span> <span class=s>&#34;Iosevka Fixed&#34;</span> <span class=nb>:height</span> <span class=mi>160</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nv>display-graphic-p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>dolist</span> <span class=p>(</span><span class=nv>charset</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>kana</span> <span class=nv>han</span> <span class=nv>cjk-misc</span> <span class=nv>bopomofo</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nf>set-fontset-font</span> <span class=p>(</span><span class=nf>frame-parameter</span> <span class=no>nil</span> <span class=ss>&#39;font</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                        <span class=nv>charset</span> <span class=p>(</span><span class=nf>font-spec</span> <span class=nb>:family</span> <span class=s>&#34;Source Han Serif SC&#34;</span> <span class=nb>:height</span> <span class=mi>160</span><span class=p>))</span> <span class=no>t</span> <span class=ss>&#39;prepend</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=themes class=headerLink><a href=#themes class=header-mark></a>Themes</h3><p>当前内置的 Modus-themes 主题看起来很好，I like it.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>modus-themes</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>modus-themes-bold-constructs</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>modus-themes-italic-constructs</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>modus-themes-common-palette-overrides</span>
</span></span><span class=line><span class=cl>    <span class=o>&#39;</span><span class=p>(</span><span class=c1>;; mode-line</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>border-mode-line-active</span> <span class=nv>unspecified</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>border-mode-line-inactive</span> <span class=nv>unspecified</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>bg-mode-line-active</span> <span class=nv>bg-main</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>fg-mode-line-active</span> <span class=nv>fg-main</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=c1>;; line-number</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>fg-line-number-inactive</span> <span class=s>&#34;gray50&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>fg-line-number-active</span> <span class=nv>red-cooler</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>bg-line-number-inactive</span> <span class=nv>unspecified</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>bg-line-number-active</span> <span class=nv>unspecified</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=c1>;; link</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>underline-link</span> <span class=nv>border</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>underline-link-visited</span> <span class=nv>border</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>underline-link-symbolic</span> <span class=nv>border</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=c1>;; org agenda</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>date-common</span> <span class=nv>cyan</span><span class=p>)</span>   <span class=c1>; default value (for timestamps and more)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>date-deadline</span> <span class=nv>red-warmer</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>date-event</span> <span class=nv>magenta-warmer</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>date-holiday</span> <span class=nv>blue</span><span class=p>)</span> <span class=c1>; for M-x calendar</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>date-now</span> <span class=nv>yellow-warmer</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>date-scheduled</span> <span class=nv>magenta-cooler</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>date-weekday</span> <span class=nv>cyan-cooler</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>date-weekend</span> <span class=nv>blue-faint</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=c1>;; org heading</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>fg-heading-1</span> <span class=nv>blue-warmer</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>fg-heading-2</span> <span class=nv>yellow-cooler</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>fg-heading-3</span> <span class=nv>cyan-cooler</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>modus-themes-prompts</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>extrabold</span> <span class=nv>italic</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>modus-themes-completions</span>
</span></span><span class=line><span class=cl>    <span class=o>&#39;</span><span class=p>((</span><span class=nv>matches</span> <span class=o>.</span> <span class=p>(</span><span class=nv>extrabold</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>selection</span> <span class=o>.</span> <span class=p>(</span><span class=nv>semibold</span> <span class=nv>italic</span> <span class=nv>text-also</span><span class=p>)))))</span>
</span></span></code></pre></div><h4 id=theme-switch class=headerLink><a href=#theme-switch class=header-mark></a>Theme switch</h4><p>emacs-plus can switch themes by system. 通过增加的补定实现的此功能，若是不使用这种方法，还有 <a href=https://github.com/LionyxML/auto-dark-emacs target=_blank rel="noopener noreffer">auto-dark-emacs</a> 可以使用。</p><p>使用 <a href=https://github.com/mclear-tools/build-emacs-macos/tree/main/ target=_blank rel="noopener noreffer">mclear-tools/build-emacs-macos: Build script for emacs and macos</a> 自编译 Emacs 也有改变主题的 patch.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my/apply-theme</span> <span class=p>(</span><span class=nv>appearance</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Load theme, taking current system APPEARANCE into consideration.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>mapc</span> <span class=nf>#&#39;</span><span class=nv>disable-theme</span> <span class=nv>custom-enabled-themes</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>pcase</span> <span class=nv>appearance</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=ss>&#39;light</span> <span class=p>(</span><span class=nv>load-theme</span> <span class=ss>&#39;modus-operandi</span> <span class=no>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=ss>&#39;dark</span> <span class=p>(</span><span class=nv>load-theme</span> <span class=ss>&#39;modus-vivendi</span> <span class=no>t</span><span class=p>))))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;ns-system-appearance-change-functions</span> <span class=nf>#&#39;</span><span class=nv>my/apply-theme</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=all-the-icons class=headerLink><a href=#all-the-icons class=header-mark></a>all-the-icons</h3><p>这里使用了<a href=https://github.com/domtronn/all-the-icons.el target=_blank rel="noopener noreffer">domtronn/all-the-icons.el: A utility package to collect various Icon Fonts and propertize them within Emacs.</a></p><p>需要自己执行 all-the-icons-install-fonts 来安装对应的字体。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nf>set-fontset-font</span> <span class=no>t</span> <span class=ss>&#39;unicode</span> <span class=p>(</span><span class=nf>font-spec</span> <span class=nb>:family</span> <span class=s>&#34;Material Icons&#34;</span><span class=p>)</span> <span class=no>nil</span> <span class=ss>&#39;prepend</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nf>set-fontset-font</span> <span class=no>t</span> <span class=ss>&#39;unicode</span> <span class=p>(</span><span class=nf>font-spec</span> <span class=nb>:family</span> <span class=s>&#34;file-icons&#34;</span><span class=p>)</span> <span class=no>nil</span> <span class=ss>&#39;prepend</span><span class=p>)</span>
</span></span></code></pre></div><p>这部份的配置来源：<a href=https://github.com/seagle0128/.emacs.d target=_blank rel="noopener noreffer">seagle0128/.emacs.d: Centaur Emacs - A Fancy and Fast Emacs Configuration</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>all-the-icons</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>extension-icon-alist</span>
</span></span><span class=line><span class=cl>         <span class=o>&#39;</span><span class=p>((</span><span class=s>&#34;bat&#34;</span>  <span class=nv>all-the-icons-alltheicon</span> <span class=s>&#34;terminal&#34;</span> <span class=nb>:face</span> <span class=nv>all-the-icons-lsilver</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=s>&#34;cmd&#34;</span>  <span class=nv>all-the-icons-alltheicon</span> <span class=s>&#34;terminal&#34;</span> <span class=nb>:face</span> <span class=nv>all-the-icons-lsilver</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=s>&#34;conf&#34;</span> <span class=nv>all-the-icons-octicon</span> <span class=s>&#34;settings&#34;</span>    <span class=nb>:v-adjust</span> <span class=mf>0.0</span> <span class=nb>:face</span> <span class=nv>all-the-icons-yellow</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=s>&#34;eln&#34;</span>  <span class=nv>all-the-icons-octicon</span> <span class=s>&#34;file-binary&#34;</span> <span class=nb>:v-adjust</span> <span class=mf>0.0</span> <span class=nb>:face</span> <span class=nv>all-the-icons-dsilver</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=s>&#34;epub&#34;</span> <span class=nv>all-the-icons-faicon</span> <span class=s>&#34;book&#34;</span>         <span class=nb>:height</span> <span class=mf>1.0</span> <span class=nb>:v-adjust</span> <span class=mf>-0.1</span> <span class=nb>:face</span> <span class=nv>all-the-icons-green</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=s>&#34;exe&#34;</span>  <span class=nv>all-the-icons-octicon</span> <span class=s>&#34;file-binary&#34;</span> <span class=nb>:v-adjust</span> <span class=mf>0.0</span> <span class=nb>:face</span> <span class=nv>all-the-icons-dsilver</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=s>&#34;make&#34;</span> <span class=nv>all-the-icons-fileicon</span> <span class=s>&#34;gnu&#34;</span>        <span class=nb>:face</span> <span class=nv>all-the-icons-dorange</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=s>&#34;rss&#34;</span>  <span class=nv>all-the-icons-octicon</span> <span class=s>&#34;rss&#34;</span>         <span class=nb>:height</span> <span class=mf>1.1</span> <span class=nb>:v-adjust</span> <span class=mf>0.0</span> <span class=nb>:face</span> <span class=nv>all-the-icons-lorange</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=s>&#34;toml&#34;</span> <span class=nv>all-the-icons-octicon</span> <span class=s>&#34;settings&#34;</span>    <span class=nb>:v-adjust</span> <span class=mf>0.0</span> <span class=nb>:face</span> <span class=nv>all-the-icons-yellow</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=s>&#34;tsx&#34;</span>  <span class=nv>all-the-icons-fileicon</span> <span class=s>&#34;tsx&#34;</span>        <span class=nb>:height</span> <span class=mf>1.0</span> <span class=nb>:v-adjust</span> <span class=mf>-0.1</span> <span class=nb>:face</span> <span class=nv>all-the-icons-cyan-alt</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=s>&#34;xpm&#34;</span>  <span class=nv>all-the-icons-octicon</span> <span class=s>&#34;file-media&#34;</span>  <span class=nb>:v-adjust</span> <span class=mf>0.0</span> <span class=nb>:face</span> <span class=nv>all-the-icons-dgreen</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>dolist</span> <span class=p>(</span><span class=nv>icon</span> <span class=nv>extension-icon-alist</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;all-the-icons-extension-icon-alist</span> <span class=nv>icon</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>regexp-icon-alist</span>
</span></span><span class=line><span class=cl>         <span class=o>&#39;</span><span class=p>((</span><span class=s>&#34;\\.[bB][iI][nN]$&#34;</span>               <span class=nv>all-the-icons-octicon</span> <span class=s>&#34;file-binary&#34;</span> <span class=nb>:v-adjust</span> <span class=mf>0.0</span> <span class=nb>:face</span> <span class=nv>all-the-icons-yellow</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=s>&#34;^config$&#34;</span>                       <span class=nv>all-the-icons-octicon</span> <span class=s>&#34;settings&#34;</span>    <span class=nb>:v-adjust</span> <span class=mf>0.0</span> <span class=nb>:face</span> <span class=nv>all-the-icons-dorange</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=s>&#34;\\.\\(ba\\|z\\)shrc$&#34;</span>           <span class=nv>all-the-icons-alltheicon</span> <span class=s>&#34;script&#34;</span>   <span class=nb>:height</span> <span class=mf>0.9</span> <span class=nb>:face</span> <span class=nv>all-the-icons-dpink</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=s>&#34;\\.\\(bash\\|zsh\\)*_?profile$&#34;</span> <span class=nv>all-the-icons-alltheicon</span> <span class=s>&#34;script&#34;</span>   <span class=nb>:height</span> <span class=mf>0.9</span> <span class=nb>:face</span> <span class=nv>all-the-icons-dred</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=s>&#34;\\.\\(ba\\|z\\)sh_history$&#34;</span>     <span class=nv>all-the-icons-alltheicon</span> <span class=s>&#34;script&#34;</span>   <span class=nb>:height</span> <span class=mf>0.9</span> <span class=nb>:face</span> <span class=nv>all-the-icons-dsilver</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=s>&#34;\\.zshenv$&#34;</span>                     <span class=nv>all-the-icons-alltheicon</span> <span class=s>&#34;script&#34;</span>   <span class=nb>:height</span> <span class=mf>0.9</span> <span class=nb>:face</span> <span class=nv>all-the-icons-dred</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=s>&#34;Cask\\&#39;&#34;</span>                        <span class=nv>all-the-icons-fileicon</span> <span class=s>&#34;elisp&#34;</span>      <span class=nb>:height</span> <span class=mf>1.0</span> <span class=nb>:v-adjust</span> <span class=mf>-0.2</span> <span class=nb>:face</span> <span class=nv>all-the-icons-blue</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=s>&#34;NEWS$&#34;</span>                          <span class=nv>all-the-icons-faicon</span> <span class=s>&#34;newspaper-o&#34;</span>  <span class=nb>:height</span> <span class=mf>0.9</span> <span class=nb>:v-adjust</span> <span class=mf>-0.2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=s>&#34;^Rakefile$&#34;</span>                     <span class=nv>all-the-icons-alltheicon</span> <span class=s>&#34;ruby-alt&#34;</span> <span class=nb>:face</span> <span class=nv>all-the-icons-red</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>dolist</span> <span class=p>(</span><span class=nv>icon</span> <span class=nv>regexp-icon-alist</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;all-the-icons-regexp-icon-alist</span> <span class=nv>icon</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>mode-icon-alist</span>
</span></span><span class=line><span class=cl>         <span class=o>&#39;</span><span class=p>((</span><span class=nv>xwidget-webkit-mode</span>           <span class=nv>all-the-icons-faicon</span> <span class=s>&#34;chrome&#34;</span>          <span class=nb>:v-adjust</span> <span class=mf>-0.1</span> <span class=nb>:face</span> <span class=nv>all-the-icons-blue</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>bongo-playlist-mode</span>           <span class=nv>all-the-icons-material</span> <span class=s>&#34;queue_music&#34;</span>   <span class=nb>:height</span> <span class=mf>1.3</span> <span class=nb>:face</span> <span class=nv>all-the-icons-green</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>bongo-library-mode</span>            <span class=nv>all-the-icons-material</span> <span class=s>&#34;library_music&#34;</span> <span class=nb>:height</span> <span class=mf>1.1</span> <span class=nb>:face</span> <span class=nv>all-the-icons-green</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>simple-mpc-mode</span>               <span class=nv>all-the-icons-faicon</span> <span class=s>&#34;music&#34;</span>           <span class=nb>:v-adjust</span> <span class=mf>-0.1</span> <span class=nb>:face</span> <span class=nv>all-the-icons-green</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>mingus-playlist-mode</span>          <span class=nv>all-the-icons-faicon</span> <span class=s>&#34;music&#34;</span>           <span class=nb>:v-adjust</span> <span class=mf>-0.1</span> <span class=nb>:face</span> <span class=nv>all-the-icons-green</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>mingus-help-mode</span>              <span class=nv>all-the-icons-material</span> <span class=s>&#34;music_note&#34;</span>    <span class=nb>:height</span> <span class=mf>1.2</span> <span class=nb>:face</span> <span class=nv>all-the-icons-green</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>mingus-browse-mode</span>            <span class=nv>all-the-icons-material</span> <span class=s>&#34;library_music&#34;</span> <span class=nb>:height</span> <span class=mf>1.1</span> <span class=nb>:face</span> <span class=nv>all-the-icons-green</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>mingus-burn-mode</span>              <span class=nv>all-the-icons-material</span> <span class=s>&#34;queue_music&#34;</span>   <span class=nb>:height</span> <span class=mf>1.3</span> <span class=nb>:face</span> <span class=nv>all-the-icons-green</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>gnus-group-mode</span>               <span class=nv>all-the-icons-fileicon</span> <span class=s>&#34;gnu&#34;</span>           <span class=nb>:face</span> <span class=nv>all-the-icons-silver</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>gnus-summary-mode</span>             <span class=nv>all-the-icons-octicon</span> <span class=s>&#34;inbox&#34;</span>          <span class=nb>:height</span> <span class=mf>1.0</span> <span class=nb>:v-adjust</span> <span class=mf>0.0</span> <span class=nb>:face</span> <span class=nv>all-the-icons-orange</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>gnus-article-mode</span>             <span class=nv>all-the-icons-octicon</span> <span class=s>&#34;mail&#34;</span>           <span class=nb>:height</span> <span class=mf>1.1</span> <span class=nb>:v-adjust</span> <span class=mf>0.0</span> <span class=nb>:face</span> <span class=nv>all-the-icons-lblue</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>message-mode</span>                  <span class=nv>all-the-icons-octicon</span> <span class=s>&#34;mail&#34;</span>           <span class=nb>:height</span> <span class=mf>1.1</span> <span class=nb>:v-adjust</span> <span class=mf>0.0</span> <span class=nb>:face</span> <span class=nv>all-the-icons-lblue</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>diff-mode</span>                     <span class=nv>all-the-icons-octicon</span> <span class=s>&#34;git-compare&#34;</span>    <span class=nb>:v-adjust</span> <span class=mf>0.0</span> <span class=nb>:face</span> <span class=nv>all-the-icons-lred</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>flycheck-error-list-mode</span>      <span class=nv>all-the-icons-octicon</span> <span class=s>&#34;checklist&#34;</span>      <span class=nb>:height</span> <span class=mf>1.1</span> <span class=nb>:v-adjust</span> <span class=mf>0.0</span> <span class=nb>:face</span> <span class=nv>all-the-icons-lred</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>newsticker-mode</span>               <span class=nv>all-the-icons-faicon</span> <span class=s>&#34;rss-square&#34;</span>      <span class=nb>:v-adjust</span> <span class=mf>-0.1</span> <span class=nb>:face</span> <span class=nv>all-the-icons-orange</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>newsticker-treeview-mode</span>      <span class=nv>all-the-icons-faicon</span> <span class=s>&#34;rss-square&#34;</span>      <span class=nb>:v-adjust</span> <span class=mf>-0.1</span> <span class=nb>:face</span> <span class=nv>all-the-icons-orange</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>newsticker-treeview-list-mode</span> <span class=nv>all-the-icons-octicon</span> <span class=s>&#34;rss&#34;</span>            <span class=nb>:height</span> <span class=mf>1.1</span> <span class=nb>:v-adjust</span> <span class=mf>0.0</span> <span class=nb>:face</span> <span class=nv>all-the-icons-orange</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>newsticker-treeview-item-mode</span> <span class=nv>all-the-icons-octicon</span> <span class=s>&#34;rss&#34;</span>            <span class=nb>:height</span> <span class=mf>1.1</span> <span class=nb>:v-adjust</span> <span class=mf>0.0</span> <span class=nb>:face</span> <span class=nv>all-the-icons-lorange</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>conf-mode</span>                     <span class=nv>all-the-icons-octicon</span> <span class=s>&#34;settings&#34;</span>       <span class=nb>:v-adjust</span> <span class=mf>0.0</span> <span class=nb>:face</span> <span class=nv>all-the-icons-yellow</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>conf-space-mode</span>               <span class=nv>all-the-icons-octicon</span> <span class=s>&#34;settings&#34;</span>       <span class=nb>:v-adjust</span> <span class=mf>0.0</span> <span class=nb>:face</span> <span class=nv>all-the-icons-yellow</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>gitconfig-mode</span>                <span class=nv>all-the-icons-octicon</span> <span class=s>&#34;settings&#34;</span>       <span class=nb>:v-adjust</span> <span class=mf>0.0</span> <span class=nb>:face</span> <span class=nv>all-the-icons-dorange</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>forge-topic-mode</span>              <span class=nv>all-the-icons-alltheicon</span> <span class=s>&#34;git&#34;</span>         <span class=nb>:face</span> <span class=nv>all-the-icons-blue</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>help-mode</span>                     <span class=nv>all-the-icons-faicon</span> <span class=s>&#34;info-circle&#34;</span>     <span class=nb>:height</span> <span class=mf>1.1</span> <span class=nb>:v-adjust</span> <span class=mf>-0.1</span> <span class=nb>:face</span> <span class=nv>all-the-icons-purple</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>helpful-mode</span>                  <span class=nv>all-the-icons-faicon</span> <span class=s>&#34;info-circle&#34;</span>     <span class=nb>:height</span> <span class=mf>1.1</span> <span class=nb>:v-adjust</span> <span class=mf>-0.1</span> <span class=nb>:face</span> <span class=nv>all-the-icons-purple</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>Info-mode</span>                     <span class=nv>all-the-icons-faicon</span> <span class=s>&#34;info-circle&#34;</span>     <span class=nb>:height</span> <span class=mf>1.1</span> <span class=nb>:v-adjust</span> <span class=mf>-0.1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>cask-mode</span>                     <span class=nv>all-the-icons-fileicon</span> <span class=s>&#34;elisp&#34;</span>         <span class=nb>:height</span> <span class=mf>1.0</span> <span class=nb>:v-adjust</span> <span class=mf>-0.2</span> <span class=nb>:face</span> <span class=nv>all-the-icons-blue</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>ein:notebooklist-mode</span>         <span class=nv>all-the-icons-faicon</span> <span class=s>&#34;book&#34;</span>            <span class=nb>:face</span> <span class=nv>all-the-icons-lorange</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>ein:notebook-mode</span>             <span class=nv>all-the-icons-fileicon</span> <span class=s>&#34;jupyter&#34;</span>       <span class=nb>:height</span> <span class=mf>1.2</span> <span class=nb>:face</span> <span class=nv>all-the-icons-orange</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>ein:notebook-multilang-mode</span>   <span class=nv>all-the-icons-fileicon</span> <span class=s>&#34;jupyter&#34;</span>       <span class=nb>:height</span> <span class=mf>1.2</span> <span class=nb>:face</span> <span class=nv>all-the-icons-dorange</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>nov-mode</span>                      <span class=nv>all-the-icons-faicon</span> <span class=s>&#34;book&#34;</span>            <span class=nb>:height</span> <span class=mf>1.0</span> <span class=nb>:v-adjust</span> <span class=mf>-0.1</span> <span class=nb>:face</span> <span class=nv>all-the-icons-green</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>gfm-mode</span>                      <span class=nv>all-the-icons-octicon</span> <span class=s>&#34;markdown&#34;</span>       <span class=nb>:face</span> <span class=nv>all-the-icons-lblue</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>osx-dictionary-mode</span>           <span class=nv>all-the-icons-material</span> <span class=s>&#34;library_books&#34;</span> <span class=nb>:face</span> <span class=nv>all-the-icons-lblue</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>youdao-dictionary-mode</span>        <span class=nv>all-the-icons-material</span> <span class=s>&#34;library_books&#34;</span> <span class=nb>:face</span> <span class=nv>all-the-icons-lblue</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>fanyi-mode</span>                    <span class=nv>all-the-icons-material</span> <span class=s>&#34;library_books&#34;</span> <span class=nb>:face</span> <span class=nv>all-the-icons-lblue</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>dolist</span> <span class=p>(</span><span class=nv>icon</span> <span class=nv>mode-icon-alist</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;all-the-icons-mode-icon-alist</span> <span class=nv>icon</span><span class=p>))))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>all-the-icons-completion</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>((</span><span class=nv>minibuffer-setup</span> <span class=o>.</span> <span class=nv>all-the-icons-completion-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>marginalia-mode</span> <span class=o>.</span> <span class=nv>all-the-icons-completion-marginalia-setup</span><span class=p>)))</span>
</span></span></code></pre></div><h3 id=fringe-mode class=headerLink><a href=#fringe-mode class=header-mark></a>fringe-mode</h3><p>因为我要使用 <a href=#org-transclusion rel>org-transclusion</a>, 所以不能默认不显示 fringe. 将其设置为最小模式。</p><p>fringe-mode 需要跟一个 cons cell, 直接使用 minimal 会报错。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nf>define-fringe-bitmap</span> <span class=ss>&#39;right-curly-arrow</span>  <span class=p>[])</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nf>define-fringe-bitmap</span> <span class=ss>&#39;left-curly-arrow</span>  <span class=p>[])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>fringe-mode</span> <span class=o>&#39;</span><span class=p>(</span><span class=mi>1</span> <span class=o>.</span> <span class=mi>1</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=hl-line-mode class=headerLink><a href=#hl-line-mode class=header-mark></a>hl-line-mode</h3><p>高亮当前行，全局开启使用 <code>global-hl-line-mode</code>.</p><p>不使用 <code>global-hl-line-mode</code> 因为不想在 dashboard 中开启行高亮。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;prog-mode-hook</span> <span class=ss>&#39;hl-line-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;org-mode-hook</span> <span class=ss>&#39;hl-line-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=line-numbers class=headerLink><a href=#line-numbers class=header-mark></a>line numbers</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq-default</span> <span class=nv>display-line-numbers-widen</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;prog-mode-hook</span> <span class=ss>&#39;display-line-numbers-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;org-mode-hook</span> <span class=ss>&#39;display-line-numbers-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;LaTeX-mode-hook</span> <span class=ss>&#39;display-line-numbers-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=scroll-bar-mode class=headerLink><a href=#scroll-bar-mode class=header-mark></a>scroll-bar-mode</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>scroll-bar-mode</span> <span class=mi>0</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=fill-column-indicator class=headerLink><a href=#fill-column-indicator class=header-mark></a>fill column indicator</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq-default</span> <span class=nv>fill-column</span> <span class=mi>90</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>face-spec-set</span> <span class=ss>&#39;fill-column-indicator</span>
</span></span><span class=line><span class=cl>               <span class=o>&#39;</span><span class=p>((</span><span class=nv>default</span> <span class=nb>:height</span> <span class=mf>0.1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>               <span class=ss>&#39;face-override-spec</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>;; only show fill indicator in prog mode.</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;prog-mode-hook</span> <span class=ss>&#39;display-fill-column-indicator-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=paren class=headerLink><a href=#paren class=header-mark></a>Paren</h3><p>显示对应的括号，这个在 elisp 中挺友好。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>show-paren-style</span> <span class=ss>&#39;parenthesis</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>show-paren-context-when-offscreen</span> <span class=ss>&#39;overlay</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;text-mode-hook</span> <span class=ss>&#39;show-paren-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=cursor-and-color class=headerLink><a href=#cursor-and-color class=header-mark></a>Cursor and color</h3><p>默认关闭光标闪烁。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>blink-cursor-mode</span> <span class=mi>-1</span><span class=p>)</span>
</span></span></code></pre></div><p>使用 Evil，通过光标的颜色来提示当前的输入法状态，结合使用<a href=http://zzzm.ysepan.com/ target=_blank rel="noopener noreffer">三码郑码 / 至至郑码 （至简·至爱）zhengma.plus</a> 输入法，具有很好的使用体验，相当的明确感。</p><p>关于光标自动更换颜色，这里有个包可以使用：<a href=https://github.com/Eason0210/im-cursor-chg target=_blank rel="noopener noreffer">Eason0210/im-cursor-chg</a>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>im--chinese-p</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Check if the current input state is Chinese.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nb>featurep</span> <span class=ss>&#39;rime</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>and</span> <span class=p>(</span><span class=nv>rime--should-enable-p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>not</span> <span class=p>(</span><span class=nv>rime--should-inline-ascii-p</span><span class=p>))</span>
</span></span><span class=line><span class=cl>           <span class=nv>current-input-method</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nv>current-input-method</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>im-change-cursor-color</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Set cursor color depending on input method.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>set-cursor-color</span> <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nv>im--chinese-p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                        <span class=s>&#34;red&#34;</span>
</span></span><span class=line><span class=cl>                      <span class=p>(</span><span class=nv>foreground-color-at-point</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;post-command-hook</span> <span class=ss>&#39;im-change-cursor-color</span><span class=p>)</span>
</span></span></code></pre></div><p><a href=https://emacs-china.org/t/topic/17717/42 target=_blank rel="noopener noreffer">切换输入法时自动更换光标颜色 - Emacs-general - Emacs China</a> 提到了 <code>post-command-hook</code> 的开销比较大，调用频繁。</p><p>使用 evil 内置的 hook 也可以达到切换光标颜色的功能，同时避免 <code>post-command-hook</code> 的巨大开销。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>im--chinese-p</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Check if the current input state is Chinese.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nb>featurep</span> <span class=ss>&#39;rime</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>and</span> <span class=p>(</span><span class=nv>rime--should-enable-p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>not</span> <span class=p>(</span><span class=nv>rime--should-inline-ascii-p</span><span class=p>))</span>
</span></span><span class=line><span class=cl>           <span class=nv>current-input-method</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nv>current-input-method</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;evil-insert-state-entry-hook</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nv>im--chinese-p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nv>set-cursor-color</span> <span class=s>&#34;red&#34;</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;evil-insert-state-exit-hook</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nv>set-cursor-color</span> <span class=p>(</span><span class=nv>foreground-color-at-point</span><span class=p>))))</span>
</span></span></code></pre></div><h3 id=frame class=headerLink><a href=#frame class=header-mark></a>Frame</h3><p>窗口透明，更多见：<a href=https://emacs-china.org/t/emacs/2405/11 target=_blank rel="noopener noreffer">Emacs 透明窗口 - Emacs-general - Emacs China</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>set-frame-parameter</span> <span class=no>nil</span> <span class=ss>&#39;alpha</span> <span class=o>&#39;</span><span class=p>(</span><span class=mi>100</span> <span class=o>.</span> <span class=mi>100</span><span class=p>))</span>
</span></span></code></pre></div><p>在 MacOS 上新建的 frame 总是位于屏幕的左上角。解决方案：<a href=https://christiantietze.de/posts/2021/06/emacs-center-window/ target=_blank rel="noopener noreffer">Automatically Center New Emacs Windows (Aka Frames) on Screen • Christian Tietze</a>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>ct/frame-center</span> <span class=p>(</span><span class=kp>&amp;optional</span> <span class=nv>frame</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Center a frame on the screen.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let*</span> <span class=p>((</span><span class=nv>frame</span> <span class=p>(</span><span class=nb>or</span> <span class=p>(</span><span class=nb>and</span> <span class=p>(</span><span class=nf>boundp</span> <span class=ss>&#39;frame</span><span class=p>)</span> <span class=nv>frame</span><span class=p>)</span> <span class=p>(</span><span class=nf>selected-frame</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>center</span> <span class=p>(</span><span class=nv>ct/frame-get-center</span> <span class=nv>frame</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>apply</span> <span class=ss>&#39;set-frame-position</span> <span class=p>(</span><span class=nv>flatten-list</span> <span class=p>(</span><span class=nf>list</span> <span class=nv>frame</span> <span class=nv>center</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>ct/screen-usable-height</span> <span class=p>(</span><span class=kp>&amp;optional</span> <span class=nv>display</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Return the usable height of the display.
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>Some window-systems have portions of the screen which Emacs
</span></span></span><span class=line><span class=cl><span class=s>cannot address. This function should return the height of the
</span></span></span><span class=line><span class=cl><span class=s>screen, minus anything which is not usable.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>-</span> <span class=p>(</span><span class=nv>display-pixel-height</span> <span class=nv>display</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=p>(</span><span class=nb>cond</span> <span class=p>((</span><span class=nf>eq</span> <span class=nf>window-system</span> <span class=ss>&#39;ns</span><span class=p>)</span> <span class=mi>22</span><span class=p>)</span> <span class=c1>;; macOS Menu Bar offset</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=no>t</span> <span class=mi>0</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>ct/screen-usable-width</span> <span class=p>(</span><span class=kp>&amp;optional</span> <span class=nv>display</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Return the usable width of the display.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>display-pixel-width</span> <span class=nv>display</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>ct/center-box</span> <span class=p>(</span><span class=nv>w</span> <span class=nv>h</span> <span class=nv>cw</span> <span class=nv>ch</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Center a box inside another box.
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>Returns a list of `(TOP LEFT)&#39; representing the centered position
</span></span></span><span class=line><span class=cl><span class=s>of the box `(w h)&#39; inside the box `(cw ch)&#39;.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>list</span> <span class=p>(</span><span class=nf>/</span> <span class=p>(</span><span class=nf>-</span> <span class=nv>cw</span> <span class=nv>w</span><span class=p>)</span> <span class=mi>2</span><span class=p>)</span> <span class=p>(</span><span class=nf>/</span> <span class=p>(</span><span class=nf>-</span> <span class=nv>ch</span> <span class=nv>h</span><span class=p>)</span> <span class=mi>2</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>ct/frame-get-center</span> <span class=p>(</span><span class=nv>frame</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Return the center position of FRAME on it&#39;s display.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>disp</span> <span class=p>(</span><span class=nf>frame-parameter</span> <span class=nv>frame</span> <span class=ss>&#39;display</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>ct/center-box</span> <span class=p>(</span><span class=nf>frame-pixel-width</span> <span class=nv>frame</span><span class=p>)</span> <span class=p>(</span><span class=nf>frame-pixel-height</span> <span class=nv>frame</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                   <span class=p>(</span><span class=nv>ct/screen-usable-width</span> <span class=nv>disp</span><span class=p>)</span> <span class=p>(</span><span class=nv>ct/screen-usable-height</span> <span class=nv>disp</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>ct/frame-center</span> <span class=p>(</span><span class=kp>&amp;optional</span> <span class=nv>frame</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Center a frame on the screen.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>apply</span> <span class=ss>&#39;set-frame-position</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nb>let*</span> <span class=p>((</span><span class=nv>frame</span> <span class=p>(</span><span class=nb>or</span> <span class=p>(</span><span class=nb>and</span> <span class=p>(</span><span class=nf>boundp</span> <span class=ss>&#39;frame</span><span class=p>)</span> <span class=nv>frame</span><span class=p>)</span> <span class=p>(</span><span class=nf>selected-frame</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=nv>center</span> <span class=p>(</span><span class=nv>ct/frame-get-center</span> <span class=nv>frame</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>           <span class=c1>;; Flatten the X/Y list in `center` into a single list with `frame`</span>
</span></span><span class=line><span class=cl>           <span class=c1>;; so this list can be applied as parameters to `set-frame-position`:</span>
</span></span><span class=line><span class=cl>           <span class=o>`</span><span class=p>(</span><span class=o>,</span><span class=nv>frame</span> <span class=o>,@</span><span class=nv>center</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;after-make-frame-functions</span> <span class=nf>#&#39;</span><span class=nv>ct/frame-center</span> <span class=mi>0</span><span class=p>)</span>
</span></span></code></pre></div><p>默认的 make-frame 的按键是 <code>s-n</code>, 使用修改的函数实现了同一个按键，两种形为。我默认的 frame 是全屏使用，只在少数时候使用 make-frame 的功能。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my/make-or-delete-frame</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nf>=</span> <span class=p>(</span><span class=nv>frame-width</span><span class=p>)</span> <span class=mi>80</span><span class=p>)</span> <span class=c1>;; 80 is the default frame width.</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nf>delete-frame</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>make-frame</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;s-n&#34;</span><span class=p>)</span> <span class=ss>&#39;my/make-or-delete-frame</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=modeline class=headerLink><a href=#modeline class=header-mark></a>modeline</h3><h4 id=mode-line-format class=headerLink><a href=#mode-line-format class=header-mark></a>mode-line-format</h4><p>2023-01-30 发现 doom-modeline 总是在不停的 <code>redisplay_internal</code> ，需要消耗较多的资源。所以暂时禁用此包，通过自定义 mode-line-format 来配置 modeline。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>210  56% + command-execute
</span></span><span class=line><span class=cl> 94  25% + ...
</span></span><span class=line><span class=cl> 62  16% - redisplay_internal (C function)
</span></span><span class=line><span class=cl> 61  16%  - eval
</span></span><span class=line><span class=cl> 51  13%   + doom-modeline-segment--buffer-info
</span></span><span class=line><span class=cl>  9   2%   + doom-modeline-format--main
</span></span><span class=line><span class=cl>  1   0%   + doom-modeline-segment--modals
</span></span></code></pre></div><p><a href=https://emacs.stackexchange.com/questions/5529/how-to-right-align-some-items-in-the-modeline target=_blank rel="noopener noreffer">mode line - How to right align some items in the modeline? - Emacs Stack Exchange</a>
以下的函数来自上面的链接中的回答，使用 <code>string-width</code> 替代了 <code>length</code> ，否则在对含有中文的 heading 进行 org-clock 的时候，会导致超出 mode-line 只显示部份的 heading。</p><p>2023-02-01 Emacs 29 上使用 <code>string-pixel-width</code> 替代 <code>string-width</code> ，可以获得象素级对齐。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my/mode-line-padding</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let*</span> <span class=p>((</span><span class=nv>r-length</span> <span class=p>(</span><span class=nf>string-width</span> <span class=p>(</span><span class=nf>format-mode-line</span> <span class=nv>global-mode-string</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>propertize</span> <span class=s>&#34; &#34;</span>
</span></span><span class=line><span class=cl>                <span class=ss>&#39;display</span> <span class=o>`</span><span class=p>(</span><span class=nv>space</span> <span class=nb>:align-to</span> <span class=p>(</span><span class=nf>-</span> <span class=nv>right</span> <span class=o>,</span><span class=p>(</span><span class=nf>+</span> <span class=nv>r-length</span> <span class=mi>1</span><span class=p>))))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;global-mode-string</span>
</span></span><span class=line><span class=cl>             <span class=o>&#39;</span><span class=p>(</span><span class=nb>:eval</span> <span class=p>(</span><span class=nf>propertize</span>
</span></span><span class=line><span class=cl>                      <span class=p>(</span><span class=nf>concat</span>
</span></span><span class=line><span class=cl>                       <span class=s>&#34;𝚻𝚨𝚩 &#34;</span>
</span></span><span class=line><span class=cl>                       <span class=p>(</span><span class=nf>number-to-string</span> <span class=p>(</span><span class=nv>tab-bar--current-tab-index</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                       <span class=s>&#34;: &#34;</span>
</span></span><span class=line><span class=cl>                       <span class=p>(</span><span class=nv>alist-get</span> <span class=ss>&#39;group</span> <span class=p>(</span><span class=nv>tab-bar--current-tab</span><span class=p>)))</span> <span class=ss>&#39;face</span> <span class=ss>&#39;font-lock-constant-face</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>mode-line-end-spaces</span>
</span></span><span class=line><span class=cl>      <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nv>global-mode-string</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>mode-line-position-column-line-format</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34; %l,%c&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>mode-line-percent-position</span> <span class=o>&#39;</span><span class=p>(</span><span class=mi>-4</span> <span class=s>&#34;%p&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq-default</span> <span class=nv>mode-line-format</span>
</span></span><span class=line><span class=cl>              <span class=o>`</span><span class=p>(</span><span class=s>&#34;%e&#34;</span>
</span></span><span class=line><span class=cl>                <span class=nv>mode-line-front-space</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=nb>:propertize</span> <span class=p>(</span><span class=s>&#34;&#34;</span> <span class=nv>mode-line-mule-info</span> <span class=nv>mode-line-client</span> <span class=nv>mode-line-modified</span> <span class=nv>mode-line-remote</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=nv>mode-line-frame-identification</span>
</span></span><span class=line><span class=cl>                <span class=nv>mode-line-buffer-identification</span>
</span></span><span class=line><span class=cl>                <span class=nv>mode-line-position</span>
</span></span><span class=line><span class=cl>                <span class=c1>;; (:eval (propertize &#34; %I &#34; &#39;face &#39;font-lock-constant-face))</span>
</span></span><span class=line><span class=cl>                <span class=s>&#34;  &#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=nv>vc-mode</span> <span class=nv>vc-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=nb>:eval</span> <span class=p>(</span><span class=nb>when</span> <span class=nv>buffer-read-only</span>
</span></span><span class=line><span class=cl>                         <span class=p>(</span><span class=nf>concat</span> <span class=s>&#34;  &#34;</span>  <span class=p>(</span><span class=nf>propertize</span> <span class=s>&#34;RO&#34;</span>
</span></span><span class=line><span class=cl>                                                   <span class=ss>&#39;face</span> <span class=ss>&#39;font-lock-type-face</span>
</span></span><span class=line><span class=cl>                                                   <span class=ss>&#39;help-echo</span> <span class=s>&#34;Buffer is read-only&#34;</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=nb>:eval</span> <span class=p>(</span><span class=nv>my/mode-line-padding</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=nv>mode-line-end-spaces</span><span class=p>))</span>
</span></span></code></pre></div><p>上式中的 <code>%e</code> 等说明如下：<a href=http://emacs-fu.blogspot.com/2011/08/customizing-mode-line.html target=_blank rel="noopener noreffer">emacs-fu: customizing the mode-line</a>.</p><blockquote><p>%b &ndash; print buffer name. %f &ndash; print visited file name.
%F &ndash; print frame name.
%* &ndash; print %, * or hyphen. %+ &ndash; print <strong>, % or hyphen.
%& is like %</strong>, but ignore read-only-ness.
% means buffer is read-only and * means it is modified.
For a modified read-only buffer, %* gives % and %+ gives *.
%s &ndash; print process status. %l &ndash; print the current line number.
%c &ndash; print the current column number (this makes editing slower).
To make the column number update correctly in all cases,
`column-number-mode&rsquo; must be non-nil.
%i &ndash; print the size of the buffer.
%I &ndash; like %i, but use k, M, G, etc., to abbreviate.
%p &ndash; print percent of buffer above top of window, or Top, Bot or All.
%P &ndash; print percent of buffer above bottom of window, perhaps plus Top,
or print Bottom or All.
%n &ndash; print Narrow if appropriate.
%t &ndash; visited file is text or binary (if OS supports this distinction).
%z &ndash; print mnemonics of keyboard, terminal, and buffer coding systems.
%Z &ndash; like %z, but including the end-of-line format.
%e &ndash; print error message about full memory.
%@ &ndash; print @ or hyphen. @ means that default-directory is on a
remote machine.
%[ &ndash; print one [ for each recursive editing level. %] similar.
%% &ndash; print %. %- &ndash; print infinitely many dashes.
Decimal digits after the % specify field width to which to pad.</p></blockquote><h4 id=hide-mode-line class=headerLink><a href=#hide-mode-line class=header-mark></a>hide-mode-line</h4><p><a href=https://github.com/hlissner/emacs-hide-mode-line target=_blank rel="noopener noreffer">hlissner/emacs-hide-mode-line: An Emacs plugin that hides (or masks) the current buffer&rsquo;s mode-line</a> 在有些情况下需要隐藏对应 buffer 的 modeline.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>hide-mode-line</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>      <span class=c1>;;:hook (dashboard-mode . hide-mode-line-mode)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;dashboard-mode-hook</span> <span class=ss>&#39;hide-mode-line-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nv>string=</span> <span class=p>(</span><span class=nf>buffer-name</span><span class=p>)</span> <span class=s>&#34;*scratch*&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>hide-mode-line-mode</span><span class=p>)))</span>
</span></span></code></pre></div><h4 id=mode-line-bell class=headerLink><a href=#mode-line-bell class=header-mark></a>mode-line-bell</h4><p><a href=https://github.com/purcell/mode-line-bell target=_blank rel="noopener noreffer">purcell/mode-line-bell: Flash the Emacs mode line instead of ringing the bell</a> 如题。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>mode-line-bell</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>on-first-buffer</span> <span class=o>.</span> <span class=nv>mode-line-bell-mode</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=rainbow-mode class=headerLink><a href=#rainbow-mode class=header-mark></a>rainbow-mode</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>rainbow-mode</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>prog-mode</span> <span class=o>.</span> <span class=nv>rainbow-mode</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=rainbow-delimiters class=headerLink><a href=#rainbow-delimiters class=header-mark></a>rainbow-delimiters</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>rainbow-delimiters</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>prog-mode</span> <span class=o>.</span> <span class=nv>rainbow-delimiters-mode</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=pulse class=headerLink><a href=#pulse class=header-mark></a>pulse</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>pulse-line</span> <span class=p>(</span><span class=kp>&amp;rest</span> <span class=nv>_</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Pulse the current line.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>pulse-momentary-highlight-one-line</span> <span class=p>(</span><span class=nf>point</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>dolist</span> <span class=p>(</span><span class=nv>command</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>evil-paste-after</span>
</span></span><span class=line><span class=cl>                   <span class=nv>evil-paste-pop</span>
</span></span><span class=line><span class=cl>                   <span class=nv>evil-paste-before</span>
</span></span><span class=line><span class=cl>                   <span class=nv>evil-delete</span>
</span></span><span class=line><span class=cl>                   <span class=nv>evil-delete-line</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>advice-add</span> <span class=nv>command</span> <span class=nb>:after</span> <span class=nf>#&#39;</span><span class=nv>pulse-line</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=dashboard class=headerLink><a href=#dashboard class=header-mark></a>dashboard</h3><p>Dashboard 可以让启动界面看起来比 scratch 界面更 fancy, 但是会比较明显的增加启动时间，有明显的迟顿感。</p><p>Dashboard 界面的 banner 使用的是 <code>ascii art</code>, 可以通过 <a href=https://ascii.co.uk/ target=_blank rel="noopener noreffer">ASCII.co.uk - The home of all things ASCII</a> 生成。</p><p>或者不使用 dashboard, 将启动界面设置成图片等，参见 <a href=https://emacs-china.org/t/topic/264/33 target=_blank rel="noopener noreffer">如何自定义 Banner 的图案？ - Spacemacs - Emacs China</a>.</p><p>也可以结合 <a href=https://www.emacswiki.org/emacs/TipOfTheDay target=_blank rel="noopener noreffer">EmacsWiki: Tip Of The Day</a>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>dashboard</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>dashboard-center-content</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>dashboard-set-init-info</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>dashboard-set-footer</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>dashboard-banner-logo-title</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>dashboard-heading-icons</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>dashboard-setup-startup-hook</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>dashboard-items</span> <span class=o>&#39;</span><span class=p>((</span><span class=nv>recents</span>  <span class=o>.</span> <span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                          <span class=p>(</span><span class=nv>bookmarks</span> <span class=o>.</span> <span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                          <span class=p>(</span><span class=nv>agenda</span> <span class=o>.</span> <span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                          <span class=p>(</span><span class=nv>registers</span> <span class=o>.</span> <span class=mi>5</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>require</span> <span class=ss>&#39;cal-china</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let*</span> <span class=p>((</span><span class=nv>ny</span> <span class=p>(</span><span class=nv>calendar-gregorian-from-absolute</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nv>cadr</span> <span class=p>(</span><span class=nf>assoc</span> <span class=mi>1</span> <span class=p>(</span><span class=nv>calendar-chinese-year</span>
</span></span><span class=line><span class=cl>                              <span class=p>(</span><span class=nf>string-to-number</span>
</span></span><span class=line><span class=cl>                               <span class=p>(</span><span class=nf>format-time-string</span> <span class=s>&#34;%Y&#34;</span> <span class=p>(</span><span class=nf>current-time</span><span class=p>))))))))</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>m</span> <span class=p>(</span><span class=nf>string-to-number</span> <span class=p>(</span><span class=nf>format-time-string</span> <span class=s>&#34;%m&#34;</span> <span class=p>(</span><span class=nf>current-time</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>d</span> <span class=p>(</span><span class=nf>string-to-number</span> <span class=p>(</span><span class=nf>format-time-string</span> <span class=s>&#34;%d&#34;</span> <span class=p>(</span><span class=nf>current-time</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nb>and</span> <span class=p>(</span><span class=nf>=</span> <span class=nv>d</span> <span class=p>(</span><span class=nv>cadr</span> <span class=nv>ny</span><span class=p>))</span>
</span></span><span class=line><span class=cl>             <span class=p>(</span><span class=nf>=</span> <span class=nv>m</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>ny</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nb>setq</span> <span class=nv>dashboard-startup-banner</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;src/banner2.txt&#34;</span> <span class=nv>user-emacs-directory</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>setq</span> <span class=nv>dashboard-startup-banner</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;src/banner.txt&#34;</span> <span class=nv>user-emacs-directory</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;evil</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>evil-define-key</span> <span class=ss>&#39;motion</span> <span class=ss>&#39;dashboard-mode-map</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;gf&#34;</span> <span class=ss>&#39;find-file</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;gb&#34;</span> <span class=ss>&#39;consult-buffer</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>run-with-idle-timer</span> <span class=mi>300</span> <span class=no>t</span> <span class=nf>#&#39;</span><span class=nv>dashboard-open</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=color-identifiers-mode class=headerLink><a href=#color-identifiers-mode class=header-mark></a>color-identifiers-mode</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>color-identifiers-mode</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>on-first-file</span> <span class=o>.</span> <span class=nv>global-color-identifiers-mode</span><span class=p>))</span>
</span></span></code></pre></div><h2 id=powerful-emacs-equipped-with-builtin-packages class=headerLink><a href=#powerful-emacs-equipped-with-builtin-packages class=header-mark></a>Powerful Emacs Equipped with Builtin Packages</h2><p>Emacs 内置了很多有用的 mode, 详细内容请参考仓库：<a href=https://github.com/condy0919/emacs-newbie target=_blank rel="noopener noreffer">condy0919/emacs-newbie: Introduction to Emacs</a>. 初学者可以看看。</p><h3 id=better-default class=headerLink><a href=#better-default class=header-mark></a>Better default</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>frame-inhibit-implied-resize</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>use-file-dialog</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>use-dialog-box</span> <span class=no>nil</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq-default</span> <span class=nv>ring-bell-function</span> <span class=ss>&#39;ignore</span>
</span></span><span class=line><span class=cl>              <span class=nv>use-short-answers</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>              <span class=nv>read-process-output-max</span> <span class=mh>#x10000</span>
</span></span><span class=line><span class=cl>              <span class=nv>message-kill-buffer-on-exit</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>              <span class=nv>message-kill-buffer-query</span> <span class=no>nil</span>
</span></span><span class=line><span class=cl>              <span class=nv>indent-tabs-mode</span> <span class=no>nil</span>
</span></span><span class=line><span class=cl>              <span class=nv>tab-width</span> <span class=mi>4</span>
</span></span><span class=line><span class=cl>              <span class=nv>make-backup-files</span> <span class=no>nil</span>
</span></span><span class=line><span class=cl>              <span class=nv>create-lockfiles</span> <span class=no>nil</span>
</span></span><span class=line><span class=cl>              <span class=nv>confirm-kill-processes</span> <span class=no>nil</span>
</span></span><span class=line><span class=cl>              <span class=nv>confirm-kill-emacs</span> <span class=no>nil</span>
</span></span><span class=line><span class=cl>              <span class=nv>recenter-redisplay</span> <span class=no>nil</span>
</span></span><span class=line><span class=cl>              <span class=nv>load-prefer-newer</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>              <span class=nv>mark-ring-max</span> <span class=mi>128</span>
</span></span><span class=line><span class=cl>              <span class=nv>next-screen-context-lines</span> <span class=mi>5</span>
</span></span><span class=line><span class=cl>              <span class=nv>inhibit-default-init</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>              <span class=nv>inhibit-startup-message</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>              <span class=nv>inhibit-splash-screen</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>              <span class=nv>inhibit-compacting-font-caches</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>              <span class=c1>;; inhibit-quit nil</span>
</span></span><span class=line><span class=cl>              <span class=nv>fast-but-imprecise-scrolling</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>              <span class=nv>scroll-preserve-screen-position</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>              <span class=nv>auto-save-default</span> <span class=no>nil</span>
</span></span><span class=line><span class=cl>              <span class=nv>auto-save-list-file-name</span> <span class=no>nil</span>
</span></span><span class=line><span class=cl>              <span class=nv>kill-do-not-save-duplicates</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>              <span class=nv>kill-ring-max</span> <span class=p>(</span><span class=nf>*</span> <span class=nv>kill-ring-max</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=nv>history-delete-duplicates</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>              <span class=nv>view-read-only</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>              <span class=nv>kill-read-only-ok</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>              <span class=nv>async-shell-command-display-buffer</span> <span class=no>nil</span>
</span></span><span class=line><span class=cl>              <span class=c1>;; Improve the performance of rendering long lines.</span>
</span></span><span class=line><span class=cl>              <span class=nv>bidi-display-reordering</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>ffap-machine-p-known</span> <span class=ss>&#39;reject</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=system-coding class=headerLink><a href=#system-coding class=header-mark></a>system coding</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>prefer-coding-system</span> <span class=ss>&#39;utf-8</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>set-default-coding-systems</span> <span class=ss>&#39;utf-8</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>set-terminal-coding-system</span> <span class=ss>&#39;utf-8</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>set-keyboard-coding-system</span> <span class=ss>&#39;utf-8</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=profiler class=headerLink><a href=#profiler class=header-mark></a>profiler</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;profiler-report-mode-hook</span> <span class=nf>#&#39;</span><span class=nv>hl-line-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=buffer class=headerLink><a href=#buffer class=header-mark></a>buffer</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>switch-to-buffer-in-dedicated-window</span> <span class=ss>&#39;pop</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>switch-to-buffer-obey-display-actions</span> <span class=no>t</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>my/space-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;b&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nb>:ignore</span> <span class=no>t</span> <span class=nb>:wk</span> <span class=s>&#34;Buffer/Bibtex&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;be&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nf>eval-buffer</span> <span class=nb>:wk</span> <span class=s>&#34;Eval buffer&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;bk&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>kill-this-buffer</span> <span class=nb>:wk</span> <span class=s>&#34;Kill This Buffer&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;evil</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>evil-define-key</span> <span class=ss>&#39;normal</span> <span class=ss>&#39;global</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;gB&#34;</span> <span class=ss>&#39;switch-to-prev-buffer</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;gb&#34;</span> <span class=ss>&#39;switch-to-buffer</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;zx&#34;</span> <span class=ss>&#39;kill-current-buffer</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=calculator class=headerLink><a href=#calculator class=header-mark></a>calculator</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>calc</span>
</span></span><span class=line><span class=cl>  <span class=nb>:commands</span> <span class=nv>calc</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>((</span><span class=nv>clac-mode</span> <span class=o>.</span> <span class=nv>hide-mode-line-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>clac-trail-mode</span> <span class=o>.</span> <span class=nv>hide-mode-line-mode</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>my/comma-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;C&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>calc</span> <span class=nb>:wk</span> <span class=s>&#34;calc&#34;</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=column-number-mode class=headerLink><a href=#column-number-mode class=header-mark></a>column-number-mode</h3><p>作用是在 modeline 中显示当前光标竖向处的位置。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;prog-mode-hook</span> <span class=ss>&#39;column-number-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=size-indication-mode class=headerLink><a href=#size-indication-mode class=header-mark></a>size-indication-mode</h3><p>作用是在 modeline 中显示文件的大小。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;find-file-hook</span> <span class=ss>&#39;size-indication-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=delete-selection-mode class=headerLink><a href=#delete-selection-mode class=header-mark></a>delete-selection-mode</h3><p>作用是当选中区域后输入字符会删除选中的区域，大部份软件都是这种行为。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;on-first-input-hook</span> <span class=ss>&#39;delete-selection-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=winner-mode class=headerLink><a href=#winner-mode class=header-mark></a>winner-mode</h3><p>进行窗口管理。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq-default</span> <span class=nv>winner-dont-bind-my-keys</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;on-first-buffer-hook</span> <span class=ss>&#39;winner-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>winner-boring-buffers</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;*Completions*&#34;</span>
</span></span><span class=line><span class=cl>                              <span class=s>&#34;*Compile-Log*&#34;</span>
</span></span><span class=line><span class=cl>                              <span class=s>&#34;*inferior-lisp*&#34;</span>
</span></span><span class=line><span class=cl>                              <span class=s>&#34;*Fuzzy Completions*&#34;</span>
</span></span><span class=line><span class=cl>                              <span class=s>&#34;*Apropos*&#34;</span>
</span></span><span class=line><span class=cl>                              <span class=s>&#34;*Help*&#34;</span>
</span></span><span class=line><span class=cl>                              <span class=s>&#34;*cvs*&#34;</span>
</span></span><span class=line><span class=cl>                              <span class=s>&#34;*Buffer List*&#34;</span>
</span></span><span class=line><span class=cl>                              <span class=s>&#34;*Ibuffer*&#34;</span>
</span></span><span class=line><span class=cl>                              <span class=s>&#34;*esh command on file*&#34;</span><span class=p>))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>my/space-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;w&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nb>:ignore</span> <span class=no>t</span> <span class=nb>:wk</span> <span class=s>&#34;Window&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;wu&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>winner-undo</span> <span class=nb>:wk</span> <span class=s>&#34;Undo winner&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;wr&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>winner-redo</span> <span class=nb>:wk</span> <span class=s>&#34;Redo winner&#34;</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=auto-revert-mode class=headerLink><a href=#auto-revert-mode class=header-mark></a>auto-revert-mode</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;on-first-file-hook</span> <span class=ss>&#39;global-auto-revert-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=tab-bar-mode class=headerLink><a href=#tab-bar-mode class=header-mark></a>tab-bar-mode</h3><p>可以将 mode-line 上的一些信息显示在 tab-bar 之上。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>(setq tab-bar-format &#39;(tab-bar-format-history
</span></span><span class=line><span class=cl>                       tab-bar-format-tabs
</span></span><span class=line><span class=cl>                       tab-bar-format-align-right
</span></span><span class=line><span class=cl>                       tab-bar-format-global))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>tab-bar</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>on-first-file</span> <span class=o>.</span> <span class=nv>tab-bar-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>tab-bar-new-tab-choice</span> <span class=s>&#34;*scratch*&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>tab-bar-close-button-show</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>tab-bar-tab-hints</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>tab-bar-show</span> <span class=no>nil</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>tabspaces</span>
</span></span><span class=line><span class=cl>  <span class=nb>:after</span> <span class=nv>tab-bar</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>tab-bar-mode</span> <span class=o>.</span> <span class=nv>tabspaces-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>tabspaces-session-file</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;tabsession.el&#34;</span> <span class=nv>no-littering-var-directory</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>tabspaces-use-filtered-buffers-as-default</span> <span class=no>t</span><span class=p>))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>my/space-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;t&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nb>:ignore</span> <span class=no>t</span> <span class=nb>:wk</span> <span class=s>&#34;Tabs&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;tn&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>tab-new</span> <span class=nb>:wk</span> <span class=s>&#34;New&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;tg&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>tab-group</span> <span class=nb>:wk</span> <span class=s>&#34;Group&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;tr&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>tab-bar-switch-to-recent-tab</span> <span class=nb>:wk</span> <span class=s>&#34;Recent&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;tc&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>tab-close</span> <span class=nb>:wk</span> <span class=s>&#34;Close&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;tC&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>tab-close-group</span> <span class=nb>:wk</span> <span class=s>&#34;Close group&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;tO&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>tab-close-other</span> <span class=nb>:wk</span> <span class=s>&#34;Close other&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;evil</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>evil-define-key</span> <span class=ss>&#39;normal</span> <span class=ss>&#39;global</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;gs&#34;</span> <span class=ss>&#39;tab-switch</span><span class=p>))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;display-buffer-alist</span>
</span></span><span class=line><span class=cl>             <span class=o>&#39;</span><span class=p>((</span><span class=nb>or</span> <span class=p>(</span><span class=nv>derived-mode</span> <span class=o>.</span> <span class=nv>org-mode</span><span class=p>))</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nv>display-buffer-in-tab</span><span class=p>)</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nv>tab-name</span> <span class=o>.</span> <span class=s>&#34;Org&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nv>tab-group</span> <span class=o>.</span> <span class=s>&#34;Org&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;display-buffer-alist</span>
</span></span><span class=line><span class=cl>             <span class=o>&#39;</span><span class=p>((</span><span class=nb>or</span> <span class=p>(</span><span class=nv>derived-mode</span> <span class=o>.</span> <span class=nv>latex-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                   <span class=p>(</span><span class=nv>derived-mode</span> <span class=o>.</span> <span class=nv>LaTeX-mode</span><span class=p>))</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nv>display-buffer-in-tab</span><span class=p>)</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nv>tab-name</span> <span class=o>.</span> <span class=s>&#34;TEX&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nv>tab-group</span> <span class=o>.</span> <span class=s>&#34;TEX&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;display-buffer-alist</span>
</span></span><span class=line><span class=cl>             <span class=o>&#39;</span><span class=p>((</span><span class=nb>or</span> <span class=p>(</span><span class=nv>derived-mode</span> <span class=o>.</span> <span class=nv>dired-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                   <span class=p>(</span><span class=nv>derived-mode</span> <span class=o>.</span> <span class=nv>dirvish-mode</span><span class=p>))</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nv>display-buffer-in-tab</span><span class=p>)</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nv>tab-name</span> <span class=o>.</span> <span class=s>&#34;Dired&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nv>tab-group</span> <span class=o>.</span> <span class=s>&#34;Dired&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;display-buffer-alist</span>
</span></span><span class=line><span class=cl>             <span class=o>&#39;</span><span class=p>((</span><span class=nv>derived-mode</span> <span class=o>.</span> <span class=nv>image-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nv>display-buffer-in-tab</span><span class=p>)</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nv>tab-name</span> <span class=o>.</span> <span class=s>&#34;Pic&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nv>tab-group</span> <span class=o>.</span> <span class=s>&#34;Pic&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;display-buffer-alist</span>
</span></span><span class=line><span class=cl>             <span class=o>&#39;</span><span class=p>((</span><span class=nv>derived-mode</span> <span class=o>.</span> <span class=nv>emacs-lisp-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nv>display-buffer-in-tab</span><span class=p>)</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nv>tab-name</span> <span class=o>.</span> <span class=s>&#34;Prog&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nv>tab-group</span> <span class=o>.</span> <span class=s>&#34;Prog&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;display-buffer-alist</span>
</span></span><span class=line><span class=cl>             <span class=o>`</span><span class=p>(</span><span class=o>,</span><span class=p>(</span><span class=nb>rx</span> <span class=p>(</span><span class=nv>|</span> <span class=s>&#34;*scratch*&#34;</span>
</span></span><span class=line><span class=cl>                       <span class=s>&#34;*dashboard*&#34;</span>
</span></span><span class=line><span class=cl>                       <span class=s>&#34;*elfeed-search*&#34;</span>
</span></span><span class=line><span class=cl>                       <span class=s>&#34;*mu4e-main&#34;</span>
</span></span><span class=line><span class=cl>                       <span class=s>&#34;*mu4e-headers&#34;</span>
</span></span><span class=line><span class=cl>                       <span class=s>&#34;*elfeed-summary*&#34;</span>
</span></span><span class=line><span class=cl>                       <span class=s>&#34;*elfeed-entry-&#34;</span>
</span></span><span class=line><span class=cl>                       <span class=s>&#34;*Messages*&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nv>display-buffer-in-tab</span><span class=p>)</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nv>tab-name</span> <span class=o>.</span> <span class=s>&#34;Home&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nv>tab-group</span> <span class=o>.</span> <span class=s>&#34;Home&#34;</span><span class=p>)))</span>
</span></span></code></pre></div><h3 id=savehist-mode class=headerLink><a href=#savehist-mode class=header-mark></a>savehist-mode</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>history-length</span> <span class=mi>1000</span>
</span></span><span class=line><span class=cl>      <span class=nv>savehist-save-minibuffer-history</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>      <span class=nv>savehist-additional-variables</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>kill-ring</span>
</span></span><span class=line><span class=cl>                                      <span class=nv>search-ring</span>
</span></span><span class=line><span class=cl>                                      <span class=nv>regexp-search-ring</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=nv>history-delete-duplicates</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;on-first-file-hook</span> <span class=ss>&#39;savehist-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=save-place-mode class=headerLink><a href=#save-place-mode class=header-mark></a>save-place-mode</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;on-first-buffer-hook</span> <span class=ss>&#39;save-place-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=midnight-mode class=headerLink><a href=#midnight-mode class=header-mark></a>midnight-mode</h3><p>作用是半夜的时候自动清理 buffer。怀疑这个导致 mu4e 出现 error code 1 的错误，先关闭试试。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;on-first-buffer-hook</span> <span class=ss>&#39;midnight-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=so-long-mode class=headerLink><a href=#so-long-mode class=header-mark></a>so-long-mode</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;text-mode-hook</span> <span class=ss>&#39;global-so-long-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq-default</span> <span class=nv>large-file-warning-threshold</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nf>fboundp</span> <span class=ss>&#39;so-long-enable</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;on-first-file-hook</span> <span class=ss>&#39;so-long-enable</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=electric-pair-mode class=headerLink><a href=#electric-pair-mode class=header-mark></a>electric-pair-mode</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;prog-mode-hook</span> <span class=ss>&#39;electric-pair-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;org-mode-hook</span> <span class=ss>&#39;electric-pair-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=prettify-symbols-mode class=headerLink><a href=#prettify-symbols-mode class=header-mark></a>prettify-symbols-mode</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>prettify-symbols-alist</span> <span class=o>&#39;</span><span class=p>((</span><span class=s>&#34;lambda&#34;</span> <span class=o>.</span> <span class=sc>?λ</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                               <span class=p>(</span><span class=s>&#34;function&#34;</span> <span class=o>.</span> <span class=sc>?𝑓</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;prog-mode-hook</span> <span class=ss>&#39;prettify-symbols-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;LaTeX-mode-hook</span> <span class=ss>&#39;prettify-symbols-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=hippie-expand class=headerLink><a href=#hippie-expand class=header-mark></a>hippie-expand</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>hippie-expand-try-functions-list</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>try-complete-file-name-partially</span>
</span></span><span class=line><span class=cl>                                         <span class=nv>try-complete-file-name</span>
</span></span><span class=line><span class=cl>                                         <span class=nv>try-expand-all-abbrevs</span>
</span></span><span class=line><span class=cl>                                         <span class=nv>try-expand-dabbrev</span>
</span></span><span class=line><span class=cl>                                         <span class=nv>try-expand-dabbrev-all-buffers</span>
</span></span><span class=line><span class=cl>                                         <span class=nv>try-expand-dabbrev-from-kill</span>
</span></span><span class=line><span class=cl>                                         <span class=nv>try-complete-lisp-symbol-partially</span>
</span></span><span class=line><span class=cl>                                         <span class=nv>try-complete-lisp-symbol</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>[</span><span class=nv>remap</span> <span class=nv>dabbrev-expand</span><span class=p>]</span> <span class=ss>&#39;hippie-expand</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=outline-minor-mode class=headerLink><a href=#outline-minor-mode class=header-mark></a>outline-minor-mode</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;prog-mode-hook</span> <span class=ss>&#39;outline-minor-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=pixel-scroll-precision-mode class=headerLink><a href=#pixel-scroll-precision-mode class=header-mark></a>pixel-scroll-precision-mode</h3><p>这个 mode 不好用，使用触摸板大幅度滚动屏幕后，会自动回到原先的位置。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>loaddefs</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>on-first-file</span> <span class=o>.</span> <span class=nv>pixel-scroll-precision-mode</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=recentf-mode class=headerLink><a href=#recentf-mode class=header-mark></a>recentf-mode</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;on-first-input-hook</span> <span class=ss>&#39;recentf-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;recentf</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>recentf-auto-cleanup</span> <span class=mi>300</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>recentf-max-saved-items</span> <span class=mi>1000</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;recentf-exclude</span> <span class=s>&#34;\\.pdf\\&#39;&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>my/space-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;fr&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>recentf-open-files</span> <span class=nb>:wk</span> <span class=s>&#34;Recent files&#34;</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=visual-line-mode class=headerLink><a href=#visual-line-mode class=header-mark></a>visual-line-mode</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;org-mode-hook</span> <span class=ss>&#39;turn-on-visual-line-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;org-roam-mode-hook</span> <span class=ss>&#39;turn-on-visual-line-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;LaTeX-mode-hook</span> <span class=nf>#&#39;</span><span class=nv>turn-on-visual-line-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=word-wrap-whitespace-mode class=headerLink><a href=#word-wrap-whitespace-mode class=header-mark></a>word-wrap-whitespace-mode</h3><p>这个是 Emacs 29 中的功能，具体见：<a href=https://github.com/emacs-mirror/emacs/commit/c789430331948e76b38091aa95bb9a9602a08289 target=_blank rel="noopener noreffer">Add new minor mode word-wrap-whitespace-mode · emacs-mirror/emacs@c789430</a></p><p>如果你使用 emacs 29 以下的版本，将这个文件保存到本地可以使用。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;org-mode-hook</span> <span class=ss>&#39;word-wrap-whitespace-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;org-roam-mode-hook</span> <span class=ss>&#39;word-wrap-whitespace-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=dired class=headerLink><a href=#dired class=header-mark></a>dired</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>dired</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span> <span class=p>(</span><span class=s>&#34;C-x d&#34;</span> <span class=o>.</span> <span class=nv>dired</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>insert-directory-program</span> <span class=s>&#34;/opt/homebrew/bin/gls&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>dired-use-ls-dired</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>dired-dwim-target</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>dired-auto-revert-buffer</span> <span class=nf>#&#39;</span><span class=nv>dired-buffer-stale-p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>dired-recursive-copies</span> <span class=ss>&#39;always</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>dired-recursive-deletes</span> <span class=ss>&#39;top</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>dired-listing-switches</span>
</span></span><span class=line><span class=cl>        <span class=s>&#34;-l --almost-all --human-readable --group-directories-first --no-group&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>dired-auto-revert-buffer</span> <span class=no>t</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=dired-hide-dotfiles class=headerLink><a href=#dired-hide-dotfiles class=header-mark></a>dired-hide-dotfiles</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>dired-hide-dotfiles</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span> <span class=p>(</span><span class=nb>:map</span> <span class=nv>dired-mode-map</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=s>&#34;s-.&#34;</span> <span class=o>.</span> <span class=nv>dired-hide-dotfiles-mode</span><span class=p>)))</span>
</span></span></code></pre></div><h4 id=dirvish class=headerLink><a href=#dirvish class=header-mark></a>dirvish</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>dirvish</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span> <span class=p>([</span><span class=nv>remap</span> <span class=nv>dired</span><span class=p>]</span> <span class=o>.</span> <span class=nv>dirvish</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>dirvish-use-header-line</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>dirvish-use-mode-line</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>dirvish-hide-cursor</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;doom-modeline</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>setq</span> <span class=nv>dirvish-mode-line-height</span> <span class=nv>doom-modeline-height</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>dirvish-default-layout</span> <span class=o>&#39;</span><span class=p>(</span><span class=mi>0</span> <span class=mf>0.4</span> <span class=mf>0.6</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>dirvish-header-line-format</span>
</span></span><span class=line><span class=cl>        <span class=o>&#39;</span><span class=p>(</span><span class=nb>:left</span> <span class=p>(</span><span class=nv>path</span><span class=p>)</span> <span class=nb>:right</span> <span class=p>(</span><span class=nv>free-space</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>dirvish-mode-line-format</span>
</span></span><span class=line><span class=cl>        <span class=o>&#39;</span><span class=p>(</span><span class=nb>:left</span> <span class=p>(</span><span class=nf>sort</span> <span class=nv>file-time</span> <span class=s>&#34; &#34;</span> <span class=nv>file-size</span> <span class=nv>symlink</span><span class=p>)</span> <span class=nb>:right</span> <span class=p>(</span><span class=nv>omit</span> <span class=nv>yank</span> <span class=nv>index</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>((</span><span class=nv>dirvish-find-entry</span> <span class=o>.</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>(</span><span class=kp>&amp;rest</span> <span class=nv>_</span><span class=p>)</span> <span class=p>(</span><span class=nb>setq-local</span> <span class=nv>truncate-lines</span> <span class=no>t</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>on-switch-buffer</span> <span class=o>.</span> <span class=nv>dirvish-override-dired-mode</span><span class=p>)))</span>
</span></span></code></pre></div><p><code>e</code> 绑定的函数见：<a href=#open-file-with-system-file-manager rel>Open file with system file manager</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;evil-collection</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>evil-collection-define-key</span> <span class=ss>&#39;normal</span> <span class=ss>&#39;dirvish-mode-map</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;q&#34;</span> <span class=ss>&#39;dirvish-quit</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;e&#34;</span> <span class=ss>&#39;xah-show-in-desktop</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>;; dired has default keybinding, C-x d, remap it to dirvish.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;evil</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>evil-define-key</span> <span class=ss>&#39;normal</span> <span class=ss>&#39;global</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;zd&#34;</span> <span class=ss>&#39;dirvish-quick-access</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=consult-dir class=headerLink><a href=#consult-dir class=header-mark></a>consult-dir</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>consult-dir</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span> <span class=p>((</span><span class=s>&#34;C-x C-d&#34;</span> <span class=o>.</span> <span class=nv>consult-dir</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nb>:map</span> <span class=nv>minibuffer-mode-map</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=s>&#34;C-x C-d&#34;</span> <span class=o>.</span> <span class=nv>consult-dir</span><span class=p>)</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=s>&#34;C-x C-j&#34;</span> <span class=o>.</span> <span class=nv>consult-dir-jump-file</span><span class=p>))))</span>
</span></span></code></pre></div><h3 id=scratch class=headerLink><a href=#scratch class=header-mark></a>scratch</h3><p>以下配置来源：<a href=https://gitee.com/cxiaoc/emacs.d/blob/master/site-lisp/config/init-scratch.el target=_blank rel="noopener noreffer">site-lisp/config/init-scratch.el · xiaoc/emacs.d - Gitee.com</a>.
也可以尝试使用：<a href=https://github.com/Fanael/persistent-scratch/blob/master/persistent-scratch.el target=_blank rel="noopener noreffer">persistent-scratch/persistent-scratch.el at master · Fanael/persistent-scratch</a>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my-scratch-save</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>ignore-errors</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>with-current-buffer</span> <span class=s>&#34;*scratch*&#34;</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nf>write-region</span> <span class=no>nil</span> <span class=no>nil</span> <span class=s>&#34;~/.emacs.d/var/scratch&#34;</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my-scratch-restore</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>f</span> <span class=s>&#34;~/.emacs.d/var/scratch&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nf>file-exists-p</span> <span class=nv>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>with-current-buffer</span> <span class=s>&#34;*scratch*&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nf>erase-buffer</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nf>insert-file-contents</span> <span class=nv>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nf>goto-char</span> <span class=p>(</span><span class=nf>point-max</span><span class=p>))))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;kill-emacs-hook</span> <span class=nf>#&#39;</span><span class=nv>my-scratch-save</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;after-init-hook</span> <span class=nf>#&#39;</span><span class=nv>my-scratch-restore</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=window-divider-mode class=headerLink><a href=#window-divider-mode class=header-mark></a>window-divider-mode</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>frame</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>face-spec-set</span> <span class=ss>&#39;window-divider</span>
</span></span><span class=line><span class=cl>                 <span class=o>&#39;</span><span class=p>((((</span><span class=nv>background</span> <span class=nv>light</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                    <span class=nb>:foreground</span> <span class=s>&#34;#000000&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                   <span class=p>(</span><span class=no>t</span>
</span></span><span class=line><span class=cl>                    <span class=nb>:foreground</span> <span class=s>&#34;#FFFFFF&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                 <span class=ss>&#39;face-override-spec</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>window-divider-default-bottom-width</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>window-divider-default-places</span> <span class=ss>&#39;bottom-only</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>after-init</span> <span class=o>.</span> <span class=nv>window-divider-mode</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=doc-view class=headerLink><a href=#doc-view class=header-mark></a>doc-view</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>doc-view-mupdf-use-svg</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>doc-view-imenu-flatten</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>doc-view-continuous</span> <span class=no>t</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=abbrev-mode class=headerLink><a href=#abbrev-mode class=header-mark></a>abbrev-mode</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq-default</span> <span class=nv>abbrev-mode</span> <span class=no>t</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=bookmark class=headerLink><a href=#bookmark class=header-mark></a>bookmark</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>my/space-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;fm&#34;</span> <span class=ss>&#39;bookmark-jump</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=clipboard class=headerLink><a href=#clipboard class=header-mark></a>clipboard</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>select-enable-primary</span> <span class=no>t</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=files class=headerLink><a href=#files class=header-mark></a>files</h3><p><a href=https://emacsredux.com/blog/2022/06/12/auto-create-missing-directories/ target=_blank rel="noopener noreffer">Auto-create Missing Directories | Emacs Redux</a>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my/auto-create-missing-dirs</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>target-dir</span> <span class=p>(</span><span class=nf>file-name-directory</span> <span class=nf>buffer-file-name</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>unless</span> <span class=p>(</span><span class=nf>file-exists-p</span> <span class=nv>target-dir</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>make-directory</span> <span class=nv>target-dir</span> <span class=no>t</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;find-file-not-found-functions</span> <span class=nf>#&#39;</span><span class=nv>my/auto-create-missing-dirs</span><span class=p>)</span>
</span></span></code></pre></div><h2 id=awesome-emacs-equipped-with-third-party-packages class=headerLink><a href=#awesome-emacs-equipped-with-third-party-packages class=header-mark></a>Awesome Emacs Equipped with Third-Party Packages</h2><h3 id=undo class=headerLink><a href=#undo class=header-mark></a>undo</h3><p>Emacs 自带 undo 和 undo-redo 功能。这里使用了 <code>undo-fu</code> 和 <code>undo-fu-session</code> 以及 <code>vundo</code> 这三个包。</p><p>Evil 模式编辑需要设置 undo system.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>undo-fu</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>undo-fu-session</span>
</span></span><span class=line><span class=cl>  <span class=nb>:after</span> <span class=nv>undo-fu</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>on-first-file</span> <span class=o>.</span> <span class=nv>undo-fu-session-global-mode</span><span class=p>))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>vundo</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>vundo-glyph-alist</span> <span class=nv>vundo-unicode-symbols</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span> <span class=p>(</span><span class=s>&#34;C-x u&#34;</span> <span class=o>.</span> <span class=nv>vundo</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=delete class=headerLink><a href=#delete class=header-mark></a>delete</h3><p>关于 Emacs 中的删除，一个是 <code>delete-selection-mode</code>, <code>hungry-delelte</code> 以及是否使用系统垃圾桶。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>delete-by-moving-to-trash</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>trash-directory</span> <span class=s>&#34;~/.Trash&#34;</span><span class=p>)</span>
</span></span></code></pre></div><p><a href=https://github.com/nflath/hungry-delete target=_blank rel="noopener noreffer">nflath/hungry-delete: Enables hungry deletion in all modes.</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>hungry-delete</span>
</span></span><span class=line><span class=cl>  <span class=nb>:custom</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>hungry-delete-chars-to-skip</span> <span class=s>&#34; \t\n\r\f\v&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>((</span><span class=nv>text-mode</span> <span class=o>.</span> <span class=nv>hungry-delete-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>prog-mode</span> <span class=o>.</span> <span class=nv>hungry-delete-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>org-mode</span> <span class=o>.</span> <span class=nv>hungry-delete-mode</span><span class=p>)))</span>
</span></span></code></pre></div><h3 id=gc-buffers class=headerLink><a href=#gc-buffers class=header-mark></a>gc-buffers</h3><p>作用是自动删除 buffers.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>gc-buffers</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>on-first-buffer</span> <span class=o>.</span> <span class=nv>gc-buffers-mode</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=rime class=headerLink><a href=#rime class=header-mark></a>rime</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>rime</span>
</span></span><span class=line><span class=cl>  <span class=nb>:init</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>rime-title</span> <span class=s>&#34;𝐑 &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>default-input-method</span> <span class=s>&#34;rime&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>rime-user-data-dir</span> <span class=s>&#34;~/Library/Rime/&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>rime-emacs-module-header-root</span> <span class=s>&#34;/Applications/Emacs.app/Contents/Resources/include/&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>rime-librime-root</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;librime/dist&#34;</span> <span class=nv>user-emacs-directory</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>rime-show-candidate</span> <span class=ss>&#39;minibuffer</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=c1>;; (setq rime-posframe-properties &#39;(:internal-border-width 0))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>rime-disable-predicates</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>rime-predicate-prog-in-code-p</span>
</span></span><span class=line><span class=cl>                                  <span class=nv>rime-predicate-org-in-src-block-p</span>
</span></span><span class=line><span class=cl>                                  <span class=nv>rime-predicate-org-latex-mode-p</span>
</span></span><span class=line><span class=cl>                                  <span class=nv>rime-predicate-tex-math-or-command-p</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>rime-inline-predicates</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>rime-predicate-space-after-cc-p</span>
</span></span><span class=line><span class=cl>                                 <span class=nv>rime-predicate-after-alphabet-char-p</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span> <span class=p>(</span><span class=nb>:map</span> <span class=nv>rime-mode-map</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=s>&#34;M-j&#34;</span> <span class=o>.</span> <span class=nv>rime-force-enable</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>((</span><span class=nv>evil-insert-state-entry</span> <span class=o>.</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>                                      <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nb>and</span> <span class=p>(</span><span class=nv>not</span> <span class=p>(</span><span class=nv>rime--should-inline-ascii-p</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                                               <span class=p>(</span><span class=nf>eq</span> <span class=nv>major-mode</span> <span class=ss>&#39;org-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                                               <span class=p>(</span><span class=nv>not</span> <span class=p>(</span><span class=nv>org-at-clock-log-p</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                                               <span class=p>(</span><span class=nv>not</span> <span class=p>(</span><span class=nv>org-at-table-p</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                                               <span class=p>(</span><span class=nv>not</span> <span class=p>(</span><span class=nv>org-at-timestamp-p</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                                               <span class=p>(</span><span class=nv>not</span> <span class=p>(</span><span class=nb>and</span> <span class=p>(</span><span class=nf>bolp</span><span class=p>)</span> <span class=p>(</span><span class=nv>org-on-heading-p</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>                                          <span class=p>(</span><span class=nv>activate-input-method</span> <span class=s>&#34;rime&#34;</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>evil-insert-state-exit</span> <span class=o>.</span>  <span class=nf>#&#39;</span><span class=nv>evil-deactivate-input-method</span><span class=p>)))</span>
</span></span></code></pre></div><p>进行 Evil 的 insert 状态时自动的切换中英文输入法的状态，结合 rime 的 predicates 使用。</p><p><a href=https://github.com/colawithsauce/rime-regexp.el/tree/main/ target=_blank rel="noopener noreffer">rime-regexp-mode</a>, 通过此包可以使用输入法进行文件的检索，若使用拼音输入法则可以通过拼音进行文件名的检索。我使用三郑输入法，则可以使用形码进行检索。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>rime-regexp</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>on-first-input</span> <span class=o>.</span> <span class=nv>rime-regexp-mode</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=helpful class=headerLink><a href=#helpful class=header-mark></a>helpful</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>helpful</span>
</span></span><span class=line><span class=cl>  <span class=nb>:commands</span> <span class=nv>helpful-update</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span> <span class=p>(([</span><span class=nv>remap</span> <span class=nv>describe-function</span><span class=p>]</span> <span class=o>.</span> <span class=nv>helpful-callable</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>([</span><span class=nv>remap</span> <span class=nv>describe-variable</span><span class=p>]</span> <span class=o>.</span> <span class=nv>helpful-variable</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>([</span><span class=nv>remap</span> <span class=nv>describe-key</span><span class=p>]</span> <span class=o>.</span> <span class=nv>helpful-key</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=nb>:init</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>help-window-select</span> <span class=ss>&#39;always</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>help-window-keep-selected</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;display-buffer-alist</span>
</span></span><span class=line><span class=cl>               <span class=o>&#39;</span><span class=p>((</span><span class=nb>or</span> <span class=p>(</span><span class=nv>derived-mode</span> <span class=o>.</span> <span class=nv>help-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                     <span class=p>(</span><span class=nv>derived-mode</span> <span class=o>.</span> <span class=nv>helpful-mode</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                 <span class=p>(</span><span class=nv>display-buffer-reuse-mode-window</span> <span class=nv>display-buffer-in-side-window</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                 <span class=p>(</span><span class=nv>window-width</span> <span class=o>.</span> <span class=mf>0.5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                 <span class=p>(</span><span class=nv>side</span> <span class=o>.</span> <span class=nv>right</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                 <span class=p>(</span><span class=nv>slot</span> <span class=o>.</span> <span class=mi>0</span><span class=p>))))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nf>autoload</span> <span class=nf>#&#39;</span><span class=nv>elisp-demos-advice-helpful-update</span> <span class=s>&#34;elisp-demos&#34;</span> <span class=no>nil</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>advice-add</span> <span class=ss>&#39;helpful-update</span> <span class=nb>:after</span> <span class=nf>#&#39;</span><span class=nv>elisp-demos-advice-helpful-update</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=expand-region class=headerLink><a href=#expand-region class=header-mark></a>expand-region</h3><p>这个用于扩展选区，有时候比 Evil 的 Visual 好用。最新的配置中己经使用 <code>v</code> 替代了 <code>C-=</code> 这个快捷键。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>expand-region</span>
</span></span><span class=line><span class=cl>  <span class=nb>:after</span> <span class=nv>evil</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span> <span class=p>((</span><span class=s>&#34;C-=&#34;</span> <span class=o>.</span> <span class=nv>er/expand-region</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nb>:map</span> <span class=nv>evil-visual-state-map</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=s>&#34;v&#34;</span> <span class=o>.</span> <span class=nv>er/expand-region</span><span class=p>))))</span>
</span></span></code></pre></div><h3 id=ctrlf class=headerLink><a href=#ctrlf class=header-mark></a>ctrlf</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>ctrlf</span>
</span></span><span class=line><span class=cl>  <span class=nb>:after</span> <span class=nv>evil</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>on-first-buffer</span> <span class=o>.</span> <span class=nv>ctrlf-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>evil-global-set-key</span> <span class=ss>&#39;normal</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;/&#34;</span><span class=p>)</span> <span class=ss>&#39;ctrlf-forward-default</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=avy class=headerLink><a href=#avy class=header-mark></a>avy</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>my/comma-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;g&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nb>:ignore</span> <span class=no>t</span> <span class=nb>:wk</span> <span class=s>&#34;Goto&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;gc&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>avy-goto-char</span> <span class=nb>:wk</span> <span class=s>&#34;Goto Char&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;gC&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>avy-goto-char-2</span> <span class=nb>:wk</span> <span class=s>&#34;Goto Char 2&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;gl&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>avy-goto-line</span> <span class=nb>:wk</span> <span class=s>&#34;Goto Line&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;gw&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>avy-goto-word-0</span> <span class=nb>:wk</span> <span class=s>&#34;Goto Line&#34;</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=whitespace-cleanup-mode class=headerLink><a href=#whitespace-cleanup-mode class=header-mark></a>whitespace-cleanup-mode</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>whitespace-cleanup-mode</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>on-first-file</span> <span class=o>.</span> <span class=nv>whitespace-cleanup-mode</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=elisp-demos class=headerLink><a href=#elisp-demos class=header-mark></a>elisp-demos</h3><p><a href=https://github.com/xuchunyang/elisp-demos target=_blank rel="noopener noreffer">xuchunyang/elisp-demos: Demonstrate Emacs Lisp APIs</a> 用于查查函数的用法很方便。</p><h3 id=tempel class=headerLink><a href=#tempel class=header-mark></a>tempel</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>tempel</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span> <span class=p>((</span><span class=s>&#34;M-+&#34;</span> <span class=o>.</span> <span class=nv>tempel-complete</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=s>&#34;M-*&#34;</span> <span class=o>.</span> <span class=nv>tempel-insert</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>tempel-path</span> <span class=o>`</span><span class=p>(</span><span class=s>&#34;~/.emacs.d/template/tempel&#34;</span>
</span></span><span class=line><span class=cl>                      <span class=o>,</span><span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;template/tempel&#34;</span> <span class=nv>my-galaxy</span><span class=p>))))</span>
</span></span></code></pre></div><h3 id=yasnippet class=headerLink><a href=#yasnippet class=header-mark></a>yasnippet</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>yasnippet</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>on-first-file</span> <span class=o>.</span> <span class=nv>yas-global-mode</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>yasnippet-snippets</span>
</span></span><span class=line><span class=cl>  <span class=nb>:after</span> <span class=nv>yasnippet</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=rg class=headerLink><a href=#rg class=header-mark></a>rg</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>rg</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>on-first-input</span> <span class=o>.</span> <span class=nv>rg-enable-default-bindings</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>rg-group-result</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>rg-show-columns</span> <span class=no>t</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=minibuffer-and-completion class=headerLink><a href=#minibuffer-and-completion class=header-mark></a>Minibuffer and completion</h3><h4 id=minibuffer class=headerLink><a href=#minibuffer class=header-mark></a>minibuffer</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>read-buffer-completion-ignore-case</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>completion-ignore-case</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>minibuffer-prompt-properties</span>
</span></span><span class=line><span class=cl>      <span class=o>&#39;</span><span class=p>(</span><span class=nv>read-only</span> <span class=no>t</span> <span class=nv>cursor-intangible</span> <span class=no>t</span> <span class=nv>face</span> <span class=nf>minibuffer-prompt</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>simple</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq-default</span> <span class=nv>read-extended-command-predicate</span> <span class=nf>#&#39;</span><span class=nv>command-completion-default-include-p</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>minibuffer</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>completion-category-overrides</span> <span class=o>&#39;</span><span class=p>((</span><span class=nv>file</span> <span class=p>(</span><span class=nv>styles</span> <span class=nv>basic</span> <span class=nv>partial-completion</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>read-file-name-completion-ignore-case</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq-local</span> <span class=nv>completion-in-region-function</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nb>lambda</span> <span class=p>(</span><span class=kp>&amp;rest</span> <span class=nv>args</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=nf>apply</span> <span class=p>(</span><span class=nb>if</span> <span class=nv>vertico-mode</span>
</span></span><span class=line><span class=cl>                           <span class=nf>#&#39;</span><span class=nv>consult-completion-in-region</span>
</span></span><span class=line><span class=cl>                         <span class=nf>#&#39;</span><span class=nv>completion--in-region</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                       <span class=nv>args</span><span class=p>))))</span>
</span></span></code></pre></div><h4 id=orderless class=headerLink><a href=#orderless class=header-mark></a>orderless</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>tab-always-indent</span> <span class=ss>&#39;complete</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>orderless</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>completion-styles</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>orderless</span> <span class=nv>partial-completion</span><span class=p>)))</span>
</span></span></code></pre></div><h4 id=vertico class=headerLink><a href=#vertico class=header-mark></a>vertico</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>vertico</span>
</span></span><span class=line><span class=cl>  <span class=nb>:load-path</span> <span class=s>&#34;~/.emacs.d/packages/vertico&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>after-init</span> <span class=o>.</span> <span class=nv>vertico-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>vertico-cycle</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span> <span class=p>(</span><span class=nb>:map</span> <span class=nv>vertico-map</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=s>&#34;C-j&#34;</span> <span class=o>.</span> <span class=nv>vertico-next</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=s>&#34;C-k&#34;</span> <span class=o>.</span> <span class=nv>vertico-previous</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>vertico-directory</span>
</span></span><span class=line><span class=cl>  <span class=nb>:after</span> <span class=nv>vertico</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span> <span class=p>(</span><span class=nb>:map</span> <span class=nv>vertico-map</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=s>&#34;C-u&#34;</span> <span class=o>.</span> <span class=nv>vertico-directory-up</span><span class=p>)))</span>
</span></span></code></pre></div><h4 id=marginalia class=headerLink><a href=#marginalia class=header-mark></a>marginalia</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>marginalia</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>((</span><span class=nv>minibuffer-setup</span> <span class=o>.</span> <span class=nv>marginalia-mode</span><span class=p>)))</span>
</span></span></code></pre></div><h4 id=embark class=headerLink><a href=#embark class=header-mark></a>embark</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>embark</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span> <span class=p>((</span><span class=s>&#34;C-.&#34;</span> <span class=o>.</span> <span class=nv>embark-act</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=s>&#34;M-.&#34;</span> <span class=o>.</span> <span class=nv>embark-dwim</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nb>:map</span> <span class=nv>vertico-map</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=s>&#34;C-c C-o&#34;</span> <span class=o>.</span> <span class=nv>embark-export</span><span class=p>)</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=s>&#34;C-c C-c&#34;</span> <span class=o>.</span> <span class=nv>embark-act</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>  <span class=nb>:init</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>prefix-help-command</span> <span class=nf>#&#39;</span><span class=nv>embark-prefix-help-command</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;display-buffer-alist</span>
</span></span><span class=line><span class=cl>               <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;\\`\\*Embark Collect \\(Live\\|Completions\\)\\*&#34;</span>
</span></span><span class=line><span class=cl>                 <span class=no>nil</span>
</span></span><span class=line><span class=cl>                 <span class=p>(</span><span class=nf>window-parameters</span> <span class=p>(</span><span class=nv>mode-line-format</span> <span class=o>.</span> <span class=nv>none</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>my/space-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;fe&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>embark-open-externally</span> <span class=nb>:wk</span> <span class=s>&#34;Open externally&#34;</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=consult class=headerLink><a href=#consult class=header-mark></a>consult</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>consult</span>
</span></span><span class=line><span class=cl>  <span class=nb>:commands</span> <span class=nv>consult-outline</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>completion-list-mode</span> <span class=o>.</span> <span class=nv>consult-preview-at-point-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span> <span class=p>(([</span><span class=nv>remap</span> <span class=nv>apropos</span><span class=p>]</span> <span class=o>.</span> <span class=nv>consult-apropos</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>([</span><span class=nv>remap</span> <span class=nv>bookmark-jump</span><span class=p>]</span> <span class=o>.</span> <span class=nv>consult-bookmark</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>([</span><span class=nv>remap</span> <span class=nv>goto-line</span><span class=p>]</span> <span class=o>.</span> <span class=nv>consult-goto-line</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>([</span><span class=nv>remap</span> <span class=nv>imenu</span><span class=p>]</span> <span class=o>.</span> <span class=nv>consult-imenu</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>([</span><span class=nv>remap</span> <span class=nv>locate</span><span class=p>]</span> <span class=o>.</span> <span class=nv>consult-locate</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>([</span><span class=nv>remap</span> <span class=nv>load-theme</span><span class=p>]</span> <span class=o>.</span> <span class=nv>consult-theme</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>([</span><span class=nv>remap</span> <span class=nv>man</span><span class=p>]</span> <span class=o>.</span> <span class=nv>consult-man</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>([</span><span class=nv>remap</span> <span class=nv>recentf-open-files</span><span class=p>]</span> <span class=o>.</span> <span class=nv>consult-recent-file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>([</span><span class=nv>remap</span> <span class=nv>switch-to-buffer</span><span class=p>]</span> <span class=o>.</span> <span class=nv>consult-buffer</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>([</span><span class=nv>remap</span> <span class=nv>switch-to-buffer-other-window</span><span class=p>]</span> <span class=o>.</span> <span class=nv>consult-buffer-other-window</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>([</span><span class=nv>remap</span> <span class=nv>switch-to-buffer-other-frame</span><span class=p>]</span> <span class=o>.</span> <span class=nv>consult-buffer-other-frame</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>([</span><span class=nv>remap</span> <span class=nv>yank-pop</span><span class=p>]</span> <span class=o>.</span> <span class=nv>consult-yank-pop</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=nb>:map</span> <span class=nv>minibuffer-mode-map</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=s>&#34;C-r&#34;</span> <span class=o>.</span> <span class=nv>consult-history</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;evil</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>evil-declare-key</span> <span class=ss>&#39;normal</span> <span class=nv>org-mode-map</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;gh&#34;</span> <span class=ss>&#39;consult-outline</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>evil-declare-key</span> <span class=ss>&#39;normal</span> <span class=nv>LaTeX-mode-map</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;gh&#34;</span> <span class=ss>&#39;consult-outline</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=corfu class=headerLink><a href=#corfu class=header-mark></a>corfu</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>corfu</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>corfu-cycle</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>corfu-auto</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>corfu-auto-prefix</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>corfu-auto-delay</span> <span class=mf>0.0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>corfu-preselect</span> <span class=ss>&#39;valid</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq-default</span> <span class=nv>corfu-quit-no-match</span> <span class=ss>&#39;separator</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:init</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>defun</span> <span class=nv>corfu-enable-always-in-minibuffer</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Enable Corfu in the minibuffer if Vertico/Mct are not active.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>unless</span> <span class=p>(</span><span class=nb>or</span> <span class=p>(</span><span class=nv>bound-and-true-p</span> <span class=nv>mct--active</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nv>bound-and-true-p</span> <span class=nv>vertico--input</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nf>eq</span> <span class=p>(</span><span class=nf>current-local-map</span><span class=p>)</span> <span class=nv>read-passwd-map</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>setq-local</span> <span class=nv>corfu-auto</span> <span class=no>nil</span><span class=p>)</span> <span class=c1>;; Enable/disable auto completion</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>setq-local</span> <span class=nv>corfu-echo-delay</span> <span class=no>nil</span> <span class=c1>;; Disable automatic echo and popup</span>
</span></span><span class=line><span class=cl>                <span class=nv>corfu-popupinfo-delay</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>corfu-mode</span> <span class=mi>1</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>((</span><span class=nv>on-first-buffer</span> <span class=o>.</span> <span class=nv>global-corfu-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>eshell-mode-hook</span> <span class=o>.</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>                               <span class=p>(</span><span class=nb>setq-local</span> <span class=nv>corfu-quit-at-boundary</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>                                           <span class=nv>corfu-quit-no-match</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>                                           <span class=nv>corfu-auto</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                               <span class=p>(</span><span class=nv>corfu-mode</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>corfu-echo</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>corfu-mode</span> <span class=o>.</span> <span class=nv>corfu-echo-mode</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>corfu-popupinfo</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>corfu-mode</span> <span class=o>.</span> <span class=nv>corfu-popupinfo-mode</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=kind-icon class=headerLink><a href=#kind-icon class=header-mark></a>kind-icon</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>kind-icon</span>
</span></span><span class=line><span class=cl>  <span class=nb>:after</span> <span class=nv>corfu</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>kind-icon-use-icons</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>kind-icon-default-face</span> <span class=ss>&#39;corfu-default</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;corfu-margin-formatters</span> <span class=nf>#&#39;</span><span class=nv>kind-icon-margin-formatter</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=cape class=headerLink><a href=#cape class=header-mark></a>cape</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>cape</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span> <span class=p>((</span><span class=s>&#34;C-c p p&#34;</span> <span class=o>.</span> <span class=nv>completion-at-point</span><span class=p>)</span> <span class=c1>;; capf</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=s>&#34;C-c p t&#34;</span> <span class=o>.</span> <span class=nv>complete-tag</span><span class=p>)</span>        <span class=c1>;; etags</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=s>&#34;C-c p d&#34;</span> <span class=o>.</span> <span class=nv>cape-dabbrev</span><span class=p>)</span>        <span class=c1>;; or dabbrev-completion</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=s>&#34;C-c p h&#34;</span> <span class=o>.</span> <span class=nv>cape-history</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=s>&#34;C-c p f&#34;</span> <span class=o>.</span> <span class=nv>cape-file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=s>&#34;C-c p k&#34;</span> <span class=o>.</span> <span class=nv>cape-keyword</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=s>&#34;C-c p s&#34;</span> <span class=o>.</span> <span class=nv>cape-symbol</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=s>&#34;C-c p a&#34;</span> <span class=o>.</span> <span class=nv>cape-abbrev</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=s>&#34;C-c p i&#34;</span> <span class=o>.</span> <span class=nv>cape-ispell</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=s>&#34;C-c p l&#34;</span> <span class=o>.</span> <span class=nv>cape-line</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=s>&#34;C-c p w&#34;</span> <span class=o>.</span> <span class=nv>cape-dict</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=s>&#34;C-c p \\&#34;</span> <span class=o>.</span> <span class=nv>cape-tex</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=s>&#34;C-c p _&#34;</span> <span class=o>.</span> <span class=nv>cape-tex</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=s>&#34;C-c p ^&#34;</span> <span class=o>.</span> <span class=nv>cape-tex</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=s>&#34;C-c p &amp;&#34;</span> <span class=o>.</span> <span class=nv>cape-sgml</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=s>&#34;C-c p r&#34;</span> <span class=o>.</span> <span class=nv>cape-rfc1345</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=nb>:init</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;completion-at-point-functions</span> <span class=nf>#&#39;</span><span class=nv>cape-dabbrev</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;completion-at-point-functions</span> <span class=nf>#&#39;</span><span class=nv>cape-file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=c1>;;(add-to-list &#39;completion-at-point-functions #&#39;cape-history)</span>
</span></span><span class=line><span class=cl>  <span class=c1>;;(add-to-list &#39;completion-at-point-functions #&#39;cape-keyword)</span>
</span></span><span class=line><span class=cl>  <span class=c1>;;(add-to-list &#39;completion-at-point-functions #&#39;cape-tex)</span>
</span></span><span class=line><span class=cl>  <span class=c1>;;(add-to-list &#39;completion-at-point-functions #&#39;cape-sgml)</span>
</span></span><span class=line><span class=cl>  <span class=c1>;;(add-to-list &#39;completion-at-point-functions #&#39;cape-rfc1345)</span>
</span></span><span class=line><span class=cl>  <span class=c1>;;(add-to-list &#39;completion-at-point-functions #&#39;cape-abbrev)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;completion-at-point-functions</span> <span class=nf>#&#39;</span><span class=nv>cape-ispell</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;completion-at-point-functions</span> <span class=nf>#&#39;</span><span class=nv>cape-dict</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=c1>;;(add-to-list &#39;completion-at-point-functions #&#39;cape-symbol)</span>
</span></span><span class=line><span class=cl>  <span class=c1>;;(add-to-list &#39;completion-at-point-functions #&#39;cape-line)</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span>
</span></span></code></pre></div><p><a href=https://github.com/SystemCrafters/crafted-emacs/blob/master/modules/crafted-completion.el target=_blank rel="noopener noreffer">crafted-emacs/crafted-completion.el at master · SystemCrafters/crafted-emacs</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=c1>;; Ensure that pcomplete does not write to the buffer</span>
</span></span><span class=line><span class=cl><span class=c1>;; and behaves as a pure `completion-at-point-function&#39;.</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>advice-add</span> <span class=ss>&#39;pcomplete-completions-at-point</span> <span class=nb>:around</span> <span class=nf>#&#39;</span><span class=nv>cape-wrap-purify</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=prescient class=headerLink><a href=#prescient class=header-mark></a>prescient</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nf>autoload</span> <span class=ss>&#39;prescient-persist-mode</span> <span class=s>&#34;prescient&#34;</span> <span class=s>&#34;&#34;</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;after-init-hook</span> <span class=ss>&#39;prescient-persist-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>vertico-prescient</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>vertico-mode</span> <span class=o>.</span> <span class=nv>vertico-prescient-mode</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>corfu-prescient</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>corfu-mode</span> <span class=o>.</span> <span class=nv>corfu-prescient-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>vertico-prescient-completion-styles</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>orderless</span> <span class=nv>prescient</span> <span class=nv>partial-completion</span><span class=p>)))</span>
</span></span></code></pre></div><h2 id=misc class=headerLink><a href=#misc class=header-mark></a>Misc</h2><h3 id=gcmh class=headerLink><a href=#gcmh class=header-mark></a>gcmh</h3><p>Emacs 的拉圾回收太影响性能，此包的作用是当 Emacs 处于 idle 状态时进行拉圾回收，正常使用的时候设置一个较高的阈值，降低垃圾回收。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>gcmh</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>gcmh-idle-delay</span> <span class=ss>&#39;auto</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>gcmh-auto-idle-delay-factor</span> <span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>gcmh-high-cons-threshold</span> <span class=mh>#x1000000</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>after-init</span> <span class=o>.</span> <span class=nv>gcmh-mode</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=file-info class=headerLink><a href=#file-info class=header-mark></a>file-info</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>file-info</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span> <span class=p>(</span><span class=s>&#34;C-c f i&#34;</span> <span class=o>.</span> <span class=nv>file-info-show</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>hydra-hint-display-type</span> <span class=ss>&#39;posframe</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>hydra-posframe-show-params</span> <span class=o>`</span><span class=p>(</span><span class=nb>:poshandler</span> <span class=nv>posframe-poshandler-frame-center</span>
</span></span><span class=line><span class=cl>                                                 <span class=nb>:internal-border-width</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>                                                 <span class=nb>:internal-border-color</span> <span class=s>&#34;#61AFEF&#34;</span>
</span></span><span class=line><span class=cl>                                                 <span class=nb>:left-fringe</span> <span class=mi>16</span>
</span></span><span class=line><span class=cl>                                                 <span class=nb>:right-fringe</span> <span class=mi>16</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>my/space-leader-def</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fs&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>file-info-show</span> <span class=nb>:wk</span> <span class=s>&#34;File info&#34;</span><span class=p>)))</span>
</span></span></code></pre></div><h3 id=disk-usage class=headerLink><a href=#disk-usage class=header-mark></a>disk-usage</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>disk-usage</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span> <span class=p>(</span><span class=s>&#34;C-c d u&#34;</span> <span class=o>.</span> <span class=nv>disk-usage</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>my/space-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;d&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nb>:ignore</span> <span class=no>t</span> <span class=nb>:wk</span> <span class=s>&#34;Disk&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;du&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>disk-usage</span> <span class=nb>:wk</span> <span class=s>&#34;usage&#34;</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=youtube-dl class=headerLink><a href=#youtube-dl class=header-mark></a>youtube-dl</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>youtube-dl</span>
</span></span><span class=line><span class=cl>  <span class=nb>:commands</span> <span class=nv>youtube-dl</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>youtube-dl-directory</span> <span class=s>&#34;~/Downloads/&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>youtube-dl-program</span> <span class=s>&#34;/opt/homebrew/bin/youtube-dl&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>youtube-dl-arguments</span>
</span></span><span class=line><span class=cl>        <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;--no-mtime&#34;</span> <span class=s>&#34;--restrict-filenames&#34;</span> <span class=s>&#34;--format&#34;</span> <span class=s>&#34;best&#34;</span> <span class=s>&#34;--mark-watched&#34;</span><span class=p>)))</span>
</span></span></code></pre></div><h3 id=ocr class=headerLink><a href=#ocr class=header-mark></a>OCR</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my/ocr</span> <span class=p>()</span>
</span></span><span class=line><span class=cl><span class=s>&#34;OCR with Macos system.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>shell-command</span> <span class=s>&#34;shortcuts run \&#34;OCR Selected Area\&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>do-applescript</span> <span class=s>&#34;tell application id \&#34;org.gnu.Emacs\&#34; to activate&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>my/comma-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;o&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>my/ocr</span> <span class=nb>:wk</span> <span class=s>&#34;OCR&#34;</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=proxy class=headerLink><a href=#proxy class=header-mark></a>proxy</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>toggle-proxy</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Toggle proxy for the url.el library.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>if</span> <span class=nv>url-proxy-services</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>proxy-disable</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>proxy-enable</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>proxy-enable</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Enable proxy.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>url-proxy-services</span>
</span></span><span class=line><span class=cl>        <span class=o>&#39;</span><span class=p>((</span><span class=s>&#34;http&#34;</span> <span class=o>.</span> <span class=s>&#34;127.0.0.1:8118&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;https&#34;</span> <span class=o>.</span> <span class=s>&#34;127.0.0.1:8118&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;socks&#34;</span> <span class=o>.</span> <span class=s>&#34;127.0.0.1:8118&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;no_proxy&#34;</span> <span class=o>.</span> <span class=s>&#34;0.0.0.0&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>message</span> <span class=s>&#34;Proxy enabled! %s&#34;</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>url-proxy-services</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>proxy-disable</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Disable proxy.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>if</span> <span class=nv>url-proxy-services</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>setq</span> <span class=nv>url-proxy-services</span> <span class=no>nil</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>message</span> <span class=s>&#34;Proxy disabled!&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>run-with-idle-timer</span> <span class=mi>2</span> <span class=no>nil</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>                             <span class=p>(</span><span class=nv>proxy-enable</span><span class=p>)))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>my/comma-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;p&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>toggle-proxy</span> <span class=nb>:wk</span> <span class=s>&#34;Proxy&#34;</span><span class=p>))</span>
</span></span></code></pre></div><h2 id=emacs-works-with-multiple-language-piece-of-cake class=headerLink><a href=#emacs-works-with-multiple-language-piece-of-cake class=header-mark></a>Emacs Works with Multiple Language, Piece of Cake</h2><p>Emacs 在英文的学习、使用方面具有很大的帮助。</p><p>使用 Emacs 写文档可以自动检查拼写，需要用到的有 <code>ispell</code>, <code>flyspell</code> 或者 <code>wucuo-mode</code>. 对于具有错误的单词会有下划线提示，使用 <code>flyspell-correct</code> 进行修正。</p><p>对于不认识的单词可以使用 <code>sdcv</code> 或者 <code>osx-dictionary</code> 查询，对于读不懂的单词可以使用 <code>go-translate</code> 或者 <code>lingva</code> 或者 <code>google-translate</code> 进行中英文的互译。当然其他的语言也是可以的。</p><p>此外还可以使用 dictionary-overlay 直接渲染整个 buffer, 不认识的单词会直接显示中文意思。这个功能结合 <code>eww</code> 或者 <code>elfeed</code> 阅读网页的时候使用。</p><p>当不知道英文单词怎么写时可以使用 <code>lsp-bridge-toggle-sdcv-helper</code>, 通过输入拼音来输入英语单词。对于想要查询近意词等时可以使用 <code>powerthesaurus-lookup-dwim</code> 来查找。</p><p>学习英语单词还可以结合 <a href=https://gitlab.com/phillord/org-drill target=_blank rel="noopener noreffer">org-drll</a> 或者 <a href=https://github.com/eyeinsky/org-anki target=_blank rel="noopener noreffer">org-anki</a> 进行，这里使用到的概念是 <a href=https://en.wikipedia.org/wiki/Forgetting_curve target=_blank rel="noopener noreffer">Forgetting curve</a>.</p><h3 id=ispell class=headerLink><a href=#ispell class=header-mark></a>Ispell</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>ispell</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>ispell-program-name</span> <span class=s>&#34;/opt/homebrew/bin/aspell&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>ispell-extra-args</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;--sug-mode=ultra&#34;</span> <span class=s>&#34;--lang=en_US&#34;</span> <span class=s>&#34;--run-together&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>ispell-aspell-dict-dir</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>ispell-get-aspell-config-value</span> <span class=s>&#34;dict-dir&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>ispell-aspell-data-dir</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>ispell-get-aspell-config-value</span> <span class=s>&#34;data-dir&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>ispell-personal-dictionary</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;config/ispell/.aspell.en.pws&#34;</span> <span class=nv>my-galaxy</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq-default</span> <span class=nv>ispell-following-word</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>                <span class=nv>ispell-quietly</span> <span class=no>t</span><span class=p>))</span>
</span></span></code></pre></div><p>这里使用了<a href=https://github.com/cask/shut-up target=_blank rel="noopener noreffer">cask/shut-up: Emacs, shut up would you!</a> 来关闭一些错误提示。虽然其只是显示在 Message buffer 当中，但是看起来还是很不爽。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=c1>;; Suppress start looking process.</span>
</span></span><span class=line><span class=cl><span class=c1>;; https://github.com/company-mode/company-mode/issues/912</span>
</span></span><span class=line><span class=cl><span class=c1>;; shut-up</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;ispell</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>advice-add</span> <span class=ss>&#39;ispell-lookup-words</span> <span class=nb>:around</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nb>lambda</span> <span class=p>(</span><span class=nv>orig</span> <span class=kp>&amp;rest</span> <span class=nv>args</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=nv>shut-up</span> <span class=p>(</span><span class=nf>apply</span> <span class=nv>orig</span> <span class=nv>args</span><span class=p>)))))</span>
</span></span></code></pre></div><h3 id=flyspell class=headerLink><a href=#flyspell class=header-mark></a>flyspell</h3><p>Wucuo 在某个版本有提示 warning, 不知道产生的原因是什么。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>flyspell</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>org-mode</span> <span class=o>.</span> <span class=nv>flyspell-mode</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=flyspell-correct class=headerLink><a href=#flyspell-correct class=header-mark></a>flyspell-correct</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>flyspell-correct</span>
</span></span><span class=line><span class=cl>  <span class=nb>:commands</span> <span class=nv>flyspell-correct-wrapper</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span> <span class=p>([</span><span class=nv>remap</span> <span class=nv>flyspell-auto-correct-previous-word</span><span class=p>]</span> <span class=o>.</span> <span class=nv>flyspell-correct-wrapper</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=langtool class=headerLink><a href=#langtool class=header-mark></a>langtool</h3><p>MacOS 上使用需要安装 languagetool.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>langtool</span>
</span></span><span class=line><span class=cl>  <span class=nb>:commands</span> <span class=nv>langtool-check-buffer</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>langtool-http-server-host</span> <span class=s>&#34;localhost&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>langtool-http-server-port</span> <span class=mi>8081</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>langtool-autoshow-message-function</span> <span class=nf>#&#39;</span><span class=nv>langtool-popup-autoshow</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=dictionary class=headerLink><a href=#dictionary class=header-mark></a>dictionary</h3><p>Emacs 内置了 dictionary，默认是查询的 dict.org。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;display-buffer-alist</span>
</span></span><span class=line><span class=cl>             <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;^\\*Dictionary\\*&#34;</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nv>display-buffer-in-side-window</span><span class=p>)</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nv>side</span> <span class=o>.</span> <span class=nv>right</span><span class=p>)</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nv>window-width</span> <span class=o>.</span> <span class=mi>70</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;M-#&#34;</span><span class=p>)</span> <span class=ss>&#39;dictionary-lookup-definition</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=go-translate class=headerLink><a href=#go-translate class=header-mark></a>go-translate</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>go-translate</span>
</span></span><span class=line><span class=cl>  <span class=nb>:commands</span> <span class=nv>gts-do-translate</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>gts-buffer-follow-p</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>gts-translate-list</span> <span class=o>&#39;</span><span class=p>((</span><span class=s>&#34;en&#34;</span> <span class=s>&#34;zh&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>gts-default-translator</span> <span class=p>(</span><span class=nv>gts-translator</span>
</span></span><span class=line><span class=cl>                                <span class=nb>:picker</span> <span class=p>(</span><span class=nv>gts-noprompt-picker</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                                <span class=nb>:engines</span> <span class=p>(</span><span class=nf>list</span>
</span></span><span class=line><span class=cl>                                          <span class=p>(</span><span class=nv>gts-google-engine</span> <span class=nb>:parser</span> <span class=p>(</span><span class=nv>gts-google-summary-parser</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>                                <span class=nb>:render</span> <span class=p>(</span><span class=nv>gts-buffer-render</span><span class=p>))))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>my/space-leader-def</span>
</span></span><span class=line><span class=cl> <span class=s>&#34;l&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nb>:ignore</span> <span class=no>t</span> <span class=nb>:wk</span> <span class=s>&#34;Language&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl> <span class=s>&#34;ll&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>gts-do-translate</span> <span class=nb>:wk</span> <span class=s>&#34;Translate&#34;</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=lingva class=headerLink><a href=#lingva class=header-mark></a>lingva</h3><p>go-translate 的备用。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>lingva</span>
</span></span><span class=line><span class=cl>  <span class=nb>:commands</span> <span class=nv>lingva-translate</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>lingva-target</span> <span class=s>&#34;zh&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>my/space-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;lL&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>lingva-translate</span> <span class=nb>:wk</span> <span class=s>&#34;Lingva&#34;</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=sdcv class=headerLink><a href=#sdcv class=header-mark></a>sdcv</h3><p>此 sdcv 来自 <a href=https://github.com/manateelazycat/sdcv/tree/master/ target=_blank rel="noopener noreffer">manateelazycat/sdcv: Emacs interface for sdcv (Stardict console version)</a> 而不是 Melpa 上的。</p><p>关于 sdcv 的词典可以去这下载：<a href=http://download.huzheng.org/dict.org/ target=_blank rel="noopener noreffer">dictd-www.dict.org Dictionaries</a></p><p>默认的颜色不喜欢可以通过 <code>face-spec-set</code> 函数进行设置。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>sdcv</span>
</span></span><span class=line><span class=cl>  <span class=nb>:commands</span> <span class=nv>sdcv-search-pointer</span> <span class=nv>sdcv-search-input+</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>face-spec-set</span> <span class=ss>&#39;sdcv-tooltip-face</span>
</span></span><span class=line><span class=cl>                 <span class=o>&#39;</span><span class=p>((((</span><span class=nv>background</span> <span class=nv>light</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                    <span class=nb>:foreground</span> <span class=s>&#34;#000000&#34;</span> <span class=nb>:background</span> <span class=s>&#34;#ffffff&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                   <span class=p>(</span><span class=no>t</span>
</span></span><span class=line><span class=cl>                    <span class=nb>:foreground</span> <span class=s>&#34;#ffffff&#34;</span> <span class=nb>:background</span> <span class=s>&#34;#000000&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                 <span class=ss>&#39;face-override-spec</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>sdcv-tooltip-border-width</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>sdcv-dictionary-data-dir</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;sdcv-dict&#34;</span> <span class=nv>user-emacs-directory</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>sdcv-program</span> <span class=s>&#34;/opt/homebrew/bin/sdcv&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>sdcv-dictionary-simple-list</span>    <span class=c1>;星际译王屏幕取词词典, 简单, 快速</span>
</span></span><span class=line><span class=cl>        <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;懒虫简明英汉词典&#34;</span>
</span></span><span class=line><span class=cl>          <span class=s>&#34;懒虫简明汉英词典&#34;</span>
</span></span><span class=line><span class=cl>          <span class=s>&#34;KDic11万英汉词典&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>sdcv-dictionary-complete-list</span>     <span class=c1>;星际译王的词典, 完全, 详细</span>
</span></span><span class=line><span class=cl>        <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;牛津英汉双解美化版&#34;</span>
</span></span><span class=line><span class=cl>          <span class=s>&#34;懒虫简明英汉词典&#34;</span>
</span></span><span class=line><span class=cl>          <span class=s>&#34;英汉汉英专业词典&#34;</span>
</span></span><span class=line><span class=cl>          <span class=s>&#34;XDICT英汉辞典&#34;</span>
</span></span><span class=line><span class=cl>          <span class=s>&#34;stardict1.3英汉辞典&#34;</span>
</span></span><span class=line><span class=cl>          <span class=s>&#34;WordNet&#34;</span>
</span></span><span class=line><span class=cl>          <span class=s>&#34;XDICT汉英辞典&#34;</span>
</span></span><span class=line><span class=cl>          <span class=s>&#34;Jargon&#34;</span>
</span></span><span class=line><span class=cl>          <span class=s>&#34;懒虫简明汉英词典&#34;</span>
</span></span><span class=line><span class=cl>          <span class=s>&#34;FOLDOC&#34;</span>
</span></span><span class=line><span class=cl>          <span class=s>&#34;新世纪英汉科技大词典&#34;</span>
</span></span><span class=line><span class=cl>          <span class=s>&#34;KDic11万英汉词典&#34;</span>
</span></span><span class=line><span class=cl>          <span class=s>&#34;朗道汉英字典5.0&#34;</span>
</span></span><span class=line><span class=cl>          <span class=s>&#34;CDICT5英汉辞典&#34;</span>
</span></span><span class=line><span class=cl>          <span class=s>&#34;新世纪汉英科技大词典&#34;</span>
</span></span><span class=line><span class=cl>          <span class=s>&#34;21世纪双语科技词典&#34;</span>
</span></span><span class=line><span class=cl>          <span class=s>&#34;quick_eng-zh_CN&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>my/space-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;lp&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>sdcv-search-pointer</span> <span class=nb>:wk</span> <span class=s>&#34;SDCV Point&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;li&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>sdcv-search-input+</span> <span class=nb>:wk</span> <span class=s>&#34;SDCV Input&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;evil-collection</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>evil-collection-define-key</span> <span class=ss>&#39;normal</span> <span class=ss>&#39;sdcv-mode-map</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;q&#34;</span> <span class=ss>&#39;quit-window</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=osx-dictionary class=headerLink><a href=#osx-dictionary class=header-mark></a>osx-dictionary</h3><p><a href=https://github.com/xuchunyang/osx-dictionary.el target=_blank rel="noopener noreffer">xuchunyang/osx-dictionary.el: Mac OS X Dictionary.app interface for Emacs</a></p><p>这个是使用 MacOS 上自带的 dictionary 进行单词的查询，需要让 dictionary 后台运行，否则无结果显示。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>osx-dictionary</span>
</span></span><span class=line><span class=cl>  <span class=nb>:commands</span> <span class=nv>osx-dictionary-search-pointer</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>my/space-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;ld&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>osx-dictionary-search-pointer</span> <span class=nb>:wk</span> <span class=s>&#34;OSX dictionary&#34;</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=powerthesaurus class=headerLink><a href=#powerthesaurus class=header-mark></a>powerthesaurus</h3><p>这个的好处是可以用于查询同义词、反义词等等，用于替换单词比较方便。</p><p>需要实时在线查询，有时候结果返回的较慢。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>powerthesaurus</span>
</span></span><span class=line><span class=cl>  <span class=nb>:commands</span> <span class=p>(</span><span class=nv>powerthesaurus-lookup-dwim</span>
</span></span><span class=line><span class=cl>             <span class=nv>powerthesaurus-lookup-related-dwim</span>
</span></span><span class=line><span class=cl>             <span class=nv>powerthesaurus-lookup-synonyms-dwim</span>
</span></span><span class=line><span class=cl>             <span class=nv>powerthesaurus-lookup-antonyms-dwim</span>
</span></span><span class=line><span class=cl>             <span class=nv>powerthesaurus-lookup-definitions-dwim</span>
</span></span><span class=line><span class=cl>             <span class=nv>powerthesaurus-lookup-sentences-dwim</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>my/space-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;ls&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nb>:ignore</span> <span class=no>t</span> <span class=nb>:wk</span> <span class=s>&#34;synosaurus&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;lsl&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>powerthesaurus-lookup-dwim</span> <span class=nb>:wk</span> <span class=s>&#34;Dwim&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;lsr&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>powerthesaurus-lookup-related-dwim</span> <span class=nb>:wk</span> <span class=s>&#34;Related&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;lss&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>powerthesaurus-lookup-synonyms-dwim</span> <span class=nb>:wk</span> <span class=s>&#34;Synonyms&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;lsa&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>powerthesaurus-lookup-antonyms-dwim</span> <span class=nb>:wk</span> <span class=s>&#34;Antonyms&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;lsd&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>powerthesaurus-lookup-definitions-dwim</span> <span class=nb>:wk</span> <span class=s>&#34;Definitions&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;lsj&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>powerthesaurus-lookup-sentences-dwim</span> <span class=nb>:wk</span> <span class=s>&#34;Sentences&#34;</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=flycheck class=headerLink><a href=#flycheck class=header-mark></a>flycheck</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>flycheck</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>prog-mode</span> <span class=o>.</span> <span class=nv>flycheck-mode</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=flycheck-grammarly class=headerLink><a href=#flycheck-grammarly class=header-mark></a>flycheck-grammarly</h3><p>langtool 也可以检查语法，相比较 grammarly，不需要连网，所以速度较快。
自动开启此功能导致在文档较大时有明显的卡顿感，手动开启语法检查较好。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>flycheck-grammarly</span>
</span></span><span class=line><span class=cl>  <span class=nb>:after</span> <span class=nv>flycheck</span>
</span></span><span class=line><span class=cl>  <span class=nb>:commands</span> <span class=nv>flycheck-grammarly-setup</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=shortcut class=headerLink><a href=#shortcut class=header-mark></a>shortcut</h3><p>在 MacOS 可以调用 shortcut 使用系统翻译功能。</p><p>此处仅做记录，我不怎么使用。具体的见 <a href=https://emacs-china.org/t/emacs-macos/23268 target=_blank rel="noopener noreffer">Emacs+macOS 最简单也最强大的中英互译设置，不只英语 - Emacs-general - Emacs China</a>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;display-buffer-alist</span>
</span></span><span class=line><span class=cl>             <span class=p>(</span><span class=nf>cons</span>
</span></span><span class=line><span class=cl>              <span class=s>&#34;\\*Async Shell Command\\*.*&#34;</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nf>cons</span> <span class=nf>#&#39;</span><span class=nv>display-buffer-no-window</span> <span class=no>nil</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my/siri-translate</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>tempfile</span> <span class=p>(</span><span class=nv>make-temp-file</span> <span class=s>&#34;siri-translate-&#34;</span> <span class=no>nil</span> <span class=s>&#34;.txt&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>write-region</span>
</span></span><span class=line><span class=cl>     <span class=p>(</span><span class=nf>format</span> <span class=s>&#34;%s&#34;</span> <span class=p>(</span><span class=nv>thing-at-point</span> <span class=ss>&#39;paragraph</span><span class=p>))</span> <span class=no>nil</span> <span class=nv>tempfile</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>end-of-paragraph-text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>shell-command</span> <span class=p>(</span><span class=nf>format</span> <span class=s>&#34;shortcuts run \&#34;Translate File\&#34; -i %s &amp;&#34;</span> <span class=nv>tempfile</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>shell-command</span> <span class=s>&#34;open -b org.gnu.Emacs&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my/siri-translate2english</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>tempfile</span> <span class=p>(</span><span class=nv>make-temp-file</span> <span class=s>&#34;siri-translate-&#34;</span> <span class=no>nil</span> <span class=s>&#34;.txt&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>write-region</span>
</span></span><span class=line><span class=cl>     <span class=p>(</span><span class=nf>format</span> <span class=s>&#34;%s&#34;</span> <span class=p>(</span><span class=nv>thing-at-point</span> <span class=ss>&#39;paragraph</span><span class=p>))</span> <span class=no>nil</span> <span class=nv>tempfile</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>end-of-paragraph-text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>shell-command</span> <span class=p>(</span><span class=nf>format</span> <span class=s>&#34;shortcuts run \&#34;Translate File 2 English\&#34; -i %s &amp;&#34;</span> <span class=nv>tempfile</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>shell-command</span> <span class=s>&#34;open -b org.gnu.Emacs&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>language-to-zh-or-zh-to-english</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nf>string</span> <span class=p>(</span><span class=nv>thing-at-point</span> <span class=ss>&#39;paragraph</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nf>eq</span> <span class=p>(</span><span class=nf>string-match</span> <span class=s>&#34;\\cC&#34;</span> <span class=nf>string</span><span class=p>)</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>my/siri-translate</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>my/siri-translate2english</span><span class=p>))))</span>
</span></span></code></pre></div><h3 id=lsp class=headerLink><a href=#lsp class=header-mark></a>LSP</h3><h4 id=eglot class=headerLink><a href=#eglot class=header-mark></a>eglot</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;yasnippet</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;LaTeX-mode-hook</span> <span class=ss>&#39;eglot-ensure</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=markdown class=headerLink><a href=#markdown class=header-mark></a>markdown</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>markdown-mode</span>
</span></span><span class=line><span class=cl>  <span class=nb>:mode</span> <span class=p>((</span><span class=s>&#34;\\.\\(?:md\\|markdown\\|mkd\\|mdown\\|mkdn\\|mdwn\\)\\&#39;&#34;</span> <span class=o>.</span> <span class=nv>markdown-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=s>&#34;README\\.md\\&#39;&#34;</span> <span class=o>.</span> <span class=nv>gfm-mode</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=nb>:init</span> <span class=p>(</span><span class=nb>setq</span> <span class=nv>markdown-command</span> <span class=s>&#34;multimarkdown&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span> <span class=p>(</span><span class=nb>:map</span> <span class=nv>markdown-mode-map</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=s>&#34;C-c C-e&#34;</span> <span class=o>.</span> <span class=nv>markdown-do</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>;; (with-eval-after-load &#39;whitespace-cleanup-mode</span>
</span></span><span class=line><span class=cl><span class=c1>;;   (add-to-list &#39;whitespace-cleanup-mode-ignore-modes &#39;markdown-mode))</span>
</span></span></code></pre></div><h2 id=organize-life-with-plain-text-high-effective-system class=headerLink><a href=#organize-life-with-plain-text-high-effective-system class=header-mark></a>Organize Life with Plain Text, High Effective System</h2><h3 id=org-mode class=headerLink><a href=#org-mode class=header-mark></a>org-mode</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>org</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-ellipsis</span> <span class=s>&#34; ⇲&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-modules</span> <span class=o>&#39;</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=nv>org-imenu-depth</span> <span class=mi>4</span>
</span></span><span class=line><span class=cl>        <span class=nv>org-return-follows-link</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>        <span class=nv>org-image-actual-width</span> <span class=no>nil</span>
</span></span><span class=line><span class=cl>        <span class=nv>org-display-remote-inline-images</span> <span class=ss>&#39;download</span>
</span></span><span class=line><span class=cl>        <span class=nv>org-log-into-drawer</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>        <span class=nv>org-fast-tag-selection-single-key</span> <span class=ss>&#39;expert</span>
</span></span><span class=line><span class=cl>        <span class=nv>org-adapt-indentation</span> <span class=no>nil</span>
</span></span><span class=line><span class=cl>        <span class=nv>org-fontify-quote-and-verse-blocks</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>        <span class=nv>org-support-shift-select</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>        <span class=nv>org-treat-S-cursor-todo-selection-as-state-change</span> <span class=no>nil</span>
</span></span><span class=line><span class=cl>        <span class=nv>org-hide-leading-stars</span> <span class=no>nil</span>
</span></span><span class=line><span class=cl>        <span class=nv>org-startup-with-inline-images</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>        <span class=nv>org-image-actual-width</span> <span class=o>&#39;</span><span class=p>(</span><span class=mi>500</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nv>org-use-speed-commands</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-enforce-todo-dependencies</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-enforce-todo-checkbox-dependencies</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-todo-repeat-to-state</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-todo-keywords</span>
</span></span><span class=line><span class=cl>        <span class=o>&#39;</span><span class=p>((</span><span class=nv>sequence</span> <span class=s>&#34;TODO(t)&#34;</span> <span class=s>&#34;NEXT(n)&#34;</span> <span class=s>&#34;INPROGRESS(i)&#34;</span> <span class=s>&#34;|&#34;</span> <span class=s>&#34;WAIT(w@)&#34;</span> <span class=s>&#34;SOMEDAY(s@)&#34;</span> <span class=s>&#34;CNCL(c@/!)&#34;</span> <span class=s>&#34;DONE(d)&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-todo-state-tags-triggers</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nb>quote</span> <span class=p>((</span><span class=s>&#34;CNCL&#34;</span> <span class=p>(</span><span class=s>&#34;CNCL&#34;</span> <span class=o>.</span> <span class=no>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=s>&#34;WAIT&#34;</span> <span class=p>(</span><span class=s>&#34;WAIT&#34;</span> <span class=o>.</span> <span class=no>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=s>&#34;SOMEDAY&#34;</span> <span class=p>(</span><span class=s>&#34;WAIT&#34;</span><span class=p>)</span> <span class=p>(</span><span class=s>&#34;SOMEDAY&#34;</span> <span class=o>.</span> <span class=no>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=nv>done</span> <span class=p>(</span><span class=s>&#34;WAIT&#34;</span><span class=p>)</span> <span class=p>(</span><span class=s>&#34;SOMEDAY&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=s>&#34;TODO&#34;</span> <span class=p>(</span><span class=s>&#34;WAIT&#34;</span><span class=p>)</span> <span class=p>(</span><span class=s>&#34;CNCL&#34;</span><span class=p>)</span> <span class=p>(</span><span class=s>&#34;SOMEDAY&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=s>&#34;NEXT&#34;</span> <span class=p>(</span><span class=s>&#34;WAIT&#34;</span><span class=p>)</span> <span class=p>(</span><span class=s>&#34;CNCL&#34;</span><span class=p>)</span> <span class=p>(</span><span class=s>&#34;SOMEDAY&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=s>&#34;DONE&#34;</span> <span class=p>(</span><span class=s>&#34;WAIT&#34;</span><span class=p>)</span> <span class=p>(</span><span class=s>&#34;CNCL&#34;</span><span class=p>)</span> <span class=p>(</span><span class=s>&#34;SOMEDAY&#34;</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span> <span class=p>(</span><span class=nb>:map</span> <span class=nv>org-mode-map</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=s>&#34;C-c l&#34;</span> <span class=o>.</span> <span class=nv>org-store-link</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>              <span class=c1>;; (&#34;&lt;return&gt;&#34; . org-return)))</span>
</span></span></code></pre></div><h4 id=babel class=headerLink><a href=#babel class=header-mark></a>Babel</h4><p>以下配置来源：<a href=https://emacs-china.org/t/org-babel/18699 target=_blank rel="noopener noreffer">https://emacs-china.org/t/org-babel/18699</a></p><p>禁用 org babel 加载的语言可以有效的提高 Emacs 的启动速度。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>(org-babel-do-load-languages
</span></span><span class=line><span class=cl> &#39;org-babel-load-languages
</span></span><span class=line><span class=cl> &#39;((emacs-lisp . t)))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>ob-core</span>
</span></span><span class=line><span class=cl>  <span class=nb>:after</span> <span class=nv>org</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>defun</span> <span class=nv>my/org-babel-execute-src-block</span> <span class=p>(</span><span class=kp>&amp;optional</span> <span class=nv>_arg</span> <span class=nv>info</span> <span class=nv>_params</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;Load language if needed&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>let*</span> <span class=p>((</span><span class=nv>lang</span> <span class=p>(</span><span class=nf>nth</span> <span class=mi>0</span> <span class=nv>info</span><span class=p>))</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>sym</span> <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nf>member</span> <span class=p>(</span><span class=nf>downcase</span> <span class=nv>lang</span><span class=p>)</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;c&#34;</span> <span class=s>&#34;cpp&#34;</span> <span class=s>&#34;c++&#34;</span><span class=p>))</span> <span class=ss>&#39;C</span> <span class=p>(</span><span class=nf>intern</span> <span class=nv>lang</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>backup-languages</span> <span class=nv>org-babel-load-languages</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>unless</span> <span class=p>(</span><span class=nf>assoc</span> <span class=nv>sym</span> <span class=nv>backup-languages</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nb>condition-case</span> <span class=nv>err</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nb>progn</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nv>org-babel-do-load-languages</span> <span class=ss>&#39;org-babel-load-languages</span> <span class=p>(</span><span class=nf>list</span> <span class=p>(</span><span class=nf>cons</span> <span class=nv>sym</span> <span class=no>t</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nb>setq-default</span> <span class=nv>org-babel-load-languages</span> <span class=p>(</span><span class=nf>append</span> <span class=p>(</span><span class=nf>list</span> <span class=p>(</span><span class=nf>cons</span> <span class=nv>sym</span> <span class=no>t</span><span class=p>))</span> <span class=nv>backup-languages</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nv>file-missing</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nb>setq-default</span> <span class=nv>org-babel-load-languages</span> <span class=nv>backup-languages</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=nv>err</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>advice-add</span> <span class=ss>&#39;org-babel-execute-src-block</span> <span class=nb>:before</span> <span class=ss>&#39;my/org-babel-execute-src-block</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-confirm-babel-evaluate</span> <span class=no>nil</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=org-capture class=headerLink><a href=#org-capture class=header-mark></a>org-capture</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>org-capture</span>
</span></span><span class=line><span class=cl>  <span class=nb>:after</span> <span class=nv>org</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span> <span class=p>(</span><span class=nb>:map</span> <span class=nv>org-capture-mode-map</span>
</span></span><span class=line><span class=cl>              <span class=p>([</span><span class=nv>remap</span> <span class=nv>evil-save-and-close</span><span class=p>]</span> <span class=o>.</span> <span class=nv>org-capture-finalize</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=p>([</span><span class=nv>remap</span> <span class=nv>evil-save-modified-and-close</span><span class=p>]</span> <span class=o>.</span> <span class=nv>org-capture-finalize</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=p>([</span><span class=nv>remap</span> <span class=nv>evil-quit</span><span class=p>]</span> <span class=o>.</span> <span class=nv>org-capture-kill</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=s>&#34;RET&#34;</span> <span class=o>.</span> <span class=nv>org-capture-finalize</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-capture-templates</span>
</span></span><span class=line><span class=cl>        <span class=o>&#39;</span><span class=p>((</span><span class=s>&#34;i&#34;</span> <span class=s>&#34;Inbox&#34;</span>
</span></span><span class=line><span class=cl>           <span class=nv>plain</span> <span class=p>(</span><span class=nv>file+olp+datetree</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span> <span class=p>(</span><span class=nf>concat</span> <span class=nv>my-galaxy</span> <span class=s>&#34;/inbox/inbox.org&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>           <span class=s>&#34;**** %?\n%U\n&#34;</span> <span class=nb>:time-prompt</span> <span class=no>t</span> <span class=nb>:tree-type</span> <span class=nv>week</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;p&#34;</span> <span class=s>&#34;Daily Plan&#34;</span>
</span></span><span class=line><span class=cl>           <span class=nv>plain</span> <span class=p>(</span><span class=nv>file+olp+datetree</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span> <span class=p>(</span><span class=nf>concat</span> <span class=nv>my-galaxy</span> <span class=s>&#34;/inbox/plan.org&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>           <span class=s>&#34;- [ ] %?\n%U\n&#34;</span> <span class=nb>:time-prompt</span> <span class=no>t</span> <span class=nb>:tree-type</span> <span class=nv>week</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;r&#34;</span> <span class=s>&#34;Reflection&#34;</span>
</span></span><span class=line><span class=cl>           <span class=nv>plain</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>file+olp+datetree</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span> <span class=p>(</span><span class=nf>concat</span> <span class=nv>my-galaxy</span> <span class=s>&#34;/roam/main/reflection.org&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>file</span> <span class=s>&#34;~/.emacs.d/template/tpl-daily-reflection&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=nb>:time-prompt</span> <span class=no>t</span> <span class=nb>:tree-type</span> <span class=nv>week</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;a&#34;</span> <span class=s>&#34;Anki Deck&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;ae&#34;</span> <span class=s>&#34;Deck: English&#34;</span>
</span></span><span class=line><span class=cl>           <span class=nv>entry</span> <span class=p>(</span><span class=nv>file</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>                         <span class=p>(</span><span class=nf>concat</span> <span class=nv>my-galaxy</span> <span class=s>&#34;/anki/anki_english.org&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>           <span class=s>&#34;* %?\n&#34;</span> <span class=nb>:jump-to-captured</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;ac&#34;</span> <span class=s>&#34;Deck: Civil Engineering&#34;</span>
</span></span><span class=line><span class=cl>           <span class=nv>entry</span> <span class=p>(</span><span class=nv>file</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>                         <span class=p>(</span><span class=nf>concat</span> <span class=nv>my-galaxy</span> <span class=s>&#34;/anki/anki_engineering.org&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>           <span class=s>&#34;* %?\n&#34;</span> <span class=nb>:jump-to-captured</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;s&#34;</span> <span class=s>&#34;Code snippets&#34;</span>
</span></span><span class=line><span class=cl>           <span class=nv>entry</span> <span class=p>(</span><span class=nv>file</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>                         <span class=p>(</span><span class=nf>concat</span> <span class=nv>my-galaxy</span> <span class=s>&#34;/scripts/snippets.org&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>           <span class=s>&#34;* %?\t%^g\n#+BEGIN_SRC %^{language}\n\n#+END_SRC&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=c1>;; (&#34;l&#34; &#34;Lists&#34;)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;m&#34;</span> <span class=s>&#34;Movie&#34;</span>
</span></span><span class=line><span class=cl>           <span class=nv>entry</span> <span class=p>(</span><span class=nv>file+headline</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span> <span class=p>(</span><span class=nf>concat</span> <span class=nv>my-galaxy</span> <span class=s>&#34;/roam/main/watchlist.org&#34;</span><span class=p>))</span> <span class=s>&#34;Watching Lists&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=s>&#34;* %?
</span></span></span><span class=line><span class=cl><span class=s>:PROPERTIES:
</span></span></span><span class=line><span class=cl><span class=s>:GENRE: %^{Film genre|Action|Adventure|Comedy|Drama|Fantasy|Horror|Musicals|Mystery|Romance|Science fiction|Sports|Thriller}
</span></span></span><span class=line><span class=cl><span class=s>:COUNTRY:
</span></span></span><span class=line><span class=cl><span class=s>:SCORE:
</span></span></span><span class=line><span class=cl><span class=s>:PLOT: %^{PLOT}
</span></span></span><span class=line><span class=cl><span class=s>:END:&#34;</span><span class=p>))))</span>
</span></span></code></pre></div><p>由于使用了 org-roam 的自动弹出功能，导致 org-capture 的时候光标未能正常的跳转到 org-capture 的窗口当中，使用下面的方法来规避这个问题。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my/org-capture</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Make a new frame to do org-capture staff.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>make-frame</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>org-capture</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;org-capture-after-finalize-hook</span> <span class=ss>&#39;delete-frame</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;&lt;f10&gt;&#34;</span><span class=p>)</span> <span class=ss>&#39;my/org-capture</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=org-archive class=headerLink><a href=#org-archive class=header-mark></a>org-archive</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>org-archive</span>
</span></span><span class=line><span class=cl>  <span class=nb>:after</span> <span class=nv>org</span>
</span></span><span class=line><span class=cl>  <span class=nb>:init</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-archive-location</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;todos/gtd_archive.org::datetree/&#34;</span> <span class=nv>my-galaxy</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>defun</span> <span class=nv>my/gtd-archive</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;Archive tasks to specific file.&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>find-file</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;todos/gtd_archive.org&#34;</span> <span class=nv>my-galaxy</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>my/space-leader-def</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;foa&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>my/gtd-archive</span> <span class=nb>:wk</span> <span class=s>&#34;Archive File&#34;</span><span class=p>)))</span>
</span></span></code></pre></div><h4 id=org-attach class=headerLink><a href=#org-attach class=header-mark></a>org-attach</h4><p>POST：<a href=https://fuco1.github.io/2023-02-08-Visit-the-org-headline-from-the-attach-dired-buffer.html target=_blank rel="noopener noreffer">Visit the org headline from the attach dired buffer</a>
通常不需要管理附件在文件夹中是怎么存放的，找到 heading 就可以找到对应的附件。
或者当在 <code>dired</code> 中查看 <code>attach</code> 文件夹中的附件时，可以使用 <code>my/org-attach-visit-heading-from-dired</code> 函数跳转到对应的 heading 位置。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>org-attach</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-attach-id-dir</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;attach&#34;</span> <span class=nv>my-galaxy</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>defun</span> <span class=nv>my/org-attach-visit-headline-from-dired</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;Go to the headline corresponding to this org-attach directory.&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>let*</span> <span class=p>((</span><span class=nv>id-parts</span> <span class=p>(</span><span class=nv>last</span> <span class=p>(</span><span class=nv>split-string</span> <span class=nv>default-directory</span> <span class=s>&#34;/&#34;</span> <span class=no>t</span><span class=p>)</span> <span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>id</span> <span class=p>(</span><span class=nf>apply</span> <span class=nf>#&#39;concat</span> <span class=nv>id-parts</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>m</span> <span class=p>(</span><span class=nv>org-id-find</span> <span class=nv>id</span> <span class=ss>&#39;marker</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nb>unless</span> <span class=nv>m</span> <span class=p>(</span><span class=ne>user-error</span> <span class=s>&#34;Cannot find entry with ID \&#34;%s\&#34;&#34;</span> <span class=nv>id</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>pop-to-buffer</span> <span class=p>(</span><span class=nf>marker-buffer</span> <span class=nv>m</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nf>goto-char</span> <span class=nv>m</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>move-marker</span> <span class=nv>m</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>org-fold-show-context</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;display-buffer-alist</span>
</span></span><span class=line><span class=cl>               <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;\\*Org Attach\\*&#34;</span>
</span></span><span class=line><span class=cl>                 <span class=p>(</span><span class=nv>display-buffer-pop-up-frame</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                 <span class=p>(</span><span class=nv>side</span> <span class=o>.</span> <span class=nv>right</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                 <span class=p>(</span><span class=nv>slot</span> <span class=o>.</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                 <span class=p>(</span><span class=nv>window-width</span> <span class=o>.</span> <span class=mf>0.5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                 <span class=p>(</span><span class=nf>window-parameters</span> <span class=o>.</span> <span class=p>((</span><span class=nv>no-other-window</span> <span class=o>.</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                                       <span class=p>(</span><span class=nv>no-delete-other-windows</span> <span class=o>.</span> <span class=no>t</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span> <span class=p>(</span><span class=nb>:map</span> <span class=nv>dired-mode-map</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=s>&#34;C-&#39;&#34;</span> <span class=o>.</span> <span class=nv>my/org-attach-visit-headline-from-dired</span><span class=p>)))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my/copy-or-move-file-to-buffer-dir</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>file-name</span> <span class=kp>&amp;optional</span> <span class=nv>arg</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Copy or move the FILE-NAME to the directory of the buffer&#39;s file.\n
</span></span></span><span class=line><span class=cl><span class=s>With prefix argument ARG, copy the file instead of moving it.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span> <span class=s>&#34;FFile to move: \nP&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>new-file-name</span> <span class=p>(</span><span class=nf>concat</span> <span class=p>(</span><span class=nf>file-name-directory</span> <span class=p>(</span><span class=nf>buffer-file-name</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                               <span class=p>(</span><span class=nf>file-name-nondirectory</span> <span class=nv>file-name</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nv>not</span> <span class=p>(</span><span class=nf>file-exists-p</span> <span class=nv>file-name</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=ne>error</span> <span class=s>&#34;File does not exist: %s&#34;</span> <span class=nv>file-name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nf>file-exists-p</span> <span class=nv>new-file-name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=ne>error</span> <span class=s>&#34;File already exists: %s&#34;</span> <span class=nv>new-file-name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nb>progn</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>command</span> <span class=p>(</span><span class=nb>if</span> <span class=nv>arg</span> <span class=ss>&#39;copy-file</span> <span class=ss>&#39;rename-file</span> <span class=p>)))</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nf>funcall</span> <span class=nv>command</span> <span class=nv>file-name</span> <span class=nv>new-file-name</span> <span class=no>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nb>if</span> <span class=nv>arg</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nv>find-file-noselect</span> <span class=nv>new-file-name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nb>progn</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=nf>kill-buffer</span> <span class=p>(</span><span class=nf>current-buffer</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=nf>delete-file</span> <span class=nv>file-name</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nf>message</span> <span class=s>&#34;File %s to %s&#34;</span>
</span></span><span class=line><span class=cl>                   <span class=p>(</span><span class=nb>if</span> <span class=nv>arg</span> <span class=s>&#34;moved&#34;</span> <span class=s>&#34;copied&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                   <span class=nv>new-file-name</span><span class=p>))))))</span>
</span></span></code></pre></div><h4 id=org-habit class=headerLink><a href=#org-habit class=header-mark></a>org-habit</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>org-habit</span>
</span></span><span class=line><span class=cl>  <span class=nb>:after</span> <span class=nv>org-agenda</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;org-modules</span> <span class=ss>&#39;org-habit</span> <span class=no>t</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=org-id class=headerLink><a href=#org-id class=header-mark></a>org-id</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>org-id</span>
</span></span><span class=line><span class=cl>  <span class=nb>:after</span> <span class=nv>org</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-id-method</span> <span class=ss>&#39;ts</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-id-link-to-org-use-id</span> <span class=ss>&#39;create-if-interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>defun</span> <span class=nv>my/copy-idlink</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;Copy idlink to clipboard.&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nf>eq</span> <span class=nv>major-mode</span> <span class=ss>&#39;org-agenda-mode</span><span class=p>)</span> <span class=c1>;switch to orgmode</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>org-agenda-show</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>org-agenda-goto</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nf>eq</span> <span class=nv>major-mode</span> <span class=ss>&#39;org-mode</span><span class=p>)</span> <span class=c1>; do this only in org-mode buffers</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>let*</span> <span class=p>((</span><span class=nv>mytmphead</span> <span class=p>(</span><span class=nf>nth</span> <span class=mi>4</span> <span class=p>(</span><span class=nv>org-heading-components</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>             <span class=p>(</span><span class=nv>mytmpid</span> <span class=p>(</span><span class=nf>funcall</span> <span class=ss>&#39;org-id-get-create</span><span class=p>))</span>
</span></span><span class=line><span class=cl>             <span class=p>(</span><span class=nv>mytmplink</span> <span class=p>(</span><span class=nf>format</span> <span class=s>&#34;- [ ] [[id:%s][%s]]&#34;</span> <span class=nv>mytmpid</span> <span class=nv>mytmphead</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>kill-new</span> <span class=nv>mytmplink</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nf>message</span> <span class=s>&#34;Copied %s to killring (clipboard)&#34;</span> <span class=nv>mytmplink</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span> <span class=p>(</span><span class=s>&#34;&lt;f7&gt;&#34;</span> <span class=o>.</span> <span class=nv>my/copy-idlink</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>my/space-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;oi&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>org-id-get-create</span> <span class=nb>:wk</span> <span class=s>&#34;Create ID&#34;</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=org-src class=headerLink><a href=#org-src class=header-mark></a>org-src</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>org-src</span>
</span></span><span class=line><span class=cl>  <span class=nb>:after</span> <span class=nv>org</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-src-window-setup</span> <span class=ss>&#39;current-window</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-src-ask-before-returning-to-edit-buffer</span> <span class=no>nil</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=org-refile class=headerLink><a href=#org-refile class=header-mark></a>org-refile</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>org-refile</span>
</span></span><span class=line><span class=cl>  <span class=nb>:after</span> <span class=nv>org</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-refile-targets</span> <span class=o>&#39;</span><span class=p>((</span><span class=no>nil</span> <span class=nb>:maxlevel</span> <span class=o>.</span> <span class=mi>9</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                             <span class=p>(</span><span class=nv>org-agenda-files</span> <span class=nb>:maxlevel</span> <span class=o>.</span> <span class=mi>9</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-refile-use-outline-path</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-outline-path-complete-in-steps</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-refile-allow-creating-parent-nodes</span> <span class=ss>&#39;confirm</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-refile-use-outline-path</span> <span class=ss>&#39;file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-refile-active-region-within-subtree</span> <span class=no>t</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=org-emphasis-alist class=headerLink><a href=#org-emphasis-alist class=header-mark></a>org-emphasis-alist</h4><p>此处的设置来源：<a href=https://protesilaos.com/emacs/modus-themes target=_blank rel="noopener noreffer">https://protesilaos.com/emacs/modus-themes</a></p><p>若升级 modus-themes 到 4.0 的版本，可能需要修改。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>org</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>defface</span> <span class=nv>my-org-emphasis-bold</span>
</span></span><span class=line><span class=cl>    <span class=o>&#39;</span><span class=p>((</span><span class=nv>default</span> <span class=nb>:inherit</span> <span class=nv>bold</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(((</span><span class=nv>class</span> <span class=nv>color</span><span class=p>)</span> <span class=p>(</span><span class=nv>min-colors</span> <span class=mi>88</span><span class=p>)</span> <span class=p>(</span><span class=nv>background</span> <span class=nv>light</span><span class=p>))</span>
</span></span><span class=line><span class=cl>       <span class=nb>:foreground</span> <span class=s>&#34;#a60000&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(((</span><span class=nv>class</span> <span class=nv>color</span><span class=p>)</span> <span class=p>(</span><span class=nv>min-colors</span> <span class=mi>88</span><span class=p>)</span> <span class=p>(</span><span class=nv>background</span> <span class=nv>dark</span><span class=p>))</span>
</span></span><span class=line><span class=cl>       <span class=nb>:foreground</span> <span class=s>&#34;#ff8059&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;My bold emphasis for Org.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>defface</span> <span class=nv>my-org-emphasis-italic</span>
</span></span><span class=line><span class=cl>    <span class=o>&#39;</span><span class=p>((</span><span class=nv>default</span> <span class=nb>:inherit</span> <span class=nv>italic</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(((</span><span class=nv>class</span> <span class=nv>color</span><span class=p>)</span> <span class=p>(</span><span class=nv>min-colors</span> <span class=mi>88</span><span class=p>)</span> <span class=p>(</span><span class=nv>background</span> <span class=nv>light</span><span class=p>))</span>
</span></span><span class=line><span class=cl>       <span class=nb>:foreground</span> <span class=s>&#34;#005e00&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(((</span><span class=nv>class</span> <span class=nv>color</span><span class=p>)</span> <span class=p>(</span><span class=nv>min-colors</span> <span class=mi>88</span><span class=p>)</span> <span class=p>(</span><span class=nv>background</span> <span class=nv>dark</span><span class=p>))</span>
</span></span><span class=line><span class=cl>       <span class=nb>:foreground</span> <span class=s>&#34;#44bc44&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;My italic emphasis for Org.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>defface</span> <span class=nv>my-org-emphasis-underline</span>
</span></span><span class=line><span class=cl>    <span class=o>&#39;</span><span class=p>((</span><span class=nv>default</span> <span class=nb>:inherit</span> <span class=nv>underline</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(((</span><span class=nv>class</span> <span class=nv>color</span><span class=p>)</span> <span class=p>(</span><span class=nv>min-colors</span> <span class=mi>88</span><span class=p>)</span> <span class=p>(</span><span class=nv>background</span> <span class=nv>light</span><span class=p>))</span>
</span></span><span class=line><span class=cl>       <span class=nb>:foreground</span> <span class=s>&#34;#813e00&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(((</span><span class=nv>class</span> <span class=nv>color</span><span class=p>)</span> <span class=p>(</span><span class=nv>min-colors</span> <span class=mi>88</span><span class=p>)</span> <span class=p>(</span><span class=nv>background</span> <span class=nv>dark</span><span class=p>))</span>
</span></span><span class=line><span class=cl>       <span class=nb>:foreground</span> <span class=s>&#34;#d0bc00&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;My underline emphasis for Org.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>defface</span> <span class=nv>my-org-emphasis-strike-through</span>
</span></span><span class=line><span class=cl>    <span class=o>&#39;</span><span class=p>((</span><span class=nv>default</span> <span class=nb>:strike-through</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(((</span><span class=nv>class</span> <span class=nv>color</span><span class=p>)</span> <span class=p>(</span><span class=nv>min-colors</span> <span class=mi>88</span><span class=p>)</span> <span class=p>(</span><span class=nv>background</span> <span class=nv>light</span><span class=p>))</span>
</span></span><span class=line><span class=cl>       <span class=nb>:foreground</span> <span class=s>&#34;#505050&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(((</span><span class=nv>class</span> <span class=nv>color</span><span class=p>)</span> <span class=p>(</span><span class=nv>min-colors</span> <span class=mi>88</span><span class=p>)</span> <span class=p>(</span><span class=nv>background</span> <span class=nv>dark</span><span class=p>))</span>
</span></span><span class=line><span class=cl>       <span class=nb>:foreground</span> <span class=s>&#34;#a8a8a8&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;My strike-through emphasis for Org.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>defface</span> <span class=nv>my-org-emphasis-strike-through</span>
</span></span><span class=line><span class=cl>    <span class=o>&#39;</span><span class=p>((((</span><span class=nv>class</span> <span class=nv>color</span><span class=p>)</span> <span class=p>(</span><span class=nv>min-colors</span> <span class=mi>88</span><span class=p>)</span> <span class=p>(</span><span class=nv>background</span> <span class=nv>light</span><span class=p>))</span>
</span></span><span class=line><span class=cl>       <span class=nb>:strike-through</span> <span class=s>&#34;#972500&#34;</span> <span class=nb>:foreground</span> <span class=s>&#34;#505050&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(((</span><span class=nv>class</span> <span class=nv>color</span><span class=p>)</span> <span class=p>(</span><span class=nv>min-colors</span> <span class=mi>88</span><span class=p>)</span> <span class=p>(</span><span class=nv>background</span> <span class=nv>dark</span><span class=p>))</span>
</span></span><span class=line><span class=cl>       <span class=nb>:strike-through</span> <span class=s>&#34;#ef8b50&#34;</span> <span class=nb>:foreground</span> <span class=s>&#34;#a8a8a8&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;My strike-through emphasis for Org.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-emphasis-alist</span>
</span></span><span class=line><span class=cl>        <span class=o>&#39;</span><span class=p>((</span><span class=s>&#34;*&#34;</span> <span class=nv>my-org-emphasis-bold</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;/&#34;</span> <span class=nv>my-org-emphasis-italic</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;_&#34;</span> <span class=nv>my-org-emphasis-underline</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;=&#34;</span> <span class=nv>org-verbatim</span> <span class=nv>verbatim</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;~&#34;</span> <span class=nv>org-code</span> <span class=nv>verbatim</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;+&#34;</span> <span class=nv>my-org-emphasis-strike-through</span><span class=p>))))</span>
</span></span></code></pre></div><h4 id=org-clock class=headerLink><a href=#org-clock class=header-mark></a>org-clock</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>org-clock</span>
</span></span><span class=line><span class=cl>  <span class=nb>:after</span> <span class=nv>org</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>org-clock-persistence-insinuate</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-clock-history-length</span> <span class=mi>23</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-clock-in-resume</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-clock-into-drawer</span> <span class=s>&#34;LOGCLOCK&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-clock-out-remove-zero-time-clocks</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-clock-out-when-done</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-clock-persist</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-clock-clocktable-default-properties</span> <span class=o>&#39;</span><span class=p>(</span><span class=nb>:maxlevel</span> <span class=mi>5</span> <span class=nb>:link</span> <span class=no>t</span> <span class=nb>:tags</span> <span class=no>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-clock-persist-query-resume</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-clock-report-include-clocking-task</span> <span class=no>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>my/space-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;oc&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nb>:ignore</span> <span class=no>t</span> <span class=nb>:wk</span> <span class=s>&#34;Clock&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;ocj&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>org-clock-goto</span> <span class=nb>:wk</span> <span class=s>&#34;Clock goto&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;oci&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>org-clock-in</span> <span class=nb>:wk</span> <span class=s>&#34;Clock In&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;oco&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>org-clock-out</span> <span class=nb>:wk</span> <span class=s>&#34;Clock Out&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;ocl&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>org-clock-in-last</span> <span class=nb>:wk</span> <span class=s>&#34;Clock In Last&#34;</span><span class=p>))</span>
</span></span></code></pre></div><p>这个用于 clocktable 进行任务时间的汇总比较，目前我用它来统计一年的读书时长计录，及一年读了哪些书。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=c1>;; https://200ok.ch/posts/2022-12-07_streamline_your_org_mode_workflow_with_automatic_clock_table_recalculation.html</span>
</span></span><span class=line><span class=cl><span class=c1>;; Need add #+AUTOCALC_CLOCK_TABLES to org file.</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;org</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;org-options-keywords</span> <span class=s>&#34;AUTOCALC_CLOCK_TABLES:&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>autocalc-clocktable</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Auto update clock table.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nv>derived-mode-p</span> <span class=ss>&#39;org-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>save-excursion</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nf>goto-char</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nf>string-equal</span> <span class=p>(</span><span class=nf>car</span>
</span></span><span class=line><span class=cl>                         <span class=p>(</span><span class=nf>cdr</span>
</span></span><span class=line><span class=cl>                          <span class=p>(</span><span class=nf>car</span>
</span></span><span class=line><span class=cl>                           <span class=p>(</span><span class=nv>org-collect-keywords</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;AUTOCALC_CLOCK_TABLES&#34;</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>                        <span class=s>&#34;t&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nb>progn</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nf>goto-char</span> <span class=p>(</span><span class=nf>search-forward</span> <span class=s>&#34;clocktable&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nv>org-ctrl-c-ctrl-c</span><span class=p>))))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;before-save-hook</span> <span class=ss>&#39;autocalc-clocktable</span><span class=p>)</span>
</span></span></code></pre></div><p>Punch in or out.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>bh/keep-clock-running</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>bh/is-task-p</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Any task with a todo keyword and no subtask.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>save-restriction</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>widen</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>has-subtask</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nv>subtree-end</span> <span class=p>(</span><span class=nb>save-excursion</span> <span class=p>(</span><span class=nv>org-end-of-subtree</span> <span class=no>t</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nv>is-a-task</span> <span class=p>(</span><span class=nf>member</span> <span class=p>(</span><span class=nf>nth</span> <span class=mi>2</span> <span class=p>(</span><span class=nv>org-heading-components</span><span class=p>))</span> <span class=nv>org-todo-keywords-1</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>save-excursion</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nf>forward-line</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nb>while</span> <span class=p>(</span><span class=nb>and</span> <span class=p>(</span><span class=nv>not</span> <span class=nv>has-subtask</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=p>(</span><span class=nf>&lt;</span> <span class=p>(</span><span class=nf>point</span><span class=p>)</span> <span class=nv>subtree-end</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=p>(</span><span class=nf>re-search-forward</span> <span class=s>&#34;^\*+ &#34;</span> <span class=nv>subtree-end</span> <span class=no>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nf>member</span> <span class=p>(</span><span class=nv>org-get-todo-state</span><span class=p>)</span> <span class=nv>org-todo-keywords-1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nb>setq</span> <span class=nv>has-subtask</span> <span class=no>t</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>and</span> <span class=nv>is-a-task</span> <span class=p>(</span><span class=nv>not</span> <span class=nv>has-subtask</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>bh/is-project-p</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Any task with a todo keyword subtask.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>save-restriction</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>widen</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>has-subtask</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nv>subtree-end</span> <span class=p>(</span><span class=nb>save-excursion</span> <span class=p>(</span><span class=nv>org-end-of-subtree</span> <span class=no>t</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nv>is-a-task</span> <span class=p>(</span><span class=nf>member</span> <span class=p>(</span><span class=nf>nth</span> <span class=mi>2</span> <span class=p>(</span><span class=nv>org-heading-components</span><span class=p>))</span> <span class=nv>org-todo-keywords-1</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>save-excursion</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nf>forward-line</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nb>while</span> <span class=p>(</span><span class=nb>and</span> <span class=p>(</span><span class=nv>not</span> <span class=nv>has-subtask</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=p>(</span><span class=nf>&lt;</span> <span class=p>(</span><span class=nf>point</span><span class=p>)</span> <span class=nv>subtree-end</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=p>(</span><span class=nf>re-search-forward</span> <span class=s>&#34;^\*+ &#34;</span> <span class=nv>subtree-end</span> <span class=no>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nf>member</span> <span class=p>(</span><span class=nv>org-get-todo-state</span><span class=p>)</span> <span class=nv>org-todo-keywords-1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nb>setq</span> <span class=nv>has-subtask</span> <span class=no>t</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>and</span> <span class=nv>is-a-task</span> <span class=nv>has-subtask</span><span class=p>))))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>bh/find-project-task</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Move point to the parent (project) task if any.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>save-restriction</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>widen</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>parent-task</span> <span class=p>(</span><span class=nb>save-excursion</span> <span class=p>(</span><span class=nv>org-back-to-heading</span> <span class=ss>&#39;invisible-ok</span><span class=p>)</span> <span class=p>(</span><span class=nf>point</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>while</span> <span class=p>(</span><span class=nv>org-up-heading-safe</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nf>member</span> <span class=p>(</span><span class=nf>nth</span> <span class=mi>2</span> <span class=p>(</span><span class=nv>org-heading-components</span><span class=p>))</span> <span class=nv>org-todo-keywords-1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nb>setq</span> <span class=nv>parent-task</span> <span class=p>(</span><span class=nf>point</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nf>goto-char</span> <span class=nv>parent-task</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=nv>parent-task</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>bh/is-project-subtree-p</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Any task with a todo keyword that is in a project subtree.
</span></span></span><span class=line><span class=cl><span class=s> Callers of this function already widen the buffer view.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>task</span> <span class=p>(</span><span class=nb>save-excursion</span> <span class=p>(</span><span class=nv>org-back-to-heading</span> <span class=ss>&#39;invisible-ok</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                              <span class=p>(</span><span class=nf>point</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>save-excursion</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>bh/find-project-task</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nf>point</span><span class=p>)</span> <span class=nv>task</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=no>nil</span>
</span></span><span class=line><span class=cl>        <span class=no>t</span><span class=p>))))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>bh/clock-in-to-next</span> <span class=p>(</span><span class=nv>kw</span><span class=p>)</span> <span class=c1>;; kw should not been deleted.</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Switch a task from TODO to NEXT when clocking in.
</span></span></span><span class=line><span class=cl><span class=s> Skips capture tasks, projects, and subprojects.
</span></span></span><span class=line><span class=cl><span class=s> Switch projects and subprojects from NEXT back to TODO&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nv>not</span> <span class=p>(</span><span class=nb>and</span> <span class=p>(</span><span class=nf>boundp</span> <span class=ss>&#39;org-capture-mode</span><span class=p>)</span> <span class=nv>org-capture-mode</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>cond</span>
</span></span><span class=line><span class=cl>     <span class=p>((</span><span class=nb>and</span> <span class=p>(</span><span class=nf>member</span> <span class=p>(</span><span class=nv>org-get-todo-state</span><span class=p>)</span> <span class=p>(</span><span class=nf>list</span> <span class=s>&#34;TODO&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>bh/is-task-p</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=s>&#34;NEXT&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=p>((</span><span class=nb>and</span> <span class=p>(</span><span class=nf>member</span> <span class=p>(</span><span class=nv>org-get-todo-state</span><span class=p>)</span> <span class=p>(</span><span class=nf>list</span> <span class=s>&#34;NEXT&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>bh/is-project-p</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=s>&#34;TODO&#34;</span><span class=p>))))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>bh/punch-in</span> <span class=p>(</span><span class=nv>arg</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Start continuous clocking and set the default task to the selected task.
</span></span></span><span class=line><span class=cl><span class=s> If </span><span class=ss>`ARG&#39;</span><span class=s> is nil, set the Organization task
</span></span></span><span class=line><span class=cl><span class=s> as the default task.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span> <span class=s>&#34;p&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>bh/keep-clock-running</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nf>equal</span> <span class=nv>major-mode</span> <span class=ss>&#39;org-agenda-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=c1>;;</span>
</span></span><span class=line><span class=cl>      <span class=c1>;; We&#39;re in the agenda</span>
</span></span><span class=line><span class=cl>      <span class=c1>;;</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>let*</span> <span class=p>((</span><span class=nv>marker</span> <span class=p>(</span><span class=nv>org-get-at-bol</span> <span class=ss>&#39;org-hd-marker</span><span class=p>))</span>
</span></span><span class=line><span class=cl>             <span class=p>(</span><span class=nv>tags</span> <span class=p>(</span><span class=nv>org-with-point-at</span> <span class=nv>marker</span> <span class=p>(</span><span class=nv>org-get-tags</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nb>and</span> <span class=p>(</span><span class=nf>eq</span> <span class=nv>arg</span> <span class=mi>4</span><span class=p>)</span> <span class=nv>tags</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nv>org-agenda-clock-in</span> <span class=o>&#39;</span><span class=p>(</span><span class=mi>16</span><span class=p>))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nv>bh/clock-in-default-task-as-default</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=c1>;;</span>
</span></span><span class=line><span class=cl>    <span class=c1>;; We are not in the agenda</span>
</span></span><span class=line><span class=cl>    <span class=c1>;;</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>save-restriction</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nf>widen</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                                        <span class=c1>; Find the tags on the current task</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nb>and</span> <span class=p>(</span><span class=nf>equal</span> <span class=nv>major-mode</span> <span class=ss>&#39;org-mode</span><span class=p>)</span> <span class=p>(</span><span class=nv>not</span> <span class=p>(</span><span class=nv>org-before-first-heading-p</span><span class=p>))</span> <span class=p>(</span><span class=nf>eq</span> <span class=nv>arg</span> <span class=mi>4</span><span class=p>))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nv>org-clock-in</span> <span class=o>&#39;</span><span class=p>(</span><span class=mi>16</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>bh/clock-in-default-task-as-default</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>bh/punch-out</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Punch out.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>bh/keep-clock-running</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nv>org-clock-is-active</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>org-clock-out</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>org-agenda-remove-restriction-lock</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>bh/clock-in-default-task</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Clock In default task with specific ID.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>save-excursion</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>org-with-point-at</span> <span class=nv>org-clock-default-task</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>org-clock-in</span><span class=p>))))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>bh/clock-in-parent-task</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Move point to the parent (project) task if any and clock in.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>parent-task</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>save-excursion</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>save-restriction</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nf>widen</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nb>while</span> <span class=p>(</span><span class=nb>and</span> <span class=p>(</span><span class=nv>not</span> <span class=nv>parent-task</span><span class=p>)</span> <span class=p>(</span><span class=nv>org-up-heading-safe</span><span class=p>))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nf>member</span> <span class=p>(</span><span class=nf>nth</span> <span class=mi>2</span> <span class=p>(</span><span class=nv>org-heading-components</span><span class=p>))</span> <span class=nv>org-todo-keywords-1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nb>setq</span> <span class=nv>parent-task</span> <span class=p>(</span><span class=nf>point</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nb>if</span> <span class=nv>parent-task</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nv>org-with-point-at</span> <span class=nv>parent-task</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nv>org-clock-in</span><span class=p>))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nb>when</span> <span class=nv>bh/keep-clock-running</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nv>bh/clock-in-default-task</span><span class=p>)))))))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defvar</span> <span class=nv>bh/default-task-id</span> <span class=s>&#34;20220524T114723.420565&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>bh/clock-in-default-task-as-default</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Clock in default task.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>org-with-point-at</span> <span class=p>(</span><span class=nv>org-id-find</span> <span class=nv>bh/default-task-id</span> <span class=ss>&#39;marker</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>org-clock-in</span> <span class=o>&#39;</span><span class=p>(</span><span class=mi>16</span><span class=p>))))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>bh/clock-out-maybe</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Clock out.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nb>and</span> <span class=nv>bh/keep-clock-running</span>
</span></span><span class=line><span class=cl>             <span class=p>(</span><span class=nv>not</span> <span class=nv>org-clock-clocking-in</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=p>(</span><span class=nf>marker-buffer</span> <span class=nv>org-clock-default-task</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=p>(</span><span class=nv>not</span> <span class=nv>org-clock-resolving-clocks-due-to-idleness</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>bh/clock-in-parent-task</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;org-clock-out-hook</span> <span class=ss>&#39;bh/clock-out-maybe</span> <span class=ss>&#39;append</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>bh/clock-in-last-task</span> <span class=p>(</span><span class=nv>arg</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Clock in the interrupted task if there is one.
</span></span></span><span class=line><span class=cl><span class=s> Skip the default task and get the next one.
</span></span></span><span class=line><span class=cl><span class=s> A prefix </span><span class=ss>`ARG&#39;</span><span class=s> forces clock in of the default task.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span> <span class=s>&#34;p&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>clock-in-to-task</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nb>cond</span>
</span></span><span class=line><span class=cl>          <span class=p>((</span><span class=nf>eq</span> <span class=nv>arg</span> <span class=mi>4</span><span class=p>)</span> <span class=nv>org-clock-default-task</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>((</span><span class=nb>and</span> <span class=p>(</span><span class=nv>org-clock-is-active</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=nf>equal</span> <span class=nv>org-clock-default-task</span> <span class=p>(</span><span class=nv>cadr</span> <span class=nv>org-clock-history</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>caddr</span> <span class=nv>org-clock-history</span><span class=p>))</span>
</span></span><span class=line><span class=cl>          <span class=p>((</span><span class=nv>org-clock-is-active</span><span class=p>)</span> <span class=p>(</span><span class=nv>cadr</span> <span class=nv>org-clock-history</span><span class=p>))</span>
</span></span><span class=line><span class=cl>          <span class=p>((</span><span class=nf>equal</span> <span class=nv>org-clock-default-task</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>org-clock-history</span><span class=p>))</span> <span class=p>(</span><span class=nv>cadr</span> <span class=nv>org-clock-history</span><span class=p>))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=no>t</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>org-clock-history</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>widen</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>org-with-point-at</span> <span class=nv>clock-in-to-task</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>org-clock-in</span> <span class=no>nil</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my/toggle-punch-in-or-out</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Start clock or stop it when there is a clocking.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nv>org-clocking-p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>progn</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>bh/punch-out</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>alert</span> <span class=s>&#34;Wish you have a good day!&#34;</span> <span class=nb>:title</span> <span class=s>&#34;Punch Out&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>progn</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>bh/punch-in</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>alert</span> <span class=s>&#34;Start Working: Fighting&#34;</span> <span class=nb>:title</span> <span class=s>&#34;Punch In&#34;</span> <span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>my/comma-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;i&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>my/toggle-punch-in-or-out</span> <span class=nb>:wk</span> <span class=s>&#34;Punch In or Out&#34;</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=org-buffer class=headerLink><a href=#org-buffer class=header-mark></a>org buffer</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;display-buffer-alist</span>
</span></span><span class=line><span class=cl>             <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;\\*Org Note\\*&#34;</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nv>display-buffer-in-side-window</span><span class=p>)</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nv>side</span> <span class=o>.</span> <span class=nv>right</span><span class=p>)</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nv>slot</span> <span class=o>.</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nv>window-width</span> <span class=o>.</span> <span class=mf>0.5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nf>window-parameters</span> <span class=o>.</span> <span class=p>((</span><span class=nv>no-other-window</span> <span class=o>.</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                                     <span class=p>(</span><span class=nv>no-delete-other-windows</span> <span class=o>.</span> <span class=no>t</span><span class=p>)))))</span>
</span></span></code></pre></div><h4 id=ol class=headerLink><a href=#ol class=header-mark></a>ol</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>ol</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-link-frame-setup</span> <span class=o>&#39;</span><span class=p>((</span><span class=nv>vm</span> <span class=o>.</span> <span class=nv>vm-visit-folder-other-frame</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                               <span class=p>(</span><span class=nv>vm-imap</span> <span class=o>.</span> <span class=nv>vm-visit-imap-folder-other-frame</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                               <span class=p>(</span><span class=nv>gnus</span> <span class=o>.</span> <span class=nv>org-gnus-no-new-news</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                               <span class=p>(</span><span class=nv>file</span> <span class=o>.</span> <span class=nv>find-file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                               <span class=p>(</span><span class=nv>wl</span> <span class=o>.</span> <span class=nv>wl-other-frame</span><span class=p>))))</span>
</span></span></code></pre></div><h3 id=ekg class=headerLink><a href=#ekg class=header-mark></a>ekg</h3><p>轻度尝试，目前还有很多的不足，日常使用不太够。
和其他的模块不能很好的合作，如 org-agenda，math-preview。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>ekg</span>
</span></span><span class=line><span class=cl>  <span class=nb>:commands</span> <span class=p>(</span><span class=nv>ekg-show-notes-in-trash</span>
</span></span><span class=line><span class=cl>             <span class=nv>ekg-show-notes-for-today</span>
</span></span><span class=line><span class=cl>             <span class=nv>ekg-show-notes-with-tag</span>
</span></span><span class=line><span class=cl>             <span class=nv>ekg-show-notes-with-all-tags</span>
</span></span><span class=line><span class=cl>             <span class=nv>ekg-show-notes-with-any-tags</span>
</span></span><span class=line><span class=cl>             <span class=nv>ekg-show-rename-tag</span>
</span></span><span class=line><span class=cl>             <span class=nv>ekg-browse-url</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span> <span class=p>((</span><span class=s>&#34;&lt;f9&gt;&#34;</span> <span class=o>.</span> <span class=nv>ekg-capture</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=s>&#34;M-&lt;f9&gt;&#34;</span> <span class=o>.</span> <span class=nv>ekg-capture-url</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=nb>:general</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>evil-define-key</span> <span class=ss>&#39;motion</span> <span class=nv>ekg-notes-mode-map</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;q&#34;</span> <span class=ss>&#39;quit-window</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>triples-default-database-filename</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;ekg/triples.db&#34;</span> <span class=nv>my-galaxy</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>my/space-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;e&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nb>:ignore</span> <span class=no>t</span> <span class=nb>:wk</span> <span class=s>&#34;EKG&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;ee&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>ekg-show-notes-with-tag</span> <span class=nb>:wk</span> <span class=s>&#34;With TAG&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;ed&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>ekg-show-notes-for-today</span> <span class=nb>:wk</span> <span class=s>&#34;Today&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;eA&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>ekg-show-notes-with-all-tags</span> <span class=nb>:wk</span> <span class=s>&#34;All TAG&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;ea&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>ekg-show-notes-with-any-tags</span> <span class=nb>:wk</span> <span class=s>&#34;Any TAG&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;et&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>ekg-show-notes-in-trash</span> <span class=nb>:wk</span> <span class=s>&#34;Trash&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;er&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>ekg-rename-tag</span> <span class=nb>:wk</span> <span class=s>&#34;Rename TAG&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;eb&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>ekg-browse-url</span> <span class=nb>:wk</span> <span class=s>&#34;Open URL&#34;</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=org-roam class=headerLink><a href=#org-roam class=header-mark></a>org-roam</h3><p>readinglog 和 reference 模板见 &lt;./template/> 文件夹。</p><p>Org-roam 默认会缓存所有的节点（文件或标题），若要排除不需要的节点可以使用 <code>ROAM_EXCLUDE</code> 关键字或者使用 <code>org-roam-db-node-include-function</code> 函数。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>(setq org-roam-db-node-include-function
</span></span><span class=line><span class=cl>      (lambda ()
</span></span><span class=line><span class=cl>        (not (member &#34;ATTACH&#34; (org-get-tags)))))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>org-roam</span>
</span></span><span class=line><span class=cl>  <span class=nb>:commands</span> <span class=nv>org-roam-node-find</span>
</span></span><span class=line><span class=cl>  <span class=nb>:init</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-roam-directory</span> <span class=p>(</span><span class=nv>file-truename</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;roam&#34;</span> <span class=nv>my-galaxy</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>((</span><span class=nv>on-first-input</span> <span class=o>.</span> <span class=nv>org-roam-db-autosync-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>org-mode</span> <span class=o>.</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span> <span class=p>(</span><span class=nb>setq-local</span> <span class=nv>time-stamp-active</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>                                       <span class=nv>time-stamp-start</span> <span class=s>&#34;#\\+MODIFIED:[ \t]*&#34;</span>
</span></span><span class=line><span class=cl>                                       <span class=nv>time-stamp-end</span> <span class=s>&#34;$&#34;</span>
</span></span><span class=line><span class=cl>                                       <span class=nv>time-stamp-format</span> <span class=s>&#34;\[%Y-%m-%d %3a %H:%M\]&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                       <span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;before-save-hook</span> <span class=ss>&#39;time-stamp</span> <span class=no>nil</span> <span class=ss>&#39;local</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>org-roam-mode</span> <span class=o>.</span> <span class=nv>hide-mode-line-mode</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-roam-database-connector</span> <span class=ss>&#39;sqlite</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-roam-db-gc-threshold</span> <span class=nv>most-positive-fixnum</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-roam-mode-sections</span>
</span></span><span class=line><span class=cl>        <span class=o>&#39;</span><span class=p>((</span><span class=nv>org-roam-backlinks-section</span> <span class=nb>:unique</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=nv>org-roam-reflinks-section</span>
</span></span><span class=line><span class=cl>          <span class=nv>org-roam-unlinked-references-section</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>cl-defmethod</span> <span class=nv>org-roam-node-type</span> <span class=p>((</span><span class=nv>node</span> <span class=nv>org-roam-node</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;Return the TYPE of NODE.&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>condition-case</span> <span class=no>nil</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nf>file-name-nondirectory</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nf>directory-file-name</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nf>file-name-directory</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>file-relative-name</span> <span class=p>(</span><span class=nv>org-roam-node-file</span> <span class=nv>node</span><span class=p>)</span> <span class=nv>org-roam-directory</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=ne>error</span> <span class=s>&#34;&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>cl-defmethod</span> <span class=nv>org-roam-node-directories</span> <span class=p>((</span><span class=nv>node</span> <span class=nv>org-roam-node</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>if-let</span> <span class=p>((</span><span class=nv>dirs</span> <span class=p>(</span><span class=nf>file-name-directory</span> <span class=p>(</span><span class=nv>file-relative-name</span> <span class=p>(</span><span class=nv>org-roam-node-file</span> <span class=nv>node</span><span class=p>)</span> <span class=nv>org-roam-directory</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nf>format</span> <span class=s>&#34;(%s)&#34;</span> <span class=p>(</span><span class=nf>car</span> <span class=p>(</span><span class=nv>split-string</span> <span class=nv>dirs</span> <span class=s>&#34;/&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>      <span class=s>&#34;&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>cl-defmethod</span> <span class=nv>org-roam-node-backlinkscount</span> <span class=p>((</span><span class=nv>node</span> <span class=nv>org-roam-node</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>let*</span> <span class=p>((</span><span class=nv>count</span> <span class=p>(</span><span class=nv>caar</span> <span class=p>(</span><span class=nv>org-roam-db-query</span>
</span></span><span class=line><span class=cl>                         <span class=p>[</span><span class=nb>:select</span> <span class=p>(</span><span class=nf>funcall</span> <span class=nv>count</span> <span class=nv>source</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                                  <span class=nb>:from</span> <span class=nv>links</span>
</span></span><span class=line><span class=cl>                                  <span class=nb>:where</span> <span class=p>(</span><span class=nf>=</span> <span class=nv>dest</span> <span class=nv>$s1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                                  <span class=nb>:and</span> <span class=p>(</span><span class=nf>=</span> <span class=nv>type</span> <span class=s>&#34;id&#34;</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>                         <span class=p>(</span><span class=nv>org-roam-node-id</span> <span class=nv>node</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nf>format</span> <span class=s>&#34;[%d]&#34;</span> <span class=nv>count</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>cl-defmethod</span> <span class=nv>org-roam-node-doom-filetitle</span> <span class=p>((</span><span class=nv>node</span> <span class=nv>org-roam-node</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;Return the value of \&#34;#+title:\&#34; (if any) from file that NODE resides in.
</span></span></span><span class=line><span class=cl><span class=s>       If there&#39;s no file-level title in the file, return empty string.&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>or</span> <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nf>=</span> <span class=p>(</span><span class=nv>org-roam-node-level</span> <span class=nv>node</span><span class=p>)</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nv>org-roam-node-title</span> <span class=nv>node</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nv>org-roam-get-keyword</span> <span class=s>&#34;TITLE&#34;</span> <span class=p>(</span><span class=nv>org-roam-node-file</span> <span class=nv>node</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>        <span class=s>&#34;&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>cl-defmethod</span> <span class=nv>org-roam-node-doom-hierarchy</span> <span class=p>((</span><span class=nv>node</span> <span class=nv>org-roam-node</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;Return hierarchy for NODE, constructed of its file title, OLP and direct title.
</span></span></span><span class=line><span class=cl><span class=s>       If some elements are missing, they will be stripped out.&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>title</span>     <span class=p>(</span><span class=nv>org-roam-node-title</span> <span class=nv>node</span><span class=p>))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nv>olp</span>       <span class=p>(</span><span class=nv>org-roam-node-olp</span>   <span class=nv>node</span><span class=p>))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nv>level</span>     <span class=p>(</span><span class=nv>org-roam-node-level</span> <span class=nv>node</span><span class=p>))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nv>filetitle</span> <span class=p>(</span><span class=nv>org-roam-node-doom-filetitle</span> <span class=nv>node</span><span class=p>))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nv>separator</span> <span class=p>(</span><span class=nf>propertize</span> <span class=s>&#34; &gt; &#34;</span> <span class=ss>&#39;face</span> <span class=ss>&#39;shadow</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>cl-case</span> <span class=nv>level</span>
</span></span><span class=line><span class=cl>        <span class=c1>;; node is a top-level file</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=mi>0</span> <span class=nv>filetitle</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1>;; node is a level 1 heading</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=mi>1</span> <span class=p>(</span><span class=nf>concat</span> <span class=p>(</span><span class=nf>propertize</span> <span class=nv>filetitle</span> <span class=ss>&#39;face</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>shadow</span> <span class=nv>italic</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                   <span class=nv>separator</span> <span class=nv>title</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=c1>;; node is a heading with an arbitrary outline path</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=no>t</span> <span class=p>(</span><span class=nf>concat</span> <span class=p>(</span><span class=nf>propertize</span> <span class=nv>filetitle</span> <span class=ss>&#39;face</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>shadow</span> <span class=nv>italic</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                   <span class=nv>separator</span> <span class=p>(</span><span class=nf>propertize</span> <span class=p>(</span><span class=nv>string-join</span> <span class=nv>olp</span> <span class=s>&#34; &gt; &#34;</span><span class=p>)</span> <span class=ss>&#39;face</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>shadow</span> <span class=nv>italic</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                   <span class=nv>separator</span> <span class=nv>title</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>;; 获得文件的修改时间.</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>cl-defmethod</span> <span class=nv>org-roam-node-date</span> <span class=p>((</span><span class=nv>node</span> <span class=nv>org-roam-node</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>format-time-string</span> <span class=s>&#34;%Y-%m-%d&#34;</span> <span class=p>(</span><span class=nv>org-roam-node-file-mtime</span> <span class=nv>node</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-roam-node-display-template</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nf>concat</span> <span class=s>&#34;${type:4} ${backlinkscount:3} &#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=nf>propertize</span> <span class=s>&#34;${doom-hierarchy:*}&#34;</span> <span class=ss>&#39;face</span> <span class=ss>&#39;org-level-3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=nf>propertize</span> <span class=s>&#34;${tags:20}&#34;</span> <span class=ss>&#39;face</span> <span class=ss>&#39;org-tag</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=s>&#34; &#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-roam-capture-templates</span>
</span></span><span class=line><span class=cl>        <span class=o>&#39;</span><span class=p>((</span><span class=s>&#34;a&#34;</span> <span class=s>&#34;articles&#34;</span> <span class=nv>plain</span> <span class=s>&#34;%?&#34;</span>
</span></span><span class=line><span class=cl>           <span class=nb>:target</span> <span class=p>(</span><span class=nv>file+head</span> <span class=s>&#34;articles/${slug}.org&#34;</span>
</span></span><span class=line><span class=cl>                              <span class=s>&#34;#+TITLE: ${title}\n#+CREATED: %U\n#+MODIFIED: \n&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=nb>:unnarrowed</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;b&#34;</span> <span class=s>&#34;Books&#34;</span> <span class=nv>plain</span> <span class=p>(</span><span class=nv>file</span> <span class=s>&#34;~/.emacs.d/template/readinglog&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=nb>:target</span> <span class=p>(</span><span class=nv>file+head</span> <span class=s>&#34;books/${slug}.org&#34;</span>
</span></span><span class=line><span class=cl>                              <span class=s>&#34;#+TITLE: ${title}\n#+CREATED: %U\n#+MODIFIED: \n&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=nb>:unnarrowed</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;d&#34;</span> <span class=s>&#34;Diary&#34;</span> <span class=nv>plain</span> <span class=s>&#34;%?&#34;</span>
</span></span><span class=line><span class=cl>           <span class=nb>:target</span> <span class=p>(</span><span class=nv>file+datetree</span> <span class=s>&#34;daily/&lt;%Y-%m&gt;.org&#34;</span> <span class=nv>day</span><span class=p>))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;m&#34;</span> <span class=s>&#34;main&#34;</span> <span class=nv>plain</span> <span class=s>&#34;%?&#34;</span>
</span></span><span class=line><span class=cl>           <span class=nb>:target</span> <span class=p>(</span><span class=nv>file+head</span> <span class=s>&#34;main/${slug}.org&#34;</span>
</span></span><span class=line><span class=cl>                              <span class=s>&#34;#+TITLE: ${title}\n#+CREATED: %U\n#+MODIFIED: \n&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=nb>:unnarrowed</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;p&#34;</span> <span class=s>&#34;people&#34;</span> <span class=nv>plain</span> <span class=p>(</span><span class=nv>file</span> <span class=s>&#34;~/.emacs.d/template/crm&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=nb>:target</span> <span class=p>(</span><span class=nv>file+head</span> <span class=s>&#34;crm/${slug}.org&#34;</span>
</span></span><span class=line><span class=cl>                              <span class=s>&#34;#+TITLE: ${title}\n#+CREATED: %U\n#+MODIFIED: \n&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=nb>:unnarrowed</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;r&#34;</span> <span class=s>&#34;reference&#34;</span> <span class=nv>plain</span> <span class=p>(</span><span class=nv>file</span> <span class=s>&#34;~/.emacs.d/template/reference&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=nb>:target</span> <span class=p>(</span><span class=nv>file+head</span> <span class=s>&#34;ref/${citekey}.org&#34;</span>
</span></span><span class=line><span class=cl>                              <span class=s>&#34;#+TITLE: ${title}\n#+CREATED: %U\n#+MODIFIED: \n&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=nb>:unnarrowed</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;s&#34;</span> <span class=s>&#34;sources&#34;</span> <span class=nv>plain</span> <span class=s>&#34;%?&#34;</span>
</span></span><span class=line><span class=cl>           <span class=nb>:target</span> <span class=p>(</span><span class=nv>file+head</span> <span class=s>&#34;sources/${slug}.org&#34;</span>
</span></span><span class=line><span class=cl>                              <span class=s>&#34;#+TITLE: ${title}\n#+CREATED: %U\n#+MODIFIED: \n&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=nb>:unnarrowed</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;w&#34;</span> <span class=s>&#34;work&#34;</span> <span class=nv>plain</span> <span class=s>&#34;%?&#34;</span>
</span></span><span class=line><span class=cl>           <span class=nb>:target</span> <span class=p>(</span><span class=nv>file+head</span> <span class=s>&#34;work/${slug}.org&#34;</span>
</span></span><span class=line><span class=cl>                              <span class=s>&#34;#+TITLE: ${title}\n#+CREATED: %U\n#+MODIFIED: \n&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=nb>:unnarrowed</span> <span class=no>t</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>defun</span> <span class=nv>my/org-roam-buffer-show</span> <span class=p>(</span><span class=nv>_</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nb>and</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>not</span> <span class=p>(</span><span class=nf>minibufferp</span><span class=p>))</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>not</span> <span class=p>(</span><span class=nf>&gt;</span> <span class=mi>120</span> <span class=p>(</span><span class=nv>frame-width</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>not</span> <span class=p>(</span><span class=nv>derived-mode-p</span> <span class=ss>&#39;calendar-mode</span><span class=p>))</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>not</span> <span class=p>(</span><span class=nv>derived-mode-p</span> <span class=ss>&#39;org-agenda-mode</span><span class=p>))</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>xor</span> <span class=p>(</span><span class=nv>org-roam-file-p</span><span class=p>)</span> <span class=p>(</span><span class=nf>eq</span> <span class=ss>&#39;visible</span> <span class=p>(</span><span class=nv>org-roam-buffer--visibility</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>org-roam-buffer-toggle</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;window-buffer-change-functions</span> <span class=ss>&#39;my/org-roam-buffer-show</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;display-buffer-alist</span>
</span></span><span class=line><span class=cl>               <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;\\*org-roam\\*&#34;</span>
</span></span><span class=line><span class=cl>                 <span class=p>(</span><span class=nv>display-buffer-reuse-window</span> <span class=nv>display-buffer-in-side-window</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                 <span class=p>(</span><span class=nv>side</span> <span class=o>.</span> <span class=nv>right</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                 <span class=p>(</span><span class=nv>slot</span> <span class=o>.</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                 <span class=p>(</span><span class=nv>window-width</span> <span class=o>.</span> <span class=mf>0.35</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                 <span class=p>(</span><span class=nf>window-parameters</span> <span class=o>.</span> <span class=p>((</span><span class=nv>no-other-window</span> <span class=o>.</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                                       <span class=p>(</span><span class=nv>no-delete-other-windows</span> <span class=o>.</span> <span class=no>t</span><span class=p>))))))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>my/space-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;n&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nb>:ignore</span> <span class=no>t</span> <span class=nb>:wk</span> <span class=s>&#34;Notes&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;nr&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>org-roam-node-random</span> <span class=nb>:wk</span> <span class=s>&#34;Random node&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=s>&#34;nf&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>org-roam-node-find</span> <span class=nb>:wk</span> <span class=s>&#34;Find node&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;ni&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>org-roam-node-insert</span> <span class=nb>:wk</span> <span class=s>&#34;Insert node&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=s>&#34;na&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>org-roam-alias-add</span> <span class=nb>:wk</span> <span class=s>&#34;Add alias&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;nA&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>org-roam-alias-remove</span> <span class=nb>:wk</span> <span class=s>&#34;Remove alias&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=s>&#34;nt&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>org-roam-tag-add</span> <span class=nb>:wk</span> <span class=s>&#34;Add tag&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;nT&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>org-roam-tag-remove</span> <span class=nb>:wk</span> <span class=s>&#34;Remove tag&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=s>&#34;nd&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>org-roam-dailies-goto-today</span> <span class=nb>:wk</span> <span class=s>&#34;Goto today&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>my/space-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;r&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nb>:ignore</span> <span class=no>t</span> <span class=nb>:wk</span> <span class=s>&#34;References&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;ra&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>org-roam-ref-add</span> <span class=nb>:wk</span> <span class=s>&#34;Ref add&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;rf&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>org-roam-ref-find</span> <span class=nb>:wk</span> <span class=s>&#34;Ref find&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;rr&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>org-roam-ref-remove</span> <span class=nb>:wk</span> <span class=s>&#34;Ref remove&#34;</span><span class=p>))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>org</span>
</span></span><span class=line><span class=cl>  <span class=nb>:after</span> <span class=nv>evil</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>defun</span> <span class=nv>gpc/open-node-roam-ref-url</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;Open the URL in this node&#39;s ROAM_REFS property, if one exists.&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>when-let</span> <span class=p>((</span><span class=nv>ref-url</span> <span class=p>(</span><span class=nv>org-entry-get-with-inheritance</span> <span class=s>&#34;ROAM_REFS&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>browse-url</span> <span class=nv>ref-url</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>evil-collection-define-key</span> <span class=ss>&#39;normal</span> <span class=ss>&#39;org-mode-map</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;zr&#34;</span> <span class=ss>&#39;gpc/open-node-roam-ref-url</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=org-roam-ui class=headerLink><a href=#org-roam-ui class=header-mark></a>org-roam-ui</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>org-roam-ui</span>
</span></span><span class=line><span class=cl>  <span class=nb>:commands</span> <span class=nv>org-roam-ui-open</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-roam-ui-sync-theme</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-roam-ui-follow</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-roam-ui-update-on-save</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-roam-ui-open-on-start</span> <span class=no>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>my/space-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;nu&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nb>:ignore</span> <span class=nb>:wk</span> <span class=s>&#34;Roam UI&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;nuu&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>org-roam-ui-open</span> <span class=nb>:wk</span> <span class=s>&#34;Open&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;nuz&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>org-roam-ui-node-zoom</span> <span class=nb>:wk</span> <span class=s>&#34;Node zoom&#34;</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=consult-org-roam class=headerLink><a href=#consult-org-roam class=header-mark></a>consult-org-roam</h4><p>这个包提供了 3 个有用的函数，可以方便的进行链接的 forward 和 backlink 的跳转，以及进行内容的查找。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>consult-org-roam</span>
</span></span><span class=line><span class=cl>  <span class=nb>:commands</span> <span class=p>(</span><span class=nv>consult-org-roam-backlinks</span> <span class=nv>consult-org-roam-forward-links</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>my/space-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;ns&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>consult-org-roam-search</span> <span class=nb>:wk</span> <span class=s>&#34;Search&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;evil</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>evil-collection-define-key</span> <span class=ss>&#39;normal</span> <span class=ss>&#39;org-mode-map</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;zb&#34;</span> <span class=ss>&#39;consult-org-roam-backlinks</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;zf&#34;</span> <span class=ss>&#39;consult-org-roam-forward-links</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=consult-notes class=headerLink><a href=#consult-notes class=header-mark></a>consult-notes</h4><p>这个包结合 denote 比较好用，不需要结合 org-roam 使用。</p><p>因为我己经不使用 deft 而是使用 consult-notes 来管理自己写的博客。使用下面的函数来创建新的文章， consult-notes 只能用于查询，无新建文件的功能。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>consult-notes</span>
</span></span><span class=line><span class=cl>  <span class=nb>:after</span> <span class=nv>consult</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>consult-notes-file-dir-sources</span>
</span></span><span class=line><span class=cl>        <span class=o>`</span><span class=p>((</span><span class=s>&#34;Articles&#34;</span>  <span class=sc>?a</span>  <span class=o>,</span><span class=p>(</span><span class=nf>concat</span> <span class=nv>my-galaxy</span> <span class=s>&#34;/articles&#34;</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>defun</span> <span class=nv>my/new-article</span> <span class=p>(</span><span class=nv>article</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>interactive</span> <span class=s>&#34;sTitle: &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>filename</span> <span class=p>(</span><span class=nf>format</span> <span class=s>&#34;%s&#34;</span> <span class=nv>article</span><span class=p>))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nv>ext</span> <span class=s>&#34;.org&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>find-file</span> <span class=p>(</span><span class=nf>concat</span> <span class=nv>my-galaxy</span> <span class=s>&#34;/articles/&#34;</span> <span class=nv>filename</span> <span class=nv>ext</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nf>insert</span> <span class=s>&#34;#+TITLE: &#34;</span> <span class=nv>article</span> <span class=s>&#34;\n&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>tempel-insert</span> <span class=ss>&#39;hugo</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>my/space-leader-def</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;nc&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>my/new-article</span> <span class=nb>:wk</span> <span class=s>&#34;Create article&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;nn&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>consult-notes</span> <span class=nb>:wk</span> <span class=s>&#34;Consult notes&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>consult-notes-org-roam</span>
</span></span><span class=line><span class=cl>  <span class=nb>:commands</span> <span class=nv>consult-notes-org-roam-find-node-relation</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>my/space-leader-def</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;nv&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>consult-notes-org-roam-find-node-relation</span> <span class=nb>:wk</span> <span class=s>&#34;Node navigation&#34;</span><span class=p>)))</span>
</span></span></code></pre></div><h4 id=org-transclusion class=headerLink><a href=#org-transclusion class=header-mark></a>org-transclusion</h4><p>这里需要结合 <a href=#fringe-mode rel>fringe-mode</a> 使用，不能完全隐藏 fringe, 否则会没有效果。我设置的是 minimal.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>org-transclusion</span>
</span></span><span class=line><span class=cl>  <span class=nb>:commands</span> <span class=p>(</span><span class=nv>org-transclusion-make-from-link</span> <span class=nv>org-transclusion-add</span> <span class=nv>org-transclusion-add-all</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>face-spec-set</span> <span class=ss>&#39;org-transclusion-fringe</span>
</span></span><span class=line><span class=cl>                 <span class=o>&#39;</span><span class=p>((((</span><span class=nv>background</span> <span class=nv>light</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                    <span class=nb>:foreground</span> <span class=s>&#34;black&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                   <span class=p>(</span><span class=no>t</span>
</span></span><span class=line><span class=cl>                    <span class=nb>:foreground</span> <span class=s>&#34;white&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                 <span class=ss>&#39;face-override-spec</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>face-spec-set</span> <span class=ss>&#39;org-transclusion-source-fringe</span>
</span></span><span class=line><span class=cl>                 <span class=o>&#39;</span><span class=p>((((</span><span class=nv>background</span> <span class=nv>light</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                    <span class=nb>:foreground</span> <span class=s>&#34;black&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                   <span class=p>(</span><span class=no>t</span>
</span></span><span class=line><span class=cl>                    <span class=nb>:foreground</span> <span class=s>&#34;white&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                 <span class=ss>&#39;face-override-spec</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>my/space-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;ot&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nb>:ignore</span> <span class=no>t</span> <span class=nb>:wk</span> <span class=s>&#34;Transclusion&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;ota&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>org-transclusion-add</span> <span class=nb>:wk</span> <span class=s>&#34;Add&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;otA&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>org-transclusion-add-all</span> <span class=nb>:wk</span> <span class=s>&#34;Add all&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;otr&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>org-transclusion-remove</span> <span class=nb>:wk</span> <span class=s>&#34;Remove&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;otR&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>org-transclusion-remove-all</span> <span class=nb>:wk</span> <span class=s>&#34;Remove all&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;otg&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>org-transclusion-refresh</span> <span class=nb>:wk</span> <span class=s>&#34;Refresh&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;otm&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>org-transclusion-make-from-link</span> <span class=nb>:wk</span> <span class=s>&#34;Make link&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;oto&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>org-transclusion-open-source</span> <span class=nb>:wk</span> <span class=s>&#34;Open source&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;ote&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>org-transclusion-live-sync-start</span> <span class=nb>:wk</span> <span class=s>&#34;Edit live&#34;</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=dynamic-org-agenda class=headerLink><a href=#dynamic-org-agenda class=header-mark></a>dynamic org-agenda</h3><p>vulpea to build dynamic agenda.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=c1>;; (autoload &#39;vulpea-buffer-tags-get &#34;vulpea&#34; &#34;&#34; t) ;</span>
</span></span><span class=line><span class=cl><span class=c1>;; (autoload &#39;vulpea-buffer-tags-add &#34;vulpea&#34; &#34;&#34; t)</span>
</span></span><span class=line><span class=cl><span class=c1>;; (autoload &#39;vulpea-buffer-tags-remove &#34;vulpea&#34; &#34;&#34; t)</span>
</span></span><span class=line><span class=cl><span class=c1>;; (autoload &#39;vulpea-buffer-prop-set &#34;vulpea&#34; &#34;&#34; t)</span>
</span></span><span class=line><span class=cl><span class=c1>;; (autoload &#39;vulpea-buffer-prop-get &#34;vulpea&#34; &#34;&#34; t)</span>
</span></span><span class=line><span class=cl><span class=c1>;; (autoload &#39;vulpea-buffer-prop-set-list &#34;vulpea&#34; &#34;&#34; t)</span>
</span></span><span class=line><span class=cl><span class=c1>;; (autoload &#39;vulpea-buffer-prop-get-list &#34;vulpea&#34; &#34;&#34; t)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>vulpea</span>
</span></span><span class=line><span class=cl>  <span class=nb>:after</span> <span class=nv>org-roam</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>defun</span> <span class=nv>vulpea-project-p</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;Return non-nil if current buffer has any todo entry.
</span></span></span><span class=line><span class=cl><span class=s>  TODO entries marked as done are ignored, meaning the this
</span></span></span><span class=line><span class=cl><span class=s>  function returns nil if current buffer contains only completed
</span></span></span><span class=line><span class=cl><span class=s>  tasks.&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>seq-find</span>                                 <span class=c1>; (3)</span>
</span></span><span class=line><span class=cl>     <span class=p>(</span><span class=nb>lambda</span> <span class=p>(</span><span class=nv>type</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=p>(</span><span class=nb>or</span> <span class=p>(</span><span class=nf>eq</span> <span class=nv>type</span> <span class=ss>&#39;todo</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nf>eq</span> <span class=nv>type</span> <span class=ss>&#39;done</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>     <span class=p>(</span><span class=nv>org-element-map</span>                         <span class=c1>; (2)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>org-element-parse-buffer</span> <span class=ss>&#39;headline</span><span class=p>)</span> <span class=c1>; (1)</span>
</span></span><span class=line><span class=cl>         <span class=ss>&#39;headline</span>
</span></span><span class=line><span class=cl>       <span class=p>(</span><span class=nb>lambda</span> <span class=p>(</span><span class=nv>h</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>org-element-property</span> <span class=nb>:todo-type</span> <span class=nv>h</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>defun</span> <span class=nv>vulpea-buffer-p</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;Return non-nil if the currently visited buffer is a note.&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>and</span> <span class=nf>buffer-file-name</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>string-prefix-p</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nf>expand-file-name</span> <span class=p>(</span><span class=nf>file-name-as-directory</span> <span class=nv>org-roam-directory</span><span class=p>))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nf>file-name-directory</span> <span class=nf>buffer-file-name</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>defun</span> <span class=nv>vulpea-project-update-tag</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;Update PROJECT tag in the current buffer.&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nb>and</span> <span class=p>(</span><span class=nv>not</span> <span class=p>(</span><span class=nf>active-minibuffer-window</span><span class=p>))</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nv>vulpea-buffer-p</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>save-excursion</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nf>goto-char</span> <span class=p>(</span><span class=nf>point-min</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nb>let*</span> <span class=p>((</span><span class=nv>tags</span> <span class=p>(</span><span class=nv>vulpea-buffer-tags-get</span><span class=p>))</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nv>original-tags</span> <span class=nv>tags</span><span class=p>))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nv>vulpea-project-p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nb>setq</span> <span class=nv>tags</span> <span class=p>(</span><span class=nf>cons</span> <span class=s>&#34;project&#34;</span> <span class=nv>tags</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nb>setq</span> <span class=nv>tags</span> <span class=p>(</span><span class=nv>remove</span> <span class=s>&#34;project&#34;</span> <span class=nv>tags</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>          <span class=c1>;; cleanup duplicates</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nb>setq</span> <span class=nv>tags</span> <span class=p>(</span><span class=nv>seq-uniq</span> <span class=nv>tags</span><span class=p>))</span>
</span></span><span class=line><span class=cl>          <span class=c1>;; update tags if changed</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nb>or</span> <span class=p>(</span><span class=nv>seq-difference</span> <span class=nv>tags</span> <span class=nv>original-tags</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=p>(</span><span class=nv>seq-difference</span> <span class=nv>original-tags</span> <span class=nv>tags</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nf>apply</span> <span class=nf>#&#39;</span><span class=nv>vulpea-buffer-tags-set</span> <span class=nv>tags</span><span class=p>))))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>defun</span> <span class=nv>vulpea-project-files</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;Return a list of note files containing &#39;project&#39; tag.&#34;</span> <span class=c1>;</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>seq-uniq</span>
</span></span><span class=line><span class=cl>     <span class=p>(</span><span class=nv>seq-map</span>
</span></span><span class=line><span class=cl>      <span class=nf>#&#39;car</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>org-roam-db-query</span>
</span></span><span class=line><span class=cl>       <span class=p>[</span><span class=nb>:select</span> <span class=p>[</span><span class=nv>nodes:file</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=nb>:from</span> <span class=nv>tags</span>
</span></span><span class=line><span class=cl>                <span class=nb>:left-join</span> <span class=nv>nodes</span>
</span></span><span class=line><span class=cl>                <span class=nb>:on</span> <span class=p>(</span><span class=nf>=</span> <span class=nv>tags:node-id</span> <span class=nv>nodes:id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=nb>:where</span> <span class=p>(</span><span class=nv>like</span> <span class=nv>tag</span> <span class=p>(</span><span class=nb>quote</span> <span class=s>&#34;%\&#34;project\&#34;%&#34;</span><span class=p>))]))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>defun</span> <span class=nv>vulpea-agenda-files-update</span> <span class=p>(</span><span class=kp>&amp;rest</span> <span class=nv>_</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;Update the value of </span><span class=ss>`org-agenda-files&#39;</span><span class=s>.&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-agenda-files</span> <span class=p>(</span><span class=nv>seq-uniq</span>
</span></span><span class=line><span class=cl>                            <span class=p>(</span><span class=nf>append</span>
</span></span><span class=line><span class=cl>                             <span class=p>(</span><span class=nv>vulpea-project-files</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                             <span class=o>`</span><span class=p>(</span><span class=o>,</span><span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;todos/gtd.org&#34;</span> <span class=nv>my-galaxy</span><span class=p>))))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;find-file-hook</span> <span class=nf>#&#39;</span><span class=nv>vulpea-agenda-files-update</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>advice-add</span> <span class=ss>&#39;org-agenda</span> <span class=nb>:before</span> <span class=nf>#&#39;</span><span class=nv>vulpea-agenda-files-update</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>advice-add</span> <span class=ss>&#39;org-todo-list</span> <span class=nb>:before</span> <span class=nf>#&#39;</span><span class=nv>vulpea-agenda-files-update</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;find-file-hook</span> <span class=nf>#&#39;</span><span class=nv>vulpea-project-update-tag</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;before-save-hook</span> <span class=nf>#&#39;</span><span class=nv>vulpea-project-update-tag</span><span class=p>))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my/gtd-file</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>find-file</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;todos/gtd.org&#34;</span> <span class=nv>my-galaxy</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>my/space-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;fog&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>my/gtd-file</span> <span class=nb>:wk</span> <span class=s>&#34;GTD file&#34;</span><span class=p>))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>org-agenda</span>
</span></span><span class=line><span class=cl>  <span class=nb>:after</span> <span class=nv>org</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span> <span class=p>(</span><span class=s>&#34;&lt;f12&gt;&#34;</span> <span class=o>.</span> <span class=nv>my/org-agenda</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>org-agenda-finalize</span> <span class=o>.</span> <span class=nf>#&#39;</span><span class=nv>org-agenda-find-same-or-today-or-agenda</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:init</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-agenda-files</span> <span class=p>(</span><span class=nv>directory-files-recursively</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;todos&#34;</span> <span class=nv>my-galaxy</span><span class=p>)</span> <span class=s>&#34;org$\\|archive$&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-agenda-dim-blocked-tasks</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-agenda-compact-blocks</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-agenda-window-setup</span> <span class=ss>&#39;other-tab</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-agenda-align-tags-to-column</span> <span class=mi>-120</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-agenda-custom-commands</span>
</span></span><span class=line><span class=cl>        <span class=o>&#39;</span><span class=p>((</span><span class=s>&#34;R&#34;</span> <span class=s>&#34;Review projects&#34;</span> <span class=nv>tags-todo</span> <span class=s>&#34;-CANCELLED/&#34;</span>
</span></span><span class=line><span class=cl>           <span class=p>((</span><span class=nv>org-agenda-overriding-header</span> <span class=s>&#34;Reviews Scheduled&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nv>org-agenda-skip-function</span> <span class=ss>&#39;org-review-agenda-skip</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nv>org-agenda-cmp-user-defined</span> <span class=ss>&#39;org-review-compare</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;A&#34;</span> <span class=s>&#34;Archive&#34;</span>
</span></span><span class=line><span class=cl>           <span class=p>((</span><span class=nv>todo</span> <span class=s>&#34;DONE|CNCL&#34;</span>
</span></span><span class=line><span class=cl>                  <span class=p>((</span><span class=nv>org-agenda-prefix-format</span> <span class=s>&#34; %i&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                   <span class=p>(</span><span class=nv>org-agenda-hide-tags-regexp</span> <span class=s>&#34;project&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                   <span class=p>(</span><span class=nv>org-agenda-overriding-header</span> <span class=s>&#34;Archive&#34;</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34; &#34;</span> <span class=s>&#34;GTD Lists: Daily agenda and tasks&#34;</span>
</span></span><span class=line><span class=cl>           <span class=p>((</span><span class=nv>agenda</span> <span class=s>&#34;&#34;</span> <span class=p>((</span><span class=nv>org-agenda-span</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                        <span class=p>(</span><span class=nv>org-deadline-warning-days</span> <span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                        <span class=p>(</span><span class=nv>org-agenda-block-separator</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                        <span class=p>(</span><span class=nv>org-scheduled-past-days</span> <span class=mi>365</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                        <span class=p>(</span><span class=nv>org-agenda-hide-tags-regexp</span> <span class=s>&#34;project&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                        <span class=p>(</span><span class=nv>org-agenda-day-face-function</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>(</span><span class=nv>date</span><span class=p>)</span> <span class=ss>&#39;org-agenda-date</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                        <span class=p>(</span><span class=nv>org-agenda-format-date</span> <span class=s>&#34;%A %-e %B %Y&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                        <span class=p>(</span><span class=nv>org-agenda-prefix-format</span> <span class=s>&#34; %i %?-12t% s&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                        <span class=p>(</span><span class=nv>org-agenda-overriding-header</span> <span class=s>&#34;Today&#39;s agenda&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nv>tags-todo</span> <span class=s>&#34;*&#34;</span>
</span></span><span class=line><span class=cl>                       <span class=p>((</span><span class=nv>org-agenda-skip-function</span>
</span></span><span class=line><span class=cl>                         <span class=o>`</span><span class=p>(</span><span class=nv>org-agenda-skip-entry-if</span> <span class=ss>&#39;deadline</span>
</span></span><span class=line><span class=cl>                                                    <span class=ss>&#39;schedule</span>
</span></span><span class=line><span class=cl>                                                    <span class=ss>&#39;timestamp</span>
</span></span><span class=line><span class=cl>                                                    <span class=ss>&#39;notregexp</span> <span class=o>,</span><span class=p>(</span><span class=nf>format</span> <span class=s>&#34;\\[#%s\\]&#34;</span> <span class=p>(</span><span class=nf>char-to-string</span> <span class=nv>org-priority-highest</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>                        <span class=p>(</span><span class=nv>org-agenda-hide-tags-regexp</span> <span class=s>&#34;project&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                        <span class=p>(</span><span class=nv>org-agenda-prefix-format</span> <span class=s>&#34; %i&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                        <span class=p>(</span><span class=nv>org-agenda-overriding-header</span> <span class=s>&#34;Important tasks without a date&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nv>todo</span> <span class=s>&#34;NEXT&#34;</span>
</span></span><span class=line><span class=cl>                  <span class=p>((</span><span class=nv>org-agenda-skip-function</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>org-agenda-skip-if</span> <span class=no>nil</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>timestamp</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>                   <span class=p>(</span><span class=nv>org-agenda-prefix-format</span> <span class=s>&#34; %i&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                   <span class=p>(</span><span class=nv>org-agenda-block-separator</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                   <span class=p>(</span><span class=nv>org-agenda-hide-tags-regexp</span> <span class=s>&#34;project&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                   <span class=p>(</span><span class=nv>org-agenda-overriding-header</span> <span class=s>&#34;Next tasks list&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nv>tags-todo</span> <span class=s>&#34;-Reading/INPROGRESS&#34;</span>
</span></span><span class=line><span class=cl>                       <span class=p>((</span><span class=nv>org-agenda-block-separator</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                        <span class=p>(</span><span class=nv>org-agenda-skip-function</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>org-agenda-skip-if</span> <span class=no>nil</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>timestamp</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>                        <span class=p>(</span><span class=nv>org-agenda-prefix-format</span> <span class=s>&#34; %i&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                        <span class=p>(</span><span class=nv>org-agenda-hide-tags-regexp</span> <span class=s>&#34;project&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                        <span class=p>(</span><span class=nv>org-agenda-overriding-header</span> <span class=s>&#34;Inprogress tasks list&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nv>tags-todo</span> <span class=s>&#34;-Computer-Emacs-Reading/TODO&#34;</span>
</span></span><span class=line><span class=cl>                       <span class=p>((</span><span class=nv>org-agenda-skip-function</span>
</span></span><span class=line><span class=cl>                         <span class=o>`</span><span class=p>(</span><span class=nv>org-agenda-skip-entry-if</span> <span class=ss>&#39;deadline</span>
</span></span><span class=line><span class=cl>                                                    <span class=ss>&#39;schedule</span>
</span></span><span class=line><span class=cl>                                                    <span class=ss>&#39;timestamp</span>
</span></span><span class=line><span class=cl>                                                    <span class=ss>&#39;regexp</span> <span class=o>,</span><span class=p>(</span><span class=nf>format</span> <span class=s>&#34;\\[#%s\\]&#34;</span> <span class=p>(</span><span class=nf>char-to-string</span> <span class=nv>org-priority-highest</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>                        <span class=p>(</span><span class=nv>org-agenda-prefix-format</span> <span class=s>&#34; %i&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                        <span class=p>(</span><span class=nv>org-agenda-hide-tags-regexp</span> <span class=s>&#34;project&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                        <span class=p>(</span><span class=nv>org-agenda-block-separator</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                        <span class=p>(</span><span class=nv>org-agenda-overriding-header</span> <span class=s>&#34;Todo tasks list&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nv>tags-todo</span> <span class=s>&#34;Emacs|Computer&#34;</span>
</span></span><span class=line><span class=cl>                       <span class=p>((</span><span class=nv>org-agenda-block-separator</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                        <span class=p>(</span><span class=nv>org-agenda-skip-function</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>org-agenda-skip-if</span> <span class=no>nil</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>timestamp</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>                        <span class=p>(</span><span class=nv>org-agenda-prefix-format</span> <span class=s>&#34; %i&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                        <span class=p>(</span><span class=nv>org-agenda-hide-tags-regexp</span> <span class=s>&#34;project&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                        <span class=p>(</span><span class=nv>org-agenda-overriding-header</span> <span class=s>&#34;Computer science&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nv>tags-todo</span> <span class=s>&#34;Family&#34;</span>
</span></span><span class=line><span class=cl>                       <span class=p>((</span><span class=nv>org-agenda-skip-function</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>org-agenda-skip-if</span> <span class=no>nil</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>timestamp</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>                        <span class=p>(</span><span class=nv>org-agenda-prefix-format</span> <span class=s>&#34; %i&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                        <span class=p>(</span><span class=nv>org-agenda-hide-tags-regexp</span> <span class=s>&#34;project&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                        <span class=p>(</span><span class=nv>org-agenda-block-separator</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                        <span class=p>(</span><span class=nv>org-agenda-overriding-header</span> <span class=s>&#34;Family&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nv>tags-todo</span> <span class=s>&#34;Reading&#34;</span>
</span></span><span class=line><span class=cl>                       <span class=p>((</span><span class=nv>org-agenda-skip-function</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>org-agenda-skip-if</span> <span class=no>nil</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>timestamp</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>                        <span class=p>(</span><span class=nv>org-agenda-prefix-format</span> <span class=s>&#34; %i&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                        <span class=p>(</span><span class=nv>org-agenda-hide-tags-regexp</span> <span class=s>&#34;project&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                        <span class=p>(</span><span class=nv>org-agenda-block-separator</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                        <span class=p>(</span><span class=nv>org-agenda-overriding-header</span> <span class=s>&#34;Reading Lists&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nv>todo</span> <span class=s>&#34;WAIT|SOMEDAY&#34;</span>
</span></span><span class=line><span class=cl>                  <span class=p>((</span><span class=nv>org-agenda-block-separator</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                   <span class=p>(</span><span class=nv>org-agenda-prefix-format</span> <span class=s>&#34; %i&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                   <span class=p>(</span><span class=nv>org-agenda-hide-tags-regexp</span> <span class=s>&#34;project&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                   <span class=p>(</span><span class=nv>org-agenda-overriding-header</span> <span class=s>&#34;Tasks on hold&#34;</span><span class=p>)))))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-agenda-category-icon-alist</span>
</span></span><span class=line><span class=cl>        <span class=o>`</span><span class=p>((</span><span class=s>&#34;\\</span><span class=ss>`gtd\\&#39;</span><span class=s>&#34;</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=o>#(</span><span class=s>&#34; &#34;</span> <span class=mi>0</span> <span class=mi>1</span> <span class=p>(</span><span class=nv>rear-nonsticky</span> <span class=no>t</span> <span class=nv>display</span> <span class=p>(</span><span class=nv>raise</span> <span class=mf>0.0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                                       <span class=nv>font-lock-face</span>
</span></span><span class=line><span class=cl>                                       <span class=p>(</span><span class=nb>:family</span> <span class=s>&#34;FontAwesome&#34;</span> <span class=nb>:height</span> <span class=mf>1.0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                                       <span class=nv>face</span>
</span></span><span class=line><span class=cl>                                       <span class=p>(</span><span class=nb>:family</span> <span class=s>&#34;FontAwesome&#34;</span> <span class=nb>:height</span> <span class=mf>1.0</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>           <span class=no>nil</span> <span class=no>nil</span> <span class=nb>:ascent</span> <span class=nv>center</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;\\\cc\\\|[a-zA-z0-9]*&#34;</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=o>#(</span><span class=s>&#34; &#34;</span> <span class=mi>0</span> <span class=mi>1</span> <span class=p>(</span><span class=nv>rear-nonsticky</span> <span class=no>t</span> <span class=nv>display</span> <span class=p>(</span><span class=nv>raise</span> <span class=mf>0.0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                                       <span class=nv>font-lock-face</span>
</span></span><span class=line><span class=cl>                                       <span class=p>(</span><span class=nb>:family</span> <span class=s>&#34;FontAwesome&#34;</span> <span class=nb>:height</span> <span class=mf>1.0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                                       <span class=nv>face</span>
</span></span><span class=line><span class=cl>                                       <span class=p>(</span><span class=nb>:family</span> <span class=s>&#34;FontAwesome&#34;</span> <span class=nb>:height</span> <span class=mf>1.0</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>           <span class=no>nil</span> <span class=no>nil</span> <span class=nb>:ascent</span> <span class=nv>center</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>defun</span> <span class=nv>my/org-agenda</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;Open my </span><span class=ss>`org-agenda&#39;</span><span class=s>.
</span></span></span><span class=line><span class=cl><span class=s>Run </span><span class=ss>`org-roam-db-sync&#39;</span><span class=s> to get full lists of org agenda files.&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nf>eq</span> <span class=nv>major-mode</span> <span class=ss>&#39;org-agenda-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>org-agenda-redo-all</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>org-agenda</span> <span class=s>&#34;&#34;</span> <span class=s>&#34; &#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>defun</span> <span class=nv>my/org-agenda-query</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;Open my </span><span class=ss>`org-agenda&#39;</span><span class=s> and </span><span class=ss>`m&#39;</span><span class=s>.
</span></span></span><span class=line><span class=cl><span class=s>  Run </span><span class=ss>`org-roam-db-sync&#39;</span><span class=s> to get full lists of org agenda files.&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>org-roam-db-sync</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>org-agenda</span> <span class=s>&#34;&#34;</span> <span class=s>&#34;m&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>defun</span> <span class=nv>my/org-inprogress-tasks</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>org-todo-list</span> <span class=s>&#34;INPROGRESS&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>my/space-leader-def</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;o&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nb>:ignore</span> <span class=no>t</span> <span class=nb>:wk</span> <span class=s>&#34;Org&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;oa&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nb>:ignore</span> <span class=no>t</span> <span class=nb>:wk</span> <span class=s>&#34;Agenda&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;oaa&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>my/org-agenda</span> <span class=nb>:wk</span> <span class=s>&#34;Agenda&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;oaq&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>my/org-agenda-query</span> <span class=nb>:wk</span> <span class=s>&#34;Query&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;oat&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>org-todo-list</span> <span class=nb>:wk</span> <span class=s>&#34;Todo list&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;oav&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>org-search-view</span> <span class=nb>:wk</span> <span class=s>&#34;View search&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;oai&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>my/org-inprogress-tasks</span> <span class=nb>:wk</span> <span class=s>&#34;Inprogess tasks&#34;</span><span class=p>)))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>run-with-idle-timer</span> <span class=mi>300</span> <span class=no>t</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>                             <span class=p>(</span><span class=nb>progn</span>
</span></span><span class=line><span class=cl>                             <span class=p>(</span><span class=nv>svg-clock</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                             <span class=p>(</span><span class=nv>hide-mode-line-mode</span><span class=p>))))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>org-agenda</span>
</span></span><span class=line><span class=cl>  <span class=nb>:after</span> <span class=nv>evil</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>evil-set-initial-state</span> <span class=ss>&#39;org-agenda-mode</span> <span class=ss>&#39;motion</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>evil-define-key</span> <span class=ss>&#39;motion</span> <span class=nv>org-agenda-mode-map</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;RET&#34;</span><span class=p>)</span> <span class=ss>&#39;org-agenda-switch-to</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;gj&#34;</span> <span class=ss>&#39;org-agenda-next-item</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;gr&#34;</span> <span class=ss>&#39;org-agenda-redo</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;gR&#34;</span> <span class=ss>&#39;org-agenda-redo-all</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;t&#34;</span> <span class=ss>&#39;org-agenda-todo</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;u&#34;</span> <span class=ss>&#39;org-agenda-undo</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;I&#34;</span> <span class=ss>&#39;org-agenda-clock-in</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;O&#34;</span> <span class=ss>&#39;org-agenda-clock-out</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;cg&#34;</span> <span class=ss>&#39;org-agenda-clock-goto</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;cc&#34;</span> <span class=ss>&#39;org-agenda-clock-cancel</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;cr&#34;</span> <span class=ss>&#39;org-agenda-clockreport-mode</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=calendar-and-appt class=headerLink><a href=#calendar-and-appt class=header-mark></a>calendar and appt</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>calendar</span>
</span></span><span class=line><span class=cl>  <span class=nb>:commands</span> <span class=nv>calendar</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>calendar-view-diary-initially-flag</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>calendar-mark-diary-entries-flag</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>calendar-mode-line-format</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>calendar-date-style</span> <span class=ss>&#39;iso</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>calendar-date-display-form</span> <span class=nv>calendar-iso-date-display-form</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>calendar-time-display-form</span>
</span></span><span class=line><span class=cl>        <span class=o>&#39;</span><span class=p>(</span><span class=nv>24-hours</span> <span class=s>&#34;:&#34;</span> <span class=nv>minutes</span>
</span></span><span class=line><span class=cl>                   <span class=p>(</span><span class=nb>when</span> <span class=nv>time-zone</span>
</span></span><span class=line><span class=cl>                     <span class=p>(</span><span class=nf>format</span> <span class=s>&#34;(%s)&#34;</span> <span class=nv>time-zone</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>diary-date-forms</span> <span class=nv>diary-iso-date-forms</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>calendar-today-visible</span> <span class=o>.</span> <span class=nf>#&#39;</span><span class=nv>calendar-mark-today</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>my/comma-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;c&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>calendar</span> <span class=nb>:wk</span> <span class=s>&#34;Calendar&#34;</span><span class=p>))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>appt</span>
</span></span><span class=line><span class=cl>  <span class=nb>:after</span> <span class=nv>calendar</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>appt-display-diary</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>appt-disp-window-function</span> <span class=nf>#&#39;</span><span class=nv>appt-disp-window</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>appt-display-mode-line</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>appt-display-interval</span> <span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>appt-audible</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>appt-warning-time-regexp</span> <span class=s>&#34;appt \\([0-9]+\\)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>appt-message-warning-time</span> <span class=mi>6</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;diary-mode-hook</span> <span class=nf>#&#39;</span><span class=nv>appt-activate</span><span class=p>))</span>
</span></span></code></pre></div><p>Use diary-lib to write diary. 关于这个的使用可以见：<a href="https://www.youtube.com/watch?v=NkhgIB64zgc" target=_blank rel="noopener noreffer">Emacs: Diary and Calendar - YouTube</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>diary-lib</span>
</span></span><span class=line><span class=cl>  <span class=nb>:after</span> <span class=nv>calendar</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;diary-list-entries-hook</span> <span class=nf>#&#39;</span><span class=nv>diary-sort-entries</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;diary-mode-hook</span> <span class=nf>#&#39;</span><span class=nv>goto-address-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>diary-display-function</span> <span class=nf>#&#39;</span><span class=nv>diary-fancy-display</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>diary-header-line-format</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>diary-list-include-blanks</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>diary-abbreviated-year-flag</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>diary-number-of-entries</span> <span class=mi>7</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>diary-comment-start</span> <span class=s>&#34;);;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>diary-comment-end</span> <span class=s>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>diary-nonmarking-symbol</span> <span class=s>&#34;!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>diary-file</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;diary/diary.org&#34;</span> <span class=nv>my-galaxy</span><span class=p>)))</span>
</span></span></code></pre></div><h3 id=zen class=headerLink><a href=#zen class=header-mark></a>Zen</h3><p>Zen Mode 或者叫禅模式，其目的是为了降低不相关因素对于心智的干挠。将自己的视野集中于可见的区域，不需要移动脑袋。</p><p>在 Emacs 上有两个相关的包，一个是 <code>olivetti</code>, 另外一个是 <code>writeroom-mode</code>. <code>olivetti</code> 的功能更单一一些，但是足够使用。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>olivetti</span>
</span></span><span class=line><span class=cl>  <span class=nb>:commands</span> <span class=nv>olivetti-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;evil</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>evil-define-key</span> <span class=ss>&#39;nromal</span> <span class=ss>&#39;org-mode-map</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;zw&#34;</span> <span class=ss>&#39;olivetti-mode</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=toc class=headerLink><a href=#toc class=header-mark></a>TOC</h3><p>在 Org 文件的顶部生成目录。<a href=https://github.com/snosov1/toc-org target=_blank rel="noopener noreffer">snosov1/toc-org: toc-org is an Emacs utility to have an up-to-date table of contents in the org files without exporting (useful primarily for readme files on GitHub)</a></p><p>需要在文件的头部新建一个 heading 并加上 tag：toc.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>toc-org</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>org-mode</span> <span class=o>.</span> <span class=nv>toc-org-mode</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=org-super-star class=headerLink><a href=#org-super-star class=header-mark></a>org-super-star</h3><p><a href=https://github.com/integral-dw/org-superstar-mode target=_blank rel="noopener noreffer">integral-dw/org-superstar-mode: Make org-mode stars a little more super</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>org-superstar</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>org-mode</span> <span class=o>.</span> <span class=nv>org-superstar-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-superstar-headline-bullets-list</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;❶&#34;</span> <span class=s>&#34;❷&#34;</span> <span class=s>&#34;❸&#34;</span> <span class=s>&#34;❹&#34;</span> <span class=s>&#34;❺&#34;</span> <span class=s>&#34;❻&#34;</span> <span class=s>&#34;❼&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=c1>;; (setq org-superstar-headline-bullets-list &#39;(&#34;1&#34; &#34;2&#34; &#34;3&#34; &#34;4&#34; &#34;5&#34; &#34;6&#34; &#34;7&#34;))</span>
</span></span><span class=line><span class=cl>  <span class=c1>;; (setq org-superstar-headline-bullets-list &#39;(&#34;①&#34; &#34;②&#34; &#34;③&#34; &#34;④&#34; &#34;⑤&#34; &#34;⑥&#34;))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-hide-leading-stars</span> <span class=no>t</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=org-download class=headerLink><a href=#org-download class=header-mark></a>org-download</h3><p>用于管理图片。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>org-download</span>
</span></span><span class=line><span class=cl>  <span class=nb>:commands</span> <span class=nv>org-download-enable</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>org-mode</span> <span class=o>.</span> <span class=nv>org-download-enable</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-download-image-dir</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;pictures&#34;</span> <span class=nv>my-galaxy</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-download-screenshot-method</span> <span class=ss>&#39;screencapture</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-download-abbreviate-filename-function</span> <span class=ss>&#39;expand-file-name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-download-timestamp</span> <span class=s>&#34;%Y%m%d%H%M%S&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-download-display-inline-images</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-download-heading-lvl</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-download-annotate-function</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>(</span><span class=nv>_link</span><span class=p>)</span> <span class=s>&#34;&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-download-image-attr-list</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;#+NAME: fig: &#34;</span>
</span></span><span class=line><span class=cl>                                       <span class=s>&#34;#+CAPTION: &#34;</span>
</span></span><span class=line><span class=cl>                                       <span class=s>&#34;#+ATTR_ORG: :width 500px&#34;</span>
</span></span><span class=line><span class=cl>                                       <span class=s>&#34;#+ATTR_LATEX: :width 10cm :placement [!htpb]&#34;</span>
</span></span><span class=line><span class=cl>                                       <span class=s>&#34;#+ATTR_HTML: :width 600px&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>my/space-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;od&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nb>:ignore</span> <span class=no>t</span> <span class=nb>:wk</span> <span class=s>&#34;Download&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;odc&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>org-download-clipboard</span> <span class=nb>:wk</span> <span class=s>&#34;Download Clipboard&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;ody&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>org-download-yank</span> <span class=nb>:wk</span> <span class=s>&#34;Download Yank&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;odr&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>org-download-rename-last-file</span> <span class=nb>:wk</span> <span class=s>&#34;Rename last file&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;odR&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>org-download-rename-at-point</span> <span class=nb>:wk</span> <span class=s>&#34;Rename point&#34;</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=org-appear class=headerLink><a href=#org-appear class=header-mark></a>org-appear</h3><p>在 org 中经常使用链接，使 Org 元素的不可见部分显示为可见。结合 Evil 使用，对于链接的编辑很方便。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>org-appear</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-appear-autolinks</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-appear-trigger</span> <span class=ss>&#39;manual</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>((</span><span class=nv>org-mode</span> <span class=o>.</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>                       <span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;evil-insert-state-entry-hook</span>
</span></span><span class=line><span class=cl>                                 <span class=nf>#&#39;</span><span class=nv>org-appear-manual-start</span>
</span></span><span class=line><span class=cl>                                 <span class=no>nil</span>
</span></span><span class=line><span class=cl>                                 <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                       <span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;evil-insert-state-exit-hook</span>
</span></span><span class=line><span class=cl>                                 <span class=nf>#&#39;</span><span class=nv>org-appear-manual-stop</span>
</span></span><span class=line><span class=cl>                                 <span class=no>nil</span>
</span></span><span class=line><span class=cl>                                 <span class=no>t</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>org-mode</span> <span class=o>.</span> <span class=nv>org-appear-mode</span><span class=p>)))</span>
</span></span></code></pre></div><h3 id=math-preview class=headerLink><a href=#math-preview class=header-mark></a>math-preview</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>math-preview</span>
</span></span><span class=line><span class=cl>  <span class=nb>:commands</span> <span class=p>(</span><span class=nv>math-preview-all</span> <span class=nv>math-preview-at-point</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>math-preview-scale</span> <span class=mf>1.1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>math-preview-raise</span> <span class=mf>0.3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>math-preview-margin</span> <span class=o>&#39;</span><span class=p>(</span><span class=mi>1</span> <span class=o>.</span> <span class=mi>0</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>my/space-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;mpa&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>math-preview-all</span> <span class=nb>:wk</span> <span class=s>&#34;All&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;mpA&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>math-preview-clear-all</span> <span class=nb>:wk</span> <span class=s>&#34;Clear All&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;mpp&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>math-preview-at-point</span> <span class=nb>:wk</span> <span class=s>&#34;Point&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;mpP&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>math-preview-clear-at-point</span> <span class=nb>:wk</span> <span class=s>&#34;Clear Point&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;mpr&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>math-preview-region</span> <span class=nb>:wk</span> <span class=s>&#34;Region&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;mpR&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>math-preview-clear-region</span> <span class=nb>:wk</span> <span class=s>&#34;Clear Region&#34;</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=plantuml class=headerLink><a href=#plantuml class=header-mark></a>plantuml</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>plantuml</span>
</span></span><span class=line><span class=cl>  <span class=nb>:commands</span> <span class=p>(</span><span class=nv>plantuml-org-to-mindmap-open</span> <span class=nv>plantuml-org-to-wbs-open</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>org-mode</span> <span class=o>.</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>                      <span class=p>(</span><span class=nb>require</span> <span class=ss>&#39;plantuml</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>plantuml-jar-path</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nf>concat</span> <span class=p>(</span><span class=nv>string-trim</span>
</span></span><span class=line><span class=cl>                 <span class=p>(</span><span class=nv>shell-command-to-string</span> <span class=s>&#34;readlink -f $(brew --prefix plantuml)&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=s>&#34;/libexec/plantuml.jar&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>my/space-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;op&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nb>:ignore</span> <span class=no>t</span> <span class=nb>:wk</span> <span class=s>&#34;Plantuml&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;opm&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>plantuml-org-to-mindmap-open</span> <span class=nb>:wk</span> <span class=s>&#34;Mindmap&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;ops&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>plantuml-org-to-wbs-open</span> <span class=nb>:wk</span> <span class=s>&#34;Work Breakdown Structure&#34;</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=org-rainbow-tags class=headerLink><a href=#org-rainbow-tags class=header-mark></a>org-rainbow-tags</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>org-rainbow-tags</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>org-mode</span> <span class=o>.</span> <span class=nv>org-rainbow-tags-mode</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=alarm-clock class=headerLink><a href=#alarm-clock class=header-mark></a>alarm-clock</h3><p>如其名，在 Emacs 中设置闹钟的。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>alarm-clock</span>
</span></span><span class=line><span class=cl>  <span class=nb>:commands</span> <span class=p>(</span><span class=nv>alarm-clock-set</span> <span class=nv>alarm-clock-list-view</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>alarm-clock-cache-file</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;var/.alarm-clock.cache&#34;</span> <span class=nv>user-emacs-directory</span><span class=p>)))</span>
</span></span></code></pre></div><h3 id=pomm class=headerLink><a href=#pomm class=header-mark></a>pomm</h3><p>Emacs 中执行 Pomodoro 哲学。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>pomm</span>
</span></span><span class=line><span class=cl>  <span class=nb>:commands</span> <span class=nv>pomm</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>pomm-state-file-location</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;pomm&#34;</span> <span class=nv>no-littering-var-directory</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>pomm-mode-line-mode</span> <span class=mi>1</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=pandoc class=headerLink><a href=#pandoc class=header-mark></a>Pandoc</h3><p>将 org 文档转换为 word 文档，仅支持简单的文档，过于复杂的文档不行。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>org-export-docx</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Convert org to docx.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>docx-file</span> <span class=p>(</span><span class=nf>concat</span> <span class=p>(</span><span class=nv>file-name-sans-extension</span> <span class=p>(</span><span class=nf>buffer-file-name</span><span class=p>))</span> <span class=s>&#34;.docx&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>template-file</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;template/template.docx&#34;</span> <span class=nv>user-emacs-directory</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>shell-command</span> <span class=p>(</span><span class=nf>format</span> <span class=s>&#34;pandoc %s -o %s --reference-doc=%s&#34;</span> <span class=p>(</span><span class=nf>buffer-file-name</span><span class=p>)</span> <span class=nv>docx-file</span> <span class=nv>template-file</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>message</span> <span class=s>&#34;Convert finish: %s&#34;</span> <span class=nv>docx-file</span><span class=p>)))</span>
</span></span></code></pre></div><p>ox-pandoc 增加 org-export 的选项。不过 ox-pandoc 己经不怎么更新。</p><p>此外还有一个 pandoc-mode, 初步尝试后感觉还可以。.</p><p>Pandoc 不怎么使用，时间长了就忘记 pandoc 的使用方法。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=c1>;; First, install pandoc with `brew install pandoc&#39;.</span>
</span></span><span class=line><span class=cl><span class=c1>;; Only for simple file, no cite info, no latex formular.</span>
</span></span><span class=line><span class=cl><span class=c1>;; Image file has to be absolute path, relative path do not work!</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-pandoc-menu-entry</span>
</span></span><span class=line><span class=cl>      <span class=o>&#39;</span><span class=p>((</span><span class=sc>?m</span> <span class=s>&#34;as md.&#34;</span> <span class=nv>org-pandoc-export-as-commonmark</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=sc>?M</span> <span class=s>&#34;to md and open.&#34;</span> <span class=nv>org-pandoc-export-to-commonmark-and-open</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=sc>?x</span> <span class=s>&#34;to docx.&#34;</span> <span class=nv>org-pandoc-export-to-docx</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=sc>?X</span> <span class=s>&#34;to docx and open.&#34;</span> <span class=nv>org-pandoc-export-to-docx-and-open</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=sc>?e</span> <span class=s>&#34;to epub.&#34;</span> <span class=nv>org-pandoc-export-to-epub</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=sc>?E</span> <span class=s>&#34;to epub and open.&#34;</span> <span class=nv>org-pandoc-export-to-epub-and-open</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=sc>?3</span> <span class=s>&#34;to epub3.&#34;</span> <span class=nv>org-pandoc-export-to-epub3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=sc>?£</span> <span class=s>&#34;to epub3 and open.&#34;</span> <span class=nv>org-pandoc-export-to-epub3-and-open</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=sc>?j</span> <span class=s>&#34;as json.&#34;</span> <span class=nv>org-pandoc-export-as-json</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=sc>?J</span> <span class=s>&#34;to json and open.&#34;</span> <span class=nv>org-pandoc-export-to-json-and-open</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=sc>?r</span> <span class=s>&#34;as rst.&#34;</span> <span class=nv>org-pandoc-export-as-rst</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=sc>?R</span> <span class=s>&#34;to rst and open.&#34;</span> <span class=nv>org-pandoc-export-to-rst-and-open</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-pandoc-options</span> <span class=o>&#39;</span><span class=p>((</span><span class=nv>standalone</span> <span class=o>.</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                           <span class=p>(</span><span class=nv>mathjax</span> <span class=o>.</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                           <span class=p>(</span><span class=nv>wrap</span> <span class=o>.</span> <span class=s>&#34;preserve&#34;</span><span class=p>)))</span>
</span></span></code></pre></div><h3 id=beancount-mode class=headerLink><a href=#beancount-mode class=header-mark></a>beancount-mode</h3><p>Beancount has more plugin than ledger-cli.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>beancount</span>
</span></span><span class=line><span class=cl>  <span class=nb>:mode</span> <span class=p>(</span><span class=s>&#34;.bean&#34;</span> <span class=o>.</span> <span class=nv>beancount-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>((</span><span class=nv>beancount-mode</span> <span class=o>.</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>                             <span class=p>(</span><span class=nb>setq-local</span> <span class=nv>electric-indent-chars</span> <span class=no>nil</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>beancount-mode</span> <span class=o>.</span> <span class=nv>outline-minor-mode</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>evil-define-key</span> <span class=ss>&#39;normal</span> <span class=ss>&#39;beancount-mode-map</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;zf&#34;</span> <span class=ss>&#39;beancount-fava</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>;; insert whole transaction instead of only insert date.</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>defun</span> <span class=nv>my/beancount-insert-transaction</span> <span class=p>(</span><span class=kp>&amp;optional</span> <span class=nv>days</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;Start a new timestamped directive with date shifted by DAYS from today.&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>interactive</span> <span class=s>&#34;P&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>unless</span> <span class=p>(</span><span class=nf>bolp</span><span class=p>)</span> <span class=p>(</span><span class=nv>newline</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>insert</span> <span class=p>(</span><span class=nv>beancount--shift-current-date</span> <span class=nv>days</span><span class=p>)</span> <span class=s>&#34; * \&#34;\&#34; \&#34;\&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>evil-backward-char</span> <span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>evil-insert</span> <span class=mi>0</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>advice-add</span> <span class=ss>&#39;beancount-insert-date</span> <span class=nb>:override</span> <span class=ss>&#39;my/beancount-insert-transaction</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>;; Auto open browser after beancount-fava started.</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>defun</span> <span class=nv>my/browser-beancount-fava</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>if</span> <span class=nv>beancount--fava-process</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>browse-url</span> <span class=s>&#34;http://127.0.0.1:5000&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>advice-add</span> <span class=ss>&#39;beancount-fava</span> <span class=nb>:after</span> <span class=ss>&#39;my/browser-beancount-fava</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>;; auto align transaction before save file.</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>defun</span> <span class=nv>my/beancount-align-transaction</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;Align visible region in current buffer.&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>save-excursion</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>indent-region</span> <span class=p>(</span><span class=nf>window-start</span><span class=p>)</span> <span class=p>(</span><span class=nf>window-end</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;before-save-hook</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>                                <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nf>eq</span> <span class=nv>major-mode</span> <span class=ss>&#39;beancount-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                                    <span class=p>(</span><span class=nv>my/beancount-align-transaction</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>;; If cursor in &#34;&#34;, activate input method rime.</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>defun</span> <span class=nv>my/beancount-activate-input-method</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nf>eq</span> <span class=nv>major-mode</span> <span class=ss>&#39;beancount-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nv>not</span> <span class=p>(</span><span class=nv>bounds-of-thing-at-point</span> <span class=ss>&#39;whitespace</span><span class=p>))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nv>bounds-of-thing-at-point</span> <span class=ss>&#39;string</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nv>activate-input-method</span> <span class=s>&#34;rime&#34;</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;evil-insert-state-entry-hook</span> <span class=nf>#&#39;</span><span class=nv>my/beancount-activate-input-method</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=bibtex-management class=headerLink><a href=#bibtex-management class=header-mark></a>Bibtex management</h3><p>文献管理涉及到的内容比较多，文献的查找、管理、阅读与引用等等。</p><p>Emacs 进行文献管理需要用到的包有 org-cite,bibtex-completion,citar</p><h4 id=org-cite class=headerLink><a href=#org-cite class=header-mark></a>org-cite</h4><p>Org-cite 目前是 org 内置的进行文献引用的包。</p><p>关于 org-cite 的使用见：<a href=https://blog.tecosaur.com/tmio/2021-07-31-citations.html target=_blank rel="noopener noreffer">https://blog.tecosaur.com/tmio/2021-07-31-citations.html</a> 或 <a href=https://kristofferbalintona.me/posts/202206141852/ target=_blank rel="noopener noreffer">Citations in org-mode: Org-cite and Citar | Kristoffer Balintona</a>.</p><p>己经说的比较详细。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>oc</span>
</span></span><span class=line><span class=cl>  <span class=nb>:after</span> <span class=nv>org</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-cite-global-bibliography</span> <span class=o>`</span><span class=p>(</span><span class=o>,</span><span class=p>(</span><span class=nf>concat</span> <span class=nv>my-galaxy</span> <span class=s>&#34;/bibtexs/References.bib&#34;</span><span class=p>))))</span>
</span></span></code></pre></div><h4 id=citar class=headerLink><a href=#citar class=header-mark></a>citar</h4><p>为什么使用 citar? 是因为 org-cite 的提示界面看起来不咋地，而 citar 提供的界面就很友好。</p><p>我通常使用 <code>citar-open-files</code> / <code>SPC n r p</code> 来打开想要阅读的文献 PDF 文件。</p><p>阅读文献使用的是 <a href=#pdf-tools rel>pdf-tools</a> ，更好用的是 <a href=https://github.com/emacs-eaf/eaf-pdf-viewer target=_blank rel="noopener noreffer">emacs-eaf/eaf-pdf-viewer: Fastest PDF Viewer in Emacs</a>.</p><p>eaf-pdf-viewer 存在的问题还是安装较难，对于系统环境要求较高，如 Emacs 29 上就不能使用，存在问题。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>citar</span>
</span></span><span class=line><span class=cl>  <span class=nb>:commands</span> <span class=nv>citar-open</span> <span class=nv>citar-open-entry</span> <span class=nv>citar-open-files</span> <span class=nv>citar-open-notes</span> <span class=nv>citar-open-links</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>citar-bibliography</span> <span class=nv>org-cite-global-bibliography</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>citar-notes-paths</span> <span class=o>`</span><span class=p>(</span><span class=o>,</span><span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;roam/ref&#34;</span> <span class=nv>my-galaxy</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>citar-library-file-extensions</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;pdf&#34;</span> <span class=s>&#34;jpg&#34;</span> <span class=s>&#34;epub&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>citar-templates</span> <span class=o>&#39;</span><span class=p>((</span><span class=nv>main</span> <span class=o>.</span> <span class=s>&#34;${author editor:30} ${date year issued:4} ${title:48}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                          <span class=p>(</span><span class=nv>suffix</span> <span class=o>.</span> <span class=s>&#34;${=key= id:15} ${=type=:12} ${tags keywords:*}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                          <span class=p>(</span><span class=nv>preview</span> <span class=o>.</span> <span class=s>&#34;${author editor} (${year issued date}) ${title}, ${journal journaltitle publisher container-title collection-title}.\n&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                          <span class=p>(</span><span class=nv>note</span> <span class=o>.</span> <span class=s>&#34;${title}&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>citar-symbol-separator</span> <span class=s>&#34;  &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>citar-file-additional-files-separator</span> <span class=s>&#34;-&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>citar-at-point-function</span> <span class=ss>&#39;embark-act</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>citar</span>
</span></span><span class=line><span class=cl>  <span class=nb>:after</span> <span class=nv>all-the-icons</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>citar-symbols</span>
</span></span><span class=line><span class=cl>        <span class=o>`</span><span class=p>((</span><span class=nv>file</span> <span class=o>,</span><span class=p>(</span><span class=nv>all-the-icons-faicon</span> <span class=s>&#34;file-pdf-o&#34;</span> <span class=nb>:face</span> <span class=ss>&#39;all-the-icons-dred</span> <span class=nb>:v-adjust</span> <span class=mf>-0.1</span><span class=p>)</span> <span class=o>.</span> <span class=s>&#34; &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nv>note</span> <span class=o>,</span><span class=p>(</span><span class=nv>all-the-icons-material</span> <span class=s>&#34;speaker_notes&#34;</span> <span class=nb>:face</span> <span class=ss>&#39;all-the-icons-blue</span> <span class=nb>:v-adjust</span> <span class=mf>-0.3</span><span class=p>)</span> <span class=o>.</span> <span class=s>&#34; &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nv>link</span> <span class=o>,</span><span class=p>(</span><span class=nv>all-the-icons-octicon</span> <span class=s>&#34;link&#34;</span> <span class=nb>:face</span> <span class=ss>&#39;all-the-icons-orange</span> <span class=nb>:v-adjust</span> <span class=mf>0.01</span><span class=p>)</span> <span class=o>.</span> <span class=s>&#34; &#34;</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>citar-capf</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>((</span><span class=nv>LaTeX-mode</span> <span class=o>.</span> <span class=nv>citar-capf-setup</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>org-mode</span> <span class=o>.</span> <span class=nv>citar-capf-setup</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>citar-org</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-cite-insert-processor</span> <span class=ss>&#39;citar</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-cite-follow-processor</span> <span class=ss>&#39;citar</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-cite-activate-processor</span> <span class=ss>&#39;citar</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;citar-org</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>define-key</span> <span class=nv>citar-org-citation-map</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;RET&#34;</span><span class=p>)</span> <span class=ss>&#39;org-open-at-point</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>citar-embark</span>
</span></span><span class=line><span class=cl>  <span class=nb>:commands</span> <span class=nv>citar-embark-mode</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>org-mode</span> <span class=o>.</span> <span class=nv>citar-embark-mode</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>my/space-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;re&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>citar-open-entry</span> <span class=nb>:wk</span> <span class=s>&#34;Open entry&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;rp&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>citar-open-files</span> <span class=nb>:wk</span> <span class=s>&#34;Open files&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;ri&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>citar-insert-citation</span> <span class=nb>:wk</span> <span class=s>&#34;Insert citation&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;rn&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>citar-open-notes</span> <span class=nb>:wk</span> <span class=s>&#34;Open/Create note&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;rl&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>citar-open-links</span> <span class=nb>:wk</span> <span class=s>&#34;Open links&#34;</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=citar-org-roam class=headerLink><a href=#citar-org-roam class=header-mark></a>citar-org-roam</h4><p>这个包将 citar 和 org-roam 相结合，我主要使用它来创建文献笔记内容。</p><p>目前 citar-org-roam 不支持 capture with template, 我改写了 citar-org-roam&ndash;create-capture-note 函数。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>citar-org-roam</span>
</span></span><span class=line><span class=cl>  <span class=nb>:commands</span> <span class=p>(</span><span class=nv>citar-org-roam-mode</span> <span class=nv>citar-org-roam-cited</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>org-roam-mode</span> <span class=o>.</span> <span class=nv>citar-org-roam-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>citar-org-roam-subdir</span> <span class=s>&#34;ref&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>citar-org-roam-note-title-template</span> <span class=s>&#34;${title}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>;; Temporarily work, wait citar-org-roam update to support capture with template.</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>defun</span> <span class=nv>my/citar-org-roam--create-capture-note</span> <span class=p>(</span><span class=nv>citekey</span> <span class=nv>entry</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;Open or create org-roam node for CITEKEY and ENTRY.&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1>;; adapted from https://jethrokuan.github.io/org-roam-guide/#orgc48eb0d</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>title</span> <span class=p>(</span><span class=nv>citar-format--entry</span>
</span></span><span class=line><span class=cl>                  <span class=nv>citar-org-roam-note-title-template</span> <span class=nv>entry</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>org-roam-capture-</span>
</span></span><span class=line><span class=cl>       <span class=nb>:templates</span>
</span></span><span class=line><span class=cl>       <span class=o>&#39;</span><span class=p>((</span><span class=s>&#34;r&#34;</span> <span class=s>&#34;reference&#34;</span> <span class=nv>plain</span> <span class=p>(</span><span class=nv>file</span> <span class=s>&#34;~/.emacs.d/template/reference&#34;</span><span class=p>)</span> <span class=nb>:if-new</span> <span class=c1>;; Change &#34;%?&#34; to a template file.</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nv>file+head</span>
</span></span><span class=line><span class=cl>           <span class=s>&#34;%(concat
</span></span></span><span class=line><span class=cl><span class=s>                  (when citar-org-roam-subdir (concat citar-org-roam-subdir \&#34;/\&#34;)) \&#34;${citekey}.org\&#34;)&#34;</span>
</span></span><span class=line><span class=cl>           <span class=s>&#34;#+title: ${title}\n&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=nb>:immediate-finish</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>          <span class=nb>:unnarrowed</span> <span class=no>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>       <span class=nb>:info</span> <span class=p>(</span><span class=nf>list</span> <span class=nb>:citekey</span> <span class=nv>citekey</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=nb>:node</span> <span class=p>(</span><span class=nv>org-roam-node-create</span> <span class=nb>:title</span> <span class=nv>title</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=nb>:props</span> <span class=o>&#39;</span><span class=p>(</span><span class=nb>:finalize</span> <span class=nv>find-file</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>org-roam-ref-add</span> <span class=p>(</span><span class=nf>concat</span> <span class=s>&#34;@&#34;</span> <span class=nv>citekey</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>advice-add</span> <span class=ss>&#39;citar-org-roam--create-capture-note</span> <span class=nb>:override</span> <span class=nf>#&#39;</span><span class=nv>my/citar-org-roam--create-capture-note</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>my/space-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;rc&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>citar-org-roam-cited</span> <span class=nb>:wk</span> <span class=s>&#34;Cited Roam Node&#34;</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=bibtex-completion class=headerLink><a href=#bibtex-completion class=header-mark></a>bibtex-completion</h4><p>bibtex-completion 这个包是 org-roam-bibtex 的依赖。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>bibtex-completion</span>
</span></span><span class=line><span class=cl>  <span class=nb>:after</span> <span class=nv>org-roam-bibtex</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>bibtex-completion-bibliography</span> <span class=nv>org-cite-global-bibliography</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>bibtex-completion-notes-path</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;roam/ref&#34;</span> <span class=nv>my-galaxy</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>bibtex-completion-pdf-field</span> <span class=s>&#34;File&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>bibtex-completion-additional-search-fields</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>keywords</span> <span class=nv>journal</span> <span class=nv>booktitle</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>bibtex-completion-pdf-symbol</span> <span class=s>&#34;P&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>bibtex-completion-notes-symbol</span> <span class=s>&#34;N&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>bibtex-completion-display-formats</span> <span class=o>&#39;</span><span class=p>((</span><span class=nv>article</span> <span class=o>.</span> <span class=s>&#34;${=has-pdf=:1} ${=has-note=:1} ${year:4} ${author:36} ${title:*} ${journal:40}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                                            <span class=p>(</span><span class=nv>inbook</span> <span class=o>.</span> <span class=s>&#34;${=has-pdf=:1} ${=has-note=:1} ${year:4} ${author:36} ${title:*} Chapter ${chapter:32}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                                            <span class=p>(</span><span class=nv>incollection</span> <span class=o>.</span> <span class=s>&#34;${=has-pdf=:1} ${=has-note=:1} ${year:4} ${author:36} ${title:*} ${booktitle:40}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                                            <span class=p>(</span><span class=nv>inproceedings</span> <span class=o>.</span> <span class=s>&#34;${=has-pdf=:1} ${=has-note=:1} ${year:4} ${author:36} ${title:*} ${booktitle:40}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                                            <span class=p>(</span><span class=no>t</span> <span class=o>.</span> <span class=s>&#34;${=has-pdf=:1} ${=has-note=:1} ${year:4} ${author:36} ${title:*}&#34;</span><span class=p>))))</span>
</span></span></code></pre></div><h4 id=org-roam-bibtex class=headerLink><a href=#org-roam-bibtex class=header-mark></a>org-roam-bibtex</h4><p>org-roam-bibtex 的主要作用是当创建文献笔记时，会在文件的头部创建一个 <code>ROAM_REFS: @xxx</code> ，这样通过 @xxx 可以打开对应文献的 PDF 文件。</p><p>我设置了 <code>z m</code> 调用 <code>orb-note-actions</code>. 主要作用有两个，一个是打开对应文献笔记的 PDF 文件，一个是通过 scrapper 来获取 PDF 文件的引文信息。</p><p>使用 scrapper 功能需要安装 <a href=https://github.com/inukshuk/anystyle target=_blank rel="noopener noreffer">inukshuk/anystyle: Fast and smart citation reference parsing</a>, <code>[sudo] gem install anystyle-cli</code>.</p><p>这样文献检索就有了另外一个方法，就是通过己有的文献来查找文献，这也是阅读文献的一个重要方法。别人引用了啥，捡重要的看哈。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>org-roam-bibtex</span>
</span></span><span class=line><span class=cl>  <span class=nb>:commands</span> <span class=nv>orb-note-actions</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;evil</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>evil-define-key</span> <span class=ss>&#39;normal</span> <span class=ss>&#39;org-mode-map</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;zm&#34;</span> <span class=ss>&#39;orb-note-actions</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=ebib class=headerLink><a href=#ebib class=header-mark></a>ebib</h4><p>Ebib 是 Emacs 中的文献管理软件，类似于 zotero, 但是我感觉 Zotero 更强一些，但是 Zotero 占用的内存实在是大，MacOS 上约有一个G.</p><p>相比较而言，Emacs 整个占用的内存才几百兆。</p><p>我保留 Ebib 的原因是它可以从主 bibtex 文件中提取文章需要的文献内容。</p><p>具体的使用见：<a href=https://joostkremers.github.io/ebib/ebib-manual.html#main-and-dependent-databases target=_blank rel="noopener noreffer">Ebib Manual</a></p><p>首先创建一个 dependent database <code>M c</code>, 然后使用 <code>M a</code> 把 main database 中的引文添加到 dependent database 中。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>ebib</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span> <span class=p>(</span><span class=s>&#34;&lt;f2&gt;&#34;</span> <span class=o>.</span> <span class=nv>ebib</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>ebib-index-mode</span> <span class=o>.</span> <span class=nv>hide-mode-line-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>ebib-index-mode-line</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>ebib-entry-mode-line</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>ebib-preload-bib-files</span> <span class=nv>org-cite-global-bibliography</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>ebib-keywords</span> <span class=p>(</span><span class=nf>concat</span> <span class=nv>org-roam-directory</span> <span class=s>&#34;/bibtexs/keywords.txt&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>ebib-notes-directory</span> <span class=p>(</span><span class=nf>concat</span> <span class=nv>org-roam-directory</span> <span class=s>&#34;/ref&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>ebib-filters-default-file</span> <span class=p>(</span><span class=nf>concat</span> <span class=nv>org-roam-directory</span> <span class=s>&#34;/bibtexs/ebib-filters&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>ebib-reading-list-file</span> <span class=p>(</span><span class=nf>concat</span> <span class=nv>org-roam-directory</span> <span class=s>&#34;/bibtexs/reading_list.org&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>ebib-keywords-field-keep-sorted</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>ebib-keywords-file-save-on-exit</span> <span class=ss>&#39;always</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>ebib-index-columns</span>
</span></span><span class=line><span class=cl>        <span class=o>&#39;</span><span class=p>((</span><span class=s>&#34;Entry Key&#34;</span> <span class=mi>30</span> <span class=no>t</span><span class=p>)</span> <span class=p>(</span><span class=s>&#34;Note&#34;</span> <span class=mi>1</span> <span class=no>nil</span><span class=p>)</span> <span class=p>(</span><span class=s>&#34;Year&#34;</span> <span class=mi>6</span> <span class=no>t</span><span class=p>)</span> <span class=p>(</span><span class=s>&#34;Title&#34;</span> <span class=mi>50</span> <span class=no>t</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>ebib-file-associations</span> <span class=o>&#39;</span><span class=p>((</span><span class=s>&#34;ps&#34;</span> <span class=o>.</span> <span class=s>&#34;gv&#34;</span><span class=p>))))</span>
</span></span></code></pre></div><h4 id=scihub class=headerLink><a href=#scihub class=header-mark></a>scihub</h4><p>当有了 DOI 之后想要下载文献，可以使用 scihub 这个通过 scihub 下载。若没有源的话再想其他的方式。</p><p>使用 scihub 需要提供 DOI 或者完整的文献题目。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>scihub</span>
</span></span><span class=line><span class=cl>  <span class=nb>:commands</span> <span class=nv>scihub</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>scihub-download-directory</span> <span class=s>&#34;~/Downloads/&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>scihub-open-after-download</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>scihub-fetch-domain</span> <span class=ss>&#39;scihub-fetch-domains-lovescihub</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=biblio class=headerLink><a href=#biblio class=header-mark></a>biblio</h4><p>文献的查找目前有多种方式，如可以使用 biblio 进行查找，常用的有 crossfer-lookup.</p><p>我默认使用 crossref 作为后端，通过 <code>SPC n r d</code> 调用，若要使用其他的后端，通过 <code>M-x biblio-lookup</code> 进行。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>biblio</span>
</span></span><span class=line><span class=cl>  <span class=nb>:commands</span> <span class=nv>biblio-lookup</span>
</span></span><span class=line><span class=cl>  <span class=nb>:general</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>:states</span> <span class=ss>&#39;normal</span>
</span></span><span class=line><span class=cl>           <span class=s>&#34;SPC rd&#34;</span> <span class=ss>&#39;my/biblio-lookup-crossref</span> <span class=nb>:no-autoload</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:preface</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>defun</span> <span class=nv>my/biblio-lookup-crossref</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>biblio-lookup</span> <span class=ss>&#39;biblio-crossref-backend</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>my/space-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;rd&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>my/biblio-lookup-crossref</span> <span class=nb>:wk</span> <span class=s>&#34;Get bib from crossfer&#34;</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=latex class=headerLink><a href=#latex class=header-mark></a>latex</h3><p>参考资料：<a href=https://gist.github.com/karthink/7d89df35ee9b7ac0c93d0177b862dadb target=_blank rel="noopener noreffer">fast latex input</a>.</p><p>Latex 可以结合 eglot 使用，有多个 server 可以使用， <code>digestif</code> 和 =texlab=，我使用前者。</p><h4 id=auctex class=headerLink><a href=#auctex class=header-mark></a>Auctex</h4><p>Auctex 若通过源文件安装，需要先将其克隆到本地，然后执行：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>./autogen.sh
</span></span><span class=line><span class=cl>./configure
</span></span><span class=line><span class=cl>make
</span></span><span class=line><span class=cl>sudo make install
</span></span></code></pre></div><p>emacs 上有 <code>latex-mode</code> 和 <code>LaTeX-mode</code> 两个，使用哪个取决于是否安装了 <code>auctex</code> 这个包。若有，使用 <code>LaTex-mode</code> 就好。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>tex</span>
</span></span><span class=line><span class=cl>  <span class=nb>:mode</span> <span class=p>(</span><span class=s>&#34;.tex&#34;</span> <span class=o>.</span> <span class=nv>LaTeX-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:init</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>load</span> <span class=s>&#34;auctex.el&#34;</span> <span class=no>nil</span> <span class=no>t</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>load</span> <span class=s>&#34;preview-latex.el&#34;</span> <span class=no>nil</span> <span class=no>t</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>TeX-auto-save</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>TeX-parse-self</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>TeX-save-query</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>TeX-electric-sub-and-superscript</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>TeX-auto-local</span> <span class=s>&#34;.auctex-auto&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>TeX-style-local</span> <span class=s>&#34;.auctex-style&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>TeX-source-correlate-mode</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>TeX-source-correlate-method</span> <span class=ss>&#39;synctex</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>TeX-source-correlate-start-server</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq-default</span> <span class=nv>TeX-master</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;TeX-command-list</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;XeLaTeX&#34;</span> <span class=s>&#34;%`xelatex%(mode)%&#39; %t&#34;</span> <span class=nv>TeX-run-TeX</span> <span class=no>nil</span> <span class=no>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;TeX-view-program-selection</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>output-pdf</span> <span class=s>&#34;PDF Tools&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;TeX-view-program-list</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;PDF Tools&#34;</span> <span class=nv>TeX-pdf-tools-sync-view</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;TeX-after-compilation-finished-functions</span> <span class=nf>#&#39;</span><span class=nv>TeX-revert-document-buffer</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>latex</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span> <span class=p>(</span><span class=nb>:map</span> <span class=nv>LaTeX-mode-map</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=s>&#34;C-c h&#34;</span> <span class=o>.</span> <span class=nv>TeX-doc</span><span class=p>)))</span>
</span></span></code></pre></div><h4 id=fontification class=headerLink><a href=#fontification class=header-mark></a>fontification</h4><p><a href=https://tex.stackexchange.com/questions/85849/auctex-new-commands-recognized-as-such/86119#86119 target=_blank rel="noopener noreffer">macros - AUCTeX – new commands recognized as such - TeX - LaTeX Stack Exchange</a>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>font-latex</span>
</span></span><span class=line><span class=cl>  <span class=nb>:after</span> <span class=nv>tex</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>font-latex-match-reference-keywords</span>
</span></span><span class=line><span class=cl>        <span class=o>&#39;</span><span class=p>(</span><span class=c1>;; BibLaTeX.</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;printbibliography&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;addbibresource&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=c1>;; Standard commands.</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;cite&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;citep&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;citet&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;Cite&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;parencite&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;Parencite&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;footcite&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;footcitetext&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=c1>;; Style-specific commands.</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;textcite&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;Textcite&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;smartcite&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;Smartcite&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;cite*&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;parencite*&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;supercite&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=c1>;; Qualified citation lists.</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;cites&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;Cites&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;parencites&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;Parencites&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;footcites&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;footcitetexts&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;smartcites&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;Smartcites&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;textcites&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;Textcites&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;supercites&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=c1>;; Style-independent commands.</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;autocite&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;Autocite&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;autocite*&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;Autocite*&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;autocites&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;Autocites&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=c1>;; Text commands.</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;citeauthor&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;Citeauthor&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;citetitle&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;citetitle*&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;citeyear&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;citedate&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;citeurl&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=c1>;; Special commands.</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;fullcite&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=c1>;; Cleveref.</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;cref&#34;</span> <span class=s>&#34;{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;Cref&#34;</span> <span class=s>&#34;{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;cpageref&#34;</span> <span class=s>&#34;{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;Cpageref&#34;</span> <span class=s>&#34;{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;cpagerefrange&#34;</span> <span class=s>&#34;{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;Cpagerefrange&#34;</span> <span class=s>&#34;{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;crefrange&#34;</span> <span class=s>&#34;{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;Crefrange&#34;</span> <span class=s>&#34;{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;labelcref&#34;</span> <span class=s>&#34;{&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>font-latex-match-textual-keywords</span>
</span></span><span class=line><span class=cl>        <span class=o>&#39;</span><span class=p>(</span><span class=c1>;; BibLaTeX brackets.</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;parentext&#34;</span> <span class=s>&#34;{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;brackettext&#34;</span> <span class=s>&#34;{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;hybridblockquote&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=c1>;; Auxiliary commands.</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;textelp&#34;</span> <span class=s>&#34;{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;textelp*&#34;</span> <span class=s>&#34;{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;textins&#34;</span> <span class=s>&#34;{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;textins*&#34;</span> <span class=s>&#34;{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=c1>;; Subcaption.</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;subcaption&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>font-latex-match-variable-keywords</span>
</span></span><span class=line><span class=cl>        <span class=o>&#39;</span><span class=p>(</span><span class=c1>;; Amsmath.</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;numberwithin&#34;</span> <span class=s>&#34;{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=c1>;; Enumitem.</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;setlist&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;setlist*&#34;</span> <span class=s>&#34;[{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;newlist&#34;</span> <span class=s>&#34;{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;renewlist&#34;</span> <span class=s>&#34;{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;setlistdepth&#34;</span> <span class=s>&#34;{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;restartlist&#34;</span> <span class=s>&#34;{&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;crefname&#34;</span> <span class=s>&#34;{&#34;</span><span class=p>))))</span>
</span></span></code></pre></div><h4 id=cdlatex class=headerLink><a href=#cdlatex class=header-mark></a>cdlatex</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>cdlatex</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>((</span><span class=nv>LaTeX-mode</span> <span class=o>.</span> <span class=nv>turn-on-cdlatex</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>org-mode</span> <span class=o>.</span> <span class=nv>org-cdlatex-mode</span><span class=p>)))</span>
</span></span></code></pre></div><h4 id=reftex class=headerLink><a href=#reftex class=header-mark></a>Reftex</h4><p>Hide mode line see <a href=#hide-mode-line rel>hide-mode-line</a>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>reftex</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>((</span><span class=nv>LaTeX-mode</span> <span class=o>.</span> <span class=nv>turn-on-reftex</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>reftex-toc-mode</span> <span class=o>.</span> <span class=nv>menu-bar--visual-line-mode-enable</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>reftex-toc-mode</span> <span class=o>.</span> <span class=nv>hide-mode-line-mode</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>reftex-toc-split-windows-horizontally</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>reftex-toc-split-windows-fraction</span> <span class=mf>0.25</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=ox-latex class=headerLink><a href=#ox-latex class=header-mark></a>ox-latex</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>org</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-highlight-latex-and-related</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>latex</span> <span class=nv>script</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>ox-latex</span>
</span></span><span class=line><span class=cl>  <span class=nb>:defer</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-latex-src-block-backend</span> <span class=ss>&#39;minted</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-latex-minted-options</span> <span class=o>&#39;</span><span class=p>((</span><span class=s>&#34;breaklines&#34;</span> <span class=s>&#34;true&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                                   <span class=p>(</span><span class=s>&#34;breakanywhere&#34;</span> <span class=s>&#34;true&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-latex-classes</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;org-latex-classes</span>
</span></span><span class=line><span class=cl>               <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;book&#34;</span>
</span></span><span class=line><span class=cl>                 <span class=s>&#34;\\documentclass[UTF8,twoside,a4paper,12pt,openright]{ctexrep}
</span></span></span><span class=line><span class=cl><span class=s>                   [NO-DEFAULT-PACKAGES]
</span></span></span><span class=line><span class=cl><span class=s>                   [NO-PACKAGES]
</span></span></span><span class=line><span class=cl><span class=s>                   [EXTRA]&#34;</span>
</span></span><span class=line><span class=cl>                 <span class=p>(</span><span class=s>&#34;\\chapter{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\chapter*{%s}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                 <span class=p>(</span><span class=s>&#34;\\section{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\section*{%s}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                 <span class=p>(</span><span class=s>&#34;\\subsection{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\subsection*{%s}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                 <span class=p>(</span><span class=s>&#34;\\subsubsection{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\subsubsection*{%s}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                 <span class=p>(</span><span class=s>&#34;\\paragraph{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\paragraph*{%s}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                 <span class=p>(</span><span class=s>&#34;\\subparagraph{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\subparagraph*{%s}&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;org-latex-classes</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;article-cn&#34;</span> <span class=s>&#34;\\documentclass{ctexart}
</span></span></span><span class=line><span class=cl><span class=s>                                      [NO-DEFAULT-PACKAGES]
</span></span></span><span class=line><span class=cl><span class=s>                                      [NO-PACKAGES]
</span></span></span><span class=line><span class=cl><span class=s>                                      [EXTRA]&#34;</span>
</span></span><span class=line><span class=cl>                                    <span class=p>(</span><span class=s>&#34;\\section{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\section*{%s}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                                    <span class=p>(</span><span class=s>&#34;\\subsection{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\subsection*{%s}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                                    <span class=p>(</span><span class=s>&#34;\\subsubsection{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\subsubsection*{%s}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                                    <span class=p>(</span><span class=s>&#34;\\paragraph{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\paragraph*{%s}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                                    <span class=p>(</span><span class=s>&#34;\\subparagraph{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\subparagraph*{%s}&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;org-latex-classes</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;article&#34;</span> <span class=s>&#34;\\documentclass[11pt]{article}
</span></span></span><span class=line><span class=cl><span class=s>                                      [NO-DEFAULT-PACKAGES]
</span></span></span><span class=line><span class=cl><span class=s>                                      [NO-PACKAGES]
</span></span></span><span class=line><span class=cl><span class=s>                                      [EXTRA]&#34;</span>
</span></span><span class=line><span class=cl>                                    <span class=p>(</span><span class=s>&#34;\\section{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\section*{%s}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                                    <span class=p>(</span><span class=s>&#34;\\subsection{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\subsection*{%s}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                                    <span class=p>(</span><span class=s>&#34;\\subsubsection{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\subsubsection*{%s}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                                    <span class=p>(</span><span class=s>&#34;\\paragraph{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\paragraph*{%s}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                                    <span class=p>(</span><span class=s>&#34;\\subparagraph{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\subparagraph*{%s}&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;org-latex-classes</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;beamer&#34;</span> <span class=s>&#34;\\documentclass[presentation]{beamer}
</span></span></span><span class=line><span class=cl><span class=s>                                      [DEFAULT-PACKAGES]
</span></span></span><span class=line><span class=cl><span class=s>                                      [PACKAGES]
</span></span></span><span class=line><span class=cl><span class=s>                                      [EXTRA]&#34;</span>
</span></span><span class=line><span class=cl>                                    <span class=p>(</span><span class=s>&#34;\\section{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\section*{%s}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                                    <span class=p>(</span><span class=s>&#34;\\subsection{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\subsection*{%s}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                                    <span class=p>(</span><span class=s>&#34;\\subsubsection{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\subsubsection*{%s}&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-latex-pdf-process</span>
</span></span><span class=line><span class=cl>        <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;xelatex -8bit --shell-escape  -interaction=nonstopmode -output-directory %o %f&#34;</span>
</span></span><span class=line><span class=cl>          <span class=s>&#34;bibtex -shell-escape %b&#34;</span>
</span></span><span class=line><span class=cl>          <span class=s>&#34;xelatex -8bit --shell-escape  -interaction=nonstopmode -output-directory %o %f&#34;</span>
</span></span><span class=line><span class=cl>          <span class=s>&#34;xelatex -8bit --shell-escape  -interaction=nonstopmode -output-directory %o %f&#34;</span>
</span></span><span class=line><span class=cl>          <span class=s>&#34;rm -fr %b.out %b.log %b.tex %b.brf %b.bbl&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-latex-logfiles-extensions</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;lof&#34;</span> <span class=s>&#34;lot&#34;</span> <span class=s>&#34;tex~&#34;</span> <span class=s>&#34;aux&#34;</span> <span class=s>&#34;idx&#34;</span> <span class=s>&#34;log&#34;</span>
</span></span><span class=line><span class=cl>                                        <span class=s>&#34;out&#34;</span> <span class=s>&#34;toc&#34;</span> <span class=s>&#34;nav&#34;</span> <span class=s>&#34;snm&#34;</span> <span class=s>&#34;vrb&#34;</span> <span class=s>&#34;dvi&#34;</span>
</span></span><span class=line><span class=cl>                                        <span class=s>&#34;fdb_latexmk&#34;</span> <span class=s>&#34;blg&#34;</span> <span class=s>&#34;brf&#34;</span> <span class=s>&#34;fls&#34;</span>
</span></span><span class=line><span class=cl>                                        <span class=s>&#34;entoc&#34;</span> <span class=s>&#34;ps&#34;</span> <span class=s>&#34;spl&#34;</span> <span class=s>&#34;bbl&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-latex-prefer-user-labels</span> <span class=no>t</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=auctex-latexmk class=headerLink><a href=#auctex-latexmk class=header-mark></a>auctex-latexmk</h4><p><a href=https://github.com/tom-tan/auctex-latexmk target=_blank rel="noopener noreffer">tom-tan/auctex-latexmk: This library adds LatexMk support to AUCTeX.</a>
最新的 auctex 不能使用此处的包文件，需要使用 <a href=https://github.com/emacsmirror/auctex-latexmk target=_blank rel="noopener noreffer">emacsmirror/auctex-latexmk: Add LatexMk support to AUCTeX</a> 替代。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>auctex-latexmk</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>LaTeX-mode</span> <span class=o>.</span> <span class=nv>auctex-latexmk-setup</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=ox-beamer class=headerLink><a href=#ox-beamer class=header-mark></a>ox-beamer</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>ox-beamer</span>
</span></span><span class=line><span class=cl>  <span class=nb>:defer</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>  <span class=nb>:after</span> <span class=nv>org</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=blog class=headerLink><a href=#blog class=header-mark></a>Blog</h3><p>使用 org-mode 写 blog 有两个方法，一个是使用 ox-hugo, 另外一个就是使用 org-publish.</p><p>这两个都可以基于 github 建立自己的博客。</p><p>使用 deft 管理自己的写作，原先想使用 denote 进行，但是 denote 创建的文件名过长，会导致 <a href=https://codeberg.org/ideasman42/emacs-undo-fu-session target=_blank rel="noopener noreffer">undo-fu-session</a> 报 <code>file name too long</code> 的错误。</p><p>发现使用 <a href=#consult-notes rel>consult-notes</a> 比 deft 好用。Deft 默认创建的文件名是一串日期格式，没有直接使用 title 直观。虽然可以使用 deft 提供的界面查找文件，但是不能结合 vertico 直接使用拼音进行中文的检索。</p><h4 id=ox-hugo class=headerLink><a href=#ox-hugo class=header-mark></a>ox-hugo</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>ox-hugo</span>
</span></span><span class=line><span class=cl>  <span class=nb>:defer</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>  <span class=nb>:after</span> <span class=nv>ox</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=ox-html class=headerLink><a href=#ox-html class=header-mark></a>ox-html</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>ox-html</span>
</span></span><span class=line><span class=cl>  <span class=nb>:after</span> <span class=nv>ox</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-html-preamble</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-html-preamble-format</span>
</span></span><span class=line><span class=cl>        <span class=o>&#39;</span><span class=p>((</span><span class=s>&#34;en&#34;</span> <span class=s>&#34;&lt;a href=\&#34;/index.html\&#34; class=\&#34;button\&#34;&gt;Home&lt;/a&gt;
</span></span></span><span class=line><span class=cl><span class=s>               &lt;a href=\&#34;/notes/index.html\&#34; class=\&#34;button\&#34;&gt;Notes&lt;/a&gt;
</span></span></span><span class=line><span class=cl><span class=s>               &lt;a href=\&#34;/engineering/index.html\&#34; class=\&#34;button\&#34;&gt;Engineering&lt;/a&gt;
</span></span></span><span class=line><span class=cl><span class=s>               &lt;a href=\&#34;/movies/index.html\&#34; class=\&#34;button\&#34;&gt;Movies&lt;/a&gt;
</span></span></span><span class=line><span class=cl><span class=s>               &lt;a href=\&#34;/books/index.html\&#34; class=\&#34;button\&#34;&gt;Books&lt;/a&gt;
</span></span></span><span class=line><span class=cl><span class=s>               &lt;a href=\&#34;/about.html\&#34; class=\&#34;button\&#34;&gt;About&lt;/a&gt;
</span></span></span><span class=line><span class=cl><span class=s>               &lt;hr&gt;&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-html-postamble</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-html-postamble-format</span>
</span></span><span class=line><span class=cl>        <span class=o>&#39;</span><span class=p>((</span><span class=s>&#34;en&#34;</span> <span class=s>&#34;&lt;hr&gt;&lt;div class=\&#34;generated\&#34;&gt;Created with %c on MacOS&lt;/div&gt;&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-html-head-include-default-style</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-html-head</span>
</span></span><span class=line><span class=cl>        <span class=s>&#34;&lt;link rel=\&#34;stylesheet\&#34; type=\&#34;text/css\&#34; href=\&#34;../css/style.css\&#34; /&gt;&#34;</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=ox-publish class=headerLink><a href=#ox-publish class=header-mark></a>ox-publish</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>ox-publish</span>
</span></span><span class=line><span class=cl>  <span class=nb>:after</span> <span class=nv>ox</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>defvar</span> <span class=nv>my/publish-directory</span> <span class=s>&#34;~/shuyi.github.io&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-publish-project-alist</span>
</span></span><span class=line><span class=cl>        <span class=o>`</span><span class=p>((</span><span class=s>&#34;site&#34;</span>
</span></span><span class=line><span class=cl>           <span class=nb>:base-directory</span> <span class=o>,</span><span class=nv>website-directory</span>
</span></span><span class=line><span class=cl>           <span class=nb>:base-extension</span> <span class=s>&#34;org&#34;</span>
</span></span><span class=line><span class=cl>           <span class=nb>:recursive</span> <span class=no>nil</span>
</span></span><span class=line><span class=cl>           <span class=nb>:publishing-directory</span> <span class=o>,</span><span class=nv>my/publish-directory</span>
</span></span><span class=line><span class=cl>           <span class=nb>:publishing-function</span> <span class=nv>org-html-publish-to-html</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;notes&#34;</span>
</span></span><span class=line><span class=cl>           <span class=nb>:base-directory</span> <span class=o>,</span><span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;notes&#34;</span> <span class=nv>website-directory</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=nb>:base-extension</span> <span class=s>&#34;org&#34;</span>
</span></span><span class=line><span class=cl>           <span class=nb>:publishing-directory</span> <span class=o>,</span><span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;notes&#34;</span> <span class=nv>my/publish-directory</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=nb>:publishing-function</span> <span class=nv>org-html-publish-to-html</span>
</span></span><span class=line><span class=cl>           <span class=nb>:auto-sitemap</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>           <span class=nb>:sitemap-filename</span> <span class=s>&#34;index.org&#34;</span>
</span></span><span class=line><span class=cl>           <span class=nb>:sitemap-title</span> <span class=s>&#34;Notes&#34;</span>
</span></span><span class=line><span class=cl>           <span class=nb>:sitemap-sort-files</span> <span class=nv>anti-chronologically</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;books&#34;</span>
</span></span><span class=line><span class=cl>           <span class=nb>:base-directory</span> <span class=o>,</span><span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;books&#34;</span> <span class=nv>website-directory</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=nb>:base-extension</span> <span class=s>&#34;org&#34;</span>
</span></span><span class=line><span class=cl>           <span class=nb>:publishing-directory</span> <span class=o>,</span><span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;books&#34;</span> <span class=nv>my/publish-directory</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=nb>:publishing-function</span> <span class=nv>org-html-publish-to-html</span>
</span></span><span class=line><span class=cl>           <span class=nb>:auto-sitemap</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>           <span class=nb>:sitemap-filename</span> <span class=s>&#34;index.org&#34;</span>
</span></span><span class=line><span class=cl>           <span class=nb>:sitemap-title</span> <span class=s>&#34;Books&#34;</span>
</span></span><span class=line><span class=cl>           <span class=nb>:sitemap-sort-files</span> <span class=nv>anti-chronologically</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;movies&#34;</span>
</span></span><span class=line><span class=cl>           <span class=nb>:base-directory</span> <span class=o>,</span><span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;movies&#34;</span> <span class=nv>website-directory</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=nb>:base-extension</span> <span class=s>&#34;org&#34;</span>
</span></span><span class=line><span class=cl>           <span class=nb>:publishing-directory</span> <span class=o>,</span><span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;movies&#34;</span> <span class=nv>my/publish-directory</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=nb>:publishing-function</span> <span class=nv>org-html-publish-to-html</span>
</span></span><span class=line><span class=cl>           <span class=nb>:auto-sitemap</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>           <span class=nb>:sitemap-filename</span> <span class=s>&#34;index.org&#34;</span>
</span></span><span class=line><span class=cl>           <span class=nb>:sitemap-title</span> <span class=s>&#34;Movies&#34;</span>
</span></span><span class=line><span class=cl>           <span class=nb>:sitemap-sort-files</span> <span class=nv>anti-chronologically</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;engineering&#34;</span>
</span></span><span class=line><span class=cl>           <span class=nb>:base-directory</span> <span class=o>,</span><span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;engineering&#34;</span> <span class=nv>website-directory</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=nb>:base-extension</span> <span class=s>&#34;org&#34;</span>
</span></span><span class=line><span class=cl>           <span class=nb>:publishing-directory</span> <span class=o>,</span><span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;engineering&#34;</span> <span class=nv>my/publish-directory</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=nb>:publishing-function</span> <span class=nv>org-html-publish-to-html</span>
</span></span><span class=line><span class=cl>           <span class=nb>:auto-sitemap</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>           <span class=nb>:sitemap-filename</span> <span class=s>&#34;index.org&#34;</span>
</span></span><span class=line><span class=cl>           <span class=nb>:sitemap-title</span> <span class=s>&#34;Engineering&#34;</span>
</span></span><span class=line><span class=cl>           <span class=nb>:sitemap-sort-files</span> <span class=nv>anti-chronologically</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;static&#34;</span>
</span></span><span class=line><span class=cl>           <span class=nb>:base-directory</span> <span class=o>,</span><span class=nv>website-directory</span>
</span></span><span class=line><span class=cl>           <span class=nb>:base-extension</span> <span class=s>&#34;css\\|txt\\|jpg\\|gif\\|png&#34;</span>
</span></span><span class=line><span class=cl>           <span class=nb>:recursive</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>           <span class=nb>:publishing-directory</span>  <span class=o>,</span><span class=nv>my/publish-directory</span>
</span></span><span class=line><span class=cl>           <span class=nb>:publishing-function</span> <span class=nv>org-publish-attachment</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=s>&#34;personal-website&#34;</span> <span class=nb>:components</span> <span class=p>(</span><span class=s>&#34;site&#34;</span> <span class=s>&#34;notes&#34;</span> <span class=s>&#34;books&#34;</span>
</span></span><span class=line><span class=cl>                                           <span class=s>&#34;movies&#34;</span> <span class=s>&#34;engineering&#34;</span> <span class=s>&#34;static&#34;</span><span class=p>)))))</span>
</span></span></code></pre></div><h2 id=applications class=headerLink><a href=#applications class=header-mark></a>Applications</h2><h3 id=browser class=headerLink><a href=#browser class=header-mark></a>Browser</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=c1>;; eww</span>
</span></span><span class=line><span class=cl><span class=c1>;; Install readability first.</span>
</span></span><span class=line><span class=cl><span class=c1>;; npm install -g readability-cli</span>
</span></span><span class=line><span class=cl><span class=c1>;; (setq eww-retrieve-command &#39;(&#34;readable&#34;))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>;; Another choice `websearch&#39;.</span>
</span></span><span class=line><span class=cl><span class=c1>;; Search engine</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>engine-mode</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>on-first-input</span> <span class=o>.</span> <span class=nv>engine-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>defengine</span> <span class=nv>google</span> <span class=s>&#34;https://google.com/search?q=%s&#34;</span>
</span></span><span class=line><span class=cl>             <span class=nb>:keybinding</span> <span class=s>&#34;g&#34;</span>
</span></span><span class=line><span class=cl>             <span class=nb>:docstring</span> <span class=s>&#34;Search Google.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>defengine</span> <span class=nv>wikipedia</span> <span class=s>&#34;https://en.wikipedia.org/wiki/Special:Search?search=%s&#34;</span>
</span></span><span class=line><span class=cl>             <span class=nb>:keybinding</span> <span class=s>&#34;w&#34;</span>
</span></span><span class=line><span class=cl>             <span class=nb>:docstring</span> <span class=s>&#34;Search Wikipedia.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>defengine</span> <span class=nv>github</span> <span class=s>&#34;https://github.com/search?ref=simplesearch&amp;q=%s&#34;</span>
</span></span><span class=line><span class=cl>             <span class=nb>:keybinding</span> <span class=s>&#34;h&#34;</span>
</span></span><span class=line><span class=cl>             <span class=nb>:docstring</span> <span class=s>&#34;Search GitHub.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>defengine</span> <span class=nv>youtube</span> <span class=s>&#34;http://www.youtube.com/results?aq=f&amp;oq=&amp;search_query=%s&#34;</span>
</span></span><span class=line><span class=cl>             <span class=nb>:keybinding</span> <span class=s>&#34;y&#34;</span>
</span></span><span class=line><span class=cl>             <span class=nb>:docstring</span> <span class=s>&#34;Search YouTube.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>defengine</span> <span class=nv>moviedouban</span> <span class=s>&#34;https://search.douban.com/movie/subject_search?search_text=%s&#34;</span>
</span></span><span class=line><span class=cl>             <span class=nb>:keybinding</span> <span class=s>&#34;m&#34;</span>
</span></span><span class=line><span class=cl>             <span class=nb>:docstring</span> <span class=s>&#34;Search Moive DouBan.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>defengine</span> <span class=nv>bookdouban</span> <span class=s>&#34;https://search.douban.com/book/subject_search?search_text=%s&#34;</span>
</span></span><span class=line><span class=cl>             <span class=nb>:keybinding</span> <span class=s>&#34;b&#34;</span>
</span></span><span class=line><span class=cl>             <span class=nb>:docstring</span> <span class=s>&#34;Search Book DouBan.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>defengine</span> <span class=nv>zhihu</span> <span class=s>&#34;https://www.zhihu.com/search?type=content&amp;q=%s&#34;</span>
</span></span><span class=line><span class=cl>             <span class=nb>:keybinding</span> <span class=s>&#34;z&#34;</span>
</span></span><span class=line><span class=cl>             <span class=nb>:docstring</span> <span class=s>&#34;Search Zhihu.&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>my/comma-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;s&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nb>:ignore</span> <span class=no>t</span> <span class=nb>:wk</span> <span class=s>&#34;Search&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;sb&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>engine/search-bookdouban</span> <span class=nb>:wk</span> <span class=s>&#34;Book DouBan&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;ss&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>engine/search-google</span> <span class=nb>:wk</span> <span class=s>&#34;Google&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;sg&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>engine/search-github</span> <span class=nb>:wk</span> <span class=s>&#34;Github&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;sy&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>engine/search-youtube</span> <span class=nb>:wk</span> <span class=s>&#34;Youtube&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;sw&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>engine/search-wikipedia</span> <span class=nb>:wk</span> <span class=s>&#34;Wikipedia&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;sm&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>engine/search-moviedouban</span> <span class=nb>:wk</span> <span class=s>&#34;Movie DouBan&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;sz&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>engine/search-zhihu</span> <span class=nb>:wk</span> <span class=s>&#34;Zhihu&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;sr&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>rg</span> <span class=nb>:wk</span> <span class=s>&#34;rg&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;sl&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>consult-git-log-grep</span> <span class=nb>:wk</span> <span class=s>&#34;Git Log Grep&#34;</span><span class=p>))</span>
</span></span></code></pre></div><p><a href=https://github.com/xuchunyang/grab-mac-link.el target=_blank rel="noopener noreffer">xuchunyang/grab-mac-link.el: Grab link from Mac Apps and insert it into Emacs</a>. 很方便的在文件中增加当前浏览网页的链接，我使用 MacOS, 常用的是 Safari 浏览器。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>grab-mac-link</span>
</span></span><span class=line><span class=cl>  <span class=nb>:commands</span> <span class=nv>grab-mac-link-dwim</span>
</span></span><span class=line><span class=cl>  <span class=nb>:preface</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>defun</span> <span class=nv>my/link-grab</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>grab-mac-link-dwim</span> <span class=ss>&#39;safari</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span> <span class=p>(</span><span class=s>&#34;&lt;f8&gt;&#34;</span> <span class=o>.</span> <span class=nv>my/link-grab</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=elfeed class=headerLink><a href=#elfeed class=header-mark></a>Elfeed</h3><p><a href=https://github.com/skeeto/elfeed target=_blank rel="noopener noreffer">https://github.com/skeeto/elfeed</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>elfeed</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span> <span class=p>(</span><span class=s>&#34;C-c , r&#34;</span> <span class=o>.</span> <span class=nv>elfeed</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:preface</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>defun</span> <span class=nv>elfeed-display-buffer</span> <span class=p>(</span><span class=nv>buf</span> <span class=kp>&amp;optional</span> <span class=nv>act</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>pop-to-buffer</span> <span class=nv>buf</span> <span class=o>&#39;</span><span class=p>((</span><span class=nv>display-buffer-reuse-window</span> <span class=nv>display-buffer-in-side-window</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                         <span class=p>(</span><span class=nv>side</span> <span class=o>.</span> <span class=nv>bottom</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                         <span class=p>(</span><span class=nv>window-height</span> <span class=o>.</span> <span class=mf>0.8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                         <span class=p>(</span><span class=nv>reusable-frames</span> <span class=o>.</span> <span class=nv>visible</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                         <span class=p>(</span><span class=nf>window-parameters</span>
</span></span><span class=line><span class=cl>                          <span class=p>(</span><span class=nv>select</span> <span class=o>.</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                          <span class=p>(</span><span class=nv>quit</span> <span class=o>.</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                          <span class=p>(</span><span class=nv>popup</span> <span class=o>.</span> <span class=no>t</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>elfeed-show-entry-switch</span> <span class=nf>#&#39;</span><span class=nv>elfeed-display-buffer</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>my/comma-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;r&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>elfeed-summary</span> <span class=nb>:wk</span> <span class=s>&#34;Elfeed&#34;</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=elfeed-org class=headerLink><a href=#elfeed-org class=header-mark></a>elfeed-org</h4><p><a href=https://github.com/remyhonig/elfeed-org target=_blank rel="noopener noreffer">remyhonig/elfeed-org: Configure the Elfeed RSS reader with an Orgmode file</a> 通过 org 集中管理 elfeed 源。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>elfeed-org</span>
</span></span><span class=line><span class=cl>  <span class=nb>:after</span> <span class=nv>elfeed</span>
</span></span><span class=line><span class=cl>  <span class=nb>:init</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>rmh-elfeed-org-files</span> <span class=o>`</span><span class=p>(</span><span class=o>,</span><span class=p>(</span><span class=nf>concat</span> <span class=nv>my-galaxy</span> <span class=s>&#34;/rss/elfeed.org&#34;</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my/rss-source</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Open elfeed config file.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>find-file</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>rmh-elfeed-org-files</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>my/space-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;foe&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>my/rss-source</span> <span class=nb>:wk</span> <span class=s>&#34;Elfeed file&#34;</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=elfeed-summary class=headerLink><a href=#elfeed-summary class=header-mark></a>elfeed-summary</h4><p><a href=https://github.com/SqrtMinusOne/elfeed-summary target=_blank rel="noopener noreffer">SqrtMinusOne/elfeed-summary: Feed summary interface for elfeed</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>elfeed-summary</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span> <span class=p>(</span><span class=s>&#34;C-c , r&#34;</span> <span class=o>.</span> <span class=nv>elfeed-summary</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>elfeed-summary-other-window</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>elfeed-summary-settings</span>
</span></span><span class=line><span class=cl>        <span class=o>&#39;</span><span class=p>((</span><span class=nv>group</span> <span class=p>(</span><span class=nb>:title</span> <span class=o>.</span> <span class=s>&#34;科技&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                 <span class=p>(</span><span class=nb>:elements</span> <span class=p>(</span><span class=nv>query</span> <span class=o>.</span> <span class=p>(</span><span class=nb>and</span> <span class=nv>tec</span> <span class=p>(</span><span class=nv>not</span> <span class=nv>emacs</span><span class=p>)</span> <span class=p>(</span><span class=nv>not</span> <span class=nv>blogs</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>                            <span class=p>(</span><span class=nv>group</span> <span class=p>(</span><span class=nb>:title</span> <span class=o>.</span> <span class=s>&#34;Emacs&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                                   <span class=p>(</span><span class=nb>:elements</span> <span class=p>(</span><span class=nv>query</span> <span class=o>.</span> <span class=nv>emacs</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                                   <span class=p>(</span><span class=nb>:face</span> <span class=o>.</span> <span class=nv>org-level-1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                            <span class=p>(</span><span class=nv>group</span> <span class=p>(</span><span class=nb>:title</span> <span class=o>.</span> <span class=s>&#34;Blogs&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                                   <span class=p>(</span><span class=nb>:elements</span> <span class=p>(</span><span class=nv>query</span> <span class=o>.</span> <span class=nv>blogs</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nv>group</span> <span class=p>(</span><span class=nb>:title</span> <span class=o>.</span> <span class=s>&#34;News&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                 <span class=p>(</span><span class=nb>:elements</span> <span class=p>(</span><span class=nv>query</span> <span class=o>.</span> <span class=nv>news</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nv>group</span> <span class=p>(</span><span class=nb>:title</span> <span class=o>.</span> <span class=s>&#34;Books&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                 <span class=p>(</span><span class=nb>:elements</span> <span class=p>(</span><span class=nv>query</span> <span class=o>.</span> <span class=nv>book</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nv>group</span> <span class=p>(</span><span class=nb>:title</span> <span class=o>.</span> <span class=s>&#34;Finance&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                 <span class=p>(</span><span class=nb>:elements</span> <span class=p>(</span><span class=nv>query</span> <span class=o>.</span> <span class=nv>finance</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nv>group</span> <span class=p>(</span><span class=nb>:title</span> <span class=o>.</span> <span class=s>&#34;Youtube&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                 <span class=p>(</span><span class=nb>:elements</span> <span class=p>(</span><span class=nv>query</span> <span class=o>.</span> <span class=nv>video</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>advice-add</span> <span class=ss>&#39;elfeed-summary</span> <span class=nb>:after</span> <span class=ss>&#39;elfeed-summary-update</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>advice-add</span> <span class=ss>&#39;elfeed-summary</span> <span class=nb>:before</span> <span class=ss>&#39;elfeed-org</span><span class=p>))</span>
</span></span></code></pre></div><p><a href=https://github.com/karthink/elfeed-tube target=_blank rel="noopener noreffer">karthink/elfeed-tube: Youtube integration for Elfeed, the feed reader for Emacs</a> 不知道为什么不能更新 RSS. 暂时停用了。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;elfeed</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>require</span> <span class=ss>&#39;elfeed-tube</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>elfeed-tube-setup</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>define-key</span> <span class=nv>elfeed-show-mode-map</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;F&#34;</span><span class=p>)</span> <span class=ss>&#39;elfeed-tube-fetch</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>define-key</span> <span class=nv>elfeed-show-mode-map</span> <span class=p>[</span><span class=nv>remap</span> <span class=nv>save-buffer</span><span class=p>]</span> <span class=ss>&#39;elfeed-tube-save</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>define-key</span> <span class=nv>elfeed-search-mode-map</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;F&#34;</span><span class=p>)</span> <span class=ss>&#39;elfeed-tube-fetch</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>define-key</span> <span class=nv>elfeed-search-mode-map</span> <span class=p>[</span><span class=nv>remap</span> <span class=nv>save-buffer</span><span class=p>]</span> <span class=ss>&#39;elfeed-tube-save</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>require-package</span> <span class=ss>&#39;elfeed-tube-mpv</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;elfeed</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>require</span> <span class=ss>&#39;elfeed-tube-mpv</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>define-key</span> <span class=nv>elfeed-show-mode-map</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-c C-f&#34;</span><span class=p>)</span> <span class=ss>&#39;elfeed-tube-mpv-follow-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>define-key</span> <span class=nv>elfeed-show-mode-map</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-c C-w&#34;</span><span class=p>)</span> <span class=ss>&#39;elfeed-tube-mpv-where</span><span class=p>)))</span>
</span></span></code></pre></div><h3 id=reader class=headerLink><a href=#reader class=header-mark></a>Reader</h3><h4 id=pdf-tools class=headerLink><a href=#pdf-tools class=header-mark></a>pdf-tools</h4><p>升级 pdf-tools 后要重新生成 <code>epdfinfo</code> 文件，最好的方式就是重装 pdf-tools，以免有问题。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>pdf-tools</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>((</span><span class=nv>doc-view-mode</span> <span class=o>.</span> <span class=nv>pdf-tools-install</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>dirvish-setup</span> <span class=o>.</span> <span class=nv>pdf-tools-install</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>pdf-tools-enabled</span> <span class=o>.</span> <span class=nv>pdf-view-themed-minor-mode</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>pdf-view</span>
</span></span><span class=line><span class=cl>  <span class=nb>:mode</span> <span class=p>(</span><span class=s>&#34;\\.[pP][dD][fF]\\&#39;&#34;</span> <span class=o>.</span> <span class=nv>pdf-view-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:magic</span> <span class=p>(</span><span class=s>&#34;%PDF&#34;</span> <span class=o>.</span> <span class=nv>pdf-view-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>pdf-tools-install</span> <span class=no>t</span> <span class=no>nil</span> <span class=no>t</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>evil-declare-key</span> <span class=ss>&#39;normal</span> <span class=nv>pdf-view-mode-map</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;gh&#34;</span> <span class=ss>&#39;pdf-annot-add-highlight-markup-annotation</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;ga&#34;</span> <span class=ss>&#39;pdf-annot-add-text-annotation</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;gd&#34;</span> <span class=ss>&#39;pdf-annot-delete</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:init</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>pdf-view-display-size</span> <span class=ss>&#39;fit-width</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>pdf-view-use-unicode-ligther</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>pdf-view-use-scaling</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>pdf-view-use-imagemagick</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>pdf-annot-activate-created-annotations</span> <span class=no>nil</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>pdf-occur</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>pdf-view-mode</span> <span class=o>.</span> <span class=nv>pdf-occur-global-minor-mode</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>pdf-history</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>pdf-view-mode</span> <span class=o>.</span> <span class=nv>pdf-history-minor-mode</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>pdf-links</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>pdf-view-mode</span> <span class=o>.</span> <span class=nv>pdf-links-minor-mode</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my/get-file-name</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Copy pdf file name.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>kill-new</span> <span class=p>(</span><span class=nv>file-name-base</span> <span class=p>(</span><span class=nf>buffer-file-name</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>message</span> <span class=s>&#34;Copied %s&#34;</span> <span class=p>(</span><span class=nv>file-name-base</span> <span class=p>(</span><span class=nf>buffer-file-name</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>pdf-outline</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>((</span><span class=nv>pdf-view-mode</span> <span class=o>.</span> <span class=nv>pdf-outline-minor-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>pdf-outline-buffer-mode</span> <span class=o>.</span> <span class=nv>hide-mode-line-mode</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span> <span class=p>(</span><span class=nb>:map</span> <span class=nv>pdf-outline-buffer-mode-map</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=s>&#34;RET&#34;</span> <span class=o>.</span> <span class=nv>pdf-outline-follow-link-and-quit</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>pdf-annot</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>pdf-view-mode</span> <span class=o>.</span> <span class=nv>pdf-annot-minor-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span> <span class=p>(</span><span class=nb>:map</span> <span class=nv>pdf-annot-edit-contents-minor-mode-map</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=s>&#34;&lt;return&gt;&#34;</span> <span class=o>.</span> <span class=nv>pdf-annot-edit-contents-commit</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=s>&#34;&lt;S-return&gt;&#34;</span> <span class=o>.</span> <span class=nv>newline</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>pdf-sync</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>pdf-view-mode</span> <span class=o>.</span> <span class=nv>pdf-sync-minor-mode</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>pdf-cache</span>
</span></span><span class=line><span class=cl>  <span class=nb>:after</span> <span class=nv>pdf-view</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>define-pdf-cache-function</span> <span class=nv>pagelabels</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>pdf-misc</span>
</span></span><span class=line><span class=cl>  <span class=nb>:after</span> <span class=nv>pdf-view</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>pdf-misc-print-program-executable</span> <span class=s>&#34;/usr/bin/lp&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>defun</span> <span class=nv>mrb/pdf-misc-print-pages</span><span class=p>(</span><span class=nv>filename</span> <span class=nv>pages</span> <span class=kp>&amp;optional</span> <span class=nv>interactive-p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;Wrapper for `pdf-misc-print-document` to add page selection support.&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>interactive</span> <span class=p>(</span><span class=nf>list</span> <span class=p>(</span><span class=nv>pdf-view-buffer-file-name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                       <span class=p>(</span><span class=nf>read-string</span> <span class=s>&#34;Page range (empty for all pages): &#34;</span>
</span></span><span class=line><span class=cl>                                    <span class=p>(</span><span class=nf>number-to-string</span> <span class=p>(</span><span class=nv>pdf-view-current-page</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>                       <span class=no>t</span><span class=p>)</span> <span class=nv>pdf-view-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>pdf-misc-print-program-args</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nv>not</span> <span class=p>(</span><span class=nv>string-blank-p</span> <span class=nv>pages</span><span class=p>))</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nf>cons</span> <span class=p>(</span><span class=nf>concat</span> <span class=s>&#34;-P &#34;</span> <span class=nv>pages</span><span class=p>)</span> <span class=nv>pdf-misc-print-program-args</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=nv>pdf-misc-print-program-args</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>pdf-misc-print-document</span> <span class=nv>filename</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span> <span class=p>(</span><span class=nb>:map</span> <span class=nv>pdf-view-mode-map</span>
</span></span><span class=line><span class=cl>              <span class=p>([</span><span class=nv>remap</span> <span class=nv>pdf-misc-print-document</span><span class=p>]</span> <span class=o>.</span> <span class=nv>mrb/pdf-misc-print-pages</span><span class=p>)))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my/pdf-extract-highlight</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Extract highlight to plain text.
</span></span></span><span class=line><span class=cl><span class=s>When it finised, it will jump to note file.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let*</span> <span class=p>((</span><span class=nv>pdf-filename</span> <span class=p>(</span><span class=nf>buffer-name</span><span class=p>))</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>txt-filename</span> <span class=p>(</span><span class=nf>make-temp-name</span> <span class=s>&#34;/tmp/annot-&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>org-file</span> <span class=p>(</span><span class=nv>read-file-name</span> <span class=s>&#34;Save extracted highlights to org file: &#34;</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;roam/ref/&#34;</span> <span class=nv>my-galaxy</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>org-heading</span> <span class=s>&#34;Highlights&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>process</span> <span class=p>(</span><span class=nv>start-process-shell-command</span>
</span></span><span class=line><span class=cl>                   <span class=s>&#34;pdfannots&#34;</span>
</span></span><span class=line><span class=cl>                   <span class=no>nil</span>
</span></span><span class=line><span class=cl>                   <span class=p>(</span><span class=nf>format</span> <span class=s>&#34;python3 ~/pdfannots/pdfannots.py \&#34;%s\&#34; -o \&#34;%s\&#34;&#34;</span>
</span></span><span class=line><span class=cl>                           <span class=nv>pdf-filename</span> <span class=nv>txt-filename</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>set-process-sentinel</span>
</span></span><span class=line><span class=cl>     <span class=nv>process</span>
</span></span><span class=line><span class=cl>     <span class=p>(</span><span class=nb>lambda</span> <span class=p>(</span><span class=nv>process</span> <span class=nv>_event</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nf>eq</span> <span class=p>(</span><span class=nf>process-status</span> <span class=nv>process</span><span class=p>)</span> <span class=ss>&#39;exit</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>find-file</span> <span class=nv>org-file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nf>goto-char</span> <span class=p>(</span><span class=nf>point-min</span><span class=p>))</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nf>re-search-forward</span> <span class=p>(</span><span class=nf>format</span> <span class=s>&#34;^* %s&#34;</span> <span class=nv>org-heading</span><span class=p>)</span> <span class=no>nil</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=p>(</span><span class=nb>progn</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nf>end-of-line</span><span class=p>)</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nf>insert</span> <span class=s>&#34;\n&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nf>insert-file-contents</span> <span class=nv>txt-filename</span><span class=p>)</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nf>delete-file</span> <span class=nv>txt-filename</span><span class=p>)</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nf>message</span> <span class=s>&#34;PDF highlights added to org heading &#39;%s&#39;&#34;</span> <span class=nv>org-heading</span><span class=p>))</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nf>message</span> <span class=s>&#34;Org heading &#39;%s&#39; not found&#34;</span> <span class=nv>org-heading</span><span class=p>)))))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>my/comma-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;h&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>my/pdf-extract-highlight</span> <span class=nb>:wk</span> <span class=s>&#34;Extract highlight&#34;</span><span class=p>))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my/dired-pdf-to-png</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let*</span> <span class=p>((</span><span class=nv>filename</span> <span class=p>(</span><span class=nv>dired-get-filename</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nf>string-match</span> <span class=s>&#34;\.pdf&#34;</span> <span class=nv>filename</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nb>let*</span> <span class=p>((</span><span class=nv>pdf-base-name</span> <span class=p>(</span><span class=nv>file-name-sans-extension</span> <span class=p>(</span><span class=nf>file-name-nondirectory</span> <span class=nv>filename</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nv>png</span> <span class=p>(</span><span class=nf>concat</span> <span class=nv>pdf-base-name</span> <span class=s>&#34;.png&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nv>pdf-info</span> <span class=p>(</span><span class=nv>shell-command-to-string</span> <span class=p>(</span><span class=nf>format</span> <span class=s>&#34;pdfinfo %s | grep Pages | awk &#39;{print $2}&#39;&#34;</span> <span class=nv>filename</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nv>pdf-pages</span> <span class=p>(</span><span class=nf>string-to-number</span> <span class=nv>pdf-info</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nf>file-exists-p</span> <span class=nv>png</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nf>delete-file</span> <span class=nv>png</span><span class=p>))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nf>=</span> <span class=nv>pdf-pages</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nv>start-process-shell-command</span>
</span></span><span class=line><span class=cl>               <span class=s>&#34;pdf-to-png&#34;</span>
</span></span><span class=line><span class=cl>               <span class=no>nil</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nf>format</span> <span class=s>&#34;pdftoppm -singlefile -r 600 %s %s -png&#34;</span> <span class=nv>filename</span> <span class=nv>pdf-base-name</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nv>start-process-shell-command</span>
</span></span><span class=line><span class=cl>             <span class=s>&#34;pdf-to-png&#34;</span>
</span></span><span class=line><span class=cl>             <span class=no>nil</span>
</span></span><span class=line><span class=cl>             <span class=p>(</span><span class=nf>format</span> <span class=s>&#34;pdftoppm -r 600 %s %s -png&#34;</span> <span class=nv>filename</span> <span class=nv>pdf-base-name</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nf>message</span> <span class=s>&#34;Current file is not a PDF file.&#34;</span><span class=p>))))</span>
</span></span></code></pre></div><h4 id=nov class=headerLink><a href=#nov class=header-mark></a>Nov</h4><p>Nov 用于阅读 epub 文件。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>nov</span>
</span></span><span class=line><span class=cl>  <span class=nb>:mode</span> <span class=p>(</span><span class=s>&#34;.epub&#34;</span> <span class=o>.</span> <span class=nv>nov-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>nov-unzip-program</span> <span class=p>(</span><span class=nv>executable-find</span> <span class=s>&#34;bsdtar&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nv>nov-unzip-args</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;-xC&#34;</span> <span class=nv>directory</span> <span class=s>&#34;-f&#34;</span> <span class=nv>filename</span><span class=p>)))</span>
</span></span></code></pre></div><h4 id=calibredb class=headerLink><a href=#calibredb class=header-mark></a>Calibredb</h4><p>Calibre 用于管理书籍，Calibredb 可以在 Emacs 中管理而不需要打开 Calibre 软件。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=c1>;; Export catalog need to use argument: set entry type to mixed, default is book.</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>calibredb</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span> <span class=p>((</span><span class=s>&#34;&lt;f1&gt;&#34;</span> <span class=o>.</span> <span class=nv>calibredb</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=nb>:map</span> <span class=nv>calibredb-search-mode-map</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=s>&#34;C-c l&#34;</span> <span class=o>.</span> <span class=nv>calibredb-copy-as-org-link</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>calibredb-root-dir</span> <span class=s>&#34;~/Nextcloud/L.Calibre/&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>calibredb-db-dir</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;metadata.db&#34;</span> <span class=nv>calibredb-root-dir</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>calibredb-add-delete-original-file</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>calibredb-size-show</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>calibredb-format-character-icons</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>calibredb-ref-default-bibliography</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;calibre.bib&#34;</span> <span class=nv>calibredb-root-dir</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>evil-set-initial-state</span> <span class=ss>&#39;calibredb-search-mode</span> <span class=ss>&#39;emacs</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=vterm class=headerLink><a href=#vterm class=header-mark></a>vterm</h3><p>使用<a href=https://github.com/akermu/emacs-libvterm target=_blank rel="noopener noreffer">akermu/emacs-libvterm: Emacs libvterm integration</a> 替代了内置的 eshell.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>vterm</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span> <span class=p>(</span><span class=s>&#34;C-c , v&#34;</span> <span class=o>.</span> <span class=nv>toggle-vterm</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>vterm-kill-buffer-on-exit</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>vterm-max-scrollback</span> <span class=mi>5000</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;display-buffer-alist</span>
</span></span><span class=line><span class=cl>               <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;\\*vterm\\*&#34;</span>
</span></span><span class=line><span class=cl>                 <span class=p>(</span><span class=nv>display-buffer-in-side-window</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                 <span class=p>(</span><span class=nv>window-height</span> <span class=o>.</span> <span class=mf>0.35</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                 <span class=p>(</span><span class=nv>side</span> <span class=o>.</span> <span class=nv>bottom</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                 <span class=p>(</span><span class=nv>slot</span> <span class=o>.</span> <span class=mi>-1</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>defun</span> <span class=nv>toggle-vterm</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;Toggle vterm on or off.&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nf>get-buffer-window</span> <span class=s>&#34;*vterm*&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>delete-window</span> <span class=p>(</span><span class=nf>get-buffer-window</span> <span class=s>&#34;*vterm*&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>progn</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>vterm</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>evil-insert</span> <span class=mi>1</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>my/comma-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;v&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>toggle-vterm</span> <span class=nb>:wk</span> <span class=s>&#34;vterm&#34;</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=mail class=headerLink><a href=#mail class=header-mark></a>Mail</h3><h4 id=personal-info class=headerLink><a href=#personal-info class=header-mark></a>Personal Info</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nf>user-full-name</span> <span class=s>&#34;Duan Ning&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>user-mail-address</span> <span class=s>&#34;duan_n@outlook.com&#34;</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=message class=headerLink><a href=#message class=header-mark></a>Message</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>message-sendmail-envelope-from</span> <span class=ss>&#39;header</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>message-kill-buffer-query</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>message-sendmail-extra-arguments</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;-a&#34;</span> <span class=s>&#34;outlook&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>message-send-mail-function</span> <span class=ss>&#39;sendmail-send-it</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=mu4e class=headerLink><a href=#mu4e class=header-mark></a>Mu4e</h4><p>在 MacOS 上配置 mu 和 mu4e 的教程见：<a href=https://macowners.club/posts/email-emacs-mu4e-macos/ target=_blank rel="noopener noreffer">Email setup in Emacs with Mu4e on macOS | macOS & (open-source) Software</a>.</p><p>上述的教程写的很详细，按照步骤进行一定会成功。</p><p>配置 Emacs 时经常要多次重启，这有可能导致 mu 报以下的错误：</p><blockquote><p>error in process sentinel: mu4e&ndash;server-sentinel: Mu server process ended with exit code 1
error in process sentinel: Mu server process ended with exit code 1</p></blockquote><p>这时需要在终端下执行以下的命令来恢复 mu 的状态。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>mu init --maildir<span class=o>=</span>~/.maildir --my-address<span class=o>=</span>your_email_account <span class=o>&amp;&amp;</span> mu index
</span></span></code></pre></div><p>启动 Emacs 时直接启动 mu4e 会导致 Emacs 启动速度变的很慢，当 Emacs 处于 idle 状态时在后台启动。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;load-path</span> <span class=s>&#34;/opt/homebrew/opt/mu/share/emacs/site-lisp/mu/mu4e&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>unless</span> <span class=p>(</span><span class=nf>fboundp</span> <span class=ss>&#39;mu4e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>autoload</span> <span class=nf>#&#39;</span><span class=nv>mu4e</span> <span class=s>&#34;mu4e&#34;</span> <span class=no>nil</span> <span class=no>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>run-with-idle-timer</span> <span class=mi>5</span> <span class=no>nil</span> <span class=nf>#&#39;</span><span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span> <span class=p>(</span><span class=nv>mu4e</span> <span class=ss>&#39;background</span><span class=p>)))</span>
</span></span></code></pre></div><p>这里有个 <a href=https://github.com/rougier/mu4e-dashboard target=_blank rel="noopener noreffer">rougier/mu4e-dashboard: A dashboard for mu4e (mu for emacs)</a> 看着很好看，但是不实用，不要再尝试。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;mu4e</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>mail-user-agent</span> <span class=ss>&#39;mu4e-user-agent</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>mu4e-mu-binary</span> <span class=p>(</span><span class=nv>executable-find</span> <span class=s>&#34;mu&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>mu4e-update-interval</span> <span class=p>(</span><span class=nf>*</span> <span class=mi>15</span> <span class=mi>60</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>mu4e-attachment-dir</span> <span class=s>&#34;~/Downloads/&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>mu4e-get-mail-command</span> <span class=p>(</span><span class=nf>concat</span> <span class=p>(</span><span class=nv>executable-find</span> <span class=s>&#34;mbsync&#34;</span><span class=p>)</span> <span class=s>&#34; -a&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>mu4e-index-update-in-background</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>mu4e-index-update-error-warning</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>mu4e-index-update-error-warning</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>mu4e-index-cleanup</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>mu4e-view-show-images</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>mu4e-view-image-max-width</span> <span class=mi>800</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>mu4e-view-show-addresses</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>mu4e-confirm-quit</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>mu4e-context-policy</span> <span class=ss>&#39;pick-first</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;mu4e</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>setq</span> <span class=nv>mu4e-sent-folder</span>   <span class=s>&#34;/outlook/Sent&#34;</span>
</span></span><span class=line><span class=cl>          <span class=nv>mu4e-drafts-folder</span> <span class=s>&#34;/outlook/Drafts&#34;</span>
</span></span><span class=line><span class=cl>          <span class=nv>mu4e-trash-folder</span>  <span class=s>&#34;/outlook/Deleted&#34;</span>
</span></span><span class=line><span class=cl>          <span class=nv>mu4e-refile-folder</span>  <span class=s>&#34;/outlook/Archive&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>mu4e-view-prefer-html</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>mu4e-html2text-command</span> <span class=ss>&#39;mu4e-shr2text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>mu4e-main-hide-personal-addresses</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>mu4e-headers-precise-alignment</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>mu4e-headers-include-related</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>mu4e-headers-auto-update</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>mu4e-headers-date-format</span> <span class=s>&#34;%d/%m/%y&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>mu4e-headers-time-format</span> <span class=s>&#34;%H:%M&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>mu4e-headers-fields</span> <span class=o>&#39;</span><span class=p>((</span><span class=nb>:flags</span> <span class=o>.</span> <span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                              <span class=p>(</span><span class=nb>:human-date</span> <span class=o>.</span> <span class=mi>9</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                              <span class=p>(</span><span class=nb>:subject</span> <span class=o>.</span> <span class=mi>90</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                              <span class=p>(</span><span class=nb>:from-or-to</span> <span class=o>.</span> <span class=mi>40</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                              <span class=p>(</span><span class=nb>:tags</span> <span class=o>.</span> <span class=mi>20</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>mu4e-bookmarks</span> <span class=o>&#39;</span><span class=p>((</span><span class=s>&#34;flag:unread AND NOT flag:trashed&#34;</span> <span class=s>&#34;Unread messages&#34;</span> <span class=sc>?u</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                         <span class=p>(</span><span class=s>&#34;date:today..now&#34;</span> <span class=s>&#34;Today&#39;s messages&#34;</span> <span class=sc>?t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                         <span class=p>(</span><span class=s>&#34;date:7d..now&#34;</span> <span class=s>&#34;Last 7 days&#34;</span> <span class=sc>?w</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                         <span class=p>(</span><span class=s>&#34;date:1d..now AND NOT list:emacs-orgmode.gnu.org&#34;</span> <span class=s>&#34;Last 1 days&#34;</span> <span class=sc>?o</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                         <span class=p>(</span><span class=s>&#34;date:1d..now AND list:emacs-orgmode.gnu.org&#34;</span> <span class=s>&#34;Last 1 days (org mode)&#34;</span> <span class=sc>?m</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                         <span class=p>(</span><span class=s>&#34;maildir:/drafts&#34;</span> <span class=s>&#34;drafts&#34;</span> <span class=sc>?d</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                         <span class=p>(</span><span class=s>&#34;flag:flagged AND NOT flag:trashed&#34;</span> <span class=s>&#34;flagged&#34;</span> <span class=sc>?f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                         <span class=p>(</span><span class=s>&#34;mime:image/*&#34;</span> <span class=s>&#34;Messages with images&#34;</span> <span class=sc>?p</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>mu4e-compose-reply-ignore-address</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;no-?reply&#34;</span> <span class=s>&#34;duan_n@outlook.com&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>mu4e-compose-format-flowed</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>mu4e-compose-signature-auto-include</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>mu4e-compose-dont-reply-to-self</span> <span class=no>t</span><span class=p>))</span>
</span></span></code></pre></div><p>若要把 mail 和 org 笔记相结合，可以使用 <code>org-store-link</code> 和 <code>org-insert-link</code> 给合使用，在 org 文件中插入 mail 的链接。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;mu4e</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>define-key</span> <span class=nv>mu4e-headers-mode-map</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-c l&#34;</span><span class=p>)</span> <span class=ss>&#39;org-store-link</span><span class=p>))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>my/comma-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;e&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>mu4e</span> <span class=nb>:wk</span> <span class=s>&#34;MAIL&#34;</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=mu4e-actions class=headerLink><a href=#mu4e-actions class=header-mark></a>mu4e-actions</h4><p>Save mail to pdf as backup.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>extra-email-to-pdf</span> <span class=p>(</span><span class=nv>msg</span> <span class=kp>&amp;optional</span> <span class=nv>args</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Pdf temp file MSG to a new name with ARGS ignored.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let*</span> <span class=p>((</span><span class=nv>async-shell-command-display-buffer</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>temp</span> <span class=p>(</span><span class=nf>format-time-string</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;%Y-%m-%dT%H:%M.pdf&#34;</span> <span class=nv>mail-source-directory</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>name</span> <span class=p>(</span><span class=nf>read-string</span> <span class=s>&#34;File name: &#34;</span> <span class=nv>temp</span><span class=p>))</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>html</span> <span class=p>(</span><span class=nv>replace-regexp-in-string</span> <span class=p>(</span><span class=nf>regexp-quote</span> <span class=s>&#34;file://&#34;</span><span class=p>)</span> <span class=s>&#34;&#34;</span> <span class=nv>msg</span> <span class=no>t</span> <span class=no>t</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>if</span> <span class=nv>args</span> <span class=p>(</span><span class=nf>message</span> <span class=s>&#34;Additional optional argument was ignored when saving to PDF.&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>async-shell-command</span> <span class=p>(</span><span class=nf>concat</span> <span class=s>&#34;pandoc &#34;</span> <span class=nv>html</span> <span class=s>&#34; -o &#34;</span> <span class=nv>name</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>extra-print-email-to-pdf</span> <span class=p>(</span><span class=nv>msg</span> <span class=kp>&amp;optional</span> <span class=nv>skip-headers</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Save current MSG as a pdf if it includes an HTML-part.
</span></span></span><span class=line><span class=cl><span class=s>If SKIP-HEADERS is set, do not show include message headers.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let*</span> <span class=p>((</span><span class=nv>browse-url-browser-function</span>  <span class=ss>&#39;extra-email-to-pdf</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>mu4e-action-view-in-browser</span> <span class=nv>msg</span> <span class=nv>skip-headers</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;mu4e</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;mu4e-view-actions</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;print to PDF&#34;</span>  <span class=o>.</span> <span class=nv>extra-print-email-to-pdf</span><span class=p>)))</span>
</span></span></code></pre></div><p>Save mail to html as backup.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>extra-move-temp-email-location</span> <span class=p>(</span><span class=nv>msg</span> <span class=kp>&amp;optional</span> <span class=nv>args</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Move and rename temp file MSG to a new location with ARGS ignored.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let*</span> <span class=p>((</span><span class=nv>temp</span> <span class=p>(</span><span class=nf>format-time-string</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;html/%Y-%m-%dT%H:%M.html&#34;</span> <span class=nv>mail-source-directory</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>name</span> <span class=p>(</span><span class=nf>read-string</span> <span class=s>&#34;File name: &#34;</span> <span class=nv>temp</span><span class=p>))</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>file</span> <span class=p>(</span><span class=nv>replace-regexp-in-string</span> <span class=p>(</span><span class=nf>regexp-quote</span> <span class=s>&#34;file://&#34;</span><span class=p>)</span> <span class=s>&#34;&#34;</span> <span class=nv>msg</span> <span class=no>t</span> <span class=no>t</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>if</span> <span class=nv>args</span> <span class=p>(</span><span class=nf>message</span> <span class=s>&#34;Additional optional argument was ignored when saving to HTML.&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>rename-file</span> <span class=nv>file</span> <span class=nv>name</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>extra-save-email-html</span> <span class=p>(</span><span class=nv>msg</span> <span class=kp>&amp;optional</span> <span class=nv>skip-headers</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Save current MSG HTML-part.
</span></span></span><span class=line><span class=cl><span class=s>If SKIP-HEADERS is set, do not show include message headers.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let*</span> <span class=p>((</span><span class=nv>extra-temp-email-dir</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;html&#34;</span> <span class=nv>mail-source-directory</span><span class=p>))</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>browse-url-browser-function</span>  <span class=ss>&#39;extra-move-temp-email-location</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>mu4e-action-view-in-browser</span> <span class=nv>msg</span> <span class=nv>skip-headers</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;mu4e</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;mu4e-view-actions</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;download as html&#34;</span>  <span class=o>.</span> <span class=nv>extra-save-email-html</span><span class=p>)))</span>
</span></span></code></pre></div><h4 id=icons class=headerLink><a href=#icons class=header-mark></a>Icons</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;all-the-icons</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>display-time-mail-icon</span> <span class=o>`</span><span class=p>(</span><span class=o>,</span><span class=p>(</span><span class=nf>propertize</span>
</span></span><span class=line><span class=cl>                                   <span class=p>(</span><span class=nv>all-the-icons-material</span> <span class=s>&#34;mail&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                                   <span class=ss>&#39;face</span> <span class=o>`</span><span class=p>(</span><span class=nb>:family</span> <span class=o>,</span><span class=p>(</span><span class=nv>all-the-icons-material-family</span><span class=p>))))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;mu4e</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>mu4e-use-fancy-chars</span> <span class=no>nil</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=c1>;; (require-package &#39;mu4e-marker-icons)</span>
</span></span><span class=line><span class=cl><span class=c1>;; (add-hook &#39;mu4e-headers-mode-hook &#39;mu4e-marker-icons-mode)</span>
</span></span></code></pre></div><h4 id=send-mail class=headerLink><a href=#send-mail class=header-mark></a>Send mail</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;mu4e-main-mode-hook</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nb>progn</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nb>require</span> <span class=ss>&#39;smtpmail-async</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nb>setq</span> <span class=nv>send-mail-function</span> <span class=ss>&#39;async-sendmail-send-it</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nb>setq</span> <span class=nv>message-send-mail-function</span> <span class=ss>&#39;async-smtpmail-send-it</span><span class=p>))))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>sendmail-program</span> <span class=p>(</span><span class=nv>executable-find</span> <span class=s>&#34;msmtp&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>mail-specify-envelope-from</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>mail-envelope-from</span> <span class=ss>&#39;header</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=report class=headerLink><a href=#report class=header-mark></a>Report</h3><p>我使用 <a href=#calibredb rel>Calibredb</a> 管理书籍，使用 org-roam 下的 books 文件夹管理读书笔记内容。凡是读书必建立对应的笔记内容，在笔记内容中会使用 org-clock 的功能记录读书的时长。</p><p>读书笔记通过 org-roam-capture 中的 books 一项创建。</p><p>然后在读书记录笔记中可以通过 org report 功能生成一年的读书记录。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>#+BEGIN: clocktable :scope my/reading-list :maxlevel 9 :emphasize t :fileskip0 t :hidefiles t :block 2023
</span></span><span class=line><span class=cl>#+END:
</span></span></code></pre></div><p>clocktable 中的 scope 可以是自定义的函数，下面的函数将 books 下的所有读书笔记纳入统计范围。生成的表格中包括了书名及阅读本书所花的时间。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=c1>;; Get reading list from books directory for org-clock report.</span>
</span></span><span class=line><span class=cl><span class=c1>;; The org-clock report scope can be a function.</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my/reading-list</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Get reading list.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let</span> <span class=p>(</span><span class=nv>reading-list</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>append</span> <span class=nv>reading-list</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nv>file-expand-wildcards</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;roam/books/*.org&#34;</span> <span class=nv>my-galaxy</span><span class=p>)))))</span>
</span></span></code></pre></div><h3 id=achive class=headerLink><a href=#achive class=header-mark></a>Achive</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>achive</span>
</span></span><span class=line><span class=cl>  <span class=nb>:commands</span> <span class=nv>achive</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>achive-language</span> <span class=ss>&#39;zh</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>achive-cache-path</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;.achive&#34;</span> <span class=nv>no-littering-var-directory</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>my/comma-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;a&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>achive</span> <span class=nb>:wk</span> <span class=s>&#34;A-share&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;evil-collection</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>evil-collection-define-key</span> <span class=ss>&#39;normal</span> <span class=ss>&#39;achive-visual-mode-map</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;q&#34;</span> <span class=ss>&#39;quit-window</span><span class=p>))</span>
</span></span></code></pre></div><h2 id=easy-use-code-snippets class=headerLink><a href=#easy-use-code-snippets class=header-mark></a>Easy use, Code snippets</h2><h3 id=open-app-within-emacs class=headerLink><a href=#open-app-within-emacs class=header-mark></a>Open APP within Emacs</h3><p>该配置来源：<a href=https://emacs-china.org/t/emacs-mini-buffer-app-macos-only/23153 target=_blank rel="noopener noreffer">[技巧分享] 在 Emacs mini buffer 中选择并打开其他 App【macOS only】 - Emacs-general - Emacs China</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>mac-launchpad/string-ends-with</span> <span class=p>(</span><span class=nv>s</span> <span class=nv>ending</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Return non-nil if string S ends with ENDING.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>cond</span> <span class=p>((</span><span class=nf>&gt;=</span> <span class=p>(</span><span class=nf>length</span> <span class=nv>s</span><span class=p>)</span> <span class=p>(</span><span class=nf>length</span> <span class=nv>ending</span><span class=p>))</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>elength</span> <span class=p>(</span><span class=nf>length</span> <span class=nv>ending</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>string=</span> <span class=p>(</span><span class=nf>substring</span> <span class=nv>s</span> <span class=p>(</span><span class=nf>-</span> <span class=mi>0</span> <span class=nv>elength</span><span class=p>))</span> <span class=nv>ending</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=no>t</span> <span class=no>nil</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>mac-launchpad/find-mac-apps</span> <span class=p>(</span><span class=nv>folder</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let*</span> <span class=p>((</span><span class=nv>files</span> <span class=p>(</span><span class=nf>directory-files</span> <span class=nv>folder</span><span class=p>))</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>without-dots</span> <span class=p>(</span><span class=nv>cl-delete-if</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>(</span><span class=nv>f</span><span class=p>)</span> <span class=p>(</span><span class=nb>or</span> <span class=p>(</span><span class=nv>string=</span> <span class=s>&#34;.&#34;</span> <span class=nv>f</span><span class=p>)</span> <span class=p>(</span><span class=nv>string=</span> <span class=s>&#34;..&#34;</span> <span class=nv>f</span><span class=p>)))</span> <span class=nv>files</span><span class=p>))</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>all-files</span> <span class=p>(</span><span class=nf>mapcar</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>(</span><span class=nv>f</span><span class=p>)</span> <span class=p>(</span><span class=nf>file-name-as-directory</span> <span class=p>(</span><span class=nf>concat</span> <span class=p>(</span><span class=nf>file-name-as-directory</span> <span class=nv>folder</span><span class=p>)</span> <span class=nv>f</span><span class=p>)))</span> <span class=nv>without-dots</span><span class=p>))</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>result</span> <span class=p>(</span><span class=nv>cl-delete-if-not</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>(</span><span class=nv>s</span><span class=p>)</span> <span class=p>(</span><span class=nv>mac-launchpad/string-ends-with</span> <span class=nv>s</span> <span class=s>&#34;.app/&#34;</span><span class=p>))</span> <span class=nv>all-files</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=nv>result</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>mac-launchpad</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let*</span> <span class=p>((</span><span class=nv>apps</span> <span class=p>(</span><span class=nv>mac-launchpad/find-mac-apps</span> <span class=s>&#34;/Applications&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>to-launch</span> <span class=p>(</span><span class=nf>completing-read</span> <span class=s>&#34;launch: &#34;</span> <span class=nv>apps</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>shell-command</span> <span class=p>(</span><span class=nf>format</span> <span class=s>&#34;defaults read \&#34;%s\&#34;Contents/Info.plist CFBundleIdentifier | xargs open -b&#34;</span> <span class=nv>to-launch</span><span class=p>))))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>my/comma-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;j&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>mac-launchpad</span> <span class=nb>:wk</span> <span class=s>&#34;Jump to App&#34;</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=open-file-with-system-file-manager class=headerLink><a href=#open-file-with-system-file-manager class=header-mark></a>Open file with system file manager</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>xah-show-in-desktop</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Show current file in desktop.
</span></span></span><span class=line><span class=cl><span class=s>This command can be called when in a file buffer or in </span><span class=ss>`dired&#39;</span><span class=s>.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>$path</span> <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nf>buffer-file-name</span><span class=p>)</span> <span class=p>(</span><span class=nf>buffer-file-name</span><span class=p>)</span> <span class=nv>default-directory</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>cond</span>
</span></span><span class=line><span class=cl>     <span class=p>((</span><span class=nf>string-equal</span> <span class=nv>system-type</span> <span class=s>&#34;windows-nt&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>shell-command</span>
</span></span><span class=line><span class=cl>       <span class=p>(</span><span class=nf>format</span> <span class=s>&#34;PowerShell -Command Start-Process Explorer -FilePath %s&#34;</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nv>shell-quote-argument</span> <span class=nv>default-directory</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>     <span class=p>((</span><span class=nf>string-equal</span> <span class=nv>system-type</span> <span class=s>&#34;darwin&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nf>eq</span> <span class=nv>major-mode</span> <span class=ss>&#39;dired-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>$files</span> <span class=p>(</span><span class=nv>dired-get-marked-files</span> <span class=p>)))</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nf>eq</span> <span class=p>(</span><span class=nf>length</span> <span class=nv>$files</span><span class=p>)</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=nv>shell-command</span> <span class=p>(</span><span class=nf>concat</span> <span class=s>&#34;open &#34;</span> <span class=p>(</span><span class=nv>shell-quote-argument</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=nv>default-directory</span> <span class=p>))))</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nv>shell-command</span> <span class=p>(</span><span class=nf>concat</span> <span class=s>&#34;open -R &#34;</span> <span class=p>(</span><span class=nv>shell-quote-argument</span> <span class=p>(</span><span class=nf>car</span> <span class=p>(</span><span class=nv>dired-get-marked-files</span> <span class=p>)))))))</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>shell-command</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nf>concat</span> <span class=s>&#34;open -R &#34;</span> <span class=p>(</span><span class=nv>shell-quote-argument</span> <span class=nv>$path</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>     <span class=p>((</span><span class=nf>string-equal</span> <span class=nv>system-type</span> <span class=s>&#34;gnu/linux&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>process-connection-type</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nv>openFileProgram</span> <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nf>file-exists-p</span> <span class=s>&#34;/usr/bin/gvfs-open&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                                 <span class=s>&#34;/usr/bin/gvfs-open&#34;</span>
</span></span><span class=line><span class=cl>                               <span class=s>&#34;/usr/bin/xdg-open&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nf>start-process</span> <span class=s>&#34;&#34;</span> <span class=no>nil</span> <span class=nv>openFileProgram</span> <span class=p>(</span><span class=nv>shell-quote-argument</span> <span class=nv>$path</span><span class=p>)))))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>my/space-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;fd&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>xah-show-in-desktop</span> <span class=nb>:wk</span> <span class=s>&#34;Open in Finder&#34;</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=remove-link class=headerLink><a href=#remove-link class=header-mark></a>Remove link</h3><p>下面的配置来源：<a href=https://github.com/jeremyf/dotemacs/blob/main/emacs.d/jf-org-mode.el target=_blank rel="noopener noreffer">dotemacs/jf-org-mode.el at main · jeremyf/dotemacs</a>. 作用是移除 org 文件中的链接，仅保留链接的描述内容。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>jf/org-link-remove-link</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Remove the link part of an </span><span class=ss>`org-mode&#39;</span><span class=s> link at point and keep only the description.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>elem</span> <span class=p>(</span><span class=nv>org-element-context</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nf>eq</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>elem</span><span class=p>)</span> <span class=ss>&#39;link</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>let*</span> <span class=p>((</span><span class=nv>content-begin</span> <span class=p>(</span><span class=nv>org-element-property</span> <span class=nb>:contents-begin</span> <span class=nv>elem</span><span class=p>))</span>
</span></span><span class=line><span class=cl>             <span class=p>(</span><span class=nv>content-end</span>  <span class=p>(</span><span class=nv>org-element-property</span> <span class=nb>:contents-end</span> <span class=nv>elem</span><span class=p>))</span>
</span></span><span class=line><span class=cl>             <span class=p>(</span><span class=nv>link-begin</span> <span class=p>(</span><span class=nv>org-element-property</span> <span class=nb>:begin</span> <span class=nv>elem</span><span class=p>))</span>
</span></span><span class=line><span class=cl>             <span class=p>(</span><span class=nv>link-end</span> <span class=p>(</span><span class=nv>org-element-property</span> <span class=nb>:end</span> <span class=nv>elem</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nb>and</span> <span class=nv>content-begin</span> <span class=nv>content-end</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>content</span> <span class=p>(</span><span class=nf>buffer-substring-no-properties</span> <span class=nv>content-begin</span> <span class=nv>content-end</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nf>delete-region</span> <span class=nv>link-begin</span> <span class=nv>link-end</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nf>insert</span> <span class=nv>content</span><span class=p>)))))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;evil</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>evil-declare-key</span> <span class=ss>&#39;normal</span> <span class=ss>&#39;global</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;gX&#34;</span> <span class=ss>&#39;jf/org-link-remove-link</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=add-timestamps-to-youtube-links class=headerLink><a href=#add-timestamps-to-youtube-links class=header-mark></a>Add timestamps to youtube links</h3><p>此配置来源：<a href=https://mbork.pl/2022-10-10_Adding_timestamps_to_youtube_links target=_blank rel="noopener noreffer">Marcin Borkowski: 2022-10-10 Adding timestamps to youtube links</a>.</p><p>这个函数的作用是在 youtube 链接中增加时间，这样可以进行视频内容的精准跳转，当你看了一部份视频内容时记录时间等后期接着看。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>yt-set-time</span> <span class=p>(</span><span class=nv>time</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Set TIME in the YouTube link at point.)
</span></span></span><span class=line><span class=cl><span class=s>  TIME is number of seconds if called from Lisp, and a string if
</span></span></span><span class=line><span class=cl><span class=s>  called interactively.
</span></span></span><span class=line><span class=cl><span class=s>  Supported formats:
</span></span></span><span class=line><span class=cl><span class=s>  - seconds
</span></span></span><span class=line><span class=cl><span class=s>  - minutes:seconds
</span></span></span><span class=line><span class=cl><span class=s>  - number of seconds with the \&#34;s\&#34; suffix.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span> <span class=p>(</span><span class=nf>list</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=nb>if</span> <span class=nv>current-prefix-arg</span>
</span></span><span class=line><span class=cl>                    <span class=p>(</span><span class=nf>prefix-numeric-value</span> <span class=nv>current-prefix-arg</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                  <span class=p>(</span><span class=nf>read-string</span> <span class=s>&#34;Time: &#34;</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>url</span> <span class=p>(</span><span class=nv>thing-at-point-url-at-point</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nb>and</span> <span class=nv>url</span>
</span></span><span class=line><span class=cl>             <span class=p>(</span><span class=nf>string-match</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nf>format</span> <span class=s>&#34;^%s&#34;</span>
</span></span><span class=line><span class=cl>                      <span class=p>(</span><span class=nv>regexp-opt</span>
</span></span><span class=line><span class=cl>                       <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;https://www.youtube.com/&#34;</span>
</span></span><span class=line><span class=cl>                         <span class=s>&#34;https://youtu.be/&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                       <span class=s>&#34;\\(?:&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>             <span class=nv>url</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>let*</span> <span class=p>((</span><span class=nv>bounds</span> <span class=p>(</span><span class=nv>thing-at-point-bounds-of-url-at-point</span><span class=p>))</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>time-present-p</span> <span class=p>(</span><span class=nf>string-match</span> <span class=s>&#34;t=[0-9]+&#34;</span> <span class=nv>url</span><span class=p>))</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>question-mark-present-p</span> <span class=p>(</span><span class=nv>string-search</span> <span class=s>&#34;?&#34;</span> <span class=nv>url</span><span class=p>))</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>seconds</span> <span class=p>(</span><span class=nb>cond</span>
</span></span><span class=line><span class=cl>                     <span class=p>((</span><span class=nf>numberp</span> <span class=nv>time</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                      <span class=nv>time</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                     <span class=p>((</span><span class=nf>string-match</span>
</span></span><span class=line><span class=cl>                       <span class=s>&#34;^\\([0-9]+\\):\\([0-9]\\{2\\}\\)$&#34;</span> <span class=nv>time</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                      <span class=p>(</span><span class=nf>+</span> <span class=p>(</span><span class=nf>*</span> <span class=mi>60</span> <span class=p>(</span><span class=nf>string-to-number</span>
</span></span><span class=line><span class=cl>                                <span class=p>(</span><span class=nv>match-string</span> <span class=mi>1</span> <span class=nv>time</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>                         <span class=p>(</span><span class=nf>string-to-number</span> <span class=p>(</span><span class=nv>match-string</span> <span class=mi>2</span> <span class=nv>time</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>                     <span class=p>((</span><span class=nf>string-match</span> <span class=s>&#34;^\\([0-9]+\\)s?$&#34;</span> <span class=nv>time</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                      <span class=p>(</span><span class=nf>string-to-number</span> <span class=p>(</span><span class=nv>match-string</span> <span class=mi>1</span> <span class=nv>time</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>                     <span class=p>(</span><span class=no>t</span> <span class=p>(</span><span class=ne>error</span> <span class=s>&#34;Wrong argument format&#34;</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>new-url</span> <span class=p>(</span><span class=nb>if</span> <span class=nv>time-present-p</span>
</span></span><span class=line><span class=cl>                        <span class=p>(</span><span class=nv>replace-regexp-in-string</span>
</span></span><span class=line><span class=cl>                         <span class=s>&#34;t=[0-9]+&#34;</span>
</span></span><span class=line><span class=cl>                         <span class=p>(</span><span class=nf>format</span> <span class=s>&#34;t=%i&#34;</span> <span class=nv>seconds</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                         <span class=nv>url</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                      <span class=p>(</span><span class=nf>concat</span> <span class=nv>url</span>
</span></span><span class=line><span class=cl>                              <span class=p>(</span><span class=nb>if</span> <span class=nv>question-mark-present-p</span> <span class=s>&#34;&amp;&#34;</span> <span class=s>&#34;?&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                              <span class=p>(</span><span class=nf>format</span> <span class=s>&#34;t=%i&#34;</span> <span class=nv>seconds</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nf>delete-region</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>bounds</span><span class=p>)</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>bounds</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nf>insert</span> <span class=nv>new-url</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=ne>error</span> <span class=s>&#34;Not on a Youtube link&#34;</span><span class=p>)))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>my/space-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;lt&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>yt-set-time</span> <span class=nb>:wk</span> <span class=s>&#34;Set Youtube link time&#34;</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=self-define-function class=headerLink><a href=#self-define-function class=header-mark></a>self define function</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>switch-to-message</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Quick switch to </span><span class=ss>`*Message*&#39;</span><span class=s> buffer.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>switch-to-buffer</span> <span class=s>&#34;*Messages*&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>switch-to-scratch</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Quick switch to </span><span class=ss>`*Scratch*&#39;</span><span class=s> buffer.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>switch-to-buffer</span> <span class=s>&#34;*scratch*&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>my/space-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;bs&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>switch-to-scratch</span> <span class=nb>:wk</span> <span class=s>&#34;Swtich to scratch&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;bm&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>switch-to-message</span> <span class=nb>:wk</span> <span class=s>&#34;Swtich to message&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my/inbox-file</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Open inbox file.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>find-file</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;inbox/inbox.org&#34;</span> <span class=nv>my-galaxy</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my/plan-file</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Open plan file.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>find-file</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;inbox/plan.org&#34;</span> <span class=nv>my-galaxy</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my/index-file</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>find-file</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;roam/main/index.org&#34;</span> <span class=nv>my-galaxy</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my/reflection-file</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>find-file</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;roam/main/reflection.org&#34;</span> <span class=nv>my-galaxy</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my/finance-file</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Open finance file.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>find-file</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;finance/finance.bean&#34;</span> <span class=nv>my-galaxy</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my/reading-record</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Open reading record file.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>find-file</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;roam/main/reading-record.org&#34;</span> <span class=nv>my-galaxy</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>my/space-leader-def</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;fo&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nb>:ignore</span> <span class=no>t</span> <span class=nb>:wk</span> <span class=s>&#34;Open file&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;fob&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>my/reading-record</span> <span class=nb>:wk</span> <span class=s>&#34;Reading record&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;foi&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>my/inbox-file</span> <span class=nb>:wk</span> <span class=s>&#34;Inbox file&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;foI&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>my/index-file</span> <span class=nb>:wk</span> <span class=s>&#34;Index file&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;fop&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>my/plan-file</span> <span class=nb>:wk</span> <span class=s>&#34;Plan file&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;fof&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>my/finance-file</span> <span class=nb>:wk</span> <span class=s>&#34;Finance file&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;for&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>my/reflection-file</span> <span class=nb>:wk</span> <span class=s>&#34;Reflection file&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;fog&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>my/gtd-file</span> <span class=nb>:wk</span> <span class=s>&#34;GTD file&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my/start-server</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nv>not</span> <span class=p>(</span><span class=nv>server-running-p</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>server-start</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>message</span> <span class=s>&#34;Server has started&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my/scroll-other-windown-down</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Scroll other window down.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>scroll-other-window-down</span> <span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;M-p&#34;</span><span class=p>)</span> <span class=ss>&#39;my/scroll-other-windown-down</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my/scroll-other-windown</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Scroll other window up.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>scroll-other-window</span> <span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;M-n&#34;</span><span class=p>)</span> <span class=ss>&#39;my/scroll-other-windown</span><span class=p>)</span>
</span></span></code></pre></div><h2 id=end class=headerLink><a href=#end class=header-mark></a>End</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=c1>;;; init.el ends here.</span>
</span></span></code></pre></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>更新于 2023-02-26</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=# onclick=return!1 title="分享到 Twitter" data-sharer=twitter data-url=https://jousimies.github.io/posts/emacs/ data-title="Personal emacs configuration" data-hashtags=Emacs><i class="fab fa-twitter fa-fw"></i></a><a href=# onclick=return!1 title="分享到 Reddit" data-sharer=reddit data-url=https://jousimies.github.io/posts/emacs/><i class="fab fa-reddit fa-fw"></i></a><a href=# onclick=return!1 title="分享到 Evernote" data-sharer=evernote data-url=https://jousimies.github.io/posts/emacs/ data-title="Personal emacs configuration"><i class="fab fa-evernote fa-fw"></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/emacs/>Emacs</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/posts/mac-%E4%B8%8A%E4%BD%BF%E7%94%A8-naiveproxy-%E5%8F%8A%E4%BB%A3%E7%90%86%E9%85%8D%E7%BD%AE/ class=prev rel=prev title="Mac 上使用 naiveproxy 及代理配置"><i class="fas fa-angle-left fa-fw"></i>Mac 上使用 naiveproxy 及代理配置</a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>由 <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.97.3">Hugo</a> 强力驱动&nbsp;|&nbsp;主题 - <a href=https://github.com/HEIGE-PCloud/DoIt target=_blank rel="noopener noreffer" title="DoIt 0.2.13"><i class="far fa-edit fa-fw"></i> DoIt</a></div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank rel="noopener noreferrer">Jousimies</a></span></div><div class=footer-line></div><div class=footer-line></div></div></footer></div><div id=fixed-buttons><a href=#back-to-top id=back-to-top-button class=fixed-button title=回到顶部><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title=查看评论><i class="fas fa-comment fa-fw"></i></a></div><div class=assets><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lunr/lunr.stemmer.support.min.js></script><script type=text/javascript src=/lib/lunr/lunr.zh.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/topbar/topbar.min.js></script><script type=text/javascript src=/lib/pjax/pjax.min.js></script><script type=text/javascript src=/js/theme.min.js defer></script></div><div class=pjax-assets><script type=text/javascript>window.config={code:{copyTitle:"复制到剪贴板",maxShownLines:10},comment:{},search:{highlightTag:"em",lunrIndexURL:"/index.json",lunrLanguageCode:"zh",lunrSegmentitURL:"/lib/lunr/lunr.segmentit.js",maxResultLength:10,noResultsFound:"没有找到结果",snippetLength:50,type:"lunr"},sharerjs:!0}</script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script></div></body></html>