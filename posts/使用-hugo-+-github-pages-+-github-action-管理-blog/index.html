<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>使用 Emacs(ox-hugo) + Hugo + Github-pages + Github-actions 管理 blog | 探索世界，践行人生</title><meta name=keywords content="Emacs"><meta name=description content="今天第一次尝试使用 hugo 进行写 blog ，因为之前虽然断断续续的尝试过 wordpress ， mediawiki 等方式，但是一直没有一个好的体验。查了很多关于 hugo 写 bolg 的资料，网上关于这方面的的文章特别的多，但是不是很小白，有些文章己经过时，参考这些文章走了很多的弯路。今天决定一定要把这个跑通。下面是我的折腾记录。
Github 基础 创建仓库 这部分先创建下面两个 github 仓库。具体的过程看官方的手册 （如果这部分你不清楚，建议先补下相关知识）。
  https://github.com/Jousimies/Jousimies.github.io
对于 hugo 而言，这个仓库 需要是 public 的 ，不能是 private 的。这个仓库名必需要 XXXX.github.io 的形式。
  https://github.com/Jousimies/hugo-source
这个仓库可以是 public 的，也可以是 private 的。 建议选 private 。
  以下教程中用到以上两个仓库的地方，请换成自己创建的仓库的地址。
管理仓库 - SSH 方式 虽然可以使用 https 的方式 clone ，但是目前 github 己经不充许使用密码进行仓库的 push ，需要使用 token 或者是 ssh 。我使用 ssh 。
关于 ssh 管理仓库的知识，这部分可以看 官方手册 。 这部分必需要做 。"><meta name=author content="DN"><link rel=canonical href=https://jousimies.github.io/posts/%E4%BD%BF%E7%94%A8-hugo-+-github-pages-+-github-action-%E7%AE%A1%E7%90%86-blog/><link crossorigin=anonymous href=/assets/css/stylesheet.min.ed52a04cba0843fef8297e018b15e8a32a989ea4415133cb8bf77414d3815f7b.css integrity="sha256-7VKgTLoIQ/74KX4BixXooyqYnqRBUTPLi/d0FNOBX3s=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.2840b7fccd34145847db71a290569594bdbdb00047097f75d6495d162f5d7dff.js integrity="sha256-KEC3/M00FFhH23GikFaVlL29sABHCX911kldFi9dff8=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://jousimies.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://jousimies.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://jousimies.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://jousimies.github.io/apple-touch-icon.png><link rel=mask-icon href=https://jousimies.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="使用 Emacs(ox-hugo) + Hugo + Github-pages + Github-actions 管理 blog"><meta property="og:description" content="今天第一次尝试使用 hugo 进行写 blog ，因为之前虽然断断续续的尝试过 wordpress ， mediawiki 等方式，但是一直没有一个好的体验。查了很多关于 hugo 写 bolg 的资料，网上关于这方面的的文章特别的多，但是不是很小白，有些文章己经过时，参考这些文章走了很多的弯路。今天决定一定要把这个跑通。下面是我的折腾记录。
Github 基础 创建仓库 这部分先创建下面两个 github 仓库。具体的过程看官方的手册 （如果这部分你不清楚，建议先补下相关知识）。
  https://github.com/Jousimies/Jousimies.github.io
对于 hugo 而言，这个仓库 需要是 public 的 ，不能是 private 的。这个仓库名必需要 XXXX.github.io 的形式。
  https://github.com/Jousimies/hugo-source
这个仓库可以是 public 的，也可以是 private 的。 建议选 private 。
  以下教程中用到以上两个仓库的地方，请换成自己创建的仓库的地址。
管理仓库 - SSH 方式 虽然可以使用 https 的方式 clone ，但是目前 github 己经不充许使用密码进行仓库的 push ，需要使用 token 或者是 ssh 。我使用 ssh 。
关于 ssh 管理仓库的知识，这部分可以看 官方手册 。 这部分必需要做 。"><meta property="og:type" content="article"><meta property="og:url" content="https://jousimies.github.io/posts/%E4%BD%BF%E7%94%A8-hugo-+-github-pages-+-github-action-%E7%AE%A1%E7%90%86-blog/"><meta property="article:section" content="posts"><meta name=twitter:card content="summary"><meta name=twitter:title content="使用 Emacs(ox-hugo) + Hugo + Github-pages + Github-actions 管理 blog"><meta name=twitter:description content="今天第一次尝试使用 hugo 进行写 blog ，因为之前虽然断断续续的尝试过 wordpress ， mediawiki 等方式，但是一直没有一个好的体验。查了很多关于 hugo 写 bolg 的资料，网上关于这方面的的文章特别的多，但是不是很小白，有些文章己经过时，参考这些文章走了很多的弯路。今天决定一定要把这个跑通。下面是我的折腾记录。
Github 基础 创建仓库 这部分先创建下面两个 github 仓库。具体的过程看官方的手册 （如果这部分你不清楚，建议先补下相关知识）。
  https://github.com/Jousimies/Jousimies.github.io
对于 hugo 而言，这个仓库 需要是 public 的 ，不能是 private 的。这个仓库名必需要 XXXX.github.io 的形式。
  https://github.com/Jousimies/hugo-source
这个仓库可以是 public 的，也可以是 private 的。 建议选 private 。
  以下教程中用到以上两个仓库的地方，请换成自己创建的仓库的地址。
管理仓库 - SSH 方式 虽然可以使用 https 的方式 clone ，但是目前 github 己经不充许使用密码进行仓库的 push ，需要使用 token 或者是 ssh 。我使用 ssh 。
关于 ssh 管理仓库的知识，这部分可以看 官方手册 。 这部分必需要做 。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://jousimies.github.io/posts/"},{"@type":"ListItem","position":3,"name":"使用 Emacs(ox-hugo) + Hugo + Github-pages + Github-actions 管理 blog","item":"https://jousimies.github.io/posts/%E4%BD%BF%E7%94%A8-hugo-+-github-pages-+-github-action-%E7%AE%A1%E7%90%86-blog/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"使用 Emacs(ox-hugo) + Hugo + Github-pages + Github-actions 管理 blog","name":"使用 Emacs(ox-hugo) \u002b Hugo \u002b Github-pages \u002b Github-actions 管理 blog","description":"今天第一次尝试使用 hugo 进行写 blog ，因为之前虽然断断续续的尝试过 wordpress ， mediawiki 等方式，但是一直没有一个好的体验。查了很多关于 hugo 写 bolg 的资料，网上关于这方面的的文章特别的多，但是不是很小白，有些文章己经过时，参考这些文章走了很多的弯路。今天决定一定要把这个跑通。下面是我的折腾记录。\nGithub 基础 创建仓库 这部分先创建下面两个 github 仓库。具体的过程看官方的手册 （如果这部分你不清楚，建议先补下相关知识）。\n  https://github.com/Jousimies/Jousimies.github.io\n对于 hugo 而言，这个仓库 需要是 public 的 ，不能是 private 的。这个仓库名必需要 XXXX.github.io 的形式。\n  https://github.com/Jousimies/hugo-source\n这个仓库可以是 public 的，也可以是 private 的。 建议选 private 。\n  以下教程中用到以上两个仓库的地方，请换成自己创建的仓库的地址。\n管理仓库 - SSH 方式 虽然可以使用 https 的方式 clone ，但是目前 github 己经不充许使用密码进行仓库的 push ，需要使用 token 或者是 ssh 。我使用 ssh 。\n关于 ssh 管理仓库的知识，这部分可以看 官方手册 。 这部分必需要做 。","keywords":["Emacs"],"articleBody":"今天第一次尝试使用 hugo 进行写 blog ，因为之前虽然断断续续的尝试过 wordpress ， mediawiki 等方式，但是一直没有一个好的体验。查了很多关于 hugo 写 bolg 的资料，网上关于这方面的的文章特别的多，但是不是很小白，有些文章己经过时，参考这些文章走了很多的弯路。今天决定一定要把这个跑通。下面是我的折腾记录。\nGithub 基础 创建仓库 这部分先创建下面两个 github 仓库。具体的过程看官方的手册 （如果这部分你不清楚，建议先补下相关知识）。\n  https://github.com/Jousimies/Jousimies.github.io\n对于 hugo 而言，这个仓库 需要是 public 的 ，不能是 private 的。这个仓库名必需要 XXXX.github.io 的形式。\n  https://github.com/Jousimies/hugo-source\n这个仓库可以是 public 的，也可以是 private 的。 建议选 private 。\n  以下教程中用到以上两个仓库的地方，请换成自己创建的仓库的地址。\n管理仓库 - SSH 方式 虽然可以使用 https 的方式 clone ，但是目前 github 己经不充许使用密码进行仓库的 push ，需要使用 token 或者是 ssh 。我使用 ssh 。\n关于 ssh 管理仓库的知识，这部分可以看 官方手册 。 这部分必需要做 。\nclone 仓库 将上面创建的 hugo-source 项目仓库 clone 到本地，主页仓库不需要 clone 地本地。\ncd ~ git clone git@github.com:Jousimies/hugo-source.git #替换成自己的地址 HUGO hugo 安装 Macos 上通过以下命令安装。其他的操作系统参考：Install Hugo | Hugo\nbrew install hugo 通过 hugo version 查看版本，后面会用到。\nHugo quick start 这部分可以参考 Quick Start — ox-hugo - Org to Hugo exporter 中的说明。\n设及到的操作有以下三个：\ncd hugo-source hugo new site hugo-source --force # 这里必需要使用 --force git submodule add https://github.com/adityatelange/hugo-PaperMod themes/PaperMod --depth=1 echo 'theme = \"PaperMod\"'  config.toml 以上的命令中必需要 force ，因为我是先创建的仓库 hugo-source 。 至于先创建 site 的方式，自己查资料吧，这边不说。\n需要注意的是 Quick Start — ox-hugo - Org to Hugo exporter 中第4步关于主题的设置，它推荐的是使用 hugo modules ，但是我这边会出现 hugo moduel download 然后就没有反应，所以 我推荐使用 git submodele 的方式管理主题 。\n有些教程中是使用 git clone 的方式管理主题，但是强烈建议不要直接使用 git clone 的方式管理主题，否则后面 git 配置的时候会报仓库嵌套的问题。虽然可以解决，但是我觉得麻烦，不如这里直接使用 submodule 的方式管理。\n上面的使用的是 GitHub - adityatelange/hugo-PaperMod: A fast, clean, responsive Hugo theme. 这个主题。\n写文章 我使用 emacs 中的 org-mode 写，如果你要使用 markdown 写的请参考其他的教程。\n我选择把所有的文章放到一个 org 文档中，如果要分开放，自己查资料。\ncd ~/hugo-source #这里的地址取决你的仓库名 mkdir content-org cd content-org touch all-posts.org 我把 org 原始文件 all-posts.org 放到了 content-org 文件夹中，这两个你都可以用其他的名称。\n在 emacs 中打开 all-posts.org 这个文件，编辑这个文件。\n格式可以参考以下这张图： 其中 export_file_name 你可以自己定。如果一个 title 加了 TODO ，导出时在 hugo 中会显示 draft ，改成 DONE 就会去掉。\n导出 org 文档为 markdown Hugo 使用 markdown 渲染，所以要将 org 文档转换成 markdown 格式。这个在 emacs 中是使用 ox-hugo 这个包实现。\nox-hugo 的配置很简单：\n(with-eval-after-load 'ox  (require 'ox-hugo)) 使用 C-c C-e H H 将 org 文档转换成 markdown 文档。这个命令会将 org 中的 subtree 转换成多个 markdown 文件。如果使用 C-c C-e H h 的话，会将 all-posts.org 转换成 all-posts.md 这一个文档。\n我使用的是 C-c C-e H H 这个命令。\nhugo 预览 本地使用 hugo server 预览自己的文件。执行下面两个命令后，就可以用浏览器打开 localhost:1313 预览自己的 blog 了。\ncd hugo-source hugo server 生成静态文件 cd hugo-sourch hugo 这部分必需要做 。\nGithub Actions 配置文件 cd hugo-source mkdir -p .github/workflows touch hugo.yml #这个文件名没有影响，只要是 XXX.yml 文件就行 编辑 hugo.yml 这个文件，其中的内容可以参考：GitHub Pages action · Actions · GitHub Marketplace · GitHub\n需要注意的地方我给出了说明，其中特别要注意 deploy_key 这一项。 我这里使用 deploy_key 进行身份验证。\n name: GitHub Pages  on:  push:  branches:  - main  #默认使用 main  pull_request:  jobs:  deploy:  runs-on: ubuntu-20.04  concurrency:  group: ${{ github.workflow }}-${{ github.ref }} #不用改  steps:  - uses: actions/checkout@v3 \twith: \tsubmodules: true # Fetch Hugo themes (true OR recursive) \tfetch-depth: 0 # Fetch all history for .GitInfo and .Lastmod   - name: Setup Hugo \tuses: peaceiris/actions-hugo@v2 \twith: \thugo-version: '0.97.3' #改成自己所用的 hugo 版本 \textended: true   - name: Build \trun: hugo --minify   - name: Deploy \tuses: peaceiris/actions-gh-pages@v3 \twith: \tdeploy_key: ${{ secrets.DEPLOY_TOKEN }} #注意这个 DEPLOY_TOKEN \texternal_repository: Jousimies/Jousimies.github.io # 改成自己的仓库地址 \tpublish_branch: main #默认使用 main \tpublish_dir: ./public #不用改 github actions deploy key 上面编辑好了 hugo.yml 这个文件，下面要设置 github-actions 这一项。\n首先要生成 ssh key 。\ncd ~ ssh-keygen -t rsa -b 4096 -C \"$(git config user.email)\" -f gh-pages -N \"\" 以上命令会在 ~ 目录下生成 gh-pages （私钥）和 gh-pages.pub （公钥）两个文件。这两个文件要分别用到上面建的两个 github 仓库中。\n  打开 https://github.com/Jousimies/hugo-source/settings/secrets/actions/new （改成自己的项目仓库地址）贴入 gh-pages 中的内容。\n注意 Name 那一项里必需填 DEPOLY_TOKEN 。其实是上面 hugo.yml 中 ${{ secrets.DEPLOY_TOKEN }} 设置和这里要对应上，否则 github 运行 action 时会报没有 depoly token 的错误。\n  打开 https://github.com/Jousimies/Jousimies.github.io/settings/keys/new （改成自己的主页仓库地址）贴入 gh-pages.pub 中的内容。\n这里的 title 随便填。\n  PUSH 仓库 cd hugo-source git add -A git commit -m \"Init push\" 当成功 push 仓库后， github 会自动运行 actions ，在 https://github.com/Jousimies/hugo-source/actions （切换成自己的项目仓库地址）中可以查看 workflow 的状况。\n如果显示是个绿色的勾，那么恭喜你成功了。稍后打开 https://jousimies.github.io 就能看到自己的博客内容了。\n","wordCount":"522","inLanguage":"en","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","author":[{"@type":"Person","name":"DN"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://jousimies.github.io/posts/%E4%BD%BF%E7%94%A8-hugo-+-github-pages-+-github-action-%E7%AE%A1%E7%90%86-blog/"},"publisher":{"@type":"Organization","name":"探索世界，践行人生","logo":{"@type":"ImageObject","url":"https://jousimies.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://jousimies.github.io accesskey=h title="探索世界，践行人生 (Alt + H)">探索世界，践行人生</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://jousimies.github.io/search title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://jousimies.github.io/posts title=Posts><span>Posts</span></a></li><li><a href=https://jousimies.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://jousimies.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://jousimies.github.io/archives title=Archives><span>Archives</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://jousimies.github.io>Home</a>&nbsp;»&nbsp;<a href=https://jousimies.github.io/posts/>Posts</a></div><h1 class=post-title>使用 Emacs(ox-hugo) + Hugo + Github-pages + Github-actions 管理 blog</h1><div class=post-meta>3 min&nbsp;·&nbsp;DN</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#github-%e5%9f%ba%e7%a1%80 aria-label="Github 基础">Github 基础</a><ul><li><a href=#%e5%88%9b%e5%bb%ba%e4%bb%93%e5%ba%93 aria-label=创建仓库>创建仓库</a></li><li><a href=#%e7%ae%a1%e7%90%86%e4%bb%93%e5%ba%93-ssh-%e6%96%b9%e5%bc%8f aria-label="管理仓库 - SSH 方式">管理仓库 - SSH 方式</a></li><li><a href=#clone-%e4%bb%93%e5%ba%93 aria-label="clone 仓库">clone 仓库</a></li></ul></li><li><a href=#hugo aria-label=HUGO>HUGO</a><ul><li><a href=#hugo-%e5%ae%89%e8%a3%85 aria-label="hugo 安装">hugo 安装</a></li><li><a href=#hugo-quick-start aria-label="Hugo quick start">Hugo quick start</a></li><li><a href=#%e5%86%99%e6%96%87%e7%ab%a0 aria-label=写文章>写文章</a><ul><li><a href=#%e5%af%bc%e5%87%ba-org-%e6%96%87%e6%a1%a3%e4%b8%ba-markdown aria-label="导出 org 文档为 markdown">导出 org 文档为 markdown</a></li></ul></li><li><a href=#hugo-%e9%a2%84%e8%a7%88 aria-label="hugo 预览">hugo 预览</a></li><li><a href=#%e7%94%9f%e6%88%90%e9%9d%99%e6%80%81%e6%96%87%e4%bb%b6 aria-label=生成静态文件>生成静态文件</a></li></ul></li><li><a href=#github-actions-%e9%85%8d%e7%bd%ae%e6%96%87%e4%bb%b6 aria-label="Github Actions 配置文件">Github Actions 配置文件</a><ul><li><a href=#github-actions-deploy-key aria-label="github actions deploy key">github actions deploy key</a></li><li><a href=#push-%e4%bb%93%e5%ba%93 aria-label="PUSH 仓库">PUSH 仓库</a></li></ul></li></ul></div></details></div><div class=post-content><p>今天第一次尝试使用 hugo 进行写 blog ，因为之前虽然断断续续的尝试过 wordpress ， mediawiki 等方式，但是一直没有一个好的体验。查了很多关于 hugo 写 bolg 的资料，网上关于这方面的的文章特别的多，但是不是很小白，有些文章己经过时，参考这些文章走了很多的弯路。今天决定一定要把这个跑通。下面是我的折腾记录。</p><h2 id=github-基础>Github 基础<a hidden class=anchor aria-hidden=true href=#github-基础>#</a></h2><h3 id=创建仓库>创建仓库<a hidden class=anchor aria-hidden=true href=#创建仓库>#</a></h3><p>这部分先创建下面两个 github 仓库。具体的过程看<a href=https://docs.github.com/en/get-started/quickstart/create-a-repo>官方的手册</a> （如果这部分你不清楚，建议先补下相关知识）。</p><ul><li><p><a href=https://github.com/Jousimies/Jousimies.github.io>https://github.com/Jousimies/Jousimies.github.io</a></p><p>对于 hugo 而言，这个仓库 <strong>需要是 public 的</strong> ，不能是 private 的。这个仓库名必需要 <code>XXXX.github.io</code> 的形式。</p></li><li><p><a href=https://github.com/Jousimies/hugo-source>https://github.com/Jousimies/hugo-source</a></p><p>这个仓库可以是 public 的，也可以是 private 的。 <strong>建议选 private</strong> 。</p></li></ul><p><strong>以下教程中用到以上两个仓库的地方，请换成自己创建的仓库的地址。</strong></p><h3 id=管理仓库-ssh-方式>管理仓库 - SSH 方式<a hidden class=anchor aria-hidden=true href=#管理仓库-ssh-方式>#</a></h3><p>虽然可以使用 https 的方式 clone ，但是目前 github 己经不充许使用密码进行仓库的 push ，需要使用 token 或者是 ssh 。我使用 ssh 。</p><p>关于 ssh 管理仓库的知识，这部分可以看 <a href=https://docs.github.com/en/authentication/connecting-to-github-with-ssh>官方手册</a> 。 <strong>这部分必需要做</strong> 。</p><h3 id=clone-仓库>clone 仓库<a hidden class=anchor aria-hidden=true href=#clone-仓库>#</a></h3><p>将上面创建的 hugo-source 项目仓库 clone 到本地，主页仓库不需要 clone 地本地。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd ~
</span></span><span style=display:flex><span>git clone git@github.com:Jousimies/hugo-source.git <span style=color:#75715e>#替换成自己的地址</span>
</span></span></code></pre></div><h2 id=hugo>HUGO<a hidden class=anchor aria-hidden=true href=#hugo>#</a></h2><h3 id=hugo-安装>hugo 安装<a hidden class=anchor aria-hidden=true href=#hugo-安装>#</a></h3><p>Macos 上通过以下命令安装。其他的操作系统参考：<a href=https://gohugo.io/getting-started/installing>Install Hugo | Hugo</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>brew install hugo
</span></span></code></pre></div><p>通过 <code>hugo version</code> 查看版本，后面会用到。</p><h3 id=hugo-quick-start>Hugo quick start<a hidden class=anchor aria-hidden=true href=#hugo-quick-start>#</a></h3><p>这部分可以参考 <a href=https://ox-hugo.scripter.co/doc/quick-start/>Quick Start — ox-hugo - Org to Hugo exporter</a> 中的说明。</p><p>设及到的操作有以下三个：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd hugo-source
</span></span><span style=display:flex><span>hugo new site hugo-source --force <span style=color:#75715e># 这里必需要使用 --force</span>
</span></span><span style=display:flex><span>git submodule add https://github.com/adityatelange/hugo-PaperMod themes/PaperMod --depth<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#39;theme = &#34;PaperMod&#34;&#39;</span> &gt;&gt; config.toml
</span></span></code></pre></div><p>以上的命令中必需要 <code>force</code> ，因为我是先创建的仓库 hugo-source 。
至于先创建 site 的方式，自己查资料吧，这边不说。</p><p>需要注意的是 <a href=https://ox-hugo.scripter.co/doc/quick-start/>Quick Start — ox-hugo - Org to Hugo exporter</a> 中第4步关于主题的设置，它推荐的是使用 hugo modules ，但是我这边会出现 hugo moduel download 然后就没有反应，所以 <strong>我推荐使用 git submodele 的方式管理主题</strong> 。</p><p>有些教程中是使用 git clone 的方式管理主题，但是强烈建议不要直接使用 git clone 的方式管理主题，否则后面 git 配置的时候会报仓库嵌套的问题。虽然可以解决，但是我觉得麻烦，不如这里直接使用 submodule 的方式管理。</p><p>上面的使用的是 <a href=https://github.com/adityatelange/hugo-PaperMod>GitHub - adityatelange/hugo-PaperMod: A fast, clean, responsive Hugo theme.</a> 这个主题。</p><h3 id=写文章>写文章<a hidden class=anchor aria-hidden=true href=#写文章>#</a></h3><p>我使用 emacs 中的 org-mode 写，如果你要使用 markdown 写的请参考其他的教程。</p><p>我选择把所有的文章放到一个 org 文档中，如果要分开放，自己查资料。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd ~/hugo-source <span style=color:#75715e>#这里的地址取决你的仓库名</span>
</span></span><span style=display:flex><span>mkdir content-org
</span></span><span style=display:flex><span>cd content-org
</span></span><span style=display:flex><span>touch all-posts.org
</span></span></code></pre></div><p>我把 org 原始文件 <code>all-posts.org</code> 放到了 content-org 文件夹中，这两个你都可以用其他的名称。</p><p>在 emacs 中打开 <code>all-posts.org</code> 这个文件，编辑这个文件。</p><p>格式可以参考以下这张图： <img loading=lazy src=https://www.xianmin.org/image/other/ox-hugo-01.png alt></p><p>其中 <code>export_file_name</code> 你可以自己定。如果一个 title 加了 <code>TODO</code> ，导出时在 hugo 中会显示 draft ，改成 <code>DONE</code> 就会去掉。</p><h4 id=导出-org-文档为-markdown>导出 org 文档为 markdown<a hidden class=anchor aria-hidden=true href=#导出-org-文档为-markdown>#</a></h4><p>Hugo 使用 markdown 渲染，所以要将 org 文档转换成 markdown 格式。这个在 emacs 中是使用 ox-hugo 这个包实现。</p><p>ox-hugo 的配置很简单：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(with-eval-after-load <span style=color:#e6db74>&#39;ox</span>
</span></span><span style=display:flex><span>  (require <span style=color:#e6db74>&#39;ox-hugo</span>))
</span></span></code></pre></div><p>使用 <code>C-c C-e H H</code> 将 org 文档转换成 markdown 文档。这个命令会将 org 中的 subtree 转换成多个 markdown 文件。如果使用 <code>C-c C-e H h</code> 的话，会将 <code>all-posts.org</code> 转换成 <code>all-posts.md</code> 这一个文档。</p><p>我使用的是 <code>C-c C-e H H</code> 这个命令。</p><h3 id=hugo-预览>hugo 预览<a hidden class=anchor aria-hidden=true href=#hugo-预览>#</a></h3><p>本地使用 hugo server 预览自己的文件。执行下面两个命令后，就可以用浏览器打开 localhost:1313 预览自己的 blog 了。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd hugo-source
</span></span><span style=display:flex><span>hugo server
</span></span></code></pre></div><h3 id=生成静态文件>生成静态文件<a hidden class=anchor aria-hidden=true href=#生成静态文件>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd hugo-sourch
</span></span><span style=display:flex><span>hugo
</span></span></code></pre></div><p><strong>这部分必需要做</strong> 。</p><h2 id=github-actions-配置文件>Github Actions 配置文件<a hidden class=anchor aria-hidden=true href=#github-actions-配置文件>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd hugo-source
</span></span><span style=display:flex><span>mkdir -p .github/workflows
</span></span><span style=display:flex><span>touch hugo.yml <span style=color:#75715e>#这个文件名没有影响，只要是 XXX.yml 文件就行</span>
</span></span></code></pre></div><p>编辑 <code>hugo.yml</code> 这个文件，其中的内容可以参考：<a href=https://github.com/marketplace/actions/github-pages-action>GitHub Pages action · Actions · GitHub Marketplace · GitHub</a></p><p>需要注意的地方我给出了说明，其中特别要注意 <code>deploy_key</code> 这一项。 我这里使用 deploy_key 进行身份验证。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>GitHub Pages</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>on</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>push</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>branches</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>main </span> <span style=color:#75715e>#默认使用 main</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>pull_request</span>:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>jobs</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>deploy</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>runs-on</span>: <span style=color:#ae81ff>ubuntu-20.04</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>concurrency</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>group</span>: <span style=color:#ae81ff>${{ github.workflow }}-${{ github.ref }}</span> <span style=color:#75715e>#不用改</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/checkout@v3</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>	  <span style=color:#f92672>submodules</span>: <span style=color:#66d9ef>true</span>  <span style=color:#75715e># Fetch Hugo themes (true OR recursive)</span>
</span></span><span style=display:flex><span>	  <span style=color:#f92672>fetch-depth</span>: <span style=color:#ae81ff>0</span>    <span style=color:#75715e># Fetch all history for .GitInfo and .Lastmod</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Setup Hugo</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>uses</span>: <span style=color:#ae81ff>peaceiris/actions-hugo@v2</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>	  <span style=color:#f92672>hugo-version</span>: <span style=color:#e6db74>&#39;0.97.3&#39;</span> <span style=color:#75715e>#改成自己所用的 hugo 版本</span>
</span></span><span style=display:flex><span>	  <span style=color:#f92672>extended</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Build</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>run</span>: <span style=color:#ae81ff>hugo --minify</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Deploy</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>uses</span>: <span style=color:#ae81ff>peaceiris/actions-gh-pages@v3</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>	  <span style=color:#f92672>deploy_key</span>: <span style=color:#ae81ff>${{ secrets.DEPLOY_TOKEN }}</span> <span style=color:#75715e>#注意这个 DEPLOY_TOKEN</span>
</span></span><span style=display:flex><span>	  <span style=color:#f92672>external_repository</span>: <span style=color:#ae81ff>Jousimies/Jousimies.github.io</span> <span style=color:#75715e># 改成自己的仓库地址</span>
</span></span><span style=display:flex><span>	  <span style=color:#f92672>publish_branch</span>: <span style=color:#ae81ff>main</span> <span style=color:#75715e>#默认使用 main</span>
</span></span><span style=display:flex><span>	  <span style=color:#f92672>publish_dir</span>: <span style=color:#ae81ff>./public</span> <span style=color:#75715e>#不用改</span>
</span></span></code></pre></div><h3 id=github-actions-deploy-key>github actions deploy key<a hidden class=anchor aria-hidden=true href=#github-actions-deploy-key>#</a></h3><p>上面编辑好了 hugo.yml 这个文件，下面要设置 github-actions 这一项。</p><p>首先要生成 ssh key 。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd ~
</span></span><span style=display:flex><span>ssh-keygen -t rsa -b <span style=color:#ae81ff>4096</span> -C <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>git config user.email<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span> -f gh-pages -N <span style=color:#e6db74>&#34;&#34;</span>
</span></span></code></pre></div><p>以上命令会在 <code>~</code> 目录下生成 <code>gh-pages</code> （私钥）和 <code>gh-pages.pub</code> （公钥）两个文件。这两个文件要分别用到上面建的两个 github 仓库中。</p><ul><li><p>打开 <a href=https://github.com/Jousimies/hugo-source/settings/secrets/actions/new>https://github.com/Jousimies/hugo-source/settings/secrets/actions/new</a> （改成自己的项目仓库地址）贴入 <code>gh-pages</code> 中的内容。</p><p>注意 <code>Name</code> 那一项里必需填 <code>DEPOLY_TOKEN</code> 。其实是上面 hugo.yml 中 <code>${{ secrets.DEPLOY_TOKEN }}</code> 设置和这里要对应上，否则 github 运行 action 时会报没有 depoly token 的错误。</p></li><li><p>打开 <a href=https://github.com/Jousimies/Jousimies.github.io/settings/keys/new>https://github.com/Jousimies/Jousimies.github.io/settings/keys/new</a> （改成自己的主页仓库地址）贴入 <code>gh-pages.pub</code> 中的内容。</p><p>这里的 title 随便填。</p></li></ul><h3 id=push-仓库>PUSH 仓库<a hidden class=anchor aria-hidden=true href=#push-仓库>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd hugo-source
</span></span><span style=display:flex><span>git add -A
</span></span><span style=display:flex><span>git commit -m <span style=color:#e6db74>&#34;Init push&#34;</span>
</span></span></code></pre></div><p>当成功 push 仓库后， github 会自动运行 actions ，在 <a href=https://github.com/Jousimies/hugo-source/actions>https://github.com/Jousimies/hugo-source/actions</a> （切换成自己的项目仓库地址）中可以查看 workflow 的状况。</p><p>如果显示是个绿色的勾，那么恭喜你成功了。稍后打开 <a href=https://jousimies.github.io>https://jousimies.github.io</a> 就能看到自己的博客内容了。</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://jousimies.github.io/tags/emacs/>Emacs</a></li></ul><nav class=paginav><a class=prev href=https://jousimies.github.io/posts/emacs-%E9%85%8D%E7%BD%AE%E5%8F%82%E8%80%83%E9%9B%86/><span class=title>« Prev Page</span><br><span>Emacs 配置参考集</span></a>
<a class=next href=https://jousimies.github.io/posts/%E5%93%B2%E5%AD%A6%E5%92%8C%E9%80%BB%E8%BE%91/><span class=title>Next Page »</span><br><span>哲学和逻辑</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share 使用 Emacs(ox-hugo) + Hugo + Github-pages + Github-actions 管理 blog on twitter" href="https://twitter.com/intent/tweet/?text=%e4%bd%bf%e7%94%a8%20Emacs%28ox-hugo%29%20%2b%20Hugo%20%2b%20Github-pages%20%2b%20Github-actions%20%e7%ae%a1%e7%90%86%20blog&url=https%3a%2f%2fjousimies.github.io%2fposts%2f%25E4%25BD%25BF%25E7%2594%25A8-hugo-%2b-github-pages-%2b-github-action-%25E7%25AE%25A1%25E7%2590%2586-blog%2f&hashtags=Emacs"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://jousimies.github.io>探索世界，践行人生</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerText="copy";function s(){e.innerText="copied!",setTimeout(()=>{e.innerText="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>