<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title class=pjax-title>Jousimies's Personal Emacs Configuration - 探索世界，践行人生</title><meta name=Description content="This is My New Hugo Site"><meta property="og:title" content="Jousimies's Personal Emacs Configuration"><meta property="og:description" content="IntroductionInterface Show 上面的图生成方式如下。 magick convert -size 2880x1800 xc:black -fill white -draw &#34;path 'M 0,100 C 1000,200 800,1600 2880,1700 V 1800 H 2880 V 0 H 0'&#34; mask.png magick composite dark.png light.png mask.png -alpha Off shot.png rm mask.png Why Emacs我是一个科技，数字爱好者，电子产品"><meta property="og:type" content="article"><meta property="og:url" content="http://example.org/posts/emacs-configuration/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-05-13T00:00:00+00:00"><meta property="article:modified_time" content="2022-05-13T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Jousimies's Personal Emacs Configuration"><meta name=twitter:description content="IntroductionInterface Show 上面的图生成方式如下。 magick convert -size 2880x1800 xc:black -fill white -draw &#34;path 'M 0,100 C 1000,200 800,1600 2880,1700 V 1800 H 2880 V 0 H 0'&#34; mask.png magick composite dark.png light.png mask.png -alpha Off shot.png rm mask.png Why Emacs我是一个科技，数字爱好者，电子产品"><meta name=application-name content="探索世界，践行人生"><meta name=apple-mobile-web-app-title content="探索世界，践行人生"><meta name=theme-color content="#f8f8f8"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=canonical href=http://example.org/posts/emacs-configuration/><link rel=prev href=http://example.org/posts/emacs-%E4%B8%AD-org-mode-%E6%96%87%E6%A1%A3%E7%BC%96%E8%AF%91-pdf-%E7%9A%84%E5%9F%BA%E6%9C%AC%E8%AE%BE%E7%BD%AE/><link rel=next href=http://example.org/posts/%E7%AE%97%E6%B3%95/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href=/lib/fontawesome-free/all.min.css><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href=/lib/animate/animate.min.css><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Jousimies's Personal Emacs Configuration","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"http:\/\/example.org\/posts\/emacs-configuration\/"},"genre":"posts","keywords":"Emacs, Org-mode","wordcount":15780,"url":"http:\/\/example.org\/posts\/emacs-configuration\/","datePublished":"2022-05-13T00:00:00+00:00","dateModified":"2022-05-13T00:00:00+00:00","publisher":{"@type":"Organization","name":"Jousimies"},"author":{"@type":"Person","name":"Jousimies"},"description":""}</script></head><body header-desktop header-mobile><script type=text/javascript>function setTheme(e){document.body.setAttribute("theme",e),document.documentElement.style.setProperty("color-scheme",e==="light"?"light":"dark")}function saveTheme(e){window.localStorage&&localStorage.setItem("theme",e)}function getMeta(t){const e=document.getElementsByTagName("meta");for(let n=0;n<e.length;n++)if(e[n].getAttribute("name")===t)return e[n];return''}if(window.localStorage&&localStorage.getItem("theme")){let e=localStorage.getItem("theme");e==="light"||e==="dark"||e==="black"?setTheme(e):window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?setTheme("dark"):setTheme("light")}else"auto"==="light"||"auto"==="dark"||"auto"==="black"?(setTheme("auto"),saveTheme("auto")):(saveTheme("auto"),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?setTheme("dark"):setTheme("light"));let metaColors={light:"#f8f8f8",dark:"#252627",black:"#000000"};getMeta("theme-color").content=metaColors[document.body.getAttribute("theme")]</script><div id=back-to-top></div><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title=探索世界，践行人生>探索世界，践行人生</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>文章 </a><a class=menu-item href=/tags/>标签 </a><a class=menu-item href=/categories/>分类 </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder=搜索文章标题或内容... id=search-input-desktop>
<a href=# onclick=return!1 class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fas fa-search fa-fw"></i></a>
<a href=# onclick=return!1 class="search-button search-clear" id=search-clear-desktop title=清空><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i></span>
</span><a href=# onclick=return!1 class="menu-item theme-switch" title=切换主题><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=探索世界，践行人生>探索世界，践行人生</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容... id=search-input-mobile>
<a href=# onclick=return!1 class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fas fa-search fa-fw"></i></a>
<a href=# onclick=return!1 class="search-button search-clear" id=search-clear-mobile title=清空><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=# onclick=return!1 class=search-cancel id=search-cancel-mobile>取消</a></div><a class=menu-item href=/posts/ title>文章</a><a class=menu-item href=/tags/ title>标签</a><a class=menu-item href=/categories/ title>分类</a><a href=# onclick=return!1 class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>目录</h2><div class=toc-content id=toc-content-auto><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a><ul><li><a href=#interface-show>Interface Show</a></li><li><a href=#why-emacs>Why Emacs</a></li><li><a href=#how-i-manage-my-packages>How I manage my packages</a></li><li><a href=#about-note-taking>About note taking</a></li><li><a href=#acknowledgements>Acknowledgements</a></li></ul></li><li><a href=#the-early-init-file>The Early Init File</a></li><li><a href=#emacs-foundation-configuration>Emacs Foundation Configuration</a><ul><li><a href=#debug>DEBUG</a></li><li><a href=#borg-package-manage>Borg - Package manage</a></li><li><a href=#startup>Startup</a></li><li><a href=#variables>Variables</a></li><li><a href=#custom-file>Custom file</a></li><li><a href=#private-file>Private file</a></li><li><a href=#benchmark>Benchmark</a></li></ul></li><li><a href=#emacs-user-interface-delicious>Emacs User interface, DELICIOUS</a><ul><li><a href=#fonts>Fonts</a></li><li><a href=#icon>Icon</a></li><li><a href=#cursor>Cursor</a></li><li><a href=#themes>Themes</a></li><li><a href=#dashboard>Dashboard</a></li><li><a href=#define-fringe-bitmap>define-fringe-bitmap</a></li><li><a href=#rainbow-mode>rainbow-mode</a></li><li><a href=#helpful>helpful</a></li><li><a href=#info-colors>info-colors</a></li><li><a href=#goggles>goggles</a></li><li><a href=#emojify>emojify</a></li><li><a href=#centaur-tab>centaur-tab</a></li><li><a href=#awesome-tray>Awesome Tray</a></li><li><a href=#window-divider>window-divider</a></li><li><a href=#highlight-line>Highlight line</a></li><li><a href=#stem-reading-mode>stem-reading-mode</a></li><li><a href=#emacs-frame-management>Emacs frame management</a></li><li><a href=#benchmark>Benchmark</a></li></ul></li><li><a href=#powerful-emacs-equipped-with-builtin-packages>Powerful Emacs Equipped with Builtin Packages</a><ul><li><a href=#y-or-n-p>y-or-n-p</a></li><li><a href=#bell>bell</a></li><li><a href=#kill-ring>kill-ring</a></li><li><a href=#system-coding>system coding</a></li><li><a href=#paren>paren</a></li><li><a href=#elec-pair>elec-pair</a></li><li><a href=#line-number>line number</a></li><li><a href=#simple>simple</a></li><li><a href=#autorevert>autorevert</a></li><li><a href=#subword>subword</a></li><li><a href=#winner>winner</a></li><li><a href=#server>server</a></li><li><a href=#prettify-symbols-mode>prettify-symbols-mode</a></li><li><a href=#so-long>so-long</a></li><li><a href=#delsel>delsel</a></li><li><a href=#webjump>webjump</a></li><li><a href=#url>url</a></li><li><a href=#bookmark>bookmark</a></li><li><a href=#repeat>repeat</a></li><li><a href=#minibuffer>minibuffer</a></li><li><a href=#ibuffer>ibuffer</a></li><li><a href=#mouse-avoidance>mouse-avoidance</a></li><li><a href=#cursor-intangible>cursor-intangible</a></li><li><a href=#large-file>large file</a></li><li><a href=#benchmark>Benchmark</a></li></ul></li><li><a href=#awesome-emacs-equipped-with-third-party-packages>Awesome Emacs Equipped with Third-party Packages</a><ul><li><a href=#gcmh>gcmh</a></li><li><a href=#restart-emacs>restart-emacs</a></li><li><a href=#input-method>input method</a></li><li><a href=#autoinsert>autoinsert</a></li><li><a href=#embrace>embrace</a></li><li><a href=#recent-file>recent file</a></li><li><a href=#dired-mode>dired-mode</a></li><li><a href=#hungry-delete>hungry delete</a></li><li><a href=#save>save</a></li><li><a href=#undo-and-redo>undo&redo</a></li><li><a href=#completion-and-search-framework>Completion and search framework</a></li><li><a href=#dabbrev>dabbrev</a></li><li><a href=#cape>cape</a></li><li><a href=#tempel>tempel</a></li><li><a href=#imenu-list>imenu-list</a></li><li><a href=#open-with-safari>Open with Safari</a></li><li><a href=#benchmark>Benchmark</a></li></ul></li><li><a href=#emacs-works-with-multiple-language-piece-of-cake>Emacs Works with Multiple Language, PIECE OF CAKE</a><ul><li><a href=#language-spelling>Language Spelling</a></li><li><a href=#language-translate>Language Translate</a></li><li><a href=#language-format>Language Format</a></li><li><a href=#language-service-protocol>Language Service Protocol</a></li><li><a href=#multiple-programming-language>Multiple Programming Language</a></li><li><a href=#benchmark>Benchmark</a></li></ul></li><li><a href=#organize-life-with-plain-text>Organize Life With Plain Text</a><ul><li><a href=#better-default>Better Default</a></li><li><a href=#packages-enhance-org>Packages enhance org</a></li><li><a href=#note-taking>Note taking</a></li><li><a href=#bibtex-manage>Bibtex manage</a></li><li><a href=#tasks-manage>Tasks manage</a></li><li><a href=#finance-manage>Finance manage</a></li><li><a href=#org-export>Org Export</a></li><li><a href=#latex>Latex</a></li><li><a href=#benchmark>Benchmark</a></li></ul></li><li><a href=#emacs-can-do-more-applications>Emacs Can DO More, Applications</a><ul><li><a href=#pdf-reader>PDF Reader</a></li><li><a href=#git>GIT</a></li><li><a href=#eshell>eshell</a></li><li><a href=#rss-management>Rss management</a></li><li><a href=#email>Email</a></li><li><a href=#map-osm>Map osm</a></li><li><a href=#telegaram>Telegaram</a></li><li><a href=#proxy>Proxy</a></li><li><a href=#benchmark>Benchmark</a></li></ul></li><li><a href=#emacs-keybindings>Emacs Keybindings</a><ul><li><a href=#keyfreq>Keyfreq</a></li><li><a href=#meow>Meow</a></li><li><a href=#one-key-and-meow-leader-define-key>one-key and meow-leader-define-key</a></li><li><a href=#benchmark>Benchmark</a></li></ul></li></ul></nav></div></div><script>document.getElementsByTagName("main")[0].setAttribute("pageStyle","normal")</script><script>document.getElementsByTagName("main")[0].setAttribute("autoTOC","true")</script><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Jousimies's Personal Emacs Configuration</h1><div class=post-meta><div class=post-meta-line><span class=post-author><i class="author fas fa-user-circle fa-fw"></i><a href=/ title=Author rel=author class=author>Jousimies</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2022-05-13>2022-05-13</time>&nbsp;<i class="far fa-edit fa-fw"></i>&nbsp;<time datetime=2022-05-13>2022-05-13</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 15780 字&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 32 分钟&nbsp;</div></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a><ul><li><a href=#interface-show>Interface Show</a></li><li><a href=#why-emacs>Why Emacs</a></li><li><a href=#how-i-manage-my-packages>How I manage my packages</a></li><li><a href=#about-note-taking>About note taking</a></li><li><a href=#acknowledgements>Acknowledgements</a></li></ul></li><li><a href=#the-early-init-file>The Early Init File</a></li><li><a href=#emacs-foundation-configuration>Emacs Foundation Configuration</a><ul><li><a href=#debug>DEBUG</a></li><li><a href=#borg-package-manage>Borg - Package manage</a></li><li><a href=#startup>Startup</a></li><li><a href=#variables>Variables</a></li><li><a href=#custom-file>Custom file</a></li><li><a href=#private-file>Private file</a></li><li><a href=#benchmark>Benchmark</a></li></ul></li><li><a href=#emacs-user-interface-delicious>Emacs User interface, DELICIOUS</a><ul><li><a href=#fonts>Fonts</a></li><li><a href=#icon>Icon</a></li><li><a href=#cursor>Cursor</a></li><li><a href=#themes>Themes</a></li><li><a href=#dashboard>Dashboard</a></li><li><a href=#define-fringe-bitmap>define-fringe-bitmap</a></li><li><a href=#rainbow-mode>rainbow-mode</a></li><li><a href=#helpful>helpful</a></li><li><a href=#info-colors>info-colors</a></li><li><a href=#goggles>goggles</a></li><li><a href=#emojify>emojify</a></li><li><a href=#centaur-tab>centaur-tab</a></li><li><a href=#awesome-tray>Awesome Tray</a></li><li><a href=#window-divider>window-divider</a></li><li><a href=#highlight-line>Highlight line</a></li><li><a href=#stem-reading-mode>stem-reading-mode</a></li><li><a href=#emacs-frame-management>Emacs frame management</a></li><li><a href=#benchmark>Benchmark</a></li></ul></li><li><a href=#powerful-emacs-equipped-with-builtin-packages>Powerful Emacs Equipped with Builtin Packages</a><ul><li><a href=#y-or-n-p>y-or-n-p</a></li><li><a href=#bell>bell</a></li><li><a href=#kill-ring>kill-ring</a></li><li><a href=#system-coding>system coding</a></li><li><a href=#paren>paren</a></li><li><a href=#elec-pair>elec-pair</a></li><li><a href=#line-number>line number</a></li><li><a href=#simple>simple</a></li><li><a href=#autorevert>autorevert</a></li><li><a href=#subword>subword</a></li><li><a href=#winner>winner</a></li><li><a href=#server>server</a></li><li><a href=#prettify-symbols-mode>prettify-symbols-mode</a></li><li><a href=#so-long>so-long</a></li><li><a href=#delsel>delsel</a></li><li><a href=#webjump>webjump</a></li><li><a href=#url>url</a></li><li><a href=#bookmark>bookmark</a></li><li><a href=#repeat>repeat</a></li><li><a href=#minibuffer>minibuffer</a></li><li><a href=#ibuffer>ibuffer</a></li><li><a href=#mouse-avoidance>mouse-avoidance</a></li><li><a href=#cursor-intangible>cursor-intangible</a></li><li><a href=#large-file>large file</a></li><li><a href=#benchmark>Benchmark</a></li></ul></li><li><a href=#awesome-emacs-equipped-with-third-party-packages>Awesome Emacs Equipped with Third-party Packages</a><ul><li><a href=#gcmh>gcmh</a></li><li><a href=#restart-emacs>restart-emacs</a></li><li><a href=#input-method>input method</a></li><li><a href=#autoinsert>autoinsert</a></li><li><a href=#embrace>embrace</a></li><li><a href=#recent-file>recent file</a></li><li><a href=#dired-mode>dired-mode</a></li><li><a href=#hungry-delete>hungry delete</a></li><li><a href=#save>save</a></li><li><a href=#undo-and-redo>undo&redo</a></li><li><a href=#completion-and-search-framework>Completion and search framework</a></li><li><a href=#dabbrev>dabbrev</a></li><li><a href=#cape>cape</a></li><li><a href=#tempel>tempel</a></li><li><a href=#imenu-list>imenu-list</a></li><li><a href=#open-with-safari>Open with Safari</a></li><li><a href=#benchmark>Benchmark</a></li></ul></li><li><a href=#emacs-works-with-multiple-language-piece-of-cake>Emacs Works with Multiple Language, PIECE OF CAKE</a><ul><li><a href=#language-spelling>Language Spelling</a></li><li><a href=#language-translate>Language Translate</a></li><li><a href=#language-format>Language Format</a></li><li><a href=#language-service-protocol>Language Service Protocol</a></li><li><a href=#multiple-programming-language>Multiple Programming Language</a></li><li><a href=#benchmark>Benchmark</a></li></ul></li><li><a href=#organize-life-with-plain-text>Organize Life With Plain Text</a><ul><li><a href=#better-default>Better Default</a></li><li><a href=#packages-enhance-org>Packages enhance org</a></li><li><a href=#note-taking>Note taking</a></li><li><a href=#bibtex-manage>Bibtex manage</a></li><li><a href=#tasks-manage>Tasks manage</a></li><li><a href=#finance-manage>Finance manage</a></li><li><a href=#org-export>Org Export</a></li><li><a href=#latex>Latex</a></li><li><a href=#benchmark>Benchmark</a></li></ul></li><li><a href=#emacs-can-do-more-applications>Emacs Can DO More, Applications</a><ul><li><a href=#pdf-reader>PDF Reader</a></li><li><a href=#git>GIT</a></li><li><a href=#eshell>eshell</a></li><li><a href=#rss-management>Rss management</a></li><li><a href=#email>Email</a></li><li><a href=#map-osm>Map osm</a></li><li><a href=#telegaram>Telegaram</a></li><li><a href=#proxy>Proxy</a></li><li><a href=#benchmark>Benchmark</a></li></ul></li><li><a href=#emacs-keybindings>Emacs Keybindings</a><ul><li><a href=#keyfreq>Keyfreq</a></li><li><a href=#meow>Meow</a></li><li><a href=#one-key-and-meow-leader-define-key>one-key and meow-leader-define-key</a></li><li><a href=#benchmark>Benchmark</a></li></ul></li></ul></nav></div></div><div class=content id=content><h2 id=introduction class=headerLink><a href=#introduction class=header-mark></a>Introduction</h2><h3 id=interface-show class=headerLink><a href=#interface-show class=header-mark></a>Interface Show</h3><figure><img src=/ox-hugo/interface.png width=1000px></figure><p>上面的图生成方式如下。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>magick convert -size 2880x1800 xc:black -fill white -draw <span class=s2>&#34;path &#39;M 0,100 C 1000,200 800,1600 2880,1700 V 1800 H 2880 V 0 H 0&#39;&#34;</span> mask.png
</span></span><span class=line><span class=cl>magick composite dark.png light.png mask.png -alpha Off shot.png
</span></span><span class=line><span class=cl>rm mask.png
</span></span></code></pre></div><h3 id=why-emacs class=headerLink><a href=#why-emacs class=header-mark></a>Why Emacs</h3><p>我是一个科技，数字爱好者，电子产品在我的生活中起着重要的作用。本人前前后后尝试过多种的软件来参与到自己的个人事务管理当中。在遇到 Emacs 之前，在各系统中最喜欢尝鲜，每当遇到一个新的应用，总是会主动去试用。每当试用一个新的软件时，总是认为它会很有用。但是这么长时间以来，高效的软件在多年的使用中留下来的很少。直到我遇到了 Emacs ，不愧是伪装成操作系统的软件。</p><p>现在是个电子的时代，试用的软件多了，对于软件的隐私性保护持保留的态度。虽然现在是网上无个人隐私可言，但是我还是不想把自己的信息随便给别人。Emacs 是一个本地的软件，所有的数据只在本地，数据永远在自己的手中。</p><p>对于一个非专业的程序员，使用 Emacs 这个文本编辑器对自己的生活进行方方面面的管理，简直是 AWESOME ，很好很强大。</p><p></p><figure><img src=/ox-hugo/emacscando.png alt="Figure 1: What Emacs can do" width=500px><figcaption><p>Figure 1: What Emacs can do</p></figcaption></figure><p>Emacs 具有强大的生态，可以进行文件管理，财务管理，事务管理，邮件管理，还可以用来听音乐，看视频。</p><p>从这个角度看， Emacs 和 Vim 是这个时代很强大的软件。所以为什么不用 Vim 呢？在 Emacs 中目前有比 Evil 更好用的模式编辑 Meow 。</p><p>其他人的使用见解， <a href=https://github.com/remacs/remacs#why-emacs target=_blank rel="noopener noreffer">brotzeit</a> 。</p><h3 id=how-i-manage-my-packages class=headerLink><a href=#how-i-manage-my-packages class=header-mark></a>How I manage my packages</h3><p>我尝试过的 Emacs 配置方式有多种。最开始时用的是将所有的配置文件放到 init.el 文件中，后来是学习了别人的配置方法，将配置分解到以 <code>init-</code> 为前缀的多个子文件中，现在我使用 org-mode （见<a href=https://en.wikipedia.org/wiki/Literate_programming target=_blank rel="noopener noreffer">文学编程</a>）管理自己的 Emacs 配置。</p><p>使用 org-mode 管理自己的配置文件也经历了多个阶段。最开始是直接写在 org 文档中，加载 Emacs 的时候，自动检测该文件的状态，自动解析 org 文档到 el 文件中，这种方式导致 Emacs 启动较慢。后来使用命令在关闭 Emacs 时将 org 文档 tangle 到 el 文件中。现在我使用 org-auto-tangle 这个包，当配置文件发生变动时就自动的 tangle 配置文档。</p><p>原来我将 org 文档 tangle 到多个以 <code>init-</code> 为前缀的子文件中，这样的好处是，可以使用 git 对配置进行更精细化的版本管理。但是在尝试了用了几次后，发现，Emacs 的启动速度慢了很多。</p><p>使用 git 进行版本管理，我很少使用 reset 等功能，我的目的是看到自己更改的理由。因为经常在多种配置方法中来回横跳。</p><p>使用 <code>:tangle</code> 将配置的不同部分解析到不同的文件中。在这部分中指定文件夹的路径和文件名。</p><p>使用 <code>:shebang</code> 添加 <code>lexical-binding</code> 。关于 lexical-binding 的作用见 <a href=https://nullprogram.com/blog/2016/12/22/ target=_blank rel="noopener noreffer">Make Emacs run (slightly) faster with lexical binding</a> . 或者 <a href=http://www.yinwang.org/blog-cn/2013/03/26/lisp-dead-alive target=_blank rel="noopener noreffer">Lisp 已死，Lisp 万岁！</a></p><p>顶层的节点使用 <code>C-c C-x p</code> 添加 properties ，使用的是 header-args 这个。</p><h3 id=about-note-taking class=headerLink><a href=#about-note-taking class=header-mark></a>About note taking</h3><p><code>笔记的作用</code> ：存储信息、帮助思考和理解信息、创造知识之间的链接。大脑的优势在于思考，而不是信息的存储。当下最火的笔记管理方式非 Zettelkasten 默属。关于 Zettelkasten 的概念可以看 How to take smart notes 这本书。</p><p>我使用过的笔记软件有很多，在遇到 Emacs 前，尝试过的有 PKM 软件， Mediawiki ， Tiddly wiki ， Onenote ，印象笔记，蚂蚁笔记， Simplenote ， Joplin 等等。Onenote 是私有格式，意味着当我需要夸平台时，其专有格式会给我带来麻烦。印象笔记也是如此，而且印象笔记的付费一言难尽。在这些软件中来回尝试了多次之后，发现没有一个能长久使用的，或多或少的存在痛点。</p><p>在了解过 markdown ， org-mode 等概念后，结合以上软件的使用体验，我确立了对于笔记管理的要求：​<strong>本地储存，格式可控</strong> 。这个要求 markdown 和 org-mode 都可以满足，这两种语言之上都有着相对应的软件实现， obsidian 和 org-roam 。当然除了 org-roam 之外，还有其他的实现，但是我只使用 org-roam 。</p><p>Org-mode 相比 markdown ，特性还是要丰富很多， markdown 相对比较简陋。 org-mode 写完之后可以根据需要将其转化为其他的格式，我需要的如 html，docx，latex 。</p><p>Org-mode 是 Emacs 上最强大的笔记应用，如果不是为了进行笔记管理，我很大概率是不使用 Emacs 的（难调较，需要大量的时间，众多的特性中迷失自我）。</p><h3 id=acknowledgements class=headerLink><a href=#acknowledgements class=header-mark></a>Acknowledgements</h3><blockquote><p>If I have seen further, it is by standing on the shoulders of giants. &mdash;- Sir Isaac Newton</p></blockquote><p>谢谢以下配置的作者，从他们那学到了很多关于 Emacs 的知识。排名不分先后。</p><ul><li><a href=https://github.com/bbatsov/prelude target=_blank rel="noopener noreffer">https://github.com/bbatsov/prelude</a></li><li><a href=https://github.com/syl20bnr/spacemacs target=_blank rel="noopener noreffer">https://github.com/syl20bnr/spacemacs</a></li><li><a href=https://github.com/seagle0128/.emacs.d target=_blank rel="noopener noreffer">https://github.com/seagle0128/.emacs.d</a></li><li><a href=https://github.com/hlissner/doom-emacs target=_blank rel="noopener noreffer">https://github.com/hlissner/doom-emacs</a></li><li><a href=https://github.com/remacs/remacs target=_blank rel="noopener noreffer">https://github.com/remacs/remacs</a></li><li><a href=https://github.com/redguardtoo/emacs.d target=_blank rel="noopener noreffer">https://github.com/redguardtoo/emacs.d</a></li><li><a href=https://github.com/manateelazycat/lazycat-emacs target=_blank rel="noopener noreffer">https://github.com/manateelazycat/lazycat-emacs</a></li><li><a href=https://github.com/purcell/emacs.d target=_blank rel="noopener noreffer">https://github.com/purcell/emacs.d</a></li><li><a href=https://github.com/MatthewZMD/.emacs.d target=_blank rel="noopener noreffer">https://github.com/MatthewZMD/.emacs.d</a></li><li><a href=https://sachachua.com/dotemacs/ target=_blank rel="noopener noreffer">https://sachachua.com/dotemacs/</a></li><li><a href=https://github.com/raxod502/radian target=_blank rel="noopener noreffer">https://github.com/raxod502/radian</a></li><li><a href=https://tecosaur.github.io/emacs-config/config.html target=_blank rel="noopener noreffer">https://tecosaur.github.io/emacs-config/config.html</a></li></ul><h2 id=the-early-init-file class=headerLink><a href=#the-early-init-file class=header-mark></a>The Early Init File</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=c1>;;; early-init.el --- Early Init File -*- lexical-binding: t; no-byte-compile: t -*-</span>
</span></span><span class=line><span class=cl><span class=c1>;; Defer garbage collection further back in the startup process</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>gc-cons-threshold</span> <span class=nv>most-positive-fixnum</span>
</span></span><span class=line><span class=cl>      <span class=nv>gc-cons-percentage</span> <span class=mf>0.6</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>;; In Emacs 27+, package initialization occurs before `user-init-file&#39; is</span>
</span></span><span class=line><span class=cl><span class=c1>;; loaded, but after `early-init-file&#39;. Doom handles package initialization, so</span>
</span></span><span class=line><span class=cl><span class=c1>;; we must prevent Emacs from doing it early!</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>package-enable-at-startup</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>;; Do not allow loading from the package cache (same reason).</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>package-quickstart</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>;; Prevent the glimpse of un-styled Emacs by disabling these UI elements early.</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>inhibit-startup-message</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>inhibit-splash-screen</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>push</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>menu-bar-lines</span> <span class=o>.</span> <span class=mi>0</span><span class=p>)</span> <span class=nv>default-frame-alist</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>push</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>tool-bar-lines</span> <span class=o>.</span> <span class=mi>0</span><span class=p>)</span> <span class=nv>default-frame-alist</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>push</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>vertical-scroll-bars</span><span class=p>)</span> <span class=nv>default-frame-alist</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>;; Resizing the Emacs frame can be a terribly expensive part of changing the</span>
</span></span><span class=line><span class=cl><span class=c1>;; font. By inhibiting this, we easily halve startup times with fonts that are</span>
</span></span><span class=line><span class=cl><span class=c1>;; larger than the system default.</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>frame-inhibit-implied-resize</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>inhibit-compacting-font-caches</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>use-file-dialog</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>use-dialog-box</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>;; Make the initial buffer load faster by setting its mode to fundamental-mode</span>
</span></span><span class=line><span class=cl><span class=c1>;; (setq initial-major-mode &#39;fundamental-mode)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>;; Prevent unwanted runtime builds in gccemacs (native-comp); packages are</span>
</span></span><span class=line><span class=cl><span class=c1>;; compiled ahead-of-time when they are installed and site files are compiled</span>
</span></span><span class=line><span class=cl><span class=c1>;; when gccemacs is installed.</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>comp-deferred-compilation</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>;; Disable mode-line, It&#39;s uglily after theme changed</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq-default</span> <span class=nv>mode-line-format</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>;;; early-init.el ends here</span>
</span></span></code></pre></div><h2 id=emacs-foundation-configuration class=headerLink><a href=#emacs-foundation-configuration class=header-mark></a>Emacs Foundation Configuration</h2><blockquote><p>其安易持，其未兆易谋；其脆易泮，其微易散。为之于未有，治之于未乱。合抱之木，生于毫末；九层之台，起于累土；千里之行，始于足下。 &ndash; 老子</p></blockquote><p>这部分是 Emacs 的最基础配置，包含了文件的管理方式，Emacs 的快速启动，自定义的变量，以及 custom 文件。这些配置是其他配置的基石。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=c1>;; init.el --- My personal emacs configuration -*- lexical-binding: t; -*-</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defvar</span> <span class=nv>my/init-start-time</span> <span class=p>(</span><span class=nf>current-time</span><span class=p>)</span> <span class=s>&#34;Time when init.el was started&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defvar</span> <span class=nv>my/section-start-time</span> <span class=p>(</span><span class=nf>current-time</span><span class=p>)</span> <span class=s>&#34;Time when section was started&#34;</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=debug class=headerLink><a href=#debug class=header-mark></a>DEBUG</h3><p>当需要对 Emacs 的配置进行错误检测时打开，但是基本不需要在配置中写这部分。没启动的时候可以使用 <code>--debug-init</code> ，启动后可以手动开启 debug 。正常使用 Emacs 时也会触发一些错误，这时候弹出 error 窗口就很烦。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>toggle-debug-on-error</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=borg-package-manage class=headerLink><a href=#borg-package-manage class=header-mark></a>Borg - Package manage</h3><blockquote><p>The Borg assimilate Emacs packages as Git submodules.</p></blockquote><p>我尝试的 Emacs 包管理方法有 <code>package.el</code> <code>straight.el</code> <code>git submodule</code> <code>borg.el</code> 。最终停留在了 borg 上，使用 <a href=https://github.com/emacscollective/borg target=_blank rel="noopener noreffer">borg</a> 进行 Emacs 包的管理。关于此包的详细的使用方法见 borg <a href=https://emacsmirror.net/manual/borg/ target=_blank rel="noopener noreffer">官方手册</a>。</p><p>使用 borg 管理有个好处是， borg-assimilate 后的包和 Emacs 的内置包一样，不需要使用 use-package 或 leaf 此类包对配置文件进行包裹。不会增超 Emacs 的启动时间，我目前有一百多个包，启动时间在 <del>1.6s</del> 0.7s 左右（ Arch Emacs 28.1 ）。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;load-path</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;packages/borg&#34;</span> <span class=nv>user-emacs-directory</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>eval-and-compile</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>require</span> <span class=ss>&#39;borg</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>borg-initialize</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=how-to-install-packages class=headerLink><a href=#how-to-install-packages class=header-mark></a>How to install packages</h4><p>一般的流程是使用 <code>epkg-describe-package</code> 查看包的依赖，然后直接使用 <code>borg-assimilate</code> 命令安装包。或者先使用 <code>borg-clone</code> 命令克隆包到本地，然后使用 <code>borg-build</code> 对包进行编译安装。</p><p>但是我一般直接使用 <code>borg assimilate</code> 命令安装某个包，之后跟据 <code>*Borg Build*</code> buffer 的提示安装相应依赖包。重复上述的步骤，即可安装所有包。</p><p>如果一个包并不在 melpa 上，就需要到 github 上获取链接。</p><p>重新 build 一个前可以对 .gitmodules 进行编辑，下面给出示例：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>[submodule &#34;magit&#34;]
</span></span><span class=line><span class=cl>	path = packages/magit
</span></span><span class=line><span class=cl>	url = git@github.com:magit/magit.git
</span></span><span class=line><span class=cl>	no-byte-compile = lisp/magit-libgit.el
</span></span><span class=line><span class=cl>	recursive-byte-compile = true
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>[submodule &#34;auctex&#34;]
</span></span><span class=line><span class=cl>	path = packages/auctex
</span></span><span class=line><span class=cl>	url = git@github.com:emacsmirror/auctex.git
</span></span><span class=line><span class=cl>	build-step = ./autogen.sh
</span></span><span class=line><span class=cl>	build-step = ./configure --with-texmf-dir=$HOME/texmf
</span></span><span class=line><span class=cl>	build-step = make
</span></span><span class=line><span class=cl>	build-step = sudo make install
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>[submodule &#34;corfu&#34;]
</span></span><span class=line><span class=cl>	path = packages/corfu
</span></span><span class=line><span class=cl>	url = git@github.com:minad/corfu.git
</span></span><span class=line><span class=cl>	load-path = .
</span></span><span class=line><span class=cl>	load-path = ./extensions
</span></span></code></pre></div><p>简单说明：如果不想 compile 一个包就使用 no-byte-compile 选项。比如，我不使用 helm 插件，有些包提供了关于 helm 的支持，此时我就可以不 compile 对应的文件，那么 Emacs 就不会加载这些配置。</p><h4 id=how-to-upgrade-packages class=headerLink><a href=#how-to-upgrade-packages class=header-mark></a>How to upgrade packages</h4><p>Borg 升级包，可以在 magit 界面中进行，按 <code>f m</code> 获取 submodule 的更新，展开 <code>Modules</code> 可以看到 <code>Modules unpulled</code> ，进入相应的包中的 magit 界面，通过按 <code>SPC k</code> 删除 <code>Untracked files</code> ，然后按 <code>m</code> merge 配置。最后使用 <code>borg-build</code> 重新 build 包即可升级相应的包。</p><h3 id=startup class=headerLink><a href=#startup class=header-mark></a>Startup</h3><h4 id=start-speedup class=headerLink><a href=#start-speedup class=header-mark></a>Start Speedup</h4><p>该配置来自 <a href=https://github.com/seagle0128/.emacs.d/blob/master/init.el target=_blank rel="noopener noreffer">Centaur Emacs</a> ，可以有效减少 Emacs 的启动时间，约 0.5s 。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>auto-mode-case-fold</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>unless</span> <span class=p>(</span><span class=nb>or</span> <span class=p>(</span><span class=nf>daemonp</span><span class=p>)</span> <span class=nv>noninteractive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>old-file-name-handler-alist</span> <span class=nv>file-name-handler-alist</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=c1>;; If `file-name-handler-alist&#39; is nil, no 256 colors in TUI</span>
</span></span><span class=line><span class=cl>    <span class=c1>;; @see https://emacs-china.org/t/spacemacs-centaur-emacs/3802/839</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>setq</span> <span class=nv>file-name-handler-alist</span>
</span></span><span class=line><span class=cl>	  <span class=p>(</span><span class=nb>unless</span> <span class=p>(</span><span class=nv>display-graphic-p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	    <span class=o>&#39;</span><span class=p>((</span><span class=s>&#34;\\(?:\\.tzst\\|\\.zst\\|\\.dz\\|\\.txz\\|\\.xz\\|\\.lzma\\|\\.lz\\|\\.g?z\\|\\.\\(?:tgz\\|svgz\\|sifz\\)\\|\\.tbz2?\\|\\.bz2\\|\\.Z\\)\\(?:~\\|\\.~[-[:alnum:]:#@^._]+\\(?:~[[:digit:]]+\\)?~\\)?\\&#39;&#34;</span> <span class=o>.</span> <span class=nv>jka-compr-handler</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;emacs-startup-hook</span>
</span></span><span class=line><span class=cl>	      <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>		<span class=s>&#34;Recover file name handlers.&#34;</span>
</span></span><span class=line><span class=cl>		<span class=p>(</span><span class=nb>setq</span> <span class=nv>file-name-handler-alist</span>
</span></span><span class=line><span class=cl>		      <span class=p>(</span><span class=nv>delete-dups</span> <span class=p>(</span><span class=nf>append</span> <span class=nv>file-name-handler-alist</span>
</span></span><span class=line><span class=cl>					   <span class=nv>old-file-name-handler-alist</span><span class=p>)))))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>gc-cons-threshold</span> <span class=nv>most-positive-fixnum</span>
</span></span><span class=line><span class=cl>      <span class=nv>gc-cons-percentage</span> <span class=mf>0.5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;emacs-startup-hook</span>
</span></span><span class=line><span class=cl>	  <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>	    <span class=s>&#34;Recover GC values after startup.&#34;</span>
</span></span><span class=line><span class=cl>	    <span class=p>(</span><span class=nb>setq</span> <span class=nv>gc-cons-threshold</span> <span class=mi>800000</span>
</span></span><span class=line><span class=cl>		  <span class=nv>gc-cons-percentage</span> <span class=mf>0.1</span><span class=p>)))</span>
</span></span></code></pre></div><h4 id=utility-hooks-and-functions class=headerLink><a href=#utility-hooks-and-functions class=header-mark></a>Utility hooks and functions</h4><blockquote><p>This package exposes a number of utility hooks and functions ported from Doom Emacs. The hooks make it easier to speed up Emacs startup by providing finer-grained control of the timing at which packages are loaded.</p></blockquote><p>按照这个包的说明，是用于更精细化的管理包的加载，以便加快 Emacs 的启动速度。
目前对于其的作用理解不是很深，如果需要深入理解需要对 Emacs 的启动步骤进行研究。</p><p>目前使用 <code>after-init-hook</code> 也行。此包提供的几个 hook 也能用， <code>on-first-file-hook</code> 用于当打开第一个文件的时候执行对应用的任务， <code>on-first-input-hook</code> 用于按键被触发后执行对应的任务， <code>on-first-buffer-hook</code> 用于第一个 buffer 被创建时执行对应的任务。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>require</span> <span class=ss>&#39;on</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=fullscreen class=headerLink><a href=#fullscreen class=header-mark></a>Fullscreen</h4><p>我总是全屏使用 Emacs，但是 Macos 上有些问题。以下的说明来自<a href="https://github.com/manateelazycat?tab=repositories" target=_blank rel="noopener noreffer">Andy Stewart</a> 。</p><blockquote><p>在Mac平台, Emacs不能进入Mac原生的全屏模式,否则会导致 `make-frame&rsquo; 创建时也集成原生全屏属性后造成白屏和左右滑动现象.
所以先设置 `ns-use-native-fullscreen&rsquo; 和 `ns-use-fullscreen-animation&rsquo; 禁止Emacs使用Mac原生的全屏模式.
而是采用传统的全屏模式, 传统的全屏模式, 只会在当前工作区全屏,而不是切换到Mac那种单独的全屏工作区,
这样执行 `make-frame&rsquo; 先关代码或插件时,就不会因为Mac单独工作区左右滑动产生的bug.</p><p>Mac平台下,不能直接使用 `set-frame-parameter&rsquo; 和 `fullboth&rsquo; 来设置全屏,
那样也会导致Mac窗口管理器直接把Emacs窗口扔到单独的工作区, 从而对 `make-frame&rsquo; 产生同样的Bug.
所以, 启动的时候通过 `set-frame-parameter&rsquo; 和 `maximized&rsquo; 先设置Emacs为最大化窗口状态, 启动5秒以后再设置成全屏状态,
Mac就不会移动Emacs窗口到单独的工作区, 最终解决Mac平台下原生全屏窗口导致 `make-frame&rsquo; 左右滑动闪烁的问题.</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nb>featurep</span> <span class=ss>&#39;cocoa</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>progn</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>setq</span> <span class=nv>ns-use-native-fullscreen</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>setq</span> <span class=nv>ns-use-fullscreen-animation</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>set-frame-parameter</span> <span class=p>(</span><span class=nf>selected-frame</span><span class=p>)</span> <span class=ss>&#39;fullscreen</span> <span class=ss>&#39;maximized</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>run-at-time</span> <span class=mi>2</span> <span class=no>nil</span>
</span></span><span class=line><span class=cl>		   <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>		     <span class=p>(</span><span class=nv>toggle-frame-fullscreen</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>toggle-frame-fullscreen</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=variables class=headerLink><a href=#variables class=header-mark></a>Variables</h3><p>自定义一些变量，方便配置文件位置或争对特定系统进行相关设定。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defvar</span> <span class=nv>my-cloud</span> <span class=s>&#34;~/Nextcloud&#34;</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;This folder is My cloud.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defvar</span> <span class=nv>my-galaxy</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;L.Personal.Galaxy&#34;</span> <span class=nv>my-cloud</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;This folder stores all the plain text files of my life.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defvar</span> <span class=nv>my-roam</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;roam&#34;</span> <span class=nv>my-galaxy</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;This is the org-roam folder.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defvar</span> <span class=nv>my-finance</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;finance&#34;</span> <span class=nv>my-galaxy</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;This folder stores all my finance files.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defvar</span> <span class=nv>my-finance-year</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=p>(</span><span class=nf>format-time-string</span> <span class=s>&#34;%Y&#34;</span><span class=p>)</span> <span class=nv>my-finance</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;This folder stores all my finance files of current year.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defvar</span> <span class=nv>my-pdf-storage</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;storage/pdf&#34;</span> <span class=nv>my-galaxy</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;This folder stores all the pdf files.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defvar</span> <span class=nv>my-cache-directory</span> <span class=s>&#34;~/.cache/emacs&#34;</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;This folder stores all EMACS cache file.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defvar</span> <span class=nv>my-template-directory</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;template&#34;</span> <span class=p>(</span><span class=nv>file-truename</span> <span class=nv>user-emacs-directory</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defvar</span> <span class=nv>default-search-engine-url</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;Google&#34;</span> <span class=s>&#34;www.google.com&#34;</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=custom-file class=headerLink><a href=#custom-file class=header-mark></a>Custom file</h3><p>Emacs 有时会将一些配置自动导入到此文件中。如果不配置，它会自动将配置附加到 init.el 文件中。我不喜欢这个文件，当其出现的时候，我会手动删除。也许可以写个 function 自动执行。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>custom-file</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;custom.el&#34;</span> <span class=nv>user-emacs-directory</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nf>load</span> <span class=nv>custom-file</span> <span class=no>t</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=private-file class=headerLink><a href=#private-file class=header-mark></a>Private file</h3><p>私有配置分开存放，不进行同步。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>private-file</span> <span class=s>&#34;~/.emacs.d/private.el&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nf>load</span> <span class=nv>private-file</span> <span class=no>t</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=benchmark class=headerLink><a href=#benchmark class=header-mark></a>Benchmark</h3><p>Emacs Foundation Configuration 启动时间约 0.19s 。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nf>message</span> <span class=s>&#34;Emacs Foundation Configuration: %.2fs&#34;</span>
</span></span><span class=line><span class=cl>	 <span class=p>(</span><span class=nf>float-time</span> <span class=p>(</span><span class=nf>time-subtract</span> <span class=p>(</span><span class=nf>current-time</span><span class=p>)</span> <span class=nv>my/section-start-time</span><span class=p>)))</span>
</span></span></code></pre></div><h2 id=emacs-user-interface-delicious class=headerLink><a href=#emacs-user-interface-delicious class=header-mark></a>Emacs User interface, DELICIOUS</h2><p>Emacs 中视觉相关的配置基本都在这里了，目前我喜欢极简的界面。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>my/section-start-time</span> <span class=p>(</span><span class=nf>current-time</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=fonts class=headerLink><a href=#fonts class=header-mark></a>Fonts</h3><p>对于字体的选择有 Iosevka Fixed，Fantasque Sans Mono，Sarasa Mono SC，HarmonyOS Sans SC，Source Han Serif SC。</p><p>设置字体的两种方式：一种是通过 set-fongset-fong 设置中文字体，另外一种是设置 fixed-pitch 和 variable-pitch 字体，开启 variable-pitch-mode 。</p><p>另外结合 <a href=#modus-themes rel>modus-themes</a> ，通过设置 modus-themes-mixed-pitch 可以在 org-table org-block 等环境中使用固定宽度的字体。</p><p>尝试使用了几天后，发现开启 variable-pitch-mode 之后，光标的宽度变的很细，看起来很不舒服。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>set-face-attribute</span> <span class=ss>&#39;default</span> <span class=no>nil</span> <span class=nb>:family</span> <span class=s>&#34;Iosevka Fixed&#34;</span> <span class=nb>:weight</span> <span class=ss>&#39;regular</span> <span class=nb>:height</span> <span class=mi>160</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>set-face-attribute</span> <span class=ss>&#39;fixed-pitch</span> <span class=no>nil</span> <span class=nb>:family</span> <span class=s>&#34;Iosevka Fixed&#34;</span> <span class=nb>:weight</span> <span class=ss>&#39;regular</span> <span class=nb>:height</span> <span class=mi>180</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>set-face-attribute</span> <span class=ss>&#39;variable-pitch</span> <span class=no>nil</span> <span class=nb>:family</span> <span class=s>&#34;Source Han Serif SC&#34;</span> <span class=nb>:weight</span> <span class=ss>&#39;regular</span> <span class=nb>:height</span> <span class=mi>160</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>;; (set-fontset-font t &#39;unicode (font-spec :family &#34;all-the-icons&#34;) nil &#39;prepend)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nf>set-fontset-font</span> <span class=no>t</span> <span class=ss>&#39;unicode</span> <span class=s>&#34;Apple Color Emoji&#34;</span> <span class=no>nil</span> <span class=ss>&#39;prepend</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nf>set-fontset-font</span> <span class=no>t</span> <span class=ss>&#39;unicode</span> <span class=p>(</span><span class=nf>font-spec</span> <span class=nb>:family</span> <span class=s>&#34;Material Icons&#34;</span><span class=p>)</span> <span class=no>nil</span> <span class=ss>&#39;prepend</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nf>set-fontset-font</span> <span class=no>t</span> <span class=ss>&#39;unicode</span> <span class=p>(</span><span class=nf>font-spec</span> <span class=nb>:family</span> <span class=s>&#34;file-icons&#34;</span><span class=p>)</span> <span class=no>nil</span> <span class=ss>&#39;prepend</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>;; 言总是被替换成 file-icons 中的图标，强制其使用 Source Han Serif SC 这个字体</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nf>set-fontset-font</span> <span class=no>t</span> <span class=o>&#39;</span><span class=p>(</span><span class=mh>#x8a00</span> <span class=o>.</span> <span class=mh>#x8a00</span><span class=p>)</span> <span class=p>(</span><span class=nf>font-spec</span> <span class=nb>:family</span> <span class=s>&#34;Source Han Serif SC&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=c1>;; (set-fontset-font t &#39;unicode (font-spec :family &#34;github-octicons&#34;) nil &#39;prepend)</span>
</span></span><span class=line><span class=cl><span class=c1>;; (set-fontset-font t &#39;unicode (font-spec :family &#34;FontAwesome&#34;) nil &#39;prepend)</span>
</span></span><span class=line><span class=cl><span class=c1>;; (set-fontset-font t &#39;unicode (font-spec :family &#34;Weather Icons&#34;) nil &#39;prepend)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>modus-themes-mixed-fonts</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;text-mode-hook</span> <span class=ss>&#39;variable-pitch-mode</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>set-face-attribute</span> <span class=ss>&#39;default</span> <span class=no>nil</span> <span class=nb>:family</span> <span class=s>&#34;Iosevka Fixed&#34;</span> <span class=nb>:weight</span> <span class=ss>&#39;regular</span> <span class=nb>:height</span> <span class=mi>160</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nf>set-fontset-font</span> <span class=no>t</span> <span class=ss>&#39;han</span> <span class=p>(</span><span class=nf>font-spec</span> <span class=nb>:name</span> <span class=s>&#34;Source Han Serif SC&#34;</span> <span class=nb>:weight</span> <span class=ss>&#39;regular</span> <span class=nb>:height</span> <span class=mi>160</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nf>set-fontset-font</span> <span class=no>t</span> <span class=ss>&#39;cjk-misc</span> <span class=p>(</span><span class=nf>font-spec</span> <span class=nb>:name</span> <span class=s>&#34;Source Han Serif SC&#34;</span> <span class=nb>:weight</span> <span class=ss>&#39;regular</span> <span class=nb>:height</span> <span class=mi>160</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>;; (set-fontset-font t &#39;unicode (font-spec :family &#34;all-the-icons&#34;) nil &#39;prepend)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nf>set-fontset-font</span> <span class=no>t</span> <span class=ss>&#39;unicode</span> <span class=s>&#34;Apple Color Emoji&#34;</span> <span class=no>nil</span> <span class=ss>&#39;prepend</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nf>set-fontset-font</span> <span class=no>t</span> <span class=ss>&#39;unicode</span> <span class=p>(</span><span class=nf>font-spec</span> <span class=nb>:family</span> <span class=s>&#34;Material Icons&#34;</span><span class=p>)</span> <span class=no>nil</span> <span class=ss>&#39;prepend</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nf>set-fontset-font</span> <span class=no>t</span> <span class=ss>&#39;unicode</span> <span class=p>(</span><span class=nf>font-spec</span> <span class=nb>:family</span> <span class=s>&#34;file-icons&#34;</span><span class=p>)</span> <span class=no>nil</span> <span class=ss>&#39;prepend</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>;; 言总是被替换成 file-icons 中的图标，强制其使用 Source Han Serif SC 这个字体</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nf>set-fontset-font</span> <span class=no>t</span> <span class=o>&#39;</span><span class=p>(</span><span class=mh>#x8a00</span> <span class=o>.</span> <span class=mh>#x8a00</span><span class=p>)</span> <span class=p>(</span><span class=nf>font-spec</span> <span class=nb>:family</span> <span class=s>&#34;Source Han Serif SC&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=c1>;; (set-fontset-font t &#39;unicode (font-spec :family &#34;github-octicons&#34;) nil &#39;prepend)</span>
</span></span><span class=line><span class=cl><span class=c1>;; (set-fontset-font t &#39;unicode (font-spec :family &#34;FontAwesome&#34;) nil &#39;prepend)</span>
</span></span><span class=line><span class=cl><span class=c1>;; (set-fontset-font t &#39;unicode (font-spec :family &#34;Weather Icons&#34;) nil &#39;prepend)</span>
</span></span></code></pre></div><h3 id=icon class=headerLink><a href=#icon class=header-mark></a>Icon</h3><h4 id=all-the-icons class=headerLink><a href=#all-the-icons class=header-mark></a>all-the-icons</h4><p>可以使 Emacs 显示 icon ，看上去更像是一个现代的编辑器。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>require</span> <span class=ss>&#39;all-the-icons</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=all-the-icons-completion class=headerLink><a href=#all-the-icons-completion class=header-mark></a>all-the-icons-completion</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=c1>;; (all-the-icons-completion-mode)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;vertico-mode-hook</span> <span class=ss>&#39;all-the-icons-completion-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=cursor class=headerLink><a href=#cursor class=header-mark></a>Cursor</h3><p>因为我不使用 modeline 当有多个 buffer 的时候会不知道当前处于哪个 buffer 中，所以关闭其他窗口中的光标，这样哪个 buffer 中有光标，哪个 buffer 就处于活动状态。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>blink-cursor-mode</span> <span class=mi>-1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq-default</span> <span class=nv>cursor-in-non-selected-windows</span> <span class=no>nil</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=cursor-color class=headerLink><a href=#cursor-color class=header-mark></a>cursor color</h4><p>我 Fork 了 <a href=https://github.com/Jousimies/im-cursor-chg target=_blank rel="noopener noreffer">im-cursor-chg</a> 这个包，对其做了一些修改，以实现主题切换时能自动切换光标颜色。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>im-cursor-color</span> <span class=s>&#34;orange&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;after-init-hook</span> <span class=ss>&#39;cursor-chg-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=themes class=headerLink><a href=#themes class=header-mark></a>Themes</h3><h4 id=modus-themes class=headerLink><a href=#modus-themes class=header-mark></a>modus-themes</h4><p>我的默认主题是 modus-themes ，有黑白配色两套。这个包的自定义性特别高，详细的设置见<a href=https://protesilaos.com/emacs/modus-themes target=_blank rel="noopener noreffer">官方手册</a>。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>modus-themes-italic-constructs</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>      <span class=nv>modus-themes-bold-constructs</span> <span class=no>nil</span>
</span></span><span class=line><span class=cl>      <span class=nv>modus-themes-region</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>bg-only</span> <span class=nv>no-extend</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=nv>modus-themes-lang-checkers</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>background</span> <span class=nv>text-also</span> <span class=nv>straight-underline</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=nv>modus-themes-links</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>italic</span> <span class=nv>background</span> <span class=nv>faint</span> <span class=nv>neutral-underline</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=nv>modus-themes-hl-line</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>intense</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=nv>modus-themes-paren-match</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>intense</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=nv>modus-themes-prompts</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>intense</span> <span class=nv>background</span> <span class=nv>gray</span> <span class=nv>bold</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=nv>modus-themes-completions</span> <span class=o>&#39;</span><span class=p>((</span><span class=nv>matches</span> <span class=o>.</span> <span class=p>(</span><span class=nv>extrabold</span> <span class=nv>intense</span><span class=p>))</span>
</span></span><span class=line><span class=cl>				 <span class=p>(</span><span class=nv>selection</span> <span class=o>.</span> <span class=p>(</span><span class=nv>underline</span><span class=p>))</span>
</span></span><span class=line><span class=cl>				 <span class=p>(</span><span class=nv>popup</span> <span class=o>.</span> <span class=p>(</span><span class=nv>intense</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>      <span class=nv>modus-themes-org-blocks</span> <span class=ss>&#39;tinted-background</span>
</span></span><span class=line><span class=cl>      <span class=nv>modus-themes-org-agenda</span> <span class=o>&#39;</span><span class=p>((</span><span class=nv>header-block</span> <span class=o>.</span> <span class=p>(</span><span class=nv>variable-pitch</span> <span class=mf>1.2</span><span class=p>))</span>
</span></span><span class=line><span class=cl>				<span class=p>(</span><span class=nv>habit</span> <span class=o>.</span> <span class=nv>traffic-light</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=nv>modus-themes-headings</span> <span class=o>&#39;</span><span class=p>((</span><span class=no>t</span> <span class=o>.</span> <span class=p>(</span><span class=nv>rainbow</span><span class=p>))))</span>
</span></span></code></pre></div><h4 id=override-color-for-distraction-free class=headerLink><a href=#override-color-for-distraction-free class=header-mark></a>Override color for distraction free</h4><p>Modus-theme 的主题色有些我还是不喜欢，根据自己的喜好更改了一些颜色设置。</p><p>其中 <code>bg-main</code> <code>bg-dim</code> 控制背景色。 <code>magenta-nuanced-bg</code> 控制 <code>org-src block</code> 的背景色。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>modus-themes-operandi-color-overrides</span> <span class=o>&#39;</span><span class=p>((</span><span class=nv>bg-main</span> <span class=o>.</span> <span class=s>&#34;#FFFFFF&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>					      <span class=p>(</span><span class=nv>bg-dim</span> <span class=o>.</span> <span class=s>&#34;#FFFFFF&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>					      <span class=p>(</span><span class=nv>bg-hl-line</span> <span class=o>.</span> <span class=s>&#34;#FFFFFF&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>					      <span class=p>(</span><span class=nv>bg-active</span> <span class=o>.</span> <span class=s>&#34;#FFFFFF&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>					      <span class=p>(</span><span class=nv>bg-inactive</span> <span class=o>.</span> <span class=s>&#34;#FFFFFF&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>					      <span class=p>(</span><span class=nv>bg-tab-bar</span> <span class=o>.</span> <span class=s>&#34;#FFFFFF&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>					      <span class=p>(</span><span class=nv>bg-tab-active</span> <span class=o>.</span> <span class=s>&#34;#FFFFFF&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>					      <span class=p>(</span><span class=nv>bg-tab-inactive</span> <span class=o>.</span> <span class=s>&#34;#FFFFFF&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>					      <span class=p>(</span><span class=nv>blue</span> <span class=o>.</span> <span class=s>&#34;#252321&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>					      <span class=p>(</span><span class=nv>magenta-nuanced-bg</span> <span class=o>.</span> <span class=s>&#34;#F2F0EF&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>modus-themes-vivendi-color-overrides</span> <span class=o>&#39;</span><span class=p>((</span><span class=nv>bg-main</span> <span class=o>.</span> <span class=s>&#34;#0F1116&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>					     <span class=p>(</span><span class=nv>bg-dim</span> <span class=o>.</span> <span class=s>&#34;#0F1116&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>					     <span class=p>(</span><span class=nv>bg-hl-line</span> <span class=o>.</span> <span class=s>&#34;#0F1116&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>					     <span class=p>(</span><span class=nv>bg-active</span> <span class=o>.</span> <span class=s>&#34;#0F1116&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>					     <span class=p>(</span><span class=nv>bg-inactive</span> <span class=o>.</span> <span class=s>&#34;#0F1116&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>					     <span class=p>(</span><span class=nv>bg-tab-bar</span> <span class=o>.</span> <span class=s>&#34;#0F1116&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>					     <span class=p>(</span><span class=nv>bg-tab-active</span> <span class=o>.</span> <span class=s>&#34;#0F1116&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>					     <span class=p>(</span><span class=nv>bg-tab-inactive</span> <span class=o>.</span> <span class=s>&#34;#0F1116&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>					     <span class=p>(</span><span class=nv>blue</span> <span class=o>.</span> <span class=s>&#34;#FFFFFF&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>					     <span class=p>(</span><span class=nv>magenta-nuanced-bg</span> <span class=o>.</span> <span class=s>&#34;#171B21&#34;</span><span class=p>)))</span>
</span></span></code></pre></div><h4 id=theme-auto-change class=headerLink><a href=#theme-auto-change class=header-mark></a>Theme auto change</h4><ul><li><p>For MacOS</p><p>目前切换到了 Macos 上使用 Emacs ，<a href=https://github.com/d12frosted/homebrew-emacs-plus target=_blank rel="noopener noreffer">Emacs-plus</a> 可根据系统主题自动切换 Emacs 主题。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my/apply-theme</span> <span class=p>(</span><span class=nv>appearance</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Load theme, taking current system APPEARANCE into consideration.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>mapc</span> <span class=nf>#&#39;</span><span class=nv>disable-theme</span> <span class=nv>custom-enabled-themes</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>pcase</span> <span class=nv>appearance</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=ss>&#39;light</span> <span class=p>(</span><span class=nv>load-theme</span> <span class=ss>&#39;modus-operandi</span> <span class=no>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=ss>&#39;dark</span> <span class=p>(</span><span class=nv>load-theme</span> <span class=ss>&#39;modus-vivendi</span> <span class=no>t</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;ns-system-appearance-change-functions</span> <span class=nf>#&#39;</span><span class=nv>my/apply-theme</span><span class=p>)</span>
</span></span></code></pre></div></li></ul><h3 id=dashboard class=headerLink><a href=#dashboard class=header-mark></a>Dashboard</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>dashboard-startup-banner</span> <span class=s>&#34;~/.emacs.d/banner.txt&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>dashboard-center-content</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>dashboard-set-init-info</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>;; dashboard-set-file-icons t</span>
</span></span><span class=line><span class=cl><span class=c1>;; dashboard-modify-heading-icons &#39;((recents . &#34;file-text&#34;)</span>
</span></span><span class=line><span class=cl><span class=c1>;; 				 (bookmarks . &#34;book&#34;))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>dashboard-items</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>;; (setq dashboard-footer nil)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>dashboard-set-footer</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>dashboard-setup-startup-hook</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=define-fringe-bitmap class=headerLink><a href=#define-fringe-bitmap class=header-mark></a>define-fringe-bitmap</h3><p>Word wrap at window edge, hide the right and left curly arrow. So ugly.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nf>define-fringe-bitmap</span> <span class=ss>&#39;right-curly-arrow</span>  <span class=p>[])</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nf>define-fringe-bitmap</span> <span class=ss>&#39;left-curly-arrow</span>  <span class=p>[])</span>
</span></span></code></pre></div><h3 id=rainbow-mode class=headerLink><a href=#rainbow-mode class=header-mark></a>rainbow-mode</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;prog-mode-hook</span> <span class=ss>&#39;rainbow-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=helpful class=headerLink><a href=#helpful class=header-mark></a>helpful</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>help-window-select</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>[</span><span class=nv>remap</span> <span class=nv>describe-function</span><span class=p>]</span> <span class=ss>&#39;helpful-callable</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>[</span><span class=nv>remap</span> <span class=nv>describe-variable</span><span class=p>]</span> <span class=ss>&#39;helpful-variable</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>[</span><span class=nv>remap</span> <span class=nv>describe-key</span><span class=p>]</span> <span class=ss>&#39;helpful-key</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-h F&#34;</span><span class=p>)</span> <span class=ss>&#39;helpful-function</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-h C&#34;</span><span class=p>)</span> <span class=ss>&#39;helpful-command</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>helpful-switch-buffer-function</span> <span class=nf>#&#39;</span><span class=nv>pop-to-buffer-same-window</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;helpful-mode-hook</span> <span class=ss>&#39;visual-line-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=info-colors class=headerLink><a href=#info-colors class=header-mark></a>info-colors</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;Info-selection-hook</span> <span class=ss>&#39;info-colors-fontify-node</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=goggles class=headerLink><a href=#goggles class=header-mark></a>goggles</h3><blockquote><p>Goggles highlights the modified region using pulse. Currently the commands undo, yank, kill and delete are supported.</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq-default</span> <span class=nv>goggles-pulse</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;prog-mode-hook</span> <span class=ss>&#39;goggles-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;text-mode-hook</span> <span class=ss>&#39;goggles-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=emojify class=headerLink><a href=#emojify class=header-mark></a>emojify</h3><p>用的很少，总是记不住它的按键，每次使用都要 <code>M-x</code> 。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;after-init-hook</span> <span class=ss>&#39;global-emojify-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>emojify-emojis-dir</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;emojis&#34;</span> <span class=nv>my-cache-directory</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=centaur-tab class=headerLink><a href=#centaur-tab class=header-mark></a>centaur-tab</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>centaur-tabs-style</span> <span class=s>&#34;bar&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>centaur-tabs-set-bar</span> <span class=ss>&#39;under</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>x-underline-at-descent-line</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>centaur-tabs-set-close-button</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>centaur-tabs-adjust-buffer-order</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>centaur-tabs-show-count</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>;; Enable this will bring background nil error</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>centaur-tabs-set-icons</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;after-init-hook</span> <span class=nf>#&#39;</span><span class=nv>centaur-tabs-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;dired-mode-hook</span> <span class=nf>#&#39;</span><span class=nv>centaur-tabs-local-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;dashboard-mode-hook</span> <span class=nf>#&#39;</span><span class=nv>centaur-tabs-local-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;calendar-mode-hook</span> <span class=nf>#&#39;</span><span class=nv>centaur-tabs-local-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;org-agenda-mode-hook</span> <span class=nf>#&#39;</span><span class=nv>centaur-tabs-local-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;helpful-mode-hook</span> <span class=nf>#&#39;</span><span class=nv>centaur-tabs-local-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;mu4e-main-mode-hook</span> <span class=nf>#&#39;</span><span class=nv>centaur-tabs-local-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;mu4e-view-mode-hook</span> <span class=nf>#&#39;</span><span class=nv>centaur-tabs-local-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;mu4e-headers-mode-hook</span> <span class=nf>#&#39;</span><span class=nv>centaur-tabs-local-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;ebib-index-mode-hook</span> <span class=nf>#&#39;</span><span class=nv>centaur-tabs-local-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;ebib-entry-mode-hook</span> <span class=nf>#&#39;</span><span class=nv>centaur-tabs-local-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;org-roam-mode-hook</span> <span class=nf>#&#39;</span><span class=nv>centaur-tabs-local-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;centaur-tabs</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>centaur-tabs-enable-buffer-reordering</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;s-p&#34;</span><span class=p>)</span>  <span class=ss>&#39;centaur-tabs-backward</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;s-n&#34;</span><span class=p>)</span> <span class=ss>&#39;centaur-tabs-forward</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=centaur-tab-groups class=headerLink><a href=#centaur-tab-groups class=header-mark></a>centaur-tab groups</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my/centaur-tabs-buffer-groups</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;</span><span class=ss>`centaur-tabs-buffer-groups&#39;</span><span class=s> control buffers&#39; group rules.
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>      Group centaur-tabs with mode if buffer is derived from </span><span class=ss>`eshell-mode&#39;</span><span class=s> </span><span class=ss>`emacs-lisp-mode&#39;</span><span class=s> </span><span class=ss>`dired-mode&#39;</span><span class=s> </span><span class=ss>`org-mode&#39;</span><span class=s> </span><span class=ss>`magit-mode&#39;</span><span class=s>.
</span></span></span><span class=line><span class=cl><span class=s>      All buffer name start with * will group to \&#34;Emacs\&#34;.
</span></span></span><span class=line><span class=cl><span class=s>      Other buffer group by </span><span class=ss>`centaur-tabs-get-group-name&#39;</span><span class=s> with project name.&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>list</span>
</span></span><span class=line><span class=cl>     <span class=p>(</span><span class=nb>cond</span>
</span></span><span class=line><span class=cl>      <span class=p>((</span><span class=nb>or</span> <span class=p>(</span><span class=nf>string-equal</span> <span class=s>&#34;*&#34;</span> <span class=p>(</span><span class=nf>substring</span> <span class=p>(</span><span class=nf>buffer-name</span><span class=p>)</span> <span class=mi>0</span> <span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	   <span class=p>(</span><span class=nf>memq</span> <span class=nv>major-mode</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>magit-process-mode</span>
</span></span><span class=line><span class=cl>			      <span class=nv>magit-status-mode</span>
</span></span><span class=line><span class=cl>			      <span class=nv>magit-diff-mode</span>
</span></span><span class=line><span class=cl>			      <span class=nv>magit-log-mode</span>
</span></span><span class=line><span class=cl>			      <span class=nv>magit-file-mode</span>
</span></span><span class=line><span class=cl>			      <span class=nv>magit-blob-mode</span>
</span></span><span class=line><span class=cl>			      <span class=nv>magit-blame-mode</span>
</span></span><span class=line><span class=cl>			      <span class=p>)))</span>
</span></span><span class=line><span class=cl>       <span class=s>&#34;Emacs&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>((</span><span class=nv>derived-mode-p</span> <span class=ss>&#39;prog-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=s>&#34;Editing&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>((</span><span class=nv>derived-mode-p</span> <span class=ss>&#39;dired-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=s>&#34;Dired&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>((</span><span class=nf>memq</span> <span class=nv>major-mode</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>helpful-mode</span>
</span></span><span class=line><span class=cl>			  <span class=nv>help-mode</span><span class=p>))</span>
</span></span><span class=line><span class=cl>       <span class=s>&#34;Help&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>((</span><span class=nf>memq</span> <span class=nv>major-mode</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>org-mode</span>
</span></span><span class=line><span class=cl>			  <span class=nv>org-agenda-clockreport-mode</span>
</span></span><span class=line><span class=cl>			  <span class=nv>org-src-mode</span>
</span></span><span class=line><span class=cl>			  <span class=nv>org-agenda-mode</span>
</span></span><span class=line><span class=cl>			  <span class=nv>org-beamer-mode</span>
</span></span><span class=line><span class=cl>			  <span class=nv>org-indent-mode</span>
</span></span><span class=line><span class=cl>			  <span class=nv>org-bullets-mode</span>
</span></span><span class=line><span class=cl>			  <span class=nv>org-cdlatex-mode</span>
</span></span><span class=line><span class=cl>			  <span class=nv>org-agenda-log-mode</span>
</span></span><span class=line><span class=cl>			  <span class=nv>diary-mode</span><span class=p>))</span>
</span></span><span class=line><span class=cl>       <span class=s>&#34;OrgMode&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>((</span><span class=nf>memq</span> <span class=nv>major-mode</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>pdf-view-mode</span><span class=p>))</span>
</span></span><span class=line><span class=cl>       <span class=s>&#34;PDF&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=no>t</span>
</span></span><span class=line><span class=cl>       <span class=p>(</span><span class=nv>centaur-tabs-get-group-name</span> <span class=p>(</span><span class=nf>current-buffer</span><span class=p>))))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>centaur-tabs-buffer-groups-function</span> <span class=ss>&#39;my/centaur-tabs-buffer-groups</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=awesome-tray class=headerLink><a href=#awesome-tray class=header-mark></a>Awesome Tray</h3><p>不太喜欢使用 modeline ， doom-modeline 也挺好看的，但是那么高的一大条在底部，和 echo area 有点重复。</p><p>好在有 awesome-tray ，整合了 mode-line 和 echo area 。awesome-tray 中是将 modeline 的高度设置成 0.1 ，表现为一条横线。</p><p>awesome-tray 存在着一个问题，在某种情况下会恢复 modeline 的高度为 1，就很丑。不知道是什么原因导致的 modeline 行高恢复，所以我通常是将 mode-line-formate 设置成 nil 。这样也存在着一个问题，当上下分屏时，会分不清 buffer （但是我很少上下分屏，屏幕小啊）。</p><p>山重水复疑无路，得来全不费功夫。发现 Emacs 自带 <code>window-divider-mode</code> ，结合 awesome-tray 和 window-divider ，完美的达到了自己的目的，再也不会在某些 buffer 中出现 modeline 恢复行高的问题。而且可以自定义 window-divider 的颜色。效果见 <a href=#interface-show rel>Interface Show</a> 。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>awesome-tray-input-method-zh-style</span> <span class=s>&#34;ㄓ&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>awesome-tray-info-padding-right</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>awesome-tray-active-modules</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;org-pomodoro&#34;</span> <span class=s>&#34;clock&#34;</span> <span class=s>&#34;pdf-view-page&#34;</span> <span class=s>&#34;input-method&#34;</span> <span class=s>&#34;battery&#34;</span> <span class=s>&#34;date&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;after-init-hook</span> <span class=ss>&#39;awesome-tray-enable</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defvar</span> <span class=nv>after-load-theme-hook</span> <span class=no>nil</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Hook run after a color theme is loaded using </span><span class=ss>`load-theme&#39;</span><span class=s>.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defadvice</span> <span class=nv>load-theme</span> <span class=p>(</span><span class=nv>after</span> <span class=nv>run-after-load-theme-hook</span> <span class=nv>activate</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Run </span><span class=ss>`after-load-theme-hook&#39;</span><span class=s>.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>run-hooks</span> <span class=ss>&#39;after-load-theme-hook</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;after-load-theme-hook</span> <span class=ss>&#39;awesome-tray-enable</span> <span class=no>t</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=window-divider class=headerLink><a href=#window-divider class=header-mark></a>window-divider</h3><p>使用 <code>face-spec-sat</code> 重置 <code>window-divider</code> 的颜色。同样的方式可以重置其他的使用 defface 定义的颜色。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>window-divider-default-bottom-width</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>window-divider-default-right-width</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>window-divider-default-places</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>face-spec-set</span> <span class=ss>&#39;window-divider</span>
</span></span><span class=line><span class=cl>		 <span class=o>&#39;</span><span class=p>((((</span><span class=nv>background</span> <span class=nv>light</span><span class=p>))</span>
</span></span><span class=line><span class=cl>		    <span class=nb>:foreground</span> <span class=s>&#34;#000000&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		   <span class=p>(</span><span class=no>t</span>
</span></span><span class=line><span class=cl>		    <span class=nb>:foreground</span> <span class=s>&#34;#FFFFFF&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>		 <span class=ss>&#39;face-override-spec</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>;; (window-divider-mode 1)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;after-init-hook</span> <span class=ss>&#39;window-divider-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=highlight-line class=headerLink><a href=#highlight-line class=header-mark></a>Highlight line</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=c1>;; (global-hl-line-mode t)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;on-first-buffer-hook</span> <span class=ss>&#39;global-hl-line-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;dashboard-mode-hook</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span> <span class=p>(</span><span class=nb>setq-local</span> <span class=nv>global-hl-line-mode</span> <span class=no>nil</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;eshell-mode-hook</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span> <span class=p>(</span><span class=nb>setq-local</span> <span class=nv>global-hl-line-mode</span> <span class=no>nil</span><span class=p>)))</span>
</span></span></code></pre></div><h3 id=stem-reading-mode class=headerLink><a href=#stem-reading-mode class=header-mark></a>stem-reading-mode</h3><p>还没搞懂这个包的作用是什么。作者是这么说的：“Highlight word stems in text buffers, thereby providing artificial fixation points to improve speed reading.”</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;stem-reading-mode</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>set-face-attribute</span> <span class=ss>&#39;stem-reading-highlight-face</span> <span class=no>nil</span> <span class=nb>:weight</span> <span class=ss>&#39;unspecified</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>set-face-attribute</span> <span class=ss>&#39;stem-reading-delight-face</span> <span class=no>nil</span> <span class=nb>:weight</span> <span class=ss>&#39;light</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=emacs-frame-management class=headerLink><a href=#emacs-frame-management class=header-mark></a>Emacs frame management</h3><p>Emacs 中的窗口管理。有一些包如 popup ， shackle 等可以使用，但是我选择使用 display-buffer-alist 进行窗口的管理。Emacs 中的窗口总是感觉乱乱的。</p><h4 id=quit-and-delete-window class=headerLink><a href=#quit-and-delete-window class=header-mark></a>Quit and delete window</h4><p>删除窗口，而不是只是隐藏它，见 <a href=https://www.reddit.com/r/emacs/comments/t1rvbd/help_wanted_emacs_doesnt_really_deletes_special/ target=_blank rel="noopener noreffer">Reddit</a> 。</p><p>这个对于一些临时 buffer 很有用，使用 ESC 进行最近 buffer 切换时，就不会出现不想要的 buffer。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>quit-window-delete</span> <span class=p>(</span><span class=kp>&amp;optional</span> <span class=nv>kill</span> <span class=nv>window</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Quit WINDOW, deleting it, and bury its buffer.
</span></span></span><span class=line><span class=cl><span class=s>WINDOW must be a live window and defaults to the selected one.
</span></span></span><span class=line><span class=cl><span class=s>With prefix argument KILL non-nil, kill the buffer instead of
</span></span></span><span class=line><span class=cl><span class=s>burying it.
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>This is similar to the version of </span><span class=ss>`quit-window&#39;</span><span class=s> that Emacs had before
</span></span></span><span class=line><span class=cl><span class=s>the introduction of </span><span class=ss>`quit-restore-window&#39;</span><span class=s>.  It ignores the information
</span></span></span><span class=line><span class=cl><span class=s>stored in WINDOW&#39;s </span><span class=ss>`quit-restore&#39;</span><span class=s> window parameter.
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>It deletes the WINDOW more often, rather than switching to another
</span></span></span><span class=line><span class=cl><span class=s>buffer in it.  If WINDOW is alone in its frame then the frame is
</span></span></span><span class=line><span class=cl><span class=s>deleted or iconified, according to option </span><span class=ss>`frame-auto-hide-function&#39;</span><span class=s>.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span> <span class=s>&#34;P&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>set-window-parameter</span> <span class=nv>window</span> <span class=ss>&#39;quit-restore</span> <span class=o>`</span><span class=p>(</span><span class=nv>frame</span> <span class=nv>frame</span> <span class=no>nil</span> <span class=o>,</span><span class=p>(</span><span class=nf>current-buffer</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>quit-restore-window</span> <span class=nv>window</span> <span class=p>(</span><span class=nb>if</span> <span class=nv>kill</span> <span class=ss>&#39;kill</span> <span class=ss>&#39;bury</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>[</span><span class=nv>remap</span> <span class=nv>quit-window</span><span class=p>]</span> <span class=ss>&#39;quit-window-delete</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>[</span><span class=nv>remap</span> <span class=nv>meow-quit</span><span class=p>]</span> <span class=ss>&#39;quit-window-delete</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=scroll-other-window class=headerLink><a href=#scroll-other-window class=header-mark></a>Scroll other window</h4><p>这个在并排使用两个 buffer 的时候很好用，通过 <code>M-n</code> 和 <code>M-p</code> 移动另一个 buffer 中的内容。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my/scroll-other-windown-down</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Scroll other window down.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>scroll-other-window-down</span> <span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my/scroll-other-windown</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Scroll other window up.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>scroll-other-window</span> <span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;M-n&#34;</span><span class=p>)</span> <span class=ss>&#39;my/scroll-other-windown</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;M-p&#34;</span><span class=p>)</span> <span class=ss>&#39;my/scroll-other-windown-down</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=window-resize class=headerLink><a href=#window-resize class=header-mark></a>window resize</h4><p>结合 <code>repeat-mode</code> 可以很方便的控制窗口的大小。通过 <code>C-x</code> 触发。此设置来自 <a href=https://github.com/protesilaos/dotfiles/blob/master/emacs/.emacs.d/prot-emacs.org target=_blank rel="noopener noreffer">protesilaos</a> 大神。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defvar</span> <span class=nv>resize-window-repeat-map</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>map</span> <span class=p>(</span><span class=nf>make-sparse-keymap</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>define-key</span> <span class=nv>map</span> <span class=s>&#34;^&#34;</span> <span class=ss>&#39;enlarge-window</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>define-key</span> <span class=nv>map</span> <span class=s>&#34;}&#34;</span> <span class=ss>&#39;enlarge-window-horizontally</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>define-key</span> <span class=nv>map</span> <span class=s>&#34;{&#34;</span> <span class=ss>&#39;shrink-window-horizontally</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>define-key</span> <span class=nv>map</span> <span class=s>&#34;v&#34;</span> <span class=ss>&#39;shrink-window</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nv>map</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Keymap to repeat window resizing commands.  Used in </span><span class=ss>`repeat-mode&#39;</span><span class=s>.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nf>put</span> <span class=ss>&#39;enlarge-window</span> <span class=ss>&#39;repeat-map</span> <span class=ss>&#39;resize-window-repeat-map</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nf>put</span> <span class=ss>&#39;enlarge-window-horizontally</span> <span class=ss>&#39;repeat-map</span> <span class=ss>&#39;resize-window-repeat-map</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nf>put</span> <span class=ss>&#39;shrink-window-horizontally</span> <span class=ss>&#39;repeat-map</span> <span class=ss>&#39;resize-window-repeat-map</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nf>put</span> <span class=ss>&#39;shrink-window</span> <span class=ss>&#39;repeat-map</span> <span class=ss>&#39;resize-window-repeat-map</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=display-buffer-alist class=headerLink><a href=#display-buffer-alist class=header-mark></a>display-buffer-alist</h4><ul><li><p>one-key buffer</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>display-buffer-alist</span>
</span></span><span class=line><span class=cl>      <span class=o>&#39;</span><span class=p>((</span><span class=s>&#34;*One-Key*&#34;</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=nv>display-buffer-reuse-window</span>
</span></span><span class=line><span class=cl>	 <span class=nv>display-buffer-in-side-window</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=nv>side</span> <span class=o>.</span> <span class=nv>bottom</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=nv>reusable-frames</span> <span class=o>.</span> <span class=nv>visible</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=nf>window-parameters</span>
</span></span><span class=line><span class=cl>	 <span class=p>(</span><span class=nv>select</span> <span class=o>.</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	 <span class=p>(</span><span class=nv>quit</span> <span class=o>.</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	 <span class=p>(</span><span class=nv>popup</span> <span class=o>.</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	 <span class=p>(</span><span class=nv>mode-line-format</span> <span class=o>.</span> <span class=nv>none</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	 <span class=p>(</span><span class=nv>tab-line-format</span> <span class=o>.</span> <span class=nv>none</span><span class=p>)))))</span>
</span></span></code></pre></div></li></ul><ul><li><p>eshell buffer</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;display-buffer-alist</span>
</span></span><span class=line><span class=cl>	     <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;*eshell*&#34;</span>
</span></span><span class=line><span class=cl>	       <span class=p>(</span><span class=nv>display-buffer-reuse-window</span>
</span></span><span class=line><span class=cl>		<span class=nv>display-buffer-in-side-window</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	       <span class=p>(</span><span class=nv>side</span> <span class=o>.</span> <span class=nv>bottom</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	       <span class=p>(</span><span class=nv>window-height</span> <span class=o>.</span> <span class=mf>0.8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	       <span class=p>(</span><span class=nv>slot</span> <span class=o>.</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	       <span class=p>(</span><span class=nf>window-parameters</span>
</span></span><span class=line><span class=cl>		<span class=p>(</span><span class=nv>mode-line-format</span> <span class=o>.</span> <span class=nv>none</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=p>(</span><span class=nv>tab-line-format</span> <span class=o>.</span> <span class=nv>none</span><span class=p>))))</span>
</span></span></code></pre></div></li></ul><ul><li><p>help buffer</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;display-buffer-alist</span>
</span></span><span class=line><span class=cl>	     <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;*Help*&#34;</span>
</span></span><span class=line><span class=cl>	       <span class=p>(</span><span class=nv>display-buffer-reuse-window</span>
</span></span><span class=line><span class=cl>		<span class=nv>display-buffer-same-window</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	       <span class=p>(</span><span class=nv>side</span> <span class=o>.</span> <span class=nv>right</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	       <span class=p>(</span><span class=nv>window-width</span> <span class=o>.</span> <span class=mf>0.5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	       <span class=p>(</span><span class=nf>window-parameters</span>
</span></span><span class=line><span class=cl>		<span class=p>(</span><span class=nv>select</span> <span class=o>.</span> <span class=no>t</span><span class=p>))))</span>
</span></span></code></pre></div></li></ul><ul><li><p>Info buffer</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;display-buffer-alist</span>
</span></span><span class=line><span class=cl>	       <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;*info*&#34;</span>
</span></span><span class=line><span class=cl>		 <span class=p>(</span><span class=nv>display-buffer-reuse-window</span>
</span></span><span class=line><span class=cl>		  <span class=nv>display-buffer-in-side-window</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		 <span class=p>(</span><span class=nv>side</span> <span class=o>.</span> <span class=nv>right</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		 <span class=p>(</span><span class=nv>inhibit-same-window</span> <span class=o>.</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		 <span class=p>(</span><span class=nv>reusable-frames</span> <span class=o>.</span> <span class=nv>visible</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		 <span class=p>(</span><span class=nv>window-width</span> <span class=o>.</span> <span class=mf>0.5</span><span class=p>)))</span>
</span></span></code></pre></div></li></ul><h3 id=benchmark class=headerLink><a href=#benchmark class=header-mark></a>Benchmark</h3><p>Emacs User interface 启动时间约 0.05s 。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nf>message</span> <span class=s>&#34;Emacs User interface: %.2fs&#34;</span>
</span></span><span class=line><span class=cl>	 <span class=p>(</span><span class=nf>float-time</span> <span class=p>(</span><span class=nf>time-subtract</span> <span class=p>(</span><span class=nf>current-time</span><span class=p>)</span> <span class=nv>my/section-start-time</span><span class=p>)))</span>
</span></span></code></pre></div><h2 id=powerful-emacs-equipped-with-builtin-packages class=headerLink><a href=#powerful-emacs-equipped-with-builtin-packages class=header-mark></a>Powerful Emacs Equipped with Builtin Packages</h2><p>Emacs 本身就是一个宝库，有很多的内置功能 ，这些功能的实现简单而强大。名符其实的操作系统。</p><p>这部份的详细介绍，可以参见 <a href=https://github.com/condy0919/emacs-newbie/blob/master/introduction-to-builtin-modes.md target=_blank rel="noopener noreffer">Emacs builtin modes 功能介绍</a>。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>my/section-start-time</span> <span class=p>(</span><span class=nf>current-time</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=y-or-n-p class=headerLink><a href=#y-or-n-p class=header-mark></a>y-or-n-p</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nf>boundp</span> <span class=ss>&#39;use-short-answers</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>setq</span> <span class=nv>use-short-answers</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>advice-add</span> <span class=ss>&#39;yes-or-no-p</span> <span class=nb>:override</span> <span class=nf>#&#39;</span><span class=nv>y-or-n-p</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=bell class=headerLink><a href=#bell class=header-mark></a>bell</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>ring-bell-function</span> <span class=ss>&#39;ignore</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=kill-ring class=headerLink><a href=#kill-ring class=header-mark></a>kill-ring</h3><p>Do not saves duplicates in kill-ring</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>kill-do-not-save-duplicates</span> <span class=no>t</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=system-coding class=headerLink><a href=#system-coding class=header-mark></a>system coding</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>prefer-coding-system</span> <span class=ss>&#39;utf-8</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>set-default-coding-systems</span> <span class=ss>&#39;utf-8</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>set-terminal-coding-system</span> <span class=ss>&#39;utf-8</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>set-keyboard-coding-system</span> <span class=ss>&#39;utf-8</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=paren class=headerLink><a href=#paren class=header-mark></a>paren</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>show-paren-style</span> <span class=ss>&#39;mixed</span>
</span></span><span class=line><span class=cl>      <span class=nv>show-paren-when-point-inside-paren</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>      <span class=nv>show-paren-when-point-in-periphery</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>show-paren-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=elec-pair class=headerLink><a href=#elec-pair class=header-mark></a>elec-pair</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>electric-pair-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=line-number class=headerLink><a href=#line-number class=header-mark></a>line number</h3><p>在 prog-mode 中显示行号，当在 org-mode 中，不显示行号。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>display-line-numbers</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;prog-mode-hook</span> <span class=ss>&#39;display-line-numbers-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=simple class=headerLink><a href=#simple class=header-mark></a>simple</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=c1>;; (eval-expression-print-length)</span>
</span></span><span class=line><span class=cl><span class=c1>;; (eval-expression-print-level)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;after-init-hook</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>			     <span class=p>(</span><span class=nv>line-number-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			     <span class=p>(</span><span class=nv>column-number-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			     <span class=p>(</span><span class=nv>size-indication-mode</span><span class=p>)))</span>
</span></span></code></pre></div><h3 id=autorevert class=headerLink><a href=#autorevert class=header-mark></a>autorevert</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>auto-revert-verbose</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-auto-revert-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=subword class=headerLink><a href=#subword class=header-mark></a>subword</h3><p>Enabling it remaps word-based editing commands to subword-based commands that handle symbols with mixed uppercase and lowercase letters。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=c1>;; (global-subword-mode)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;on-first-input-hook</span> <span class=ss>&#39;global-subword-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=winner class=headerLink><a href=#winner class=header-mark></a>winner</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=c1>;; (setq winner-dont-bind-my-keys nil)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>;; (winner-mode)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;on-first-buffer-hook</span> <span class=ss>&#39;winner-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=server class=headerLink><a href=#server class=header-mark></a>server</h3><p>According to this <a href=https://emacshorrors.com/posts/determining-if-the-server-is-started-or-the-wonders-of-server-running-p.html target=_blank rel="noopener noreffer">blog</a>, use <code>server-process</code> instead of <code>server-ruanning-p</code> 。但是当我新开一个 emacs 时，会报错，所以还是回到原来的配置上。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>require</span> <span class=ss>&#39;server</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>unless</span> <span class=p>(</span><span class=nv>server-running-p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>server-mode</span> <span class=mi>1</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=prettify-symbols-mode class=headerLink><a href=#prettify-symbols-mode class=header-mark></a>prettify-symbols-mode</h3><p>这个 mode 可以替换一些 fancy 的字体，但是目前没找到好看的字体。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>prettify-symbols-alist</span> <span class=o>&#39;</span><span class=p>((</span><span class=s>&#34;lambda&#34;</span> <span class=o>.</span> <span class=sc>?λ</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			       <span class=p>(</span><span class=s>&#34;function&#34;</span> <span class=o>.</span> <span class=sc>?𝑓</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;prog-mode-hook</span> <span class=ss>&#39;prettify-symbols-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=so-long class=headerLink><a href=#so-long class=header-mark></a>so-long</h3><p>Emacs 的长行检测。在 Emacs 中当编辑长行时，会很卡，开启此模式可以提高性能。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>global-so-long-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=delsel class=headerLink><a href=#delsel class=header-mark></a>delsel</h3><p>插入文本会将所选文本删除，这在其他的很多软件中都有，Emacs 中默认没有，需要手动开启。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;on-first-input-hook</span> <span class=ss>&#39;delete-selection-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=webjump class=headerLink><a href=#webjump class=header-mark></a>webjump</h3><p>基本用不上，我使用 google-this 这个包。这个的好处是可以使用不同的搜索引擎。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>webjump-sites</span> <span class=o>&#39;</span><span class=p>((</span><span class=s>&#34;Emacs China&#34;</span> <span class=o>.</span> <span class=s>&#34;https://emacs-china.org&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		      <span class=p>(</span><span class=s>&#34;DuckDuckGo&#34;</span> <span class=o>.</span> <span class=p>[</span><span class=nv>simple-query</span> <span class=s>&#34;duckduckgo.com&#34;</span>
</span></span><span class=line><span class=cl>						    <span class=s>&#34;duckduckgo.com/?q=&#34;</span> <span class=s>&#34;&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		      <span class=p>(</span><span class=s>&#34;Douban read&#34;</span> <span class=o>.</span> <span class=p>[</span><span class=nv>simple-query</span> <span class=s>&#34;https://search.douban.com&#34;</span>
</span></span><span class=line><span class=cl>						     <span class=s>&#34;https://search.douban.com/book/subject_search?search_text=&#34;</span> <span class=s>&#34;&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		      <span class=p>(</span><span class=s>&#34;Google&#34;</span> <span class=o>.</span> <span class=p>[</span><span class=nv>simple-query</span> <span class=s>&#34;https://www.google.com&#34;</span>
</span></span><span class=line><span class=cl>						<span class=s>&#34;https://www.google.com/search?q=&#34;</span> <span class=s>&#34;&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		      <span class=p>(</span><span class=s>&#34;Baidu&#34;</span> <span class=o>.</span> <span class=p>[</span><span class=nv>simple-query</span> <span class=s>&#34;https://www.baidu.com&#34;</span>
</span></span><span class=line><span class=cl>					       <span class=s>&#34;https://www.baidu.com/s?ie=utf-8&amp;wd=&#34;</span> <span class=s>&#34;&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		      <span class=p>(</span><span class=s>&#34;Wikipedia&#34;</span> <span class=o>.</span> <span class=p>[</span><span class=nv>simple-query</span> <span class=s>&#34;https://wikipedia.org&#34;</span>
</span></span><span class=line><span class=cl>						   <span class=s>&#34;https://wikipedia.org/wiki/&#34;</span> <span class=s>&#34;&#34;</span><span class=p>])))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;s-/&#34;</span><span class=p>)</span> <span class=ss>&#39;webjump</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=url class=headerLink><a href=#url class=header-mark></a>url</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>url-configuration-directory</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;url&#34;</span> <span class=nv>my-cache-directory</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=bookmark class=headerLink><a href=#bookmark class=header-mark></a>bookmark</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>bookmark-default-file</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;storage/bookmarks&#34;</span> <span class=nv>my-galaxy</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=repeat class=headerLink><a href=#repeat class=header-mark></a>repeat</h3><p>重复某个按键，比如在调整窗口大小时。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>repeat-on-final-keystroke</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>set-mark-command-repeat-pop</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;on-first-input-hook</span> <span class=ss>&#39;repeat-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=minibuffer class=headerLink><a href=#minibuffer class=header-mark></a>minibuffer</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>minibuffer-prompt-properties</span>
</span></span><span class=line><span class=cl>	<span class=o>&#39;</span><span class=p>(</span><span class=nv>read-only</span> <span class=no>t</span> <span class=nv>cursor-intangible</span> <span class=no>t</span> <span class=nv>face</span> <span class=nf>minibuffer-prompt</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=ibuffer class=headerLink><a href=#ibuffer class=header-mark></a>ibuffer</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>ibuffer-saved-filter-groups</span>
</span></span><span class=line><span class=cl>	  <span class=p>(</span><span class=nb>quote</span> <span class=p>((</span><span class=s>&#34;default&#34;</span>
</span></span><span class=line><span class=cl>		   <span class=p>(</span><span class=s>&#34;dired&#34;</span> <span class=p>(</span><span class=nv>mode</span> <span class=o>.</span> <span class=nv>dired-mode</span><span class=p>))</span>
</span></span><span class=line><span class=cl>		   <span class=p>(</span><span class=s>&#34;perl&#34;</span> <span class=p>(</span><span class=nv>mode</span> <span class=o>.</span> <span class=nv>cperl-mode</span><span class=p>))</span>
</span></span><span class=line><span class=cl>		   <span class=p>(</span><span class=s>&#34;erc&#34;</span> <span class=p>(</span><span class=nv>mode</span> <span class=o>.</span> <span class=nv>erc-mode</span><span class=p>))</span>
</span></span><span class=line><span class=cl>		   <span class=p>(</span><span class=s>&#34;planner&#34;</span> <span class=p>(</span><span class=nb>or</span>
</span></span><span class=line><span class=cl>			       <span class=p>(</span><span class=nv>name</span> <span class=o>.</span> <span class=s>&#34;^\\*Calendar\\*$&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			       <span class=p>(</span><span class=nv>name</span> <span class=o>.</span> <span class=s>&#34;^diary$&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			       <span class=p>(</span><span class=nv>mode</span> <span class=o>.</span> <span class=nv>muse-mode</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>		   <span class=p>(</span><span class=s>&#34;emacs&#34;</span> <span class=p>(</span><span class=nb>or</span>
</span></span><span class=line><span class=cl>			     <span class=p>(</span><span class=nv>name</span> <span class=o>.</span> <span class=s>&#34;^\\*scratch\\*$&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			     <span class=p>(</span><span class=nv>name</span> <span class=o>.</span> <span class=s>&#34;^\\*Messages\\*$&#34;</span><span class=p>)))))))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;ibuffer-mode-hook</span>
</span></span><span class=line><span class=cl>	      <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>		<span class=p>(</span><span class=nv>ibuffer-switch-to-saved-filter-groups</span> <span class=s>&#34;default&#34;</span><span class=p>)))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;on-first-buffer-hook</span> <span class=ss>&#39;all-the-icons-ibuffer-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=mouse-avoidance class=headerLink><a href=#mouse-avoidance class=header-mark></a>mouse-avoidance</h3><p>Builtin function. Hide mouse when type.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>mouse-avoidance-mode</span> <span class=ss>&#39;banish</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=cursor-intangible class=headerLink><a href=#cursor-intangible class=header-mark></a>cursor-intangible</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;minibuffer-setup-hook</span> <span class=nf>#&#39;</span><span class=nv>cursor-intangible-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=large-file class=headerLink><a href=#large-file class=header-mark></a>large file</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>large-file-warning-threshold</span> <span class=no>nil</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=benchmark class=headerLink><a href=#benchmark class=header-mark></a>Benchmark</h3><p>Powerful Emacs Equipped with Builtin Packages 启动时间约 0.04s 。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nf>message</span> <span class=s>&#34;Powerful Emacs Equipped with Builtin Packages: %.2fs&#34;</span>
</span></span><span class=line><span class=cl>	 <span class=p>(</span><span class=nf>float-time</span> <span class=p>(</span><span class=nf>time-subtract</span> <span class=p>(</span><span class=nf>current-time</span><span class=p>)</span> <span class=nv>my/section-start-time</span><span class=p>)))</span>
</span></span></code></pre></div><h2 id=awesome-emacs-equipped-with-third-party-packages class=headerLink><a href=#awesome-emacs-equipped-with-third-party-packages class=header-mark></a>Awesome Emacs Equipped with Third-party Packages</h2><p>编辑器的基本功能就是增删改查。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>my/section-start-time</span> <span class=p>(</span><span class=nf>current-time</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=gcmh class=headerLink><a href=#gcmh class=header-mark></a>gcmh</h3><p>Emacs 中拉圾回收的策略是当Emacs自上一次垃圾收集后分配的内存超过 <code>gc-cons-threshold</code> 阀值时就会触发新一轮的垃圾收集行为。</p><p><code>gcmh</code> 包对 Emacs 的拉圾回收进行了设置，当正常使用时，拉圾回收的阈值设置的较高，当 Emacs 空闲时阈值设的较低。</p><p><a href=http://blog.lujun9972.win/blog/2019/05/16/%E4%BC%98%E5%8C%96emacs%E7%9A%84%E5%9E%83%E5%9C%BE%E6%90%9C%E9%9B%86%E8%A1%8C%E4%B8%BA/index.html target=_blank rel="noopener noreffer">优化Emacs的垃圾搜集行为</a> 一文中提出了通过记录每次垃圾收集的时间来进行判断和调整 <code>gc-cons-threshold</code> 的值。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>gcmh-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=restart-emacs class=headerLink><a href=#restart-emacs class=header-mark></a>restart-emacs</h3><p>Never exit Emacs ！！！</p><p>防止自己误按 <code>C-x C-c</code> 导致 Emacs 退出， So stupid behavior 。 如果想要退出，使用 M-x save-buffers-kill-emacs 。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-x C-c&#34;</span><span class=p>)</span> <span class=ss>&#39;restart-emacs</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=input-method class=headerLink><a href=#input-method class=header-mark></a>input method</h3><h4 id=rime class=headerLink><a href=#rime class=header-mark></a>rime</h4><p>我使用 emacs-rime 和三码郑码，不需要进行词库的维护。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>rime-librime-root</span> <span class=s>&#34;~/.emacs.d/librime/dist&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>rime-emacs-module-header-root</span> <span class=s>&#34;/opt/homebrew/opt/emacs-plus@28/include&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>rime-user-data-dir</span> <span class=s>&#34;~/Library/Rime/&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>default-input-method</span> <span class=s>&#34;rime&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>rime-show-candidate</span> <span class=ss>&#39;posframe</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>rime-posframe-properties</span> <span class=o>&#39;</span><span class=p>(</span><span class=nb>:internal-border-width</span> <span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>rime-disable-predicates</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>meow-normal-mode-p</span>
</span></span><span class=line><span class=cl>				<span class=nv>meow-motion-mode-p</span>
</span></span><span class=line><span class=cl>				<span class=nv>meow-keypad-mode-p</span>
</span></span><span class=line><span class=cl>				<span class=nv>rime-predicate-prog-in-code-p</span>
</span></span><span class=line><span class=cl>				<span class=nv>rime-predicate-org-in-src-block-p</span>
</span></span><span class=line><span class=cl>				<span class=nv>rime-predicate-org-latex-mode-p</span>
</span></span><span class=line><span class=cl>				<span class=nv>rime-predicate-current-uppercase-letter-p</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>rime-inline-predicates</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>rime-predicate-space-after-cc-p</span>
</span></span><span class=line><span class=cl>			       <span class=nv>rime-predicate-after-alphabet-char-p</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>face-spec-set</span> <span class=ss>&#39;rime-default-face</span>
</span></span><span class=line><span class=cl>	       <span class=o>&#39;</span><span class=p>((((</span><span class=nv>background</span> <span class=nv>light</span><span class=p>))</span>
</span></span><span class=line><span class=cl>		  <span class=nb>:foreground</span> <span class=s>&#34;#000000&#34;</span> <span class=nb>:background</span> <span class=s>&#34;#FFFFFF&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		 <span class=p>(</span><span class=no>t</span>
</span></span><span class=line><span class=cl>		  <span class=nb>:foreground</span> <span class=s>&#34;#FFFFFF&#34;</span> <span class=nb>:background</span> <span class=s>&#34;#000000&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	       <span class=ss>&#39;face-override-spec</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;rime</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>define-key</span> <span class=nv>rime-mode-map</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;M-j&#34;</span><span class=p>)</span> <span class=ss>&#39;rime-force-enable</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;org-mode-hook</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span> <span class=p>(</span><span class=nv>set-input-method</span> <span class=s>&#34;rime&#34;</span><span class=p>)))</span>
</span></span></code></pre></div><h4 id=rime-regexp class=headerLink><a href=#rime-regexp class=header-mark></a>rime-regexp</h4><p>使用拼音进行中文的检索。原来使用的是拼音首字母进行检索，但是检出来的结果太多，所以还是使用全拼音进行检索。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;on-first-input-hook</span> <span class=ss>&#39;rime-regexp-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=autoinsert class=headerLink><a href=#autoinsert class=header-mark></a>autoinsert</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>define-auto-insert</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>cons</span> <span class=s>&#34;init-.*\\.el&#34;</span> <span class=s>&#34;Emacs Lisp Skeleton&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;Emacs Configuration Description: &#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;;;;; &#34;</span> <span class=p>(</span><span class=nf>file-name-nondirectory</span> <span class=p>(</span><span class=nf>buffer-file-name</span><span class=p>))</span> <span class=s>&#34; --- &#34;</span> <span class=nv>str</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>make-string</span> <span class=p>(</span><span class=nf>max</span> <span class=mi>2</span> <span class=p>(</span><span class=nf>-</span> <span class=mi>80</span> <span class=p>(</span><span class=nf>current-column</span><span class=p>)</span> <span class=mi>27</span><span class=p>))</span> <span class=sc>?\s</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;-*- lexical-binding: t; -*-&#34;</span> <span class=o>&#39;</span><span class=p>(</span><span class=nb>setq</span> <span class=nv>lexical-binding</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>;; Copyright (C) &#34;</span> <span class=p>(</span><span class=nf>format-time-string</span> <span class=s>&#34;%Y&#34;</span><span class=p>)</span> <span class=s>&#34;
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>;;; Commentary:
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>;; &#34;</span> <span class=nv>_</span> <span class=s>&#34;
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>;;; Code:
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>(provide &#39;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>file-name-base</span> <span class=p>(</span><span class=nf>buffer-file-name</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;)
</span></span></span><span class=line><span class=cl><span class=s>;;; &#34;</span> <span class=p>(</span><span class=nf>file-name-nondirectory</span> <span class=p>(</span><span class=nf>buffer-file-name</span><span class=p>))</span> <span class=s>&#34; ends here\n&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;on-first-input-hook</span> <span class=ss>&#39;auto-insert-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=embrace class=headerLink><a href=#embrace class=header-mark></a>embrace</h3><p>这个包很方便的对文本进行括号的增删改。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;embrace</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>set-face-attribute</span> <span class=ss>&#39;embrace-help-pair-face</span> <span class=no>nil</span> <span class=nb>:inherit</span> <span class=nv>font-lock-function-name-face</span> <span class=nb>:inverse-video</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>defun</span> <span class=nv>embrace-org-mode-hook</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>dolist</span> <span class=p>(</span><span class=nv>lst</span> <span class=o>&#39;</span><span class=p>((</span><span class=sc>?=</span> <span class=s>&#34; =&#34;</span> <span class=o>.</span> <span class=s>&#34;= &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		   <span class=p>(</span><span class=sc>?~</span> <span class=s>&#34; ~&#34;</span> <span class=o>.</span> <span class=s>&#34;~ &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		   <span class=p>(</span><span class=sc>?/</span> <span class=s>&#34; /&#34;</span> <span class=o>.</span> <span class=s>&#34;/ &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		   <span class=p>(</span><span class=sc>?*</span> <span class=s>&#34; *&#34;</span> <span class=o>.</span> <span class=s>&#34;* &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		   <span class=p>(</span><span class=sc>?_</span> <span class=s>&#34; _&#34;</span> <span class=o>.</span> <span class=s>&#34;_ &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		   <span class=p>(</span><span class=sc>?+</span> <span class=s>&#34; +&#34;</span> <span class=o>.</span> <span class=s>&#34;+ &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		   <span class=p>(</span><span class=sc>?k</span> <span class=s>&#34;@@html:&lt;kbd&gt;@@&#34;</span> <span class=o>.</span> <span class=s>&#34;@@html:&lt;/kbd&gt;@@&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>embrace-add-pair</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>lst</span><span class=p>)</span> <span class=p>(</span><span class=nv>cadr</span> <span class=nv>lst</span><span class=p>)</span> <span class=p>(</span><span class=nv>cddr</span> <span class=nv>lst</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>embrace-show-help-p</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-,&#34;</span><span class=p>)</span> <span class=ss>&#39;embrace-commander</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;org-mode-hook</span> <span class=ss>&#39;embrace-org-mode-hook</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=recent-file class=headerLink><a href=#recent-file class=header-mark></a>recent file</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;after-init-hook</span> <span class=nf>#&#39;</span><span class=nv>recentf-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;kill-emacs-hook</span> <span class=nf>#&#39;</span><span class=nv>recentf-cleanup</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>recentf-save-file</span> <span class=s>&#34;/Users/duanning/.cache/emacs/recentf&#34;</span>
</span></span><span class=line><span class=cl>      <span class=nv>recentf-max-saved-items</span> <span class=mi>1000</span>
</span></span><span class=line><span class=cl>      <span class=nv>recentf-exclude</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;[0-9]*-.*.org&#34;</span> <span class=s>&#34;slipbox&#34;</span> <span class=s>&#34;todos&#34;</span> <span class=s>&#34;recentf&#34;</span> <span class=s>&#34;M.Calibre&#34;</span> <span class=s>&#34;.elfeed&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>recentf-auto-cleanup</span> <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nf>daemonp</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			       <span class=mi>300</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=dired-mode class=headerLink><a href=#dired-mode class=header-mark></a>dired-mode</h3><h4 id=files class=headerLink><a href=#files class=header-mark></a>files</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>make-directory</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;backups/&#34;</span> <span class=nv>my-cache-directory</span><span class=p>)</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>confirm-kill-processes</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>backup-directory-alist</span> <span class=o>`</span><span class=p>((</span><span class=s>&#34;.&#34;</span> <span class=o>.</span> <span class=o>,</span><span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;backups/&#34;</span> <span class=nv>my-cache-directory</span><span class=p>))))</span>
</span></span></code></pre></div><h4 id=dired class=headerLink><a href=#dired class=header-mark></a>dired</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>dired-recursive-deletes</span> <span class=ss>&#39;always</span>
</span></span><span class=line><span class=cl>      <span class=nv>dired-recursive-copies</span> <span class=ss>&#39;always</span>
</span></span><span class=line><span class=cl>      <span class=nv>global-auto-revert-non-file-buffers</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>      <span class=nv>auto-revert-verbose</span> <span class=no>nil</span>
</span></span><span class=line><span class=cl>      <span class=nv>dired-dwim-target</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>      <span class=nv>delete-by-moving-to-trash</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>      <span class=nv>load-prefer-newer</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>      <span class=nv>auto-revert-use-notify</span> <span class=no>nil</span>
</span></span><span class=line><span class=cl>      <span class=nv>auto-revert-interval</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>      <span class=nv>insert-directory-program</span> <span class=s>&#34;gls&#34;</span> <span class=nv>dired-use-ls-dired</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>      <span class=nv>dired-listing-switches</span> <span class=s>&#34;-al --group-directories-first&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nf>put</span> <span class=ss>&#39;dired-find-alternate-file</span> <span class=ss>&#39;disabled</span> <span class=no>nil</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=dired-x class=headerLink><a href=#dired-x class=header-mark></a>dired-x</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-x C-j&#34;</span><span class=p>)</span> <span class=ss>&#39;dired-jump</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=diredfl class=headerLink><a href=#diredfl class=header-mark></a>diredfl</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=c1>;; (diredfl-global-mode)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;dired-mode-hook</span> <span class=ss>&#39;diredfl-global-mode</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=peep-dired class=headerLink><a href=#peep-dired class=header-mark></a>peep-dired</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>peep-dired-ignored-extensions</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;mkv&#34;</span> <span class=s>&#34;iso&#34;</span> <span class=s>&#34;mp4&#34;</span> <span class=s>&#34;pdf&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;dired</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>define-key</span> <span class=nv>dired-mode-map</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;P&#34;</span><span class=p>)</span> <span class=ss>&#39;peep-dired</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=dired-hide-dotfiles class=headerLink><a href=#dired-hide-dotfiles class=header-mark></a>dired-hide-dotfiles</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my-dired-mode-hook</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;My </span><span class=ss>`dired&#39;</span><span class=s> mode hook.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=c1>;; To hide dot-files by default</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>dired-hide-dotfiles-mode</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;dired</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>define-key</span> <span class=nv>dired-mode-map</span> <span class=s>&#34;.&#34;</span> <span class=nf>#&#39;</span><span class=nv>dired-hide-dotfiles-mode</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;dired-mode-hook</span> <span class=nf>#&#39;</span><span class=nv>my-dired-mode-hook</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=dired-git-info class=headerLink><a href=#dired-git-info class=header-mark></a>dired-git-info</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>dgi-auto-hide-details-p</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;dired</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>define-key</span> <span class=nv>dired-mode-map</span> <span class=s>&#34;)&#34;</span> <span class=ss>&#39;dired-git-info-mode</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;dired-after-readin-hook</span> <span class=ss>&#39;dired-git-info-auto-enable</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=hungry-delete class=headerLink><a href=#hungry-delete class=header-mark></a>hungry delete</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>hungry-delete-chars-to-skip</span> <span class=s>&#34;
</span></span></span><span class=line><span class=cl><span class=s>\f&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;after-init-hook</span> <span class=ss>&#39;global-hungry-delete-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=save class=headerLink><a href=#save class=header-mark></a>save</h3><h4 id=auto-save class=headerLink><a href=#auto-save class=header-mark></a>auto save</h4><p>这个包很有用，在 Emacs 中永远不需要手动保存文档，使用这个包会自动保存。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>require</span> <span class=ss>&#39;auto-save</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;after-init-hook</span> <span class=ss>&#39;auto-save-enable</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>auto-save-silent</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>      <span class=nv>auto-save-delete-trailing-whitespace</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>      <span class=nv>auto-save-list-file-prefix</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;auto-save-list/.saves-&#34;</span> <span class=nv>my-cache-directory</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;org-capture-mode-hook</span> <span class=nf>#&#39;</span><span class=p>(</span><span class=nb>lambda</span> <span class=no>nil</span> <span class=p>(</span><span class=nb>setq</span> <span class=nv>auto-save-delete-trailing-whitespace</span> <span class=no>nil</span><span class=p>)))</span>
</span></span></code></pre></div><h4 id=save-place class=headerLink><a href=#save-place class=header-mark></a>save place</h4><p>This means when you visit a file, point goes to the last place where it was when you previously visited the same file.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>save-place-file</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;saveplace&#34;</span> <span class=nv>my-cache-directory</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;on-first-file-hook</span> <span class=ss>&#39;save-place-mode</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=save-hist class=headerLink><a href=#save-hist class=header-mark></a>save hist</h4><p>Toggle saving of minibuffer history.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>savehist-file</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;savehist&#34;</span> <span class=nv>my-cache-directory</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=nv>history-length</span> <span class=mi>1000</span>
</span></span><span class=line><span class=cl>      <span class=nv>savehist-save-minibuffer-history</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>      <span class=nv>savehist-additional-variables</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>kill-ring</span>
</span></span><span class=line><span class=cl>				      <span class=nv>search-ring</span>
</span></span><span class=line><span class=cl>				      <span class=nv>regexp-search-ring</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=nv>history-delete-duplicates</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>;; (add-hook &#39;on-first-file-hook &#39;savehist-mode)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;after-init-hook</span> <span class=ss>&#39;savehist-mode</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=saveplace-pdf class=headerLink><a href=#saveplace-pdf class=header-mark></a>saveplace-pdf</h4><p>saveplace-pdf-view 可以保存 pdf 视图的位置。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;save-place</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>advice-add</span> <span class=ss>&#39;save-place-find-file-hook</span> <span class=nb>:around</span> <span class=nf>#&#39;</span><span class=nv>saveplace-pdf-view-find-file-advice</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>advice-add</span> <span class=ss>&#39;save-place-to-alist</span> <span class=nb>:around</span> <span class=nf>#&#39;</span><span class=nv>saveplace-pdf-view-to-alist-advice</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=undo-and-redo class=headerLink><a href=#undo-and-redo class=header-mark></a>undo&redo</h3><h4 id=undo class=headerLink><a href=#undo class=header-mark></a>Undo</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;on-first-file-hook</span> <span class=ss>&#39;global-undo-fu-session-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>undo-fu-session-directory</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;undo-fu-session&#34;</span> <span class=nv>my-cache-directory</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=vundo class=headerLink><a href=#vundo class=header-mark></a>Vundo</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;vundo</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>vundo-glyph-alist</span> <span class=nv>vundo-unicode-symbols</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=completion-and-search-framework class=headerLink><a href=#completion-and-search-framework class=header-mark></a>Completion and search framework</h3><h4 id=vertico class=headerLink><a href=#vertico class=header-mark></a>vertico</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>customize-set-variable</span> <span class=ss>&#39;vertico-cycle</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;vertico</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>define-key</span> <span class=nv>vertico-map</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-j&#34;</span><span class=p>)</span> <span class=ss>&#39;vertico-directory-up</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>;; (vertico-mode)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;on-first-input-hook</span> <span class=ss>&#39;vertico-mode</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=marginalia class=headerLink><a href=#marginalia class=header-mark></a>marginalia</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>customize-set-variable</span> <span class=ss>&#39;marginalia-annotators</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>marginalia-annotators-heavy</span> <span class=nv>marginalia-annotators-light</span> <span class=no>nil</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>;; (marginalia-mode)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;vertico-mode-hook</span> <span class=ss>&#39;marginalia-mode</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=orderless class=headerLink><a href=#orderless class=header-mark></a>orderless</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=c1>;; (require &#39;orderless)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>completion-styles</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>orderless</span> <span class=nv>partial-completion</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=nv>completion-category-defaults</span> <span class=no>nil</span>
</span></span><span class=line><span class=cl>      <span class=nv>completion-category-overrides</span> <span class=o>&#39;</span><span class=p>((</span><span class=nv>file</span> <span class=p>(</span><span class=nv>styles</span> <span class=o>.</span> <span class=p>(</span><span class=nv>partial-completion</span><span class=p>)))))</span>
</span></span></code></pre></div><h4 id=corfu class=headerLink><a href=#corfu class=header-mark></a>corfu</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>corfu-auto</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>      <span class=nv>corfu-cycle</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>      <span class=nv>corfu-quit-at-boundary</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>      <span class=nv>corfu-auto-prefix</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>      <span class=nv>corfu-preselect-first</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>      <span class=nv>corfu-quit-no-match</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;corfu</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>define-key</span> <span class=nv>corfu-map</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;TAB&#34;</span><span class=p>)</span> <span class=ss>&#39;corfu-next</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>define-key</span> <span class=nv>corfu-map</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;[tab]&#34;</span><span class=p>)</span> <span class=ss>&#39;corfu-next</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>define-key</span> <span class=nv>corfu-map</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;S-TAB&#34;</span><span class=p>)</span> <span class=ss>&#39;corfu-previous</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>define-key</span> <span class=nv>corfu-map</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;[backtab]&#34;</span><span class=p>)</span> <span class=ss>&#39;corfu-next</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>define-key</span> <span class=nv>corfu-map</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;&lt;escape&gt;&#34;</span><span class=p>)</span> <span class=ss>&#39;corfu-quit</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>corfu-enable-always-in-minibuffer</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Enable Corfu in the minibuffer if Vertico/Mct are not active.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>unless</span> <span class=p>(</span><span class=nb>or</span> <span class=p>(</span><span class=nv>bound-and-true-p</span> <span class=nv>mct--active</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	      <span class=p>(</span><span class=nv>bound-and-true-p</span> <span class=nv>vertico--input</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=c1>;; (setq-local corfu-auto nil) Enable/disable auto completion</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>corfu-mode</span> <span class=mi>1</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;minibuffer-setup-hook</span> <span class=nf>#&#39;</span><span class=nv>corfu-enable-always-in-minibuffer</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>;; (global-corfu-mode)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>;; (corfu-history-mode)</span>
</span></span><span class=line><span class=cl><span class=c1>;; (corfu-indexed-mode)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;on-first-input-hook</span> <span class=ss>&#39;global-corfu-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;on-first-input-hook</span> <span class=ss>&#39;corfu-history-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;on-first-input-hook</span> <span class=ss>&#39;corfu-indexed-mode</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=kind-icon class=headerLink><a href=#kind-icon class=header-mark></a>kind-icon</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>kind-icon-default-face</span> <span class=ss>&#39;corfu-default</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>kind-icon-use-icons</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;corfu</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;corfu-margin-formatters</span> <span class=nf>#&#39;</span><span class=nv>kind-icon-margin-formatter</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=consult class=headerLink><a href=#consult class=header-mark></a>consult</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;completion-list-mode-hook</span> <span class=ss>&#39;consult-preview-at-point-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-x C-b&#34;</span><span class=p>)</span> <span class=ss>&#39;consult-buffer</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;M-y&#34;</span><span class=p>)</span> <span class=ss>&#39;consult-yank-pop</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=consult-dir class=headerLink><a href=#consult-dir class=header-mark></a>consult-dir</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=c1>;; (require &#39;consult-dir)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-x C-d&#34;</span><span class=p>)</span> <span class=ss>&#39;consult-dir</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;vertico</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>define-key</span> <span class=nv>vertico-map</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-x C-d&#34;</span><span class=p>)</span> <span class=ss>&#39;consult-dir</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>define-key</span> <span class=nv>vertico-map</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-x C-j&#34;</span><span class=p>)</span> <span class=ss>&#39;consult-dir-jump-file</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=embark class=headerLink><a href=#embark class=header-mark></a>embark</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>[</span><span class=nv>remap</span> <span class=nv>describe-bindings</span><span class=p>]</span> <span class=nf>#&#39;</span><span class=nv>embark-bindings</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-.&#34;</span><span class=p>)</span> <span class=ss>&#39;embark-act</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;M-.&#34;</span><span class=p>)</span> <span class=ss>&#39;embark-dwim</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>;; Use Embark to show bindings in a key prefix with `C-h`</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>prefix-help-command</span> <span class=nf>#&#39;</span><span class=nv>embark-prefix-help-command</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=prescient class=headerLink><a href=#prescient class=header-mark></a>prescient</h4><p>Simple but effective sorting and filtering for Emacs.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>require</span> <span class=ss>&#39;prescient</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=ctrlf class=headerLink><a href=#ctrlf class=header-mark></a>ctrlf</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;on-first-input-hook</span> <span class=ss>&#39;ctrlf-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;pdf-isearch-minor-mode-hook</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span> <span class=p>(</span><span class=nv>ctrlf-local-mode</span> <span class=mi>-1</span><span class=p>)))</span>
</span></span></code></pre></div><h4 id=google-this class=headerLink><a href=#google-this class=header-mark></a>google-this</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=c1>;; (google-this-mode)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;after-init-hook</span> <span class=ss>&#39;google-this-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=dabbrev class=headerLink><a href=#dabbrev class=header-mark></a>dabbrev</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;M-/&#34;</span><span class=p>)</span> <span class=ss>&#39;dabbrev-completion</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-M-/&#34;</span><span class=p>)</span> <span class=ss>&#39;dabbrev-expand</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=cape class=headerLink><a href=#cape class=header-mark></a>cape</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=c1>;; (require &#39;cape)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-c p p&#34;</span><span class=p>)</span> <span class=ss>&#39;completion-at-point</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-c p t&#34;</span><span class=p>)</span> <span class=ss>&#39;complete-tag</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-c p d&#34;</span><span class=p>)</span> <span class=ss>&#39;cape-dabbrev</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-c p f&#34;</span><span class=p>)</span> <span class=ss>&#39;cape-file</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-c p k&#34;</span><span class=p>)</span> <span class=ss>&#39;cape-keyword</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-c p s&#34;</span><span class=p>)</span> <span class=ss>&#39;cape-symbol</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-c p a&#34;</span><span class=p>)</span> <span class=ss>&#39;cape-abbrev</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-c p i&#34;</span><span class=p>)</span> <span class=ss>&#39;cape-ispell</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-c p l&#34;</span><span class=p>)</span> <span class=ss>&#39;cape-line</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-c p w&#34;</span><span class=p>)</span> <span class=ss>&#39;cape-dict</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-c p \\&#34;</span><span class=p>)</span> <span class=ss>&#39;cape-tex</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-c p &amp;&#34;</span><span class=p>)</span> <span class=ss>&#39;cape-sgml</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-c p r&#34;</span><span class=p>)</span> <span class=ss>&#39;cape-rfc1345</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;completion-at-point-functions</span> <span class=nf>#&#39;</span><span class=nv>cape-file</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;completion-at-point-functions</span> <span class=nf>#&#39;</span><span class=nv>cape-tex</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;completion-at-point-functions</span> <span class=nf>#&#39;</span><span class=nv>cape-dabbrev</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;completion-at-point-functions</span> <span class=nf>#&#39;</span><span class=nv>cape-keyword</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>;;(add-to-list &#39;completion-at-point-functions #&#39;cape-sgml)</span>
</span></span><span class=line><span class=cl><span class=c1>;;(add-to-list &#39;completion-at-point-functions #&#39;cape-rfc1345)</span>
</span></span><span class=line><span class=cl><span class=c1>;;(add-to-list &#39;completion-at-point-functions #&#39;cape-abbrev)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;completion-at-point-functions</span> <span class=nf>#&#39;</span><span class=nv>cape-ispell</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>;; (add-to-list &#39;completion-at-point-functions #&#39;cape-dict)</span>
</span></span><span class=line><span class=cl><span class=c1>;;(add-to-list &#39;completion-at-point-functions #&#39;cape-symbol)</span>
</span></span><span class=line><span class=cl><span class=c1>;;(add-to-list &#39;completion-at-point-functions #&#39;cape-line)</span>
</span></span></code></pre></div><h3 id=tempel class=headerLink><a href=#tempel class=header-mark></a>tempel</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>require</span> <span class=ss>&#39;tempel</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>tempel-path</span> <span class=s>&#34;~/.emacs.d/template/tempel&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>tempel-setup-capf</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=c1>;; Add the Tempel Capf to `completion-at-point-functions&#39;. `tempel-expand&#39;</span>
</span></span><span class=line><span class=cl>  <span class=c1>;; only triggers on exact matches. Alternatively use `tempel-complete&#39; if</span>
</span></span><span class=line><span class=cl>  <span class=c1>;; you want to see all matches, but then Tempel will probably trigger too</span>
</span></span><span class=line><span class=cl>  <span class=c1>;; often when you don&#39;t expect it.</span>
</span></span><span class=line><span class=cl>  <span class=c1>;; NOTE: We add `tempel-expand&#39; *before* the main programming mode Capf,</span>
</span></span><span class=line><span class=cl>  <span class=c1>;; such that it will be tried first.</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq-local</span> <span class=nv>completion-at-point-functions</span>
</span></span><span class=line><span class=cl>	      <span class=p>(</span><span class=nf>cons</span> <span class=nf>#&#39;</span><span class=nv>tempel-expand</span>
</span></span><span class=line><span class=cl>		    <span class=nv>completion-at-point-functions</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;text-mode-hook</span> <span class=ss>&#39;tempel-setup-capf</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;M-+&#34;</span><span class=p>)</span> <span class=ss>&#39;tempel-complete</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;M-*&#34;</span><span class=p>)</span> <span class=ss>&#39;tempel-insert</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=imenu-list class=headerLink><a href=#imenu-list class=header-mark></a>imenu-list</h3><p><a href=https://github.com/bmag/imenu-list target=_blank rel="noopener noreffer">Imenu-list</a> 可以充当导航栏，对于我经常使用 org-mode 来说，很方便。此处添加了自动开关 imenu-list 的功能，对于有时候 org 文档中具有表格，而宽度不够时自动关闭它。</p><p>这个有个问题就是当 imenu-list 打开后，打开 help 窗口不能自动跳转了。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>imenu-list-position</span> <span class=ss>&#39;left</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>imenu-list-size</span> <span class=mf>0.2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defvar</span> <span class=nv>my/imenu-list-enabled</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my/imenu-list-on-off</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>if</span> <span class=nv>my/imenu-list-enabled</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>progn</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=nb>setq</span> <span class=nv>my/imenu-list-enabled</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=nv>imenu-list-minor-mode</span> <span class=mi>-1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>progn</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>setq</span> <span class=nv>my/imenu-list-enabled</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>imenu-list-minor-mode</span> <span class=mi>1</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my/imenu-list-noselect</span> <span class=p>(</span><span class=nv>_</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nv>not</span> <span class=p>(</span><span class=nf>minibufferp</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nb>and</span>
</span></span><span class=line><span class=cl>	 <span class=nv>my/imenu-list-enabled</span>
</span></span><span class=line><span class=cl>	 <span class=p>(</span><span class=nf>string-equal</span> <span class=nv>major-mode</span> <span class=s>&#34;org-mode&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	 <span class=p>(</span><span class=nv>not</span> <span class=nv>org-roam-capture--node</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	 <span class=p>(</span><span class=nv>not</span> <span class=nv>org-capture-mode</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=nb>progn</span>
</span></span><span class=line><span class=cl>	  <span class=p>(</span><span class=nv>imenu-list-minor-mode</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	  <span class=p>(</span><span class=nv>imenu-list-update</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	  <span class=p>(</span><span class=nv>imenu-list-show-noselect</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>imenu-list-minor-mode</span> <span class=mi>-1</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;window-buffer-change-functions</span> <span class=nf>#&#39;</span><span class=nv>my/imenu-list-noselect</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=open-with-safari class=headerLink><a href=#open-with-safari class=header-mark></a>Open with Safari</h3><p>有些时候需要使用外部应用打开相应的文件，比如打印文件的时候。目前还没有发现直接使用 Emacs 打印文件的方法。</p><p>这里只使用 safari 打开相应的文件，如需要使用其他的应用，可以参照<a href=http://xahlee.info/emacs/emacs/emacs_dired_open_file_in_ext_apps.html target=_blank rel="noopener noreffer">博客</a>。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>xah-html-open-in-safari</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Open the current file or </span><span class=ss>`dired&#39;</span><span class=s> marked files in Mac&#39;s Safari browser.
</span></span></span><span class=line><span class=cl><span class=s>If the file is not saved, save it first.
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>URL </span><span class=ss>`http://xahlee.info/emacs/emacs/emacs_dired_open_file_in_ext_apps.html&#39;</span><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>Version 2018-02-26&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let*</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	 <span class=p>(</span><span class=nv>$file-list</span>
</span></span><span class=line><span class=cl>	  <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nf>string-equal</span> <span class=nv>major-mode</span> <span class=s>&#34;dired-mode&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	      <span class=p>(</span><span class=nv>dired-get-marked-files</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	    <span class=p>(</span><span class=nf>list</span> <span class=p>(</span><span class=nf>buffer-file-name</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>	 <span class=p>(</span><span class=nv>$do-it-p</span> <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nf>&lt;=</span> <span class=p>(</span><span class=nf>length</span> <span class=nv>$file-list</span><span class=p>)</span> <span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		       <span class=no>t</span>
</span></span><span class=line><span class=cl>		     <span class=p>(</span><span class=nv>y-or-n-p</span> <span class=s>&#34;Open more than 5 files? &#34;</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>when</span> <span class=nv>$do-it-p</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>cond</span>
</span></span><span class=line><span class=cl>       <span class=p>((</span><span class=nf>string-equal</span> <span class=nv>system-type</span> <span class=s>&#34;darwin&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=nf>mapc</span>
</span></span><span class=line><span class=cl>	 <span class=p>(</span><span class=nb>lambda</span> <span class=p>(</span><span class=nv>$fpath</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	   <span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nf>buffer-modified-p</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>	     <span class=p>(</span><span class=nv>save-buffer</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	   <span class=p>(</span><span class=nv>shell-command</span>
</span></span><span class=line><span class=cl>	    <span class=p>(</span><span class=nf>format</span> <span class=s>&#34;open -a Safari.app \&#34;%s\&#34;&#34;</span> <span class=nv>$fpath</span><span class=p>)))</span> <span class=nv>$file-list</span><span class=p>))))))</span>
</span></span></code></pre></div><h3 id=benchmark class=headerLink><a href=#benchmark class=header-mark></a>Benchmark</h3><p>Awesome Emacs Equipped with Third-party Packages 启动时间约 0.06s 。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nf>message</span> <span class=s>&#34;Awesome Emacs Equipped with Third-party Packages: %.2fs&#34;</span>
</span></span><span class=line><span class=cl>	 <span class=p>(</span><span class=nf>float-time</span> <span class=p>(</span><span class=nf>time-subtract</span> <span class=p>(</span><span class=nf>current-time</span><span class=p>)</span> <span class=nv>my/section-start-time</span><span class=p>)))</span>
</span></span></code></pre></div><h2 id=emacs-works-with-multiple-language-piece-of-cake class=headerLink><a href=#emacs-works-with-multiple-language-piece-of-cake class=header-mark></a>Emacs Works with Multiple Language, PIECE OF CAKE</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>my/section-start-time</span> <span class=p>(</span><span class=nf>current-time</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=language-spelling class=headerLink><a href=#language-spelling class=header-mark></a>Language Spelling</h3><h4 id=ispell class=headerLink><a href=#ispell class=header-mark></a>ispell</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>ispell-program-name</span> <span class=s>&#34;aspell&#34;</span>
</span></span><span class=line><span class=cl>      <span class=nv>ispell-extra-args</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;--sug-mode=ultra&#34;</span> <span class=s>&#34;--lang=en_US&#34;</span> <span class=s>&#34;--run-together&#34;</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=flyspell class=headerLink><a href=#flyspell class=header-mark></a>flyspell</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;text-mode-hook</span> <span class=ss>&#39;flyspell-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;flyspell</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>define-key</span> <span class=nv>flyspell-mode-map</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-;&#34;</span><span class=p>)</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>define-key</span> <span class=nv>flyspell-mode-map</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-,&#34;</span><span class=p>)</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>define-key</span> <span class=nv>flyspell-mode-map</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-.&#34;</span><span class=p>)</span> <span class=no>nil</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>flyspell-duplicate-distance</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>      <span class=nv>flyspell-mark-duplications-flag</span> <span class=no>nil</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=flyspell-correct class=headerLink><a href=#flyspell-correct class=header-mark></a>flyspell-correct</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-;&#34;</span><span class=p>)</span> <span class=o>&#39;</span> <span class=nv>flyspell-correct-wrapper</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>flyspell-correct-interface</span> <span class=nf>#&#39;</span><span class=nv>flyspell-correct-popup</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=language-translate class=headerLink><a href=#language-translate class=header-mark></a>Language Translate</h3><h4 id=fanyi class=headerLink><a href=#fanyi class=header-mark></a>fanyi</h4><p>此包对单词进行查询。2022-04-14 目前使用有些 fanyi provider 有点慢，不知道是为什么。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>custom-set-variables</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>fanyi-providers</span> <span class=o>&#39;</span><span class=p>(</span>
</span></span><span class=line><span class=cl>					  <span class=nv>fanyi-haici-provider</span>
</span></span><span class=line><span class=cl>					  <span class=nv>fanyi-youdao-thesaurus-provider</span>
</span></span><span class=line><span class=cl>					  <span class=nv>fanyi-etymon-provider</span>
</span></span><span class=line><span class=cl>					  <span class=nv>fanyi-longman-provider</span>
</span></span><span class=line><span class=cl>					  <span class=nv>fanyi-libre-provider</span>
</span></span><span class=line><span class=cl>					  <span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;display-buffer-alist</span>
</span></span><span class=line><span class=cl>	     <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;*fanyi*&#34;</span>
</span></span><span class=line><span class=cl>	       <span class=p>(</span><span class=nv>display-buffer-reuse-window</span>
</span></span><span class=line><span class=cl>		<span class=nv>display-buffer-same-window</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	       <span class=p>(</span><span class=nv>side</span> <span class=o>.</span> <span class=nv>right</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	       <span class=p>(</span><span class=nv>window-width</span> <span class=o>.</span> <span class=mf>0.5</span><span class=p>)))</span>
</span></span></code></pre></div><h4 id=powerthesaurus class=headerLink><a href=#powerthesaurus class=header-mark></a>Powerthesaurus</h4><p>有 autoload ，此处不需要做配置，只需要在 <a href=#key-l-for-language rel>key &ldquo;l&rdquo; for language</a> 设置相应的按键绑定。</p><h4 id=smog class=headerLink><a href=#smog class=header-mark></a>Smog</h4><p><a href=https://github.com/zzkt/smog/tree/28b053198ff9c1b142789614d85d7d762d9b0fa3 target=_blank rel="noopener noreffer">https://github.com/zzkt/smog/tree/28b053198ff9c1b142789614d85d7d762d9b0fa3</a></p><p><a href="https://wiki.christophchamp.com/index.php?title=Style_and_Diction" target=_blank rel="noopener noreffer">https://wiki.christophchamp.com/index.php?title=Style_and_Diction</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>smog-command</span> <span class=s>&#34;style -L en&#34;</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=osx-dictionary class=headerLink><a href=#osx-dictionary class=header-mark></a>osx-dictionary</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>osx-dictionary-use-chinese-text-segmentation</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;display-buffer-alist</span>
</span></span><span class=line><span class=cl>	       <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;\\*osx-dictionary\\*&#34;</span>
</span></span><span class=line><span class=cl>		 <span class=p>(</span><span class=nv>display-buffer-reuse-window</span>
</span></span><span class=line><span class=cl>		  <span class=nv>display-buffer-same-window</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		 <span class=p>(</span><span class=nv>side</span> <span class=o>.</span> <span class=nv>right</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		 <span class=p>(</span><span class=nv>window-width</span> <span class=o>.</span> <span class=mf>0.5</span><span class=p>)))</span>
</span></span></code></pre></div><h4 id=go-translate class=headerLink><a href=#go-translate class=header-mark></a>go-translate</h4><p>此包可对整句进行翻译。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;go-translate</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>gts-translate-list</span> <span class=o>&#39;</span><span class=p>((</span><span class=s>&#34;en&#34;</span> <span class=s>&#34;zh&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>gts-default-translator</span> <span class=p>(</span><span class=nv>gts-translator</span>
</span></span><span class=line><span class=cl>				<span class=nb>:picker</span> <span class=p>(</span><span class=nv>gts-noprompt-picker</span><span class=p>)</span>
</span></span><span class=line><span class=cl>				<span class=nb>:engines</span> <span class=p>(</span><span class=nf>list</span>
</span></span><span class=line><span class=cl>					  <span class=p>(</span><span class=nv>gts-bing-engine</span><span class=p>)</span>
</span></span><span class=line><span class=cl>					  <span class=p>(</span><span class=nv>gts-google-engine</span> <span class=nb>:parser</span> <span class=p>(</span><span class=nv>gts-google-summary-parser</span><span class=p>))</span>
</span></span><span class=line><span class=cl>					  <span class=c1>;; (gts-google-rpc-engine :parser (gts-google-rpc-parser) :url &#34;https://translate.google.com&#34;)</span>
</span></span><span class=line><span class=cl>					  <span class=p>)</span>
</span></span><span class=line><span class=cl>				<span class=nb>:render</span> <span class=p>(</span><span class=nv>gts-buffer-render</span><span class=p>))))</span>
</span></span></code></pre></div><h3 id=language-format class=headerLink><a href=#language-format class=header-mark></a>Language Format</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;on-first-file-hook</span> <span class=ss>&#39;format-all-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;org</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>define-key</span> <span class=nv>org-src-mode-map</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;TAB&#34;</span><span class=p>)</span> <span class=ss>&#39;format-all-buffer</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=language-service-protocol class=headerLink><a href=#language-service-protocol class=header-mark></a>Language Service Protocol</h3><h4 id=eldoc class=headerLink><a href=#eldoc class=header-mark></a>eldoc</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>eldoc-mode</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=lsp-bridge class=headerLink><a href=#lsp-bridge class=header-mark></a>lsp-bridge</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>require</span> <span class=ss>&#39;lsp-bridge</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>require</span> <span class=ss>&#39;lsp-bridge-orderless</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>;; (require &#39;lsp-bridge-icon)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>dolist</span> <span class=p>(</span><span class=nv>hook</span> <span class=p>(</span><span class=nf>list</span>
</span></span><span class=line><span class=cl>	       <span class=ss>&#39;emacs-lisp-mode-hook</span>
</span></span><span class=line><span class=cl>	       <span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-hook</span> <span class=nv>hook</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>		   <span class=p>(</span><span class=nb>setq-local</span> <span class=nv>corfu-auto</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		   <span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>dolist</span> <span class=p>(</span><span class=nv>hook</span> <span class=p>(</span><span class=nf>list</span>
</span></span><span class=line><span class=cl>	       <span class=ss>&#39;python-mode-hook</span>
</span></span><span class=line><span class=cl>	       <span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-hook</span> <span class=nv>hook</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>		   <span class=p>(</span><span class=nb>setq-local</span> <span class=nv>corfu-auto</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		   <span class=p>(</span><span class=nv>lsp-bridge-mode</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		   <span class=p>)))</span>
</span></span></code></pre></div><h3 id=multiple-programming-language class=headerLink><a href=#multiple-programming-language class=header-mark></a>Multiple Programming Language</h3><h4 id=markdown class=headerLink><a href=#markdown class=header-mark></a>Markdown</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;auto-mode-alist</span>
</span></span><span class=line><span class=cl>	     <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;README\\.md\\&#39;&#34;</span> <span class=o>.</span> <span class=nv>gfm-mode</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=csv class=headerLink><a href=#csv class=header-mark></a>CSV</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;auto-mode-alist</span>
</span></span><span class=line><span class=cl>	     <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;\\.csv\\&#39;&#34;</span> <span class=o>.</span> <span class=nv>csv-mode</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=yaml class=headerLink><a href=#yaml class=header-mark></a>Yaml</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;auto-mode-alist</span>
</span></span><span class=line><span class=cl>	     <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;\\.yaml\\&#39;&#34;</span> <span class=o>.</span> <span class=nv>yaml-mode</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=python class=headerLink><a href=#python class=header-mark></a>Python</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>python-shell-interpreter</span> <span class=s>&#34;python3&#34;</span>
</span></span><span class=line><span class=cl>      <span class=nv>python-indent-guess-indent-offset</span> <span class=no>nil</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=benchmark class=headerLink><a href=#benchmark class=header-mark></a>Benchmark</h3><p>Emacs Works with Multiple Language 启动时间约 0.04s 。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nf>message</span> <span class=s>&#34;Emacs Works with Multiple Language: %.2fs&#34;</span>
</span></span><span class=line><span class=cl>	 <span class=p>(</span><span class=nf>float-time</span> <span class=p>(</span><span class=nf>time-subtract</span> <span class=p>(</span><span class=nf>current-time</span><span class=p>)</span> <span class=nv>my/section-start-time</span><span class=p>)))</span>
</span></span></code></pre></div><h2 id=organize-life-with-plain-text class=headerLink><a href=#organize-life-with-plain-text class=header-mark></a>Organize Life With Plain Text</h2><p>使用纯文本组织生活，是一种哲学，是一种生活方式。此 <a href=http://doc.norang.ca/org-mode.html target=_blank rel="noopener noreffer">Blog</a> 是践行此哲学的开端。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>my/section-start-time</span> <span class=p>(</span><span class=nf>current-time</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=better-default class=headerLink><a href=#better-default class=header-mark></a>Better Default</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-modules</span>  <span class=o>&#39;</span><span class=p>()</span>
</span></span><span class=line><span class=cl>      <span class=nv>org-deadline-warning-days</span> <span class=mi>7</span>
</span></span><span class=line><span class=cl>      <span class=nv>org-imenu-depth</span> <span class=mi>4</span>
</span></span><span class=line><span class=cl>      <span class=nv>org-return-follows-link</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>      <span class=nv>org-agenda-dim-blocked-tasks</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>      <span class=nv>org-image-actual-width</span> <span class=no>nil</span>
</span></span><span class=line><span class=cl>      <span class=nv>org-display-remote-inline-images</span> <span class=ss>&#39;download</span>
</span></span><span class=line><span class=cl>      <span class=nv>org-log-into-drawer</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>      <span class=nv>org-fast-tag-selection-single-key</span> <span class=ss>&#39;expert</span>
</span></span><span class=line><span class=cl>      <span class=nv>org-adapt-indentation</span> <span class=no>nil</span>
</span></span><span class=line><span class=cl>      <span class=nv>org-fontify-quote-and-verse-blocks</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>      <span class=nv>org-support-shift-select</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>      <span class=c1>;; org--leading-stars t</span>
</span></span><span class=line><span class=cl>      <span class=c1>;; org-hide-block-startup t</span>
</span></span><span class=line><span class=cl>      <span class=nv>org-treat-S-cursor-todo-selection-as-state-change</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-startup-with-inline-images</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;revert-without-query</span> <span class=s>&#34;.+\\.org&#34;</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=word-wrap class=headerLink><a href=#word-wrap class=header-mark></a>Word wrap</h4><p>我喜欢文本在窗口的边缘进行折行。不喜欢使用 visual-line-mode 式的折行，此方式当中英文夹杂时，在行尾参差不齐，实在是用不来。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;org-mode-hook</span> <span class=ss>&#39;menu-bar--wrap-long-lines-window-edge</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=todo-keywords-and-faces class=headerLink><a href=#todo-keywords-and-faces class=header-mark></a>todo keywords and faces</h4><p>If you do not provide the separator bar, the last state is used as the DONE state.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-todo-keywords</span>
</span></span><span class=line><span class=cl>      <span class=o>&#39;</span><span class=p>((</span><span class=nv>sequence</span> <span class=s>&#34;TODO(t)&#34;</span> <span class=s>&#34;NEXT(n)&#34;</span> <span class=s>&#34;STARTED&#34;</span> <span class=s>&#34;|&#34;</span> <span class=s>&#34;WAIT(w@)&#34;</span> <span class=s>&#34;SOMEDAY(s@)&#34;</span> <span class=s>&#34;CNCL(c@/!)&#34;</span> <span class=s>&#34;DONE(d)&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-todo-keyword-faces</span>
</span></span><span class=line><span class=cl>      <span class=o>&#39;</span><span class=p>((</span><span class=s>&#34;TODO&#34;</span> <span class=nb>:foreground</span> <span class=s>&#34;Red&#34;</span> <span class=nb>:weight</span> <span class=nv>bold</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=s>&#34;NEXT&#34;</span> <span class=nb>:foreground</span> <span class=s>&#34;Forest green&#34;</span> <span class=nb>:weight</span> <span class=nv>bold</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=s>&#34;SOMEDAY&#34;</span> <span class=nb>:foreground</span> <span class=s>&#34;blue&#34;</span> <span class=nb>:weight</span> <span class=nv>bold</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=s>&#34;DONE&#34;</span> <span class=nb>:foreground</span> <span class=s>&#34;#705628&#34;</span> <span class=nb>:weight</span> <span class=nv>bold</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=s>&#34;WAIT&#34;</span> <span class=nb>:foreground</span> <span class=s>&#34;Orange&#34;</span> <span class=nb>:weight</span> <span class=nv>bold</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=s>&#34;CNCL&#34;</span> <span class=nb>:foreground</span> <span class=s>&#34;#b4534b&#34;</span> <span class=nb>:weight</span> <span class=nv>bold</span><span class=p>)))</span>
</span></span></code></pre></div><h4 id=todo-state-triggers class=headerLink><a href=#todo-state-triggers class=header-mark></a>todo state triggers</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-todo-state-tags-triggers</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>quote</span> <span class=p>((</span><span class=s>&#34;CNCL&#34;</span> <span class=p>(</span><span class=s>&#34;CNCL&#34;</span> <span class=o>.</span> <span class=no>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	      <span class=p>(</span><span class=s>&#34;WAIT&#34;</span> <span class=p>(</span><span class=s>&#34;WAIT&#34;</span> <span class=o>.</span> <span class=no>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	      <span class=p>(</span><span class=s>&#34;SOMEDAY&#34;</span> <span class=p>(</span><span class=s>&#34;WAIT&#34;</span><span class=p>)</span> <span class=p>(</span><span class=s>&#34;SOMEDAY&#34;</span> <span class=o>.</span> <span class=no>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	      <span class=p>(</span><span class=nv>done</span> <span class=p>(</span><span class=s>&#34;WAIT&#34;</span><span class=p>)</span> <span class=p>(</span><span class=s>&#34;SOMEDAY&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	      <span class=p>(</span><span class=s>&#34;TODO&#34;</span> <span class=p>(</span><span class=s>&#34;WAIT&#34;</span><span class=p>)</span> <span class=p>(</span><span class=s>&#34;CNCL&#34;</span><span class=p>)</span> <span class=p>(</span><span class=s>&#34;SOMEDAY&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	      <span class=p>(</span><span class=s>&#34;NEXT&#34;</span> <span class=p>(</span><span class=s>&#34;WAIT&#34;</span><span class=p>)</span> <span class=p>(</span><span class=s>&#34;CNCL&#34;</span><span class=p>)</span> <span class=p>(</span><span class=s>&#34;SOMEDAY&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	      <span class=p>(</span><span class=s>&#34;DONE&#34;</span> <span class=p>(</span><span class=s>&#34;WAIT&#34;</span><span class=p>)</span> <span class=p>(</span><span class=s>&#34;CNCL&#34;</span><span class=p>)</span> <span class=p>(</span><span class=s>&#34;SOMEDAY&#34;</span><span class=p>)))))</span>
</span></span></code></pre></div><h4 id=org-priority class=headerLink><a href=#org-priority class=header-mark></a>org priority</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-priority-faces</span> <span class=o>&#39;</span><span class=p>((</span><span class=sc>?A</span> <span class=o>.</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>bold</span> <span class=nv>org-priority</span><span class=p>))</span>
</span></span><span class=line><span class=cl>			   <span class=p>(</span><span class=sc>?B</span> <span class=o>.</span> <span class=nv>org-priority</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			   <span class=p>(</span><span class=sc>?C</span> <span class=o>.</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>shadow</span> <span class=nv>org-priority</span><span class=p>))))</span>
</span></span></code></pre></div><h4 id=org-emphasis-color class=headerLink><a href=#org-emphasis-color class=header-mark></a>org emphasis color</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defface</span> <span class=nv>my-org-emphasis-bold</span>
</span></span><span class=line><span class=cl>  <span class=o>&#39;</span><span class=p>((</span><span class=nv>default</span> <span class=nb>:inherit</span> <span class=nv>bold</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(((</span><span class=nv>class</span> <span class=nv>color</span><span class=p>)</span> <span class=p>(</span><span class=nv>min-colors</span> <span class=mi>88</span><span class=p>)</span> <span class=p>(</span><span class=nv>background</span> <span class=nv>light</span><span class=p>))</span>
</span></span><span class=line><span class=cl>     <span class=nb>:foreground</span> <span class=s>&#34;#a60000&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(((</span><span class=nv>class</span> <span class=nv>color</span><span class=p>)</span> <span class=p>(</span><span class=nv>min-colors</span> <span class=mi>88</span><span class=p>)</span> <span class=p>(</span><span class=nv>background</span> <span class=nv>dark</span><span class=p>))</span>
</span></span><span class=line><span class=cl>     <span class=nb>:foreground</span> <span class=s>&#34;#ff8059&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;My bold emphasis for Org.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>:group</span> <span class=ss>&#39;org-faces</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defface</span> <span class=nv>my-org-emphasis-italic</span>
</span></span><span class=line><span class=cl>  <span class=o>&#39;</span><span class=p>((</span><span class=nv>default</span> <span class=nb>:inherit</span> <span class=nv>italic</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(((</span><span class=nv>class</span> <span class=nv>color</span><span class=p>)</span> <span class=p>(</span><span class=nv>min-colors</span> <span class=mi>88</span><span class=p>)</span> <span class=p>(</span><span class=nv>background</span> <span class=nv>light</span><span class=p>))</span>
</span></span><span class=line><span class=cl>     <span class=nb>:foreground</span> <span class=s>&#34;#005e00&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(((</span><span class=nv>class</span> <span class=nv>color</span><span class=p>)</span> <span class=p>(</span><span class=nv>min-colors</span> <span class=mi>88</span><span class=p>)</span> <span class=p>(</span><span class=nv>background</span> <span class=nv>dark</span><span class=p>))</span>
</span></span><span class=line><span class=cl>     <span class=nb>:foreground</span> <span class=s>&#34;#44bc44&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;My italic emphasis for Org.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>:group</span> <span class=ss>&#39;org-faces</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defface</span> <span class=nv>my-org-emphasis-underline</span>
</span></span><span class=line><span class=cl>  <span class=o>&#39;</span><span class=p>((</span><span class=nv>default</span> <span class=nb>:inherit</span> <span class=nv>underline</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(((</span><span class=nv>class</span> <span class=nv>color</span><span class=p>)</span> <span class=p>(</span><span class=nv>min-colors</span> <span class=mi>88</span><span class=p>)</span> <span class=p>(</span><span class=nv>background</span> <span class=nv>light</span><span class=p>))</span>
</span></span><span class=line><span class=cl>     <span class=nb>:foreground</span> <span class=s>&#34;#813e00&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(((</span><span class=nv>class</span> <span class=nv>color</span><span class=p>)</span> <span class=p>(</span><span class=nv>min-colors</span> <span class=mi>88</span><span class=p>)</span> <span class=p>(</span><span class=nv>background</span> <span class=nv>dark</span><span class=p>))</span>
</span></span><span class=line><span class=cl>     <span class=nb>:foreground</span> <span class=s>&#34;#d0bc00&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;My underline emphasis for Org.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>:group</span> <span class=ss>&#39;org-faces</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defface</span> <span class=nv>my-org-emphasis-strike-through</span>
</span></span><span class=line><span class=cl>  <span class=o>&#39;</span><span class=p>((((</span><span class=nv>class</span> <span class=nv>color</span><span class=p>)</span> <span class=p>(</span><span class=nv>min-colors</span> <span class=mi>88</span><span class=p>)</span> <span class=p>(</span><span class=nv>background</span> <span class=nv>light</span><span class=p>))</span>
</span></span><span class=line><span class=cl>     <span class=nb>:strike-through</span> <span class=s>&#34;#972500&#34;</span> <span class=nb>:foreground</span> <span class=s>&#34;#505050&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(((</span><span class=nv>class</span> <span class=nv>color</span><span class=p>)</span> <span class=p>(</span><span class=nv>min-colors</span> <span class=mi>88</span><span class=p>)</span> <span class=p>(</span><span class=nv>background</span> <span class=nv>dark</span><span class=p>))</span>
</span></span><span class=line><span class=cl>     <span class=nb>:strike-through</span> <span class=s>&#34;#ef8b50&#34;</span> <span class=nb>:foreground</span> <span class=s>&#34;#a8a8a8&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;My strike-through emphasis for Org.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>:group</span> <span class=ss>&#39;org-faces</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defface</span> <span class=nv>my-org-emphasis-verbatim</span>
</span></span><span class=line><span class=cl>  <span class=o>&#39;</span><span class=p>((((</span><span class=nv>class</span> <span class=nv>color</span><span class=p>)</span> <span class=p>(</span><span class=nv>min-colors</span> <span class=mi>88</span><span class=p>)</span> <span class=p>(</span><span class=nv>background</span> <span class=nv>light</span><span class=p>))</span>
</span></span><span class=line><span class=cl>     <span class=nb>:background</span> <span class=s>&#34;#F7B80A&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(((</span><span class=nv>class</span> <span class=nv>color</span><span class=p>)</span> <span class=p>(</span><span class=nv>min-colors</span> <span class=mi>88</span><span class=p>)</span> <span class=p>(</span><span class=nv>background</span> <span class=nv>dark</span><span class=p>))</span>
</span></span><span class=line><span class=cl>     <span class=nb>:background</span> <span class=s>&#34;#6DA906&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;My strike-through emphasis for Org.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>:group</span> <span class=ss>&#39;org-faces</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-emphasis-alist</span>
</span></span><span class=line><span class=cl>      <span class=o>&#39;</span><span class=p>((</span><span class=s>&#34;*&#34;</span> <span class=nv>my-org-emphasis-bold</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=s>&#34;/&#34;</span> <span class=nv>my-org-emphasis-italic</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=s>&#34;_&#34;</span> <span class=nv>my-org-emphasis-underline</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=s>&#34;~&#34;</span> <span class=nv>org-code</span> <span class=nv>verbatim</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=s>&#34;+&#34;</span> <span class=nv>my-org-emphasis-strike-through</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=s>&#34;=&#34;</span> <span class=nv>my-org-emphasis-verbatim</span><span class=p>)))</span>
</span></span></code></pre></div><h4 id=org-babel-load-languages class=headerLink><a href=#org-babel-load-languages class=header-mark></a>org-babel-load-languages</h4><p>根据需要加载 org-babel-load-languages, 加快 Emacs 的启动速度，<a href=https://emacs-china.org/t/org-babel/18699 target=_blank rel="noopener noreffer">相关讨论见 Emacs-china 论坛</a>。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=c1>;; (org-babel-do-load-languages</span>
</span></span><span class=line><span class=cl><span class=c1>;;  &#39;org-babel-load-languages</span>
</span></span><span class=line><span class=cl><span class=c1>;;  &#39;((emacs-lisp . t)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my/org-babel-execute-src-block</span> <span class=p>(</span><span class=kp>&amp;optional</span> <span class=nv>_arg</span> <span class=nv>info</span> <span class=nv>_params</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Load language if needed&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let*</span> <span class=p>((</span><span class=nv>lang</span> <span class=p>(</span><span class=nf>nth</span> <span class=mi>0</span> <span class=nv>info</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	 <span class=p>(</span><span class=nv>sym</span> <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nf>member</span> <span class=p>(</span><span class=nf>downcase</span> <span class=nv>lang</span><span class=p>)</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;c&#34;</span> <span class=s>&#34;cpp&#34;</span> <span class=s>&#34;c++&#34;</span><span class=p>))</span> <span class=ss>&#39;C</span> <span class=p>(</span><span class=nf>intern</span> <span class=nv>lang</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>	 <span class=p>(</span><span class=nv>backup-languages</span> <span class=nv>org-babel-load-languages</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=c1>;; - (LANG . nil) 明确禁止的语言，不加载。</span>
</span></span><span class=line><span class=cl>    <span class=c1>;; - (LANG . t) 已加载过的语言，不重复载。</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>unless</span> <span class=p>(</span><span class=nf>assoc</span> <span class=nv>sym</span> <span class=nv>backup-languages</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>condition-case</span> <span class=nv>err</span>
</span></span><span class=line><span class=cl>	  <span class=p>(</span><span class=nb>progn</span>
</span></span><span class=line><span class=cl>	    <span class=p>(</span><span class=nv>org-babel-do-load-languages</span> <span class=ss>&#39;org-babel-load-languages</span> <span class=p>(</span><span class=nf>list</span> <span class=p>(</span><span class=nf>cons</span> <span class=nv>sym</span> <span class=no>t</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>	    <span class=p>(</span><span class=nb>setq-default</span> <span class=nv>org-babel-load-languages</span> <span class=p>(</span><span class=nf>append</span> <span class=p>(</span><span class=nf>list</span> <span class=p>(</span><span class=nf>cons</span> <span class=nv>sym</span> <span class=no>t</span><span class=p>))</span> <span class=nv>backup-languages</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=nv>file-missing</span>
</span></span><span class=line><span class=cl>	 <span class=p>(</span><span class=nb>setq-default</span> <span class=nv>org-babel-load-languages</span> <span class=nv>backup-languages</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	 <span class=nv>err</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>advice-add</span> <span class=ss>&#39;org-babel-execute-src-block</span> <span class=nb>:before</span> <span class=ss>&#39;my/org-babel-execute-src-block</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-confirm-babel-evaluate</span> <span class=no>nil</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=org-capture class=headerLink><a href=#org-capture class=header-mark></a>org-capture</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-capture-templates</span>
</span></span><span class=line><span class=cl>      <span class=o>&#39;</span><span class=p>((</span><span class=s>&#34;d&#34;</span> <span class=s>&#34;Today Diary&#34;</span> <span class=nv>entry</span> <span class=p>(</span><span class=nv>file+headline</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span> <span class=p>(</span><span class=nf>concat</span> <span class=nv>my-roam</span> <span class=s>&#34;/daily/&#34;</span> <span class=p>(</span><span class=nf>format-time-string</span> <span class=s>&#34;%Y-%m-%d&#34;</span> <span class=p>(</span><span class=nf>current-time</span><span class=p>))</span> <span class=s>&#34;.org&#34;</span><span class=p>))</span> <span class=s>&#34;Morning Diary&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	 <span class=s>&#34;* %? \n%U\n\n&#34;</span> <span class=nb>:jump-to-captured</span> <span class=no>t</span> <span class=nb>:clock-in</span> <span class=no>t</span> <span class=nb>:clock-resume</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=s>&#34;t&#34;</span> <span class=s>&#34;Tasks&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=s>&#34;tt&#34;</span> <span class=s>&#34;Today Tasks&#34;</span> <span class=nv>plain</span> <span class=p>(</span><span class=nv>file+headline</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span> <span class=p>(</span><span class=nf>concat</span> <span class=nv>my-roam</span> <span class=s>&#34;/daily/&#34;</span> <span class=p>(</span><span class=nf>format-time-string</span> <span class=s>&#34;%Y-%m-%d&#34;</span> <span class=p>(</span><span class=nf>current-time</span><span class=p>))</span> <span class=s>&#34;.org&#34;</span><span class=p>))</span> <span class=s>&#34;GTD&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	 <span class=s>&#34;+ [ ] %?&#34;</span> <span class=nb>:jump-to-captured</span> <span class=no>t</span> <span class=nb>:clock-in</span> <span class=no>t</span> <span class=nb>:clock-resume</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=s>&#34;td&#34;</span> <span class=s>&#34;Date Tasks&#34;</span> <span class=nv>plain</span> <span class=p>(</span><span class=nv>file+headline</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span> <span class=p>(</span><span class=nf>concat</span> <span class=nv>my-roam</span> <span class=s>&#34;/daily/&#34;</span> <span class=p>(</span><span class=nv>org-read-date</span><span class=p>)</span> <span class=s>&#34;.org&#34;</span><span class=p>))</span> <span class=s>&#34;GTD&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	 <span class=s>&#34;** TODO %? \n%U\n\n&#34;</span> <span class=nb>:jump-to-captured</span> <span class=no>t</span> <span class=nb>:clock-in</span> <span class=no>t</span> <span class=nb>:clock-resume</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=s>&#34;i&#34;</span> <span class=s>&#34;Tasks inbox&#34;</span> <span class=nv>plain</span> <span class=p>(</span><span class=nv>file+headline</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span> <span class=p>(</span><span class=nf>concat</span> <span class=nv>my-roam</span> <span class=s>&#34;/daily/&#34;</span> <span class=p>(</span><span class=nf>format-time-string</span> <span class=s>&#34;%Y-%m-%d&#34;</span> <span class=p>(</span><span class=nf>current-time</span><span class=p>))</span> <span class=s>&#34;.org&#34;</span><span class=p>))</span> <span class=s>&#34;GTD&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	 <span class=s>&#34;** TODO %?\n%U\n\n&#34;</span> <span class=nb>:jump-to-captured</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=s>&#34;r&#34;</span> <span class=s>&#34;Random Notes&#34;</span> <span class=nv>entry</span> <span class=p>(</span><span class=nv>file+headline</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span> <span class=p>(</span><span class=nf>concat</span> <span class=nv>my-roam</span> <span class=s>&#34;/daily/&#34;</span> <span class=p>(</span><span class=nf>format-time-string</span> <span class=s>&#34;%Y-%m-%d&#34;</span> <span class=p>(</span><span class=nf>current-time</span><span class=p>))</span> <span class=s>&#34;.org&#34;</span><span class=p>))</span> <span class=s>&#34;Random Notes&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	 <span class=s>&#34;* %?\n%U\n\n&#34;</span> <span class=nb>:jump-to-captured</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=s>&#34;s&#34;</span> <span class=s>&#34;Code Snippet&#34;</span> <span class=nv>entry</span> <span class=p>(</span><span class=nv>file</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span> <span class=p>(</span><span class=nf>concat</span> <span class=nv>my-roam</span> <span class=s>&#34;/main/snippets.org&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>	 <span class=s>&#34;* %?\t%^g\n#+BEGIN_SRC %^{language}\n\n#+END_SRC&#34;</span><span class=p>)))</span>
</span></span></code></pre></div><ul><li><p>org-capture shortcut</p><p>不是很喜欢 org-capture 触发的窗口，然后再在窗口中选择要执行的命令。对于经常使用的 template ，我选择使用 one-key 。这样大部分情况下我不需要看一个占据半个屏幕的窗口。 one-key 默认不弹出窗口，其仅在 echo area 中显示提示信息，有需要的时候通过 <code>?</code> 展示就好了。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my/org-capture-shortcut</span> <span class=p>(</span><span class=nv>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>org-capture</span> <span class=no>nil</span> <span class=nv>key</span><span class=p>))</span>
</span></span></code></pre></div></li></ul><h4 id=org-attach class=headerLink><a href=#org-attach class=header-mark></a>org-attach</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-attach-id-to-path-function-list</span>
</span></span><span class=line><span class=cl>      <span class=o>&#39;</span><span class=p>(</span><span class=nv>org-attach-id-ts-folder-format</span>
</span></span><span class=line><span class=cl>	<span class=nv>org-attach-id-uuid-folder-format</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-attach-dir-relative</span> <span class=no>t</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=org-refile class=headerLink><a href=#org-refile class=header-mark></a>org-refile</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-refile-targets</span> <span class=o>&#39;</span><span class=p>((</span><span class=no>nil</span> <span class=nb>:maxlevel</span> <span class=o>.</span> <span class=mi>9</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			   <span class=p>(</span><span class=nv>org-agenda-files</span> <span class=nb>:maxlevel</span> <span class=o>.</span> <span class=mi>9</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-refile-use-outline-path</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-outline-path-complete-in-steps</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-refile-allow-creating-parent-nodes</span> <span class=ss>&#39;confirm</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-refile-use-outline-path</span> <span class=ss>&#39;file</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-refile-active-region-within-subtree</span> <span class=no>t</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=org-frame class=headerLink><a href=#org-frame class=header-mark></a>org-frame</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-link-frame-setup</span> <span class=o>&#39;</span><span class=p>((</span><span class=nv>vm</span> <span class=o>.</span> <span class=nv>vm-visit-folder-other-frame</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			     <span class=p>(</span><span class=nv>vm-imap</span> <span class=o>.</span> <span class=nv>vm-visit-imap-folder-other-frame</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			     <span class=p>(</span><span class=nv>gnus</span> <span class=o>.</span> <span class=nv>org-gnus-no-new-news</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			     <span class=p>(</span><span class=nv>file</span> <span class=o>.</span> <span class=nv>find-file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			     <span class=p>(</span><span class=nv>wl</span> <span class=o>.</span> <span class=nv>wl-other-frame</span><span class=p>)))</span>
</span></span></code></pre></div><h4 id=org-archive class=headerLink><a href=#org-archive class=header-mark></a>org-archive</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>customize-set-variable</span> <span class=ss>&#39;org-archive-location</span> <span class=s>&#34;~/Nextcloud/L.Personal.Galaxy/roam/main/gtd.org::datetree/* From %s&#34;</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=org-habit class=headerLink><a href=#org-habit class=header-mark></a>org-habit</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;org-modules</span> <span class=ss>&#39;org-habit</span> <span class=no>t</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=org-src class=headerLink><a href=#org-src class=header-mark></a>org src</h4><p>默认是在右侧打开编辑 buffer ，我的屏幕小，所以我选择当前窗口打开编辑 buffer 。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;org</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-src-window-setup</span> <span class=ss>&#39;current-window</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=org-id class=headerLink><a href=#org-id class=header-mark></a>org-id</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-id-method</span> <span class=ss>&#39;ts</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-id-link-to-org-use-id</span> <span class=ss>&#39;create-if-interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-id-locations-file</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;.org-id-locations&#34;</span> <span class=nv>my-cache-directory</span><span class=p>))</span>
</span></span></code></pre></div><ul><li><p>Copy id to clipboard</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my/copy-idlink-to-clipboard</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Copy idlink to clipboard.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nf>eq</span> <span class=nv>major-mode</span> <span class=ss>&#39;org-agenda-mode</span><span class=p>)</span> <span class=c1>;switch to orgmode</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>org-agenda-show</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>org-agenda-goto</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nf>eq</span> <span class=nv>major-mode</span> <span class=ss>&#39;org-mode</span><span class=p>)</span> <span class=c1>; do this only in org-mode buffers</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>let*</span> <span class=p>((</span><span class=nv>mytmphead</span> <span class=p>(</span><span class=nf>nth</span> <span class=mi>4</span> <span class=p>(</span><span class=nv>org-heading-components</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>	   <span class=p>(</span><span class=nv>mytmpid</span> <span class=p>(</span><span class=nf>funcall</span> <span class=ss>&#39;org-id-get-create</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	   <span class=p>(</span><span class=nv>mytmplink</span> <span class=p>(</span><span class=nf>format</span> <span class=s>&#34;[[id:%s][%s]]&#34;</span> <span class=nv>mytmpid</span> <span class=nv>mytmphead</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>kill-new</span> <span class=nv>mytmplink</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nf>message</span> <span class=s>&#34;Copied %s to killring (clipboard)&#34;</span> <span class=nv>mytmplink</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>switch-to-buffer</span> <span class=p>(</span><span class=nf>concat</span> <span class=p>(</span><span class=nf>format-time-string</span> <span class=s>&#34;%Y-%m-%d&#34;</span><span class=p>)</span> <span class=s>&#34;.org&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;&lt;f8&gt;&#34;</span><span class=p>)</span> <span class=ss>&#39;my/copy-idlink-to-clipboard</span><span class=p>)</span>
</span></span></code></pre></div></li></ul><h4 id=org-clock class=headerLink><a href=#org-clock class=header-mark></a>org-clock</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=c1>;; (org-clock-persistence-insinuate)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;on-first-buffer-hook</span> <span class=ss>&#39;org-clock-persistence-insinuate</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-clock-into-drawer</span> <span class=s>&#34;LOGCLOCK&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-clock-out-remove-zero-time-clocks</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-clock-out-when-done</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-clock-persist</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-clock-report-include-clocking-task</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-clock-persist-file</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;org-clock-save.el&#34;</span> <span class=nv>my-cache-directory</span><span class=p>))</span>
</span></span></code></pre></div><ul><li><p>switch task from TODO to NEXT</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>bh/is-task-p</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Any task with a todo keyword and no subtask&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>save-restriction</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>widen</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>has-subtask</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	  <span class=p>(</span><span class=nv>subtree-end</span> <span class=p>(</span><span class=nb>save-excursion</span> <span class=p>(</span><span class=nv>org-end-of-subtree</span> <span class=no>t</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>	  <span class=p>(</span><span class=nv>is-a-task</span> <span class=p>(</span><span class=nf>member</span> <span class=p>(</span><span class=nf>nth</span> <span class=mi>2</span> <span class=p>(</span><span class=nv>org-heading-components</span><span class=p>))</span> <span class=nv>org-todo-keywords-1</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>save-excursion</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=nf>forward-line</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=nb>while</span> <span class=p>(</span><span class=nb>and</span> <span class=p>(</span><span class=nv>not</span> <span class=nv>has-subtask</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		    <span class=p>(</span><span class=nf>&lt;</span> <span class=p>(</span><span class=nf>point</span><span class=p>)</span> <span class=nv>subtree-end</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		    <span class=p>(</span><span class=nf>re-search-forward</span> <span class=s>&#34;^\*+ &#34;</span> <span class=nv>subtree-end</span> <span class=no>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	  <span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nf>member</span> <span class=p>(</span><span class=nv>org-get-todo-state</span><span class=p>)</span> <span class=nv>org-todo-keywords-1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	    <span class=p>(</span><span class=nb>setq</span> <span class=nv>has-subtask</span> <span class=no>t</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>and</span> <span class=nv>is-a-task</span> <span class=p>(</span><span class=nv>not</span> <span class=nv>has-subtask</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>bh/clock-in-to-next</span> <span class=p>(</span><span class=nv>kw</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Switch a task from TODO to NEXT when clocking in.
</span></span></span><span class=line><span class=cl><span class=s>Skips capture tasks, projects, and subprojects.
</span></span></span><span class=line><span class=cl><span class=s>Switch projects and subprojects from NEXT back to TODO&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nv>not</span> <span class=p>(</span><span class=nb>and</span> <span class=p>(</span><span class=nf>boundp</span> <span class=ss>&#39;org-capture-mode</span><span class=p>)</span> <span class=nv>org-capture-mode</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>cond</span>
</span></span><span class=line><span class=cl>     <span class=p>((</span><span class=nb>and</span> <span class=p>(</span><span class=nf>member</span> <span class=p>(</span><span class=nv>org-get-todo-state</span><span class=p>)</span> <span class=p>(</span><span class=nf>list</span> <span class=s>&#34;TODO&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	   <span class=p>(</span><span class=nv>bh/is-task-p</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=s>&#34;NEXT&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=p>((</span><span class=nb>and</span> <span class=p>(</span><span class=nf>member</span> <span class=p>(</span><span class=nv>org-get-todo-state</span><span class=p>)</span> <span class=p>(</span><span class=nf>list</span> <span class=s>&#34;NEXT&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	   <span class=p>(</span><span class=nv>bh/is-project-p</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=s>&#34;TODO&#34;</span><span class=p>))))</span>
</span></span></code></pre></div></li></ul><h4 id=org-num class=headerLink><a href=#org-num class=header-mark></a>org-num</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;org-mode-hook</span> <span class=ss>&#39;org-num-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=packages-enhance-org class=headerLink><a href=#packages-enhance-org class=header-mark></a>Packages enhance org</h3><h4 id=auto-tangle class=headerLink><a href=#auto-tangle class=header-mark></a>auto-tangle</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>unless</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>fboundp</span> <span class=ss>&#39;org-auto-tangle-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>autoload</span> <span class=nf>#&#39;</span><span class=nv>org-auto-tangle-mode</span> <span class=s>&#34;org-auto-tangle&#34;</span> <span class=no>nil</span> <span class=no>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;org-mode-hook</span> <span class=ss>&#39;org-auto-tangle-mode</span><span class=p>)</span>
</span></span></code></pre></div><ul><li><p>toc-org</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;org-mode-hook</span> <span class=ss>&#39;toc-org-mode</span><span class=p>)</span>
</span></span></code></pre></div></li></ul><h4 id=org-superstar class=headerLink><a href=#org-superstar class=header-mark></a>org-superstar</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;org-mode-hook</span> <span class=ss>&#39;org-superstar-mode</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=org-download class=headerLink><a href=#org-download class=header-mark></a>org-download</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-download-image-dir</span> <span class=s>&#34;~/Nextcloud/L.Personal.Galaxy/roam/pic&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-download-screenshot-method</span> <span class=ss>&#39;screencapture</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-download-abbreviate-filename-function</span> <span class=ss>&#39;expand-file-name</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-download-timestamp</span> <span class=s>&#34;%Y%m%d%H%M%S&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-download-display-inline-images</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-download-heading-lvl</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-download-annotate-function</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>(</span><span class=nv>_link</span><span class=p>)</span> <span class=s>&#34;&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-download-image-attr-list</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;#+NAME:fig: &#34;</span> <span class=s>&#34;#+CAPTION: &#34;</span> <span class=s>&#34;#+ATTR_ORG: :width 500px&#34;</span> <span class=s>&#34;#+ATTR_LATEX: :width 10cm :placement [!htpb]&#34;</span> <span class=s>&#34;#+ATTR_HTML: :width 600px&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-download-screenshot-basename</span> <span class=s>&#34;.png&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;org-mode-hook</span> <span class=ss>&#39;org-download-enable</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=org-appear class=headerLink><a href=#org-appear class=header-mark></a>org-appear</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-appear-trigger</span> <span class=ss>&#39;manual</span>
</span></span><span class=line><span class=cl>      <span class=nv>org-appear-autolinks</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;org-mode-hook</span> <span class=ss>&#39;org-appear-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;org-mode-hook</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>			   <span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;meow-insert-enter-hook</span> <span class=nf>#&#39;</span><span class=nv>org-appear-manual-start</span> <span class=no>nil</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			   <span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;meow-insert-exit-hook</span> <span class=nf>#&#39;</span><span class=nv>org-appear-manual-stop</span> <span class=no>nil</span> <span class=no>t</span><span class=p>)))</span>
</span></span></code></pre></div><h4 id=org-cliplink class=headerLink><a href=#org-cliplink class=header-mark></a>org-cliplink</h4><p>和 <a href=#powerthesaurus rel>Powerthesaurus</a> 一样，不需要显式 require ，只要绑定一个按键就可以使用。</p><h3 id=note-taking class=headerLink><a href=#note-taking class=header-mark></a>Note taking</h3><h4 id=org-roam-node class=headerLink><a href=#org-roam-node class=header-mark></a>org-roam-node</h4><ul><li><p>Node type</p><p>Copied from <a href=https://jethrokuan.github.io/org-roam-guide/ target=_blank rel="noopener noreffer">https://jethrokuan.github.io/org-roam-guide/</a> 。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;org-roam</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>cl-defmethod</span> <span class=nv>org-roam-node-type</span> <span class=p>((</span><span class=nv>node</span> <span class=nv>org-roam-node</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;Return the TYPE of NODE.&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>condition-case</span> <span class=no>nil</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=nf>file-name-nondirectory</span>
</span></span><span class=line><span class=cl>	 <span class=p>(</span><span class=nf>directory-file-name</span>
</span></span><span class=line><span class=cl>	  <span class=p>(</span><span class=nf>file-name-directory</span>
</span></span><span class=line><span class=cl>	   <span class=p>(</span><span class=nv>file-relative-name</span> <span class=p>(</span><span class=nv>org-roam-node-file</span> <span class=nv>node</span><span class=p>)</span> <span class=nv>org-roam-directory</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=ne>error</span> <span class=s>&#34;&#34;</span><span class=p>))))</span>
</span></span></code></pre></div></li></ul><ul><li><p>Node directory</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;org-roam</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>cl-defmethod</span> <span class=nv>org-roam-node-directories</span> <span class=p>((</span><span class=nv>node</span> <span class=nv>org-roam-node</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>if-let</span> <span class=p>((</span><span class=nv>dirs</span> <span class=p>(</span><span class=nf>file-name-directory</span> <span class=p>(</span><span class=nv>file-relative-name</span> <span class=p>(</span><span class=nv>org-roam-node-file</span> <span class=nv>node</span><span class=p>)</span> <span class=nv>org-roam-directory</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=nf>format</span> <span class=s>&#34;(%s)&#34;</span> <span class=p>(</span><span class=nf>car</span> <span class=p>(</span><span class=nv>split-string</span> <span class=nv>dirs</span> <span class=s>&#34;/&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>      <span class=s>&#34;&#34;</span><span class=p>)))</span>
</span></span></code></pre></div></li></ul><ul><li><p>Node backlink count</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;org-roam</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>cl-defmethod</span> <span class=nv>org-roam-node-backlinkscount</span> <span class=p>((</span><span class=nv>node</span> <span class=nv>org-roam-node</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>let*</span> <span class=p>((</span><span class=nv>count</span> <span class=p>(</span><span class=nv>caar</span> <span class=p>(</span><span class=nv>org-roam-db-query</span>
</span></span><span class=line><span class=cl>			   <span class=p>[</span><span class=nb>:select</span> <span class=p>(</span><span class=nf>funcall</span> <span class=nv>count</span> <span class=nv>source</span><span class=p>)</span>
</span></span><span class=line><span class=cl>				    <span class=nb>:from</span> <span class=nv>links</span>
</span></span><span class=line><span class=cl>				    <span class=nb>:where</span> <span class=p>(</span><span class=nf>=</span> <span class=nv>dest</span> <span class=nv>$s1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>				    <span class=nb>:and</span> <span class=p>(</span><span class=nf>=</span> <span class=nv>type</span> <span class=s>&#34;id&#34;</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>			   <span class=p>(</span><span class=nv>org-roam-node-id</span> <span class=nv>node</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=nf>format</span> <span class=s>&#34;[%d]&#34;</span> <span class=nv>count</span><span class=p>))))</span>
</span></span></code></pre></div></li></ul><ul><li><p>file title hierarchy</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;org-roam</span>
</span></span><span class=line><span class=cl>  <span class=c1>;; Codes blow are used to general a hierachy for title nodes that under a file</span>
</span></span><span class=line><span class=cl>  <span class=c1>;; https://github.com/nowislewis/nowisemacs/blob/master/init.org</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>cl-defmethod</span> <span class=nv>org-roam-node-doom-filetitle</span> <span class=p>((</span><span class=nv>node</span> <span class=nv>org-roam-node</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;Return the value of \&#34;#+title:\&#34; (if any) from file that NODE resides in.
</span></span></span><span class=line><span class=cl><span class=s>If there&#39;s no file-level title in the file, return empty string.&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>or</span> <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nf>=</span> <span class=p>(</span><span class=nv>org-roam-node-level</span> <span class=nv>node</span><span class=p>)</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	    <span class=p>(</span><span class=nv>org-roam-node-title</span> <span class=nv>node</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	  <span class=p>(</span><span class=nv>org-roam-get-keyword</span> <span class=s>&#34;TITLE&#34;</span> <span class=p>(</span><span class=nv>org-roam-node-file</span> <span class=nv>node</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>cl-defmethod</span> <span class=nv>org-roam-node-doom-hierarchy</span> <span class=p>((</span><span class=nv>node</span> <span class=nv>org-roam-node</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;Return hierarchy for NODE, constructed of its file title, OLP and direct title.
</span></span></span><span class=line><span class=cl><span class=s>  If some elements are missing, they will be stripped out.&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>title</span>     <span class=p>(</span><span class=nv>org-roam-node-title</span> <span class=nv>node</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	  <span class=p>(</span><span class=nv>olp</span>       <span class=p>(</span><span class=nv>org-roam-node-olp</span>   <span class=nv>node</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	  <span class=p>(</span><span class=nv>level</span>     <span class=p>(</span><span class=nv>org-roam-node-level</span> <span class=nv>node</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	  <span class=p>(</span><span class=nv>filetitle</span> <span class=p>(</span><span class=nv>org-roam-node-doom-filetitle</span> <span class=nv>node</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	  <span class=p>(</span><span class=nv>separator</span> <span class=p>(</span><span class=nf>propertize</span> <span class=s>&#34; &gt; &#34;</span> <span class=ss>&#39;face</span> <span class=ss>&#39;shadow</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>cl-case</span> <span class=nv>level</span>
</span></span><span class=line><span class=cl>	<span class=c1>;; node is a top-level file</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=mi>0</span> <span class=nv>filetitle</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=c1>;; node is a level 1 heading</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=mi>1</span> <span class=p>(</span><span class=nf>concat</span> <span class=p>(</span><span class=nf>propertize</span> <span class=nv>filetitle</span> <span class=ss>&#39;face</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>shadow</span> <span class=nv>italic</span><span class=p>))</span>
</span></span><span class=line><span class=cl>		   <span class=nv>separator</span> <span class=nv>title</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	<span class=c1>;; node is a heading with an arbitrary outline path</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=no>t</span> <span class=p>(</span><span class=nf>concat</span> <span class=p>(</span><span class=nf>propertize</span> <span class=nv>filetitle</span> <span class=ss>&#39;face</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>shadow</span> <span class=nv>italic</span><span class=p>))</span>
</span></span><span class=line><span class=cl>		   <span class=nv>separator</span> <span class=p>(</span><span class=nf>propertize</span> <span class=p>(</span><span class=nv>string-join</span> <span class=nv>olp</span> <span class=s>&#34; &gt; &#34;</span><span class=p>)</span> <span class=ss>&#39;face</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>shadow</span> <span class=nv>italic</span><span class=p>))</span>
</span></span><span class=line><span class=cl>		   <span class=nv>separator</span> <span class=nv>title</span><span class=p>))))))</span>
</span></span></code></pre></div></li></ul><h4 id=org-roam-settings class=headerLink><a href=#org-roam-settings class=header-mark></a>org-roam settings</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=c1>;; (unless</span>
</span></span><span class=line><span class=cl><span class=c1>;;       (fboundp &#39;org-roam-db-autosync-enable)</span>
</span></span><span class=line><span class=cl><span class=c1>;;   (autoload #&#39;org-roam-db-autosync-enable &#34;org-roam&#34; nil t))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;after-init-hook</span> <span class=ss>&#39;org-roam-db-autosync-enable</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;org-roam-mode-hook</span> <span class=ss>&#39;turn-on-visual-line-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;org-mode-hook</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>			   <span class=p>(</span><span class=nb>setq-local</span> <span class=nv>time-stamp-active</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>				       <span class=nv>time-stamp-start</span> <span class=s>&#34;#\\+MODIFIED:[ \t]*&#34;</span>
</span></span><span class=line><span class=cl>				       <span class=nv>time-stamp-end</span> <span class=s>&#34;$&#34;</span>
</span></span><span class=line><span class=cl>				       <span class=nv>time-stamp-format</span> <span class=s>&#34;\[%Y-%m-%d %3a %H:%M\]&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			   <span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;before-save-hook</span> <span class=ss>&#39;time-stamp</span> <span class=no>nil</span> <span class=ss>&#39;local</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-roam-db-gc-threshold</span> <span class=nv>most-positive-fixnum</span>
</span></span><span class=line><span class=cl>      <span class=nv>org-roam-completion-everywhere</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>      <span class=nv>org-roam-directory</span> <span class=p>(</span><span class=nv>file-truename</span> <span class=nv>my-roam</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=nv>org-roam-db-location</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;org-roam.db&#34;</span> <span class=nv>my-cache-directory</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=nv>org-roam-node-display-template</span> <span class=p>(</span><span class=nf>concat</span> <span class=s>&#34;${type:8} ${backlinkscount:3} ${doom-hierarchy:*}&#34;</span> <span class=p>(</span><span class=nf>propertize</span> <span class=s>&#34;${tags:20}&#34;</span> <span class=ss>&#39;face</span> <span class=ss>&#39;org-tag</span><span class=p>)</span> <span class=s>&#34; &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=nv>org-roam-node-annotation-function</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>(</span><span class=nv>node</span><span class=p>)</span> <span class=p>(</span><span class=nv>marginalia--time</span> <span class=p>(</span><span class=nv>org-roam-node-file-mtime</span> <span class=nv>node</span><span class=p>))))</span>
</span></span></code></pre></div><h4 id=org-roam-capture-template class=headerLink><a href=#org-roam-capture-template class=header-mark></a>org-roam-capture-template</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-roam-capture-templates</span> <span class=o>&#39;</span><span class=p>((</span><span class=s>&#34;a&#34;</span> <span class=s>&#34;articles&#34;</span> <span class=nv>plain</span> <span class=s>&#34;%?&#34;</span>
</span></span><span class=line><span class=cl>				    <span class=nb>:target</span> <span class=p>(</span><span class=nv>file+head</span> <span class=s>&#34;articles/${slug}.org&#34;</span>
</span></span><span class=line><span class=cl>						       <span class=s>&#34;#+TITLE: ${title}\n#+CREATED: %U\n#+MODIFIED: \n&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>				    <span class=nb>:unnarrowed</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>				   <span class=p>(</span><span class=s>&#34;b&#34;</span> <span class=s>&#34;Books&#34;</span> <span class=nv>plain</span> <span class=p>(</span><span class=nv>file</span> <span class=s>&#34;~/.emacs.d/template/readinglog&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>				    <span class=nb>:target</span> <span class=p>(</span><span class=nv>file+head</span> <span class=s>&#34;books/${slug}.org&#34;</span>
</span></span><span class=line><span class=cl>						       <span class=s>&#34;#+TITLE: ${title}\n#+CREATED: %U\n#+MODIFIED: \n&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>				    <span class=nb>:unnarrowed</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>				   <span class=p>(</span><span class=s>&#34;d&#34;</span> <span class=s>&#34;Diary&#34;</span> <span class=nv>plain</span> <span class=s>&#34;%?&#34;</span>
</span></span><span class=line><span class=cl>				    <span class=nb>:target</span> <span class=p>(</span><span class=nv>file+datetree</span> <span class=s>&#34;daily/&lt;%Y-%m&gt;.org&#34;</span> <span class=nv>day</span><span class=p>))</span>
</span></span><span class=line><span class=cl>				   <span class=p>(</span><span class=s>&#34;m&#34;</span> <span class=s>&#34;main&#34;</span> <span class=nv>plain</span> <span class=s>&#34;%?&#34;</span>
</span></span><span class=line><span class=cl>				    <span class=nb>:target</span> <span class=p>(</span><span class=nv>file+head</span> <span class=s>&#34;main/${slug}.org&#34;</span>
</span></span><span class=line><span class=cl>						       <span class=s>&#34;#+TITLE: ${title}\n#+CREATED: %U\n#+MODIFIED: \n&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>				    <span class=nb>:unnarrowed</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>				   <span class=p>(</span><span class=s>&#34;p&#34;</span> <span class=s>&#34;people&#34;</span> <span class=nv>plain</span> <span class=p>(</span><span class=nv>file</span> <span class=s>&#34;~/.emacs.d/template/crm&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>				    <span class=nb>:target</span> <span class=p>(</span><span class=nv>file+head</span> <span class=s>&#34;crm/${slug}.org&#34;</span>
</span></span><span class=line><span class=cl>						       <span class=s>&#34;#+TITLE: ${title}\n#+CREATED: %U\n#+MODIFIED: \n&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>				    <span class=nb>:unnarrowed</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>				   <span class=p>(</span><span class=s>&#34;r&#34;</span> <span class=s>&#34;reference&#34;</span> <span class=nv>plain</span> <span class=p>(</span><span class=nv>file</span> <span class=s>&#34;~/.emacs.d/template/reference&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>				    <span class=nb>:target</span> <span class=p>(</span><span class=nv>file+head</span> <span class=s>&#34;ref/${citekey}.org&#34;</span>
</span></span><span class=line><span class=cl>						       <span class=s>&#34;#+TITLE: ${title}\n#+CREATED: %U\n#+MODIFIED: \n&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>				    <span class=nb>:unnarrowed</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>				   <span class=p>(</span><span class=s>&#34;w&#34;</span> <span class=s>&#34;work&#34;</span> <span class=nv>plain</span> <span class=s>&#34;%?&#34;</span>
</span></span><span class=line><span class=cl>				    <span class=nb>:target</span> <span class=p>(</span><span class=nv>file+head</span> <span class=s>&#34;work/${slug}.org&#34;</span>
</span></span><span class=line><span class=cl>						       <span class=s>&#34;#+TITLE: ${title}\n#+CREATED: %U\n#+MODIFIED: \n&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>				    <span class=nb>:unnarrowed</span> <span class=no>t</span><span class=p>)))</span>
</span></span></code></pre></div><h4 id=org-roam-buffer class=headerLink><a href=#org-roam-buffer class=header-mark></a>org-roam-buffer</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;display-buffer-alist</span>
</span></span><span class=line><span class=cl>	     <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;\\*org-roam\\*&#34;</span>
</span></span><span class=line><span class=cl>	       <span class=p>(</span><span class=nv>display-buffer-in-side-window</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	       <span class=p>(</span><span class=nv>side</span> <span class=o>.</span> <span class=nv>right</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	       <span class=p>(</span><span class=nv>window-width</span> <span class=o>.</span> <span class=mf>0.25</span><span class=p>)))</span>
</span></span></code></pre></div><p>当当前打开的文件是 org-roam 文件时，自动打开 org-roam-buffer 。总是打开 org-roam-buffer 不太实用，并不是总是需要看这个 buffer 。得思考何时才需要使用，或者手动切换更合适。
<a href=https://github.com/org-roam/org-roam/issues/507 target=_blank rel="noopener noreffer">https://github.com/org-roam/org-roam/issues/507</a></p><p>2022-05-06 更换了我使用 org-roam-buffer 这个功能的思路。之前我使用 olivetti ，现在将其从配置中移除，取而代之的是展示 org-roam-buffer 。增加了手动开关的功能，比如在查看表格的时候，有可能出现屏幕不够宽的问题，这样我可以临时手动打开或关闭 org-roam-buffer 。</p><p>发现一个问题，当打开 calendar 时使用 org-roam-dailies-goto-date 会导致 displayed-month 的错误，是因为 calendar buffer 被切掉了。 windows-buffer-change-functions 引入的。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;org-roam</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>defvar</span> <span class=nv>my/org-roam-buffer-enabled</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>defun</span> <span class=nv>my/org-roam-buffer-turn-on-off</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>if</span> <span class=nv>my/org-roam-buffer-enabled</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=nb>progn</span>
</span></span><span class=line><span class=cl>	  <span class=p>(</span><span class=nb>setq</span> <span class=nv>my/org-roam-buffer-enabled</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	  <span class=p>(</span><span class=nv>org-roam-buffer-toggle</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>progn</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=nb>setq</span> <span class=nv>my/org-roam-buffer-enabled</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=nv>org-roam-buffer-toggle</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>defun</span> <span class=nv>my/org-roam-backlinks-num</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>let*</span> <span class=p>((</span><span class=nv>count</span> <span class=p>(</span><span class=nv>caar</span> <span class=p>(</span><span class=nv>org-roam-db-query</span>
</span></span><span class=line><span class=cl>			 <span class=p>[</span><span class=nb>:select</span> <span class=p>(</span><span class=nf>funcall</span> <span class=nv>count</span> <span class=nv>source</span><span class=p>)</span>
</span></span><span class=line><span class=cl>				  <span class=nb>:from</span> <span class=nv>links</span>
</span></span><span class=line><span class=cl>				  <span class=nb>:where</span> <span class=p>(</span><span class=nf>=</span> <span class=nv>dest</span> <span class=nv>$s1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>				  <span class=nb>:and</span> <span class=p>(</span><span class=nf>=</span> <span class=nv>type</span> <span class=s>&#34;id&#34;</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>			 <span class=p>(</span><span class=nv>org-roam-node-id</span> <span class=p>(</span><span class=nv>org-roam-node-at-point</span><span class=p>))))))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nf>string-to-number</span> <span class=p>(</span><span class=nf>format</span> <span class=s>&#34;%d&#34;</span> <span class=nv>count</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>defun</span> <span class=nv>my/org-roam-buffer-show</span> <span class=p>(</span><span class=nv>_</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nb>and</span> <span class=nv>my/org-roam-buffer-enabled</span>
</span></span><span class=line><span class=cl>	       <span class=p>(</span><span class=nv>not</span> <span class=p>(</span><span class=nf>minibufferp</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	       <span class=p>(</span><span class=nv>not</span> <span class=nv>org-roam-capture--node</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	       <span class=p>(</span><span class=nv>not</span> <span class=nv>org-capture-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	       <span class=p>(</span><span class=nv>xor</span> <span class=p>(</span><span class=nv>org-roam-buffer-p</span><span class=p>)</span> <span class=p>(</span><span class=nf>eq</span> <span class=ss>&#39;visible</span> <span class=p>(</span><span class=nv>org-roam-buffer--visibility</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>org-roam-buffer-toggle</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;window-buffer-change-functions</span> <span class=nf>#&#39;</span><span class=nv>my/org-roam-buffer-show</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=search-org-roam-node-with-rg class=headerLink><a href=#search-org-roam-node-with-rg class=header-mark></a>search org-roam-node with rg</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>bms/org-roam-rg-search</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Search org-roam directory using consult-ripgrep. With live-preview.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>consult-ripgrep-command</span>
</span></span><span class=line><span class=cl>	 <span class=s>&#34;rg --null --ignore-case --type org --line-buffered --color=always --max-columns=500 --no-heading --line-number . -e ARG OPTS&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>consult-ripgrep</span> <span class=nv>org-roam-directory</span><span class=p>)))</span>
</span></span></code></pre></div><h4 id=quick-open-org-roam-ref-link class=headerLink><a href=#quick-open-org-roam-ref-link class=header-mark></a>quick open org roam ref link</h4><p>Copied from <a href="https://org-roam.discourse.group/t/opening-url-in-roam-refs-field/2564/4?u=jousimies" target=_blank rel="noopener noreffer">https://org-roam.discourse.group/t/opening-url-in-roam-refs-field/2564/4?u=jousimies</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>gpc/open-node-roam-ref-url</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Open the URL in this node&#39;s ROAM_REFS property, if one exists&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>when-let</span> <span class=p>((</span><span class=nv>ref-url</span> <span class=p>(</span><span class=nv>org-entry-get-with-inheritance</span> <span class=s>&#34;ROAM_REFS&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>browse-url</span> <span class=nv>ref-url</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;s-&lt;up&gt;&#34;</span><span class=p>)</span> <span class=ss>&#39;gpc/open-node-roam-ref-url</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=org-roam-ui class=headerLink><a href=#org-roam-ui class=header-mark></a>org-roam-ui</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-roam-ui-sync-theme</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-roam-ui-follow</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-roam-ui-update-on-save</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-roam-ui-open-on-start</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;org-roam-ui</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>require</span> <span class=ss>&#39;websocket</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=org-transclusion class=headerLink><a href=#org-transclusion class=header-mark></a>org-transclusion</h4><p>默认的 fringe 颜色是默白的，和我默认的主题颜色一样，这样就导致会看不清 transclusion 的状态。使用 <code>face-sepc-set</code> 更改下颜色。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>face-spec-set</span> <span class=ss>&#39;org-transclusion-fringe</span>
</span></span><span class=line><span class=cl>	       <span class=o>&#39;</span><span class=p>((((</span><span class=nv>background</span> <span class=nv>light</span><span class=p>))</span>
</span></span><span class=line><span class=cl>		  <span class=nb>:foreground</span> <span class=s>&#34;red&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		 <span class=p>(</span><span class=no>t</span>
</span></span><span class=line><span class=cl>		  <span class=nb>:foreground</span> <span class=s>&#34;green&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	       <span class=ss>&#39;face-override-spec</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>face-spec-set</span> <span class=ss>&#39;org-transclusion-source-fringe</span>
</span></span><span class=line><span class=cl>	       <span class=o>&#39;</span><span class=p>((((</span><span class=nv>background</span> <span class=nv>light</span><span class=p>))</span>
</span></span><span class=line><span class=cl>		  <span class=nb>:foreground</span> <span class=s>&#34;red&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		 <span class=p>(</span><span class=no>t</span>
</span></span><span class=line><span class=cl>		  <span class=nb>:foreground</span> <span class=s>&#34;green&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	       <span class=ss>&#39;face-override-spec</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=org-roam-preview-latex-formula class=headerLink><a href=#org-roam-preview-latex-formula class=header-mark></a>org-roam preview latex formula</h4><p>在 org-roam-buffer 中显示 latex 公式的预览而不是一堆原始符号，尤其是对于较复杂的公式。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;org-roam-buffer-postrender-functions</span>
</span></span><span class=line><span class=cl>	  <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span> <span class=p>(</span><span class=nv>org--latex-preview-region</span> <span class=p>(</span><span class=nf>point-min</span><span class=p>)</span> <span class=p>(</span><span class=nf>point-max</span><span class=p>))))</span>
</span></span></code></pre></div><h4 id=morning-diary class=headerLink><a href=#morning-diary class=header-mark></a>Morning Diary</h4><p>结合 org-roam-daily 写个人的日志。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defvar</span> <span class=nv>morning-diary-init-year</span> <span class=mi>2022</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>morning-diary-exclude</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Exclude the diary from the Org-roam database.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>goto-char</span> <span class=p>(</span><span class=nf>point-min</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>org-set-property</span> <span class=s>&#34;ROAM_EXCLUDE&#34;</span> <span class=s>&#34;t&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>goto-char</span> <span class=p>(</span><span class=nf>point-max</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>morning-diary-include</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>cond</span> <span class=p>((</span><span class=nb>and</span> <span class=p>(</span><span class=nv>vulpea-project-p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	      <span class=p>(</span><span class=nv>org-roam-dailies--daily-note-p</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	 <span class=p>(</span><span class=nb>save-excursion</span> <span class=p>(</span><span class=nf>goto-char</span> <span class=p>(</span><span class=nf>point-min</span><span class=p>))</span>
</span></span><span class=line><span class=cl>			 <span class=p>(</span><span class=nv>org-delete-property</span> <span class=s>&#34;ROAM_EXCLUDE&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>	<span class=p>((</span><span class=nb>and</span> <span class=p>(</span><span class=nv>org-roam-dailies--daily-note-p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	      <span class=p>(</span><span class=nv>not</span> <span class=p>(</span><span class=nv>vulpea-project-p</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>	 <span class=p>(</span><span class=nb>save-excursion</span> <span class=p>(</span><span class=nf>goto-char</span> <span class=p>(</span><span class=nf>point-min</span><span class=p>))</span>
</span></span><span class=line><span class=cl>			 <span class=p>(</span><span class=nv>org-set-property</span> <span class=s>&#34;ROAM_EXCLUDE&#34;</span> <span class=s>&#34;t&#34;</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>morning-diary-history-transclusion</span> <span class=p>(</span><span class=nv>year-span</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Only translusion 4 year diaries.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nf>&lt;</span> <span class=nv>year-span</span> <span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>dotimes</span> <span class=p>(</span><span class=nv>i</span> <span class=nv>year-span</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=nb>progn</span>
</span></span><span class=line><span class=cl>	  <span class=p>(</span><span class=nf>insert</span> <span class=p>(</span><span class=nf>format</span> <span class=s>&#34;** %s-%s\n&#34;</span> <span class=p>(</span><span class=nf>+</span> <span class=nv>i</span> <span class=nv>morning-diary-init-year</span><span class=p>)</span> <span class=p>(</span><span class=nf>format-time-string</span> <span class=s>&#34;%m-%d&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>	  <span class=p>(</span><span class=nf>insert</span> <span class=p>(</span><span class=nf>concat</span> <span class=s>&#34;#+transclude: [[file:&#34;</span> <span class=p>(</span><span class=nf>format</span> <span class=s>&#34;%s-%s.org&#34;</span> <span class=p>(</span><span class=nf>+</span> <span class=nv>i</span> <span class=nv>morning-diary-init-year</span><span class=p>)</span> <span class=p>(</span><span class=nf>format-time-string</span> <span class=s>&#34;%m-%d&#34;</span><span class=p>))</span> <span class=s>&#34;::Morning Diary]] :only-contents\n&#34;</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>dotimes</span> <span class=p>(</span><span class=nv>i</span> <span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>progn</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=nf>insert</span> <span class=p>(</span><span class=nf>format</span> <span class=s>&#34;** %s-%s\n&#34;</span> <span class=p>(</span><span class=nf>+</span> <span class=nv>i</span> <span class=nv>morning-diary-init-year</span><span class=p>)</span> <span class=p>(</span><span class=nf>format-time-string</span> <span class=s>&#34;%m-%d&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=nf>insert</span> <span class=p>(</span><span class=nf>concat</span> <span class=s>&#34;#+transclude: [[file:&#34;</span> <span class=p>(</span><span class=nf>format</span> <span class=s>&#34;%s-%s.org&#34;</span> <span class=p>(</span><span class=nf>+</span> <span class=nv>i</span> <span class=nv>morning-diary-init-year</span><span class=p>)</span> <span class=p>(</span><span class=nf>format-time-string</span> <span class=s>&#34;%m-%d&#34;</span><span class=p>))</span> <span class=s>&#34;::Morning Diary]] :only-contents\n&#34;</span><span class=p>))))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>morning-diary-history-diary</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Insert my history diary to today diary, for convenient reflection my past time.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let*</span> <span class=p>((</span><span class=nv>cur-year</span> <span class=p>(</span><span class=nf>format-time-string</span> <span class=s>&#34;%Y&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	 <span class=p>(</span><span class=nv>year-span</span> <span class=p>(</span><span class=nf>-</span> <span class=p>(</span><span class=nf>string-to-number</span> <span class=p>(</span><span class=nf>format-time-string</span> <span class=s>&#34;%Y&#34;</span><span class=p>))</span> <span class=nv>morning-diary-init-year</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	 <span class=p>(</span><span class=nv>cur-date</span> <span class=p>(</span><span class=nf>format-time-string</span> <span class=s>&#34;%m-%d&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>cond</span> <span class=p>((</span><span class=nf>=</span> <span class=mi>0</span> <span class=nv>year-span</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	   <span class=p>(</span><span class=nb>progn</span>
</span></span><span class=line><span class=cl>	     <span class=p>(</span><span class=nf>goto-char</span> <span class=p>(</span><span class=nv>org-find-exact-headline-in-buffer</span> <span class=s>&#34;History Diary&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	     <span class=p>(</span><span class=nf>forward-line</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	     <span class=p>(</span><span class=nf>insert</span> <span class=s>&#34;First Year Of Your Diary! KEEP NOTING EVERYTHING! Best Wishes!\n&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>	  <span class=p>((</span><span class=nf>&lt;</span> <span class=mi>0</span> <span class=nv>year-span</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	   <span class=p>(</span><span class=nb>progn</span>
</span></span><span class=line><span class=cl>	     <span class=p>(</span><span class=nf>goto-char</span> <span class=p>(</span><span class=nv>org-find-exact-headline-in-buffer</span> <span class=s>&#34;History Diary&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	     <span class=p>(</span><span class=nf>forward-line</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	     <span class=p>(</span><span class=nv>morning-diary-history-transclusion</span> <span class=nv>year-span</span><span class=p>))))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>morning-diary-content</span> <span class=p>(</span><span class=nv>tpl-ds</span> <span class=nv>tpl-dc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;</span><span class=ss>`DM&#39;</span><span class=s> for diary-morning, morning diary template.
</span></span></span><span class=line><span class=cl><span class=s></span><span class=ss>`DS&#39;</span><span class=s> for diary-structure, diary structue such as diary-day and diary-week.
</span></span></span><span class=line><span class=cl><span class=s></span><span class=ss>`DC&#39;</span><span class=s> for diary-clock, diary clock report.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>tempel-insert</span> <span class=nv>tpl-ds</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>morning-diary-history-diary</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>goto-char</span> <span class=p>(</span><span class=nv>org-find-exact-headline-in-buffer</span> <span class=s>&#34;Clock Report&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>forward-line</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>tempel-insert</span> <span class=nv>tpl-dc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>morning-diary-update-clock-report</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>morning-diary-week-reflection</span> <span class=p>(</span><span class=nv>time</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>goto-char</span> <span class=p>(</span><span class=nv>org-find-exact-headline-in-buffer</span> <span class=s>&#34;GTD Week log&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>forward-line</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>morning-diary-weekreflection-log</span> <span class=nv>time</span> <span class=s>&#34;GTD&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>goto-char</span> <span class=p>(</span><span class=nv>org-find-exact-headline-in-buffer</span> <span class=s>&#34;Random note log&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>forward-line</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>morning-diary-weekreflection-log</span> <span class=nv>time</span> <span class=s>&#34;Random Notes&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>goto-char</span> <span class=p>(</span><span class=nv>org-find-exact-headline-in-buffer</span> <span class=s>&#34;Week Diary log&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>forward-line</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>morning-diary-weekreflection-log</span> <span class=nv>time</span> <span class=s>&#34;Morning Diary&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>morning-diary-weekreflection-log</span> <span class=p>(</span><span class=nv>time</span> <span class=nv>item</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let*</span> <span class=p>((</span><span class=nv>day7</span> <span class=p>(</span><span class=nv>date-to-time</span> <span class=p>(</span><span class=nf>concat</span> <span class=nv>time</span> <span class=s>&#34;T00:00:00&#34;</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>dotimes</span> <span class=p>(</span><span class=nv>i</span> <span class=mi>6</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>progn</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=nf>insert</span> <span class=p>(</span><span class=nf>format</span> <span class=s>&#34;*** %s\n&#34;</span> <span class=p>(</span><span class=nf>format-time-string</span> <span class=s>&#34;%Y-%m-%d&#34;</span> <span class=p>(</span><span class=nf>time-subtract</span> <span class=nv>day7</span> <span class=p>(</span><span class=nf>*</span> <span class=p>(</span><span class=nf>+</span> <span class=mi>1</span> <span class=nv>i</span><span class=p>)</span> <span class=mi>24</span> <span class=mi>3600</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=nf>insert</span> <span class=p>(</span><span class=nf>concat</span> <span class=s>&#34;#+transclude: [[file:&#34;</span> <span class=p>(</span><span class=nf>format</span> <span class=s>&#34;%s.org&#34;</span> <span class=p>(</span><span class=nf>format-time-string</span> <span class=s>&#34;%Y-%m-%d&#34;</span> <span class=p>(</span><span class=nf>time-subtract</span> <span class=nv>day7</span> <span class=p>(</span><span class=nf>*</span> <span class=p>(</span><span class=nf>+</span> <span class=nv>i</span> <span class=mi>1</span><span class=p>)</span> <span class=mi>24</span> <span class=mi>3600</span><span class=p>))))</span> <span class=s>&#34;::&#34;</span> <span class=nv>item</span> <span class=s>&#34;]] :only-contents\n&#34;</span><span class=p>))))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>morning-diary-update-clock-report</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Update diary clock report&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>goto-char</span> <span class=p>(</span><span class=nv>org-find-exact-headline-in-buffer</span> <span class=s>&#34;Clock Report&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>forward-line</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>org-ctrl-c-ctrl-c</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>morning-diary</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=c1>;; hacky way to dismiss the displayed-month error</span>
</span></span><span class=line><span class=cl>  <span class=c1>;; (switch-to-buffer &#34;*scratch*&#34;)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let*</span> <span class=p>((</span><span class=nv>time</span> <span class=p>(</span><span class=nv>org-read-date</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	 <span class=p>(</span><span class=nv>time1</span> <span class=p>(</span><span class=nv>date-to-time</span> <span class=p>(</span><span class=nf>concat</span> <span class=nv>time</span> <span class=s>&#34;T00:00:00&#34;</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nf>file-exists-p</span> <span class=p>(</span><span class=nf>concat</span> <span class=nv>my-roam</span> <span class=s>&#34;/daily/&#34;</span> <span class=nv>time</span> <span class=s>&#34;.org&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=nb>progn</span>
</span></span><span class=line><span class=cl>	  <span class=p>(</span><span class=nv>find-file</span> <span class=p>(</span><span class=nf>concat</span> <span class=nv>my-roam</span> <span class=s>&#34;/daily/&#34;</span> <span class=nv>time</span> <span class=s>&#34;.org&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	  <span class=p>(</span><span class=nv>morning-diary-update-clock-report</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	  <span class=p>(</span><span class=nf>goto-char</span> <span class=p>(</span><span class=nv>org-find-exact-headline-in-buffer</span> <span class=s>&#34;Random Notes&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>progn</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=nv>find-file</span> <span class=p>(</span><span class=nf>concat</span> <span class=nv>my-roam</span> <span class=s>&#34;/daily/&#34;</span> <span class=nv>time</span> <span class=s>&#34;.org&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=nv>org-id-get-create</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=nv>morning-diary-exclude</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=nf>insert</span> <span class=p>(</span><span class=nf>concat</span> <span class=s>&#34;#+title:&#34;</span> <span class=nv>time</span> <span class=s>&#34;\n&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=nb>cond</span> <span class=p>((</span><span class=nf>equal</span> <span class=p>(</span><span class=nf>format-time-string</span> <span class=s>&#34;%u&#34;</span> <span class=nv>time1</span><span class=p>)</span> <span class=s>&#34;7&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	       <span class=p>(</span><span class=nb>progn</span> <span class=p>(</span><span class=nv>morning-diary-content</span> <span class=ss>&#39;diary-week</span> <span class=ss>&#39;weekend</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		      <span class=p>(</span><span class=nv>morning-diary-week-reflection</span> <span class=nv>time</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>	      <span class=p>((</span><span class=nv>not</span> <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nf>format-time-string</span> <span class=s>&#34;%u&#34;</span> <span class=nv>time1</span><span class=p>)</span> <span class=s>&#34;7&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	       <span class=p>(</span><span class=nv>morning-diary-content</span> <span class=ss>&#39;diary-day</span> <span class=ss>&#39;clockday</span><span class=p>)))))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;&lt;f6&gt;&#34;</span><span class=p>)</span> <span class=ss>&#39;morning-diary</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;org-roam-dailies</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;before-save-hook</span> <span class=ss>&#39;morning-diary-include</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=org-remark class=headerLink><a href=#org-remark class=header-mark></a>org-remark</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>org-remark-global-tracking-mode</span> <span class=mi>1</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=bibtex-manage class=headerLink><a href=#bibtex-manage class=header-mark></a>Bibtex manage</h3><h4 id=bibtex class=headerLink><a href=#bibtex class=header-mark></a>bibtex</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>bibtex-autokey-year-length</span> <span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>bibtex-autokey-name-year-separator</span> <span class=s>&#34;-&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>bibtex-autokey-year-title-separator</span> <span class=s>&#34;-&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>bibtex-autokey-titleword-separator</span> <span class=s>&#34;-&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>bibtex-autokey-titlewords</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>bibtex-autokey-titlewords-stretch</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>bibtex-autokey-titleword-length</span> <span class=mi>5</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=bibtex-completion class=headerLink><a href=#bibtex-completion class=header-mark></a>bibtex-completion</h4><p>这里可以设置 pdf 和 note 的图标，但是我会出现对不齐的问题。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>(setq bibtex-completion-pdf-symbol (all-the-icons-octicon &#34;file-pdf&#34;
</span></span><span class=line><span class=cl>							  :height 1
</span></span><span class=line><span class=cl>							  :v-adjust -0.05
</span></span><span class=line><span class=cl>							  :face &#39;font-lock-doc-face))
</span></span><span class=line><span class=cl>(setq bibtex-completion-notes-symbol (all-the-icons-octicon &#34;file-text&#34;
</span></span><span class=line><span class=cl>							    :height 1
</span></span><span class=line><span class=cl>							    :v-adjust -0.05
</span></span><span class=line><span class=cl>							    :face &#39;font-lock-doc-face))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>bibtex-completion-library-path</span> <span class=s>&#34;~/Nextcloud/L.Personal.Galaxy/storage/pdf&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>bibtex-completion-bibliography</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;~/Nextcloud/L.Personal.Galaxy/roam/References.bib&#34;</span>
</span></span><span class=line><span class=cl>				       <span class=s>&#34;~/Nextcloud/L.Personal.Galaxy/roam/Book.bib&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>bibtex-completion-notes-path</span> <span class=s>&#34;~/Nextcloud/L.Personal.Galaxy/roam/ref&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>bibtex-completion-additional-search-fields</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>keywords</span> <span class=nv>journal</span> <span class=nv>booktitle</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>bibtex-completion-pdf-symbol</span> <span class=s>&#34;P&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>bibtex-completion-notes-symbol</span> <span class=s>&#34;N&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>bibtex-completion-display-formats</span> <span class=o>&#39;</span><span class=p>((</span><span class=nv>article</span> <span class=o>.</span> <span class=s>&#34;${=has-pdf=:1} ${=has-note=:1} ${year:4} ${author:36} ${title:*} ${journal:40}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>					  <span class=p>(</span><span class=nv>inbook</span> <span class=o>.</span> <span class=s>&#34;${=has-pdf=:1} ${=has-note=:1} ${year:4} ${author:36} ${title:*} Chapter ${chapter:32}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>					  <span class=p>(</span><span class=nv>incollection</span> <span class=o>.</span> <span class=s>&#34;${=has-pdf=:1} ${=has-note=:1} ${year:4} ${author:36} ${title:*} ${booktitle:40}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>					  <span class=p>(</span><span class=nv>inproceedings</span> <span class=o>.</span> <span class=s>&#34;${=has-pdf=:1} ${=has-note=:1} ${year:4} ${author:36} ${title:*} ${booktitle:40}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>					  <span class=p>(</span><span class=no>t</span> <span class=o>.</span> <span class=s>&#34;${=has-pdf=:1} ${=has-note=:1} ${year:4} ${author:36} ${title:*}&#34;</span><span class=p>)))</span>
</span></span></code></pre></div><h4 id=ebib class=headerLink><a href=#ebib class=header-mark></a>ebib</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>ebib-preload-bib-files</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;~/Nextcloud/L.Personal.Galaxy/roam/References.bib&#34;</span>
</span></span><span class=line><span class=cl>				 <span class=s>&#34;~/Nextcloud/L.Personal.Galaxy/roam/Book.bib&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>ebib-file-search-dirs</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;~/Nextcloud/L.Personal.Galaxy/storage/pdf&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>ebib-keywords</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;ref/keywords.txt&#34;</span> <span class=nv>my-roam</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>ebib-notes-directory</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;ref&#34;</span> <span class=nv>my-roam</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>ebib-filters-default-file</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;ref/ebib-filters&#34;</span> <span class=nv>my-roam</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>ebib-reading-list-file</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;ref/reading_list.org&#34;</span> <span class=nv>my-roam</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>ebib-keywords-field-keep-sorted</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>ebib-keywords-file-save-on-exit</span> <span class=ss>&#39;always</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>;; (setq ebib-index-columns &#39;((&#34;Entry Key&#34; 30 t) (&#34;Note&#34; 1 nil) (&#34;Year&#34; 6 t) (&#34;Author/Editor&#34; 30 nil) (&#34;Title&#34; 50 t)))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>ebib-index-columns</span> <span class=o>&#39;</span><span class=p>((</span><span class=s>&#34;Entry Key&#34;</span> <span class=mi>30</span> <span class=no>t</span><span class=p>)</span> <span class=p>(</span><span class=s>&#34;Note&#34;</span> <span class=mi>1</span> <span class=no>nil</span><span class=p>)</span> <span class=p>(</span><span class=s>&#34;Title&#34;</span> <span class=mi>50</span> <span class=no>t</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>ebib-file-associations</span> <span class=o>&#39;</span><span class=p>((</span><span class=s>&#34;ps&#34;</span> <span class=o>.</span> <span class=s>&#34;gv&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;&lt;f2&gt;&#34;</span><span class=p>)</span> <span class=ss>&#39;ebib</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=import-bib-to-ebib-from-zotero class=headerLink><a href=#import-bib-to-ebib-from-zotero class=header-mark></a>import bib to ebib from zotero</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my/ebib-import-from-zotero</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Import entry from zotero to ebib.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>ebib</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>find-file</span> <span class=s>&#34;~/Documents/zotero.bib&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>ebib-import-entries</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>quit-window-delete</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>ebib-quit-entry-buffer</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=oc-csl class=headerLink><a href=#oc-csl class=header-mark></a>oc-csl</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=c1>;; (require &#39;oc-csl)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my/oc-csl</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>require</span> <span class=ss>&#39;oc-csl</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;org-mode-hook</span> <span class=nf>#&#39;</span><span class=nv>my/oc-csl</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-cite-global-bibliography</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;/Users/duanning/Nextcloud/L.Personal.Galaxy/roam/References.bib&#34;</span>
</span></span><span class=line><span class=cl>				     <span class=s>&#34;/Users/duanning/Nextcloud/L.Personal.Galaxy/roam/Book.bib&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-cite-insert-processor</span> <span class=ss>&#39;citar</span>
</span></span><span class=line><span class=cl>      <span class=nv>org-cite-follow-processor</span> <span class=ss>&#39;citar</span>
</span></span><span class=line><span class=cl>      <span class=nv>org-cite-activate-processor</span> <span class=ss>&#39;citar</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=citar class=headerLink><a href=#citar class=header-mark></a>citar</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>citar-bibliography</span> <span class=s>&#34;~/Nextcloud/L.Personal.Galaxy/roam/References.bib&#34;</span>
</span></span><span class=line><span class=cl>      <span class=nv>citar-templates</span> <span class=o>&#39;</span><span class=p>((</span><span class=nv>main</span> <span class=o>.</span> <span class=s>&#34;${author editor:30} ${date year issued:4} ${title:48}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			<span class=p>(</span><span class=nv>suffix</span> <span class=o>.</span> <span class=s>&#34;${=key= id:15} ${=type=:12} ${tags keywords:*}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			<span class=p>(</span><span class=nv>preview</span> <span class=o>.</span> <span class=s>&#34;${author editor} (${year issued date}) ${title}, ${journal journaltitle publisher container-title collection-title}.\n&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			<span class=p>(</span><span class=nv>note</span> <span class=o>.</span> <span class=s>&#34;${title}&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=nv>citar-at-point-function</span> <span class=ss>&#39;embark-act</span>
</span></span><span class=line><span class=cl>      <span class=nv>citar-open-note-function</span> <span class=ss>&#39;orb-citar-edit-note</span>
</span></span><span class=line><span class=cl>      <span class=nv>citar-notes-paths</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;~/Nextcloud/L.Personal.Galaxy/roam/ref&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=nv>citar-library-paths</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;~/Nextcloud/L.Personal.Galaxy/storage/pdf&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>citar-symbols</span>
</span></span><span class=line><span class=cl>      <span class=o>`</span><span class=p>((</span><span class=nv>file</span> <span class=o>,</span><span class=p>(</span><span class=nv>all-the-icons-faicon</span> <span class=s>&#34;file-o&#34;</span> <span class=nb>:face</span> <span class=ss>&#39;all-the-icons-green</span> <span class=nb>:v-adjust</span> <span class=mf>-0.1</span><span class=p>)</span> <span class=o>.</span> <span class=s>&#34; &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=nv>note</span> <span class=o>,</span><span class=p>(</span><span class=nv>all-the-icons-material</span> <span class=s>&#34;speaker_notes&#34;</span> <span class=nb>:face</span> <span class=ss>&#39;all-the-icons-blue</span> <span class=nb>:v-adjust</span> <span class=mf>-0.3</span><span class=p>)</span> <span class=o>.</span> <span class=s>&#34; &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=nv>link</span> <span class=o>,</span><span class=p>(</span><span class=nv>all-the-icons-octicon</span> <span class=s>&#34;link&#34;</span> <span class=nb>:face</span> <span class=ss>&#39;all-the-icons-orange</span> <span class=nb>:v-adjust</span> <span class=mf>0.01</span><span class=p>)</span> <span class=o>.</span> <span class=s>&#34; &#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>citar-symbol-separator</span> <span class=s>&#34;  &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;citar</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>define-key</span> <span class=nv>org-mode-map</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-c C-x @&#34;</span><span class=p>)</span> <span class=ss>&#39;citar-insert-citation</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=consult-bibtex class=headerLink><a href=#consult-bibtex class=header-mark></a>consult-bibtex</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my/consult-bibtex-start</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>require</span> <span class=ss>&#39;consult-bibtex</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;on-first-buffer-hook</span> <span class=ss>&#39;my/consult-bibtex-start</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=org-roam-bibtex class=headerLink><a href=#org-roam-bibtex class=header-mark></a>org-roam-bibtex</h4><p>这是 org-roam 建立文献笔记的关键，此配置不能删除，若删除则会出现 workflow 不一致的问题，用起来很难受。 <code>org-roam-bibtex-mode</code> 不能使用 hook 的方式起动，第一次使用的时候 capture-template 会不出来。</p><p>此包会导致 emacs 启动慢约 0.6s 。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>orb-note-actions-interface</span> <span class=ss>&#39;default</span>
</span></span><span class=line><span class=cl>      <span class=nv>orb-roam-ref-format</span> <span class=ss>&#39;org-cite</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;org-mode-hook</span> <span class=ss>&#39;org-roam-bibtex-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=tasks-manage class=headerLink><a href=#tasks-manage class=header-mark></a>Tasks manage</h3><h4 id=org-agenda class=headerLink><a href=#org-agenda class=header-mark></a>org-agenda</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;org-agenda-finalize-hook</span> <span class=nf>#&#39;</span><span class=nv>org-agenda-find-same-or-today-or-agenda</span> <span class=mi>90</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-agenda-hide-tags-regexp</span> <span class=p>(</span><span class=nv>regexp-opt</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;project&#34;</span><span class=p>)))</span> <span class=c1>;; hide project tag</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-agenda-prefix-format</span> <span class=o>&#39;</span><span class=p>((</span><span class=nv>agenda</span> <span class=o>.</span> <span class=s>&#34; %i %?-12t% s&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>				 <span class=p>(</span><span class=nv>todo</span>   <span class=o>.</span> <span class=s>&#34; %i&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>				 <span class=p>(</span><span class=nv>tags</span>   <span class=o>.</span> <span class=s>&#34; %i %-12:c&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>				 <span class=p>(</span><span class=nv>search</span> <span class=o>.</span> <span class=s>&#34; %i %-12:c&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-agenda-tags-todo-honor-ignore-options</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>      <span class=nv>org-agenda-start-on-weekday</span> <span class=no>nil</span>
</span></span><span class=line><span class=cl>      <span class=nv>org-agenda-dim-blocked-tasks</span> <span class=no>nil</span>
</span></span><span class=line><span class=cl>      <span class=nv>org-agenda-compact-blocks</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>      <span class=nv>org-agenda-to-appt</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my/org-agenda</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>org-agenda</span> <span class=no>nil</span> <span class=s>&#34; &#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;org</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>define-key</span> <span class=nv>org-mode-map</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-,&#34;</span><span class=p>)</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>define-key</span> <span class=nv>org-mode-map</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-&#39;&#34;</span><span class=p>)</span> <span class=no>nil</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=dynamic-agenda class=headerLink><a href=#dynamic-agenda class=header-mark></a>Dynamic agenda</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=c1>;; https://magnus.therning.org/2021-07-23-keeping-todo-items-in-org-roam-v2.html</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>vulpea-project-p</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Return non-nil if current buffer has any todo entry.
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>TODO entries marked as done are ignored, meaning the this
</span></span></span><span class=line><span class=cl><span class=s>function returns nil if current buffer contains only completed
</span></span></span><span class=line><span class=cl><span class=s>tasks.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>seq-find</span>                                 <span class=c1>; (3)</span>
</span></span><span class=line><span class=cl>   <span class=p>(</span><span class=nb>lambda</span> <span class=p>(</span><span class=nv>type</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=p>(</span><span class=nb>or</span> <span class=p>(</span><span class=nf>eq</span> <span class=nv>type</span> <span class=ss>&#39;todo</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	 <span class=p>(</span><span class=nf>eq</span> <span class=nv>type</span> <span class=ss>&#39;done</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>   <span class=p>(</span><span class=nv>org-element-map</span>                         <span class=c1>; (2)</span>
</span></span><span class=line><span class=cl>       <span class=p>(</span><span class=nv>org-element-parse-buffer</span> <span class=ss>&#39;headline</span><span class=p>)</span> <span class=c1>; (1)</span>
</span></span><span class=line><span class=cl>       <span class=ss>&#39;headline</span>
</span></span><span class=line><span class=cl>     <span class=p>(</span><span class=nb>lambda</span> <span class=p>(</span><span class=nv>h</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=p>(</span><span class=nv>org-element-property</span> <span class=nb>:todo-type</span> <span class=nv>h</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>vulpea-project-update-tag</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Update PROJECT tag in the current buffer.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nb>and</span> <span class=p>(</span><span class=nv>not</span> <span class=p>(</span><span class=nf>active-minibuffer-window</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	     <span class=p>(</span><span class=nv>vulpea-buffer-p</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>save-excursion</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nf>goto-char</span> <span class=p>(</span><span class=nf>point-min</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>let*</span> <span class=p>((</span><span class=nv>tags</span> <span class=p>(</span><span class=nv>vulpea-buffer-tags-get</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	     <span class=p>(</span><span class=nv>original-tags</span> <span class=nv>tags</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nv>vulpea-project-p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	    <span class=p>(</span><span class=nb>setq</span> <span class=nv>tags</span> <span class=p>(</span><span class=nf>cons</span> <span class=s>&#34;project&#34;</span> <span class=nv>tags</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	  <span class=p>(</span><span class=nb>setq</span> <span class=nv>tags</span> <span class=p>(</span><span class=nv>remove</span> <span class=s>&#34;project&#34;</span> <span class=nv>tags</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>;; cleanup duplicates</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=nb>setq</span> <span class=nv>tags</span> <span class=p>(</span><span class=nv>seq-uniq</span> <span class=nv>tags</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>;; update tags if changed</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nb>or</span> <span class=p>(</span><span class=nv>seq-difference</span> <span class=nv>tags</span> <span class=nv>original-tags</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		  <span class=p>(</span><span class=nv>seq-difference</span> <span class=nv>original-tags</span> <span class=nv>tags</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	  <span class=p>(</span><span class=nf>apply</span> <span class=nf>#&#39;</span><span class=nv>vulpea-buffer-tags-set</span> <span class=nv>tags</span><span class=p>))))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>vulpea-buffer-p</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Return non-nil if the currently visited buffer is a note.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>and</span> <span class=nf>buffer-file-name</span>
</span></span><span class=line><span class=cl>       <span class=p>(</span><span class=nv>string-prefix-p</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=nf>expand-file-name</span> <span class=p>(</span><span class=nf>file-name-as-directory</span> <span class=nv>org-roam-directory</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=nf>file-name-directory</span> <span class=nf>buffer-file-name</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>;; (defun vulpea-project-files ()</span>
</span></span><span class=line><span class=cl><span class=c1>;;     &#34;Return a list of note files containing &#39;project&#39; tag.&#34; ;</span>
</span></span><span class=line><span class=cl><span class=c1>;;     (seq-uniq</span>
</span></span><span class=line><span class=cl><span class=c1>;;      (seq-map</span>
</span></span><span class=line><span class=cl><span class=c1>;;       #&#39;car</span>
</span></span><span class=line><span class=cl><span class=c1>;;       (org-roam-db-query</span>
</span></span><span class=line><span class=cl><span class=c1>;;        [:select [nodes:file]</span>
</span></span><span class=line><span class=cl><span class=c1>;;         :from tags</span>
</span></span><span class=line><span class=cl><span class=c1>;;         :left-join nodes</span>
</span></span><span class=line><span class=cl><span class=c1>;;         :on (= tags:node-id nodes:id)</span>
</span></span><span class=line><span class=cl><span class=c1>;;         :where (like tag (quote &#34;%\&#34;project\&#34;%&#34;))]))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>;; (defun vulpea-agenda-files-update (&amp;rest _)</span>
</span></span><span class=line><span class=cl><span class=c1>;;   &#34;Update the value of `org-agenda-files&#39;.&#34;</span>
</span></span><span class=line><span class=cl><span class=c1>;;   (setq org-agenda-files (vulpea-project-files)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>;; functions borrowed from `vulpea&#39; library</span>
</span></span><span class=line><span class=cl><span class=c1>;; https://github.com/d12frosted/vulpea/blob/6a735c34f1f64e1f70da77989e9ce8da7864e5ff/vulpea-buffer.el</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>vulpea-buffer-tags-get</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Return filetags value in current buffer.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>vulpea-buffer-prop-get-list</span> <span class=s>&#34;filetags&#34;</span> <span class=s>&#34;[ :]&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>vulpea-buffer-tags-set</span> <span class=p>(</span><span class=kp>&amp;rest</span> <span class=nv>tags</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Set TAGS in current buffer.
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>If filetags value is already set, replace it.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>if</span> <span class=nv>tags</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>vulpea-buffer-prop-set</span>
</span></span><span class=line><span class=cl>       <span class=s>&#34;filetags&#34;</span> <span class=p>(</span><span class=nf>concat</span> <span class=s>&#34;:&#34;</span> <span class=p>(</span><span class=nv>string-join</span> <span class=nv>tags</span> <span class=s>&#34;:&#34;</span><span class=p>)</span> <span class=s>&#34;:&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>vulpea-buffer-prop-remove</span> <span class=s>&#34;filetags&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>vulpea-buffer-tags-add</span> <span class=p>(</span><span class=nv>tag</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Add a TAG to filetags in current buffer.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let*</span> <span class=p>((</span><span class=nv>tags</span> <span class=p>(</span><span class=nv>vulpea-buffer-tags-get</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	 <span class=p>(</span><span class=nv>tags</span> <span class=p>(</span><span class=nf>append</span> <span class=nv>tags</span> <span class=p>(</span><span class=nf>list</span> <span class=nv>tag</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>apply</span> <span class=nf>#&#39;</span><span class=nv>vulpea-buffer-tags-set</span> <span class=nv>tags</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>vulpea-buffer-tags-remove</span> <span class=p>(</span><span class=nv>tag</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Remove a TAG from filetags in current buffer.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let*</span> <span class=p>((</span><span class=nv>tags</span> <span class=p>(</span><span class=nv>vulpea-buffer-tags-get</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	 <span class=p>(</span><span class=nv>tags</span> <span class=p>(</span><span class=nf>delete</span> <span class=nv>tag</span> <span class=nv>tags</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>apply</span> <span class=nf>#&#39;</span><span class=nv>vulpea-buffer-tags-set</span> <span class=nv>tags</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>vulpea-buffer-prop-set</span> <span class=p>(</span><span class=nv>name</span> <span class=nv>value</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Set a file property called NAME to VALUE in buffer file.
</span></span></span><span class=line><span class=cl><span class=s>If the property is already set, replace its value.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>name</span> <span class=p>(</span><span class=nf>downcase</span> <span class=nv>name</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>org-with-point-at</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>case-fold-search</span> <span class=no>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nf>re-search-forward</span> <span class=p>(</span><span class=nf>concat</span> <span class=s>&#34;^#\\+&#34;</span> <span class=nv>name</span> <span class=s>&#34;:\\(.*\\)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			     <span class=p>(</span><span class=nf>point-max</span><span class=p>)</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	  <span class=p>(</span><span class=nf>replace-match</span> <span class=p>(</span><span class=nf>concat</span> <span class=s>&#34;#+&#34;</span> <span class=nv>name</span> <span class=s>&#34;: &#34;</span> <span class=nv>value</span><span class=p>)</span> <span class=ss>&#39;fixedcase</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=nb>while</span> <span class=p>(</span><span class=nb>and</span> <span class=p>(</span><span class=nv>not</span> <span class=p>(</span><span class=nf>eobp</span><span class=p>))</span>
</span></span><span class=line><span class=cl>		    <span class=p>(</span><span class=nf>looking-at</span> <span class=s>&#34;^[#:]&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	  <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nb>save-excursion</span> <span class=p>(</span><span class=nf>end-of-line</span><span class=p>)</span> <span class=p>(</span><span class=nf>eobp</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	      <span class=p>(</span><span class=nb>progn</span>
</span></span><span class=line><span class=cl>		<span class=p>(</span><span class=nf>end-of-line</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=p>(</span><span class=nf>insert</span> <span class=s>&#34;\n&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	    <span class=p>(</span><span class=nf>forward-line</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	    <span class=p>(</span><span class=nf>beginning-of-line</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=nf>insert</span> <span class=s>&#34;#+&#34;</span> <span class=nv>name</span> <span class=s>&#34;: &#34;</span> <span class=nv>value</span> <span class=s>&#34;\n&#34;</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>vulpea-buffer-prop-set-list</span> <span class=p>(</span><span class=nv>name</span> <span class=nv>values</span> <span class=kp>&amp;optional</span> <span class=nv>separators</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Set a file property called NAME to VALUES in current buffer.
</span></span></span><span class=line><span class=cl><span class=s>VALUES are quoted and combined into single string using
</span></span></span><span class=line><span class=cl><span class=s></span><span class=ss>`combine-and-quote-strings&#39;</span><span class=s>.
</span></span></span><span class=line><span class=cl><span class=s>If SEPARATORS is non-nil, it should be a regular expression
</span></span></span><span class=line><span class=cl><span class=s>matching text that separates, but is not part of, the substrings.
</span></span></span><span class=line><span class=cl><span class=s>If nil it defaults to </span><span class=ss>`split-string-default-separators&#39;</span><span class=s>, normally
</span></span></span><span class=line><span class=cl><span class=s>\&#34;[ \f\t\n\r\v]+\&#34;, and OMIT-NULLS is forced to t.
</span></span></span><span class=line><span class=cl><span class=s>If the property is already set, replace its value.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>vulpea-buffer-prop-set</span>
</span></span><span class=line><span class=cl>   <span class=nv>name</span> <span class=p>(</span><span class=nv>combine-and-quote-strings</span> <span class=nv>values</span> <span class=nv>separators</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>vulpea-buffer-prop-get</span> <span class=p>(</span><span class=nv>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Get a buffer property called NAME as a string.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>org-with-point-at</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nf>re-search-forward</span> <span class=p>(</span><span class=nf>concat</span> <span class=s>&#34;^#\\+&#34;</span> <span class=nv>name</span> <span class=s>&#34;: \\(.*\\)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			     <span class=p>(</span><span class=nf>point-max</span><span class=p>)</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nf>buffer-substring-no-properties</span>
</span></span><span class=line><span class=cl>       <span class=p>(</span><span class=nf>match-beginning</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=p>(</span><span class=nf>match-end</span> <span class=mi>1</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>vulpea-buffer-prop-get-list</span> <span class=p>(</span><span class=nv>name</span> <span class=kp>&amp;optional</span> <span class=nv>separators</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Get a buffer property NAME as a list using SEPARATORS.
</span></span></span><span class=line><span class=cl><span class=s>If SEPARATORS is non-nil, it should be a regular expression
</span></span></span><span class=line><span class=cl><span class=s>matching text that separates, but is not part of, the substrings.
</span></span></span><span class=line><span class=cl><span class=s>If nil it defaults to </span><span class=ss>`split-string-default-separators&#39;</span><span class=s>, normally
</span></span></span><span class=line><span class=cl><span class=s>\&#34;[ \f\t\n\r\v]+\&#34;, and OMIT-NULLS is forced to t.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>value</span> <span class=p>(</span><span class=nv>vulpea-buffer-prop-get</span> <span class=nv>name</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nb>and</span> <span class=nv>value</span> <span class=p>(</span><span class=nv>not</span> <span class=p>(</span><span class=nv>string-empty-p</span> <span class=nv>value</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>split-string-and-unquote</span> <span class=nv>value</span> <span class=nv>separators</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>vulpea-buffer-prop-remove</span> <span class=p>(</span><span class=nv>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Remove a buffer property called NAME.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>org-with-point-at</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nf>re-search-forward</span> <span class=p>(</span><span class=nf>concat</span> <span class=s>&#34;\\(^#\\+&#34;</span> <span class=nv>name</span> <span class=s>&#34;:.*\n?\\)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			     <span class=p>(</span><span class=nf>point-max</span><span class=p>)</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nf>replace-match</span> <span class=s>&#34;&#34;</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>;; https://systemcrafters.net/build-a-second-brain-in-emacs/5-org-roam-hacks/</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;org-roam</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>defun</span> <span class=nv>my/org-roam-filter-by-tag</span> <span class=p>(</span><span class=nv>tag-name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>lambda</span> <span class=p>(</span><span class=nv>node</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nf>member</span> <span class=nv>tag-name</span> <span class=p>(</span><span class=nv>org-roam-node-tags</span> <span class=nv>node</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>defun</span> <span class=nv>my/org-roam-list-notes-by-tag</span> <span class=p>(</span><span class=nv>tag-name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>mapcar</span> <span class=nf>#&#39;</span><span class=nv>org-roam-node-file</span>
</span></span><span class=line><span class=cl>	    <span class=p>(</span><span class=nv>seq-filter</span>
</span></span><span class=line><span class=cl>	     <span class=p>(</span><span class=nv>my/org-roam-filter-by-tag</span> <span class=nv>tag-name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	     <span class=p>(</span><span class=nv>org-roam-node-list</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>defun</span> <span class=nv>my/org-roam-refresh-agenda-list</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>dolist</span> <span class=p>(</span><span class=nv>project-file</span> <span class=p>(</span><span class=nv>my/org-roam-list-notes-by-tag</span> <span class=s>&#34;project&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;org-agenda-files</span> <span class=nv>project-file</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>  <span class=c1>;; (add-hook &#39;after-init-hook #&#39;my/org-roam-refresh-agenda-list)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>my/org-roam-refresh-agenda-list</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;org-agenda-mode-hook</span> <span class=nf>#&#39;</span><span class=nv>my/org-roam-refresh-agenda-list</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;find-file-hook</span> <span class=nf>#&#39;</span><span class=nv>vulpea-project-update-tag</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;before-save-hook</span> <span class=nf>#&#39;</span><span class=nv>vulpea-project-update-tag</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=org-agenda-view class=headerLink><a href=#org-agenda-view class=header-mark></a>Org agenda view</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-agenda-custom-commands</span>
</span></span><span class=line><span class=cl>      <span class=o>&#39;</span><span class=p>((</span><span class=s>&#34; &#34;</span> <span class=s>&#34;Agendas&#34;</span>
</span></span><span class=line><span class=cl>	 <span class=p>((</span><span class=nv>agenda</span> <span class=s>&#34;&#34;</span> <span class=p>((</span><span class=nv>org-agenda-span</span> <span class=ss>&#39;day</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		      <span class=p>(</span><span class=nv>org-super-agenda-groups</span>
</span></span><span class=line><span class=cl>		       <span class=o>&#39;</span><span class=p>((</span><span class=nb>:name</span> <span class=s>&#34;Scheduled earlier&#34;</span>
</span></span><span class=line><span class=cl>				<span class=nb>:scheduled</span> <span class=nv>past</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			 <span class=p>(</span><span class=nb>:name</span> <span class=s>&#34;Today&#34;</span>
</span></span><span class=line><span class=cl>				<span class=nb>:and</span> <span class=p>(</span><span class=nb>:scheduled</span> <span class=nv>today</span> <span class=nb>:not</span> <span class=p>(</span><span class=nb>:tag</span> <span class=p>(</span><span class=s>&#34;Family&#34;</span> <span class=s>&#34;Reading&#34;</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>			 <span class=p>(</span><span class=nb>:name</span> <span class=s>&#34;Due Today&#34;</span>
</span></span><span class=line><span class=cl>				<span class=nb>:deadline</span> <span class=nv>today</span>
</span></span><span class=line><span class=cl>				<span class=nb>:face</span> <span class=p>(</span><span class=nb>:foreground</span> <span class=s>&#34;Red&#34;</span> <span class=nb>:underline</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>				<span class=nb>:order</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			 <span class=p>(</span><span class=nb>:name</span> <span class=s>&#34;Due Soon&#34;</span>
</span></span><span class=line><span class=cl>				<span class=nb>:deadline</span> <span class=nv>future</span>
</span></span><span class=line><span class=cl>				<span class=nb>:order</span> <span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			 <span class=p>(</span><span class=nb>:name</span> <span class=s>&#34;Overdue&#34;</span>
</span></span><span class=line><span class=cl>				<span class=nb>:deadline</span> <span class=nv>past</span>
</span></span><span class=line><span class=cl>				<span class=nb>:order</span> <span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			 <span class=p>(</span><span class=nb>:discard</span> <span class=p>(</span><span class=nb>:anything</span> <span class=no>t</span><span class=p>))))))</span>
</span></span><span class=line><span class=cl>	  <span class=p>(</span><span class=nv>todo</span> <span class=s>&#34;&#34;</span> <span class=p>((</span><span class=nv>org-agenda-overriding-header</span> <span class=s>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		    <span class=p>(</span><span class=nv>org-super-agenda-groups</span>
</span></span><span class=line><span class=cl>		     <span class=o>&#39;</span><span class=p>((</span><span class=nb>:name</span> <span class=s>&#34;Next List: DO IT ASAP.&#34;</span>
</span></span><span class=line><span class=cl>			      <span class=nb>:and</span> <span class=p>(</span><span class=nb>:todo</span> <span class=s>&#34;NEXT&#34;</span> <span class=nb>:scheduled</span> <span class=no>nil</span> <span class=nb>:deadline</span> <span class=no>nil</span> <span class=nb>:not</span> <span class=p>(</span><span class=nb>:tag</span> <span class=p>(</span><span class=s>&#34;Review&#34;</span> <span class=s>&#34;FunTime&#34;</span> <span class=s>&#34;Reading&#34;</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>		       <span class=p>(</span><span class=nb>:name</span> <span class=s>&#34;Family&#34;</span>
</span></span><span class=line><span class=cl>			      <span class=nb>:and</span> <span class=p>(</span><span class=nb>:tag</span> <span class=p>(</span><span class=s>&#34;Family&#34;</span> <span class=s>&#34;Life&#34;</span> <span class=s>&#34;Memorial&#34;</span> <span class=s>&#34;Insurance&#34;</span><span class=p>)</span> <span class=nb>:scheduled</span> <span class=nv>today</span><span class=p>))</span>
</span></span><span class=line><span class=cl>		       <span class=p>(</span><span class=nb>:name</span> <span class=s>&#34;Projects lists&#34;</span>
</span></span><span class=line><span class=cl>			      <span class=nb>:children</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>			      <span class=nb>:order</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		       <span class=p>(</span><span class=nb>:habit</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		       <span class=p>(</span><span class=nb>:name</span> <span class=s>&#34;Work&#34;</span>
</span></span><span class=line><span class=cl>			      <span class=nb>:and</span> <span class=p>(</span><span class=nb>:tag</span> <span class=p>(</span><span class=s>&#34;Work&#34;</span><span class=p>)</span> <span class=nb>:scheduled</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			      <span class=nb>:order</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		       <span class=p>(</span><span class=nb>:name</span> <span class=s>&#34;Reading lists&#34;</span>
</span></span><span class=line><span class=cl>			      <span class=nb>:tag</span> <span class=s>&#34;Reading&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		       <span class=p>(</span><span class=nb>:name</span> <span class=s>&#34;Fun time&#34;</span>
</span></span><span class=line><span class=cl>			      <span class=nb>:and</span> <span class=p>(</span><span class=nb>:tag</span> <span class=p>(</span><span class=s>&#34;FunTime&#34;</span><span class=p>)</span> <span class=nb>:scheduled</span> <span class=no>nil</span><span class=p>))</span>
</span></span><span class=line><span class=cl>		       <span class=p>(</span><span class=nb>:name</span> <span class=s>&#34;COMPUTER SCIENCE&#34;</span>
</span></span><span class=line><span class=cl>			      <span class=nb>:and</span> <span class=p>(</span><span class=nb>:tag</span> <span class=p>(</span><span class=s>&#34;Emacs&#34;</span> <span class=s>&#34;Arch&#34;</span> <span class=s>&#34;Linux&#34;</span> <span class=s>&#34;Ubuntu&#34;</span> <span class=s>&#34;Windows&#34;</span> <span class=s>&#34;Computer&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>			      <span class=nb>:order</span> <span class=mi>80</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		       <span class=p>(</span><span class=nb>:discard</span> <span class=p>(</span><span class=nb>:scheduled</span> <span class=no>t</span> <span class=nb>:deadline</span> <span class=no>t</span><span class=p>))))))</span>
</span></span><span class=line><span class=cl>	  <span class=p>(</span><span class=nv>todo</span> <span class=s>&#34;SOMEDAY&#34;</span> <span class=p>((</span><span class=nv>org-agenda-overriding-header</span> <span class=s>&#34;==============MAYBE FUTURE==============&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>	  <span class=p>(</span><span class=nv>todo</span> <span class=s>&#34;WAIT&#34;</span> <span class=p>((</span><span class=nv>org-agenda-overriding-header</span> <span class=s>&#34;&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>	  <span class=p>(</span><span class=nv>todo</span> <span class=s>&#34;CNCL&#34;</span> <span class=p>((</span><span class=nv>org-agenda-overriding-header</span> <span class=s>&#34;&#34;</span><span class=p>)))))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;org-super-agenda</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>define-key</span> <span class=nv>org-super-agenda-header-map</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;j&#34;</span><span class=p>)</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>define-key</span> <span class=nv>org-super-agenda-header-map</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;k&#34;</span><span class=p>)</span> <span class=no>nil</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>;; (add-hook &#39;after-init-hook &#39;org-super-agenda-mode)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;on-first-buffer-hook</span> <span class=ss>&#39;org-super-agenda-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=finance-manage class=headerLink><a href=#finance-manage class=header-mark></a>Finance manage</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>beancount-electric-currency</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;auto-mode-alist</span>
</span></span><span class=line><span class=cl>	     <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;\\.bean\\&#39;&#34;</span> <span class=o>.</span> <span class=nv>beancount-mode</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;beancount-mode-hook</span> <span class=nf>#&#39;</span><span class=nv>outline-minor-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;beancount-mode-hook</span> <span class=nf>#&#39;</span><span class=p>(</span><span class=nb>lambda</span> <span class=no>nil</span>
</span></span><span class=line><span class=cl>				   <span class=p>(</span><span class=nb>setq-local</span> <span class=nv>electric-indent-chars</span> <span class=no>nil</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;beancount</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>define-key</span> <span class=nv>beancount-mode-map</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-c C-n&#34;</span><span class=p>)</span> <span class=ss>&#39;outline-next-visible-heading</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>define-key</span> <span class=nv>beancount-mode-map</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-c C-p&#34;</span><span class=p>)</span> <span class=ss>&#39;outline-previous-visible-heading</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;all-the-icons-icon-alist</span>
</span></span><span class=line><span class=cl>	     <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;\\.bean\\&#39;&#34;</span> <span class=nv>all-the-icons-material</span> <span class=s>&#34;attach_money&#34;</span> <span class=nb>:face</span> <span class=nv>all-the-icons-lblue</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;all-the-icons-mode-icon-alist</span>
</span></span><span class=line><span class=cl>	     <span class=o>&#39;</span><span class=p>(</span><span class=nv>beancount-mode</span> <span class=nv>all-the-icons-material</span> <span class=s>&#34;attach_money&#34;</span> <span class=nb>:face</span> <span class=nv>all-the-icons-lblue</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=org-export class=headerLink><a href=#org-export class=header-mark></a>Org Export</h3><h4 id=ox-hugo class=headerLink><a href=#ox-hugo class=header-mark></a>ox-hugo</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;ox</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>require</span> <span class=ss>&#39;ox-hugo</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=easy-hugo class=headerLink><a href=#easy-hugo class=header-mark></a>easy-hugo</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defface</span> <span class=nv>easy-hugo-help-face</span>
</span></span><span class=line><span class=cl>  <span class=o>`</span><span class=p>((((</span><span class=nv>class</span> <span class=nv>color</span><span class=p>)</span> <span class=p>(</span><span class=nv>background</span> <span class=nv>light</span><span class=p>))</span>
</span></span><span class=line><span class=cl>     <span class=o>,@</span><span class=p>(</span><span class=nb>and</span> <span class=p>(</span><span class=nf>&gt;=</span> <span class=nv>emacs-major-version</span> <span class=mi>27</span><span class=p>)</span> <span class=o>&#39;</span><span class=p>(</span><span class=nb>:extend</span> <span class=no>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>     <span class=nb>:bold</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>     <span class=nb>:foreground</span> <span class=s>&#34;#000000&#34;</span>
</span></span><span class=line><span class=cl>     <span class=nb>:background</span> <span class=s>&#34;#F2F0EF&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(((</span><span class=nv>class</span> <span class=nv>color</span><span class=p>)</span> <span class=p>(</span><span class=nv>background</span> <span class=nv>dark</span><span class=p>))</span>
</span></span><span class=line><span class=cl>     <span class=o>,@</span><span class=p>(</span><span class=nb>and</span> <span class=p>(</span><span class=nf>&gt;=</span> <span class=nv>emacs-major-version</span> <span class=mi>27</span><span class=p>)</span> <span class=o>&#39;</span><span class=p>(</span><span class=nb>:extend</span> <span class=no>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>     <span class=nb>:bold</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>     <span class=nb>:foreground</span> <span class=s>&#34;#FFFFFF&#34;</span>
</span></span><span class=line><span class=cl>     <span class=nb>:background</span> <span class=s>&#34;#252321&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Definition of help color.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>:group</span> <span class=ss>&#39;easy-hugo-faces</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>require</span> <span class=ss>&#39;easy-hugo</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>easy-hugo-no-help</span> <span class=no>nil</span>
</span></span><span class=line><span class=cl>      <span class=nv>easy-hugo-basedir</span> <span class=s>&#34;~/hugo-source/&#34;</span>
</span></span><span class=line><span class=cl>      <span class=nv>easy-hugo-postdir</span> <span class=s>&#34;content/posts&#34;</span>
</span></span><span class=line><span class=cl>      <span class=nv>easy-hugo-url</span> <span class=s>&#34;https://jousimies.github.io/&#34;</span>
</span></span><span class=line><span class=cl>      <span class=nv>easy-hugo-default-ext</span> <span class=s>&#34;.org&#34;</span>
</span></span><span class=line><span class=cl>      <span class=nv>easy-hugo-default-picture-directory</span> <span class=s>&#34;~/Nextcloud/L.Personal.Galaxy/roam/pic&#34;</span>
</span></span><span class=line><span class=cl>      <span class=nv>easy-hugo-org-header</span> <span class=no>t</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=export-org-to-docx-with-pandoc class=headerLink><a href=#export-org-to-docx-with-pandoc class=header-mark></a>export org to docx with pandoc</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>org-export-docx</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Convert org to docx.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>docx-file</span> <span class=p>(</span><span class=nf>concat</span> <span class=p>(</span><span class=nv>file-name-sans-extension</span> <span class=p>(</span><span class=nf>buffer-file-name</span><span class=p>))</span> <span class=s>&#34;.docx&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=nv>template-file</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;template.docx&#34;</span> <span class=nv>my-template-directory</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>shell-command</span> <span class=p>(</span><span class=nf>format</span> <span class=s>&#34;pandoc %s -o %s --reference-doc=%s&#34;</span> <span class=p>(</span><span class=nf>buffer-file-name</span><span class=p>)</span> <span class=nv>docx-file</span> <span class=nv>template-file</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>message</span> <span class=s>&#34;Convert finish: %s&#34;</span> <span class=nv>docx-file</span><span class=p>)))</span>
</span></span></code></pre></div><h3 id=latex class=headerLink><a href=#latex class=header-mark></a>Latex</h3><h4 id=defaults class=headerLink><a href=#defaults class=header-mark></a>Defaults</h4><p>为了在 <code>org-mode</code> 中快速的输入数学符号，开启 <code>org-cdlatex-mode</code> 。该包是 <code>org-mode</code> 自带的的。进一步的是什用 <code>cdlatex</code> 这个包，会自动成对的输入符号。进一步的是考虑使用 <code>tempel</code> 等这类包，自动展开 <code>snippet</code> 。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-highlight-latex-and-related</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>latex</span> <span class=nv>script</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;org-mode-hook</span> <span class=ss>&#39;turn-on-org-cdlatex</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-latex-with-hyperref</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;revert-without-query</span> <span class=s>&#34;.+\\.tex&#34;</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=ox-latex class=headerLink><a href=#ox-latex class=header-mark></a>ox-latex</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-highlight-latex-and-related</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>latex</span> <span class=nv>script</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;ox-latex</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-latex-classes</span> <span class=no>nil</span>
</span></span><span class=line><span class=cl>	<span class=nv>org-latex-listings</span> <span class=ss>&#39;minted</span>
</span></span><span class=line><span class=cl>	<span class=nv>org-export-latex-listings</span> <span class=ss>&#39;minted</span>
</span></span><span class=line><span class=cl>	<span class=nv>org-latex-minted-options</span> <span class=o>&#39;</span><span class=p>((</span><span class=s>&#34;breaklines&#34;</span> <span class=s>&#34;true&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>				   <span class=p>(</span><span class=s>&#34;breakanywhere&#34;</span> <span class=s>&#34;true&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;org-latex-classes</span>
</span></span><span class=line><span class=cl>	       <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;book&#34;</span>
</span></span><span class=line><span class=cl>		 <span class=s>&#34;\\documentclass[UTF8,twoside,a4paper,12pt,openright]{ctexrep}
</span></span></span><span class=line><span class=cl><span class=s>		[NO-DEFAULT-PACKAGES]
</span></span></span><span class=line><span class=cl><span class=s>		[NO-PACKAGES]
</span></span></span><span class=line><span class=cl><span class=s>		[EXTRA]&#34;</span>
</span></span><span class=line><span class=cl>		 <span class=p>(</span><span class=s>&#34;\\chapter{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\chapter*{%s}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		 <span class=p>(</span><span class=s>&#34;\\section{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\section*{%s}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		 <span class=p>(</span><span class=s>&#34;\\subsection{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\subsection*{%s}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		 <span class=p>(</span><span class=s>&#34;\\subsubsection{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\subsubsection*{%s}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		 <span class=p>(</span><span class=s>&#34;\\paragraph{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\paragraph*{%s}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		 <span class=p>(</span><span class=s>&#34;\\subparagraph{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\subparagraph*{%s}&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;org-latex-classes</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;article&#34;</span>
</span></span><span class=line><span class=cl>				    <span class=s>&#34;\\documentclass{ctexart}
</span></span></span><span class=line><span class=cl><span class=s>		[NO-DEFAULT-PACKAGES]
</span></span></span><span class=line><span class=cl><span class=s>		[NO-PACKAGES]
</span></span></span><span class=line><span class=cl><span class=s>		[EXTRA]&#34;</span>
</span></span><span class=line><span class=cl>				    <span class=p>(</span><span class=s>&#34;\\section{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\section*{%s}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>				    <span class=p>(</span><span class=s>&#34;\\subsection{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\subsection*{%s}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>				    <span class=p>(</span><span class=s>&#34;\\subsubsection{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\subsubsection*{%s}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>				    <span class=p>(</span><span class=s>&#34;\\paragraph{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\paragraph*{%s}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>				    <span class=p>(</span><span class=s>&#34;\\subparagraph{%s}&#34;</span> <span class=o>.</span> <span class=s>&#34;\\subparagraph*{%s}&#34;</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-latex-pdf-process</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;xelatex -8bit --shell-escape  -interaction=nonstopmode -output-directory %o %f&#34;</span>
</span></span><span class=line><span class=cl>			      <span class=s>&#34;bibtex -shell-escape %b&#34;</span>
</span></span><span class=line><span class=cl>			      <span class=s>&#34;xelatex -8bit --shell-escape  -interaction=nonstopmode -output-directory %o %f&#34;</span>
</span></span><span class=line><span class=cl>			      <span class=s>&#34;xelatex -8bit --shell-escape  -interaction=nonstopmode -output-directory %o %f&#34;</span>
</span></span><span class=line><span class=cl>			      <span class=s>&#34;rm -fr %b.out %b.log %b.tex %b.brf %b.bbl&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=nv>org-latex-logfiles-extensions</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;lof&#34;</span> <span class=s>&#34;lot&#34;</span> <span class=s>&#34;tex~&#34;</span> <span class=s>&#34;aux&#34;</span> <span class=s>&#34;idx&#34;</span> <span class=s>&#34;log&#34;</span> <span class=s>&#34;out&#34;</span> <span class=s>&#34;toc&#34;</span> <span class=s>&#34;nav&#34;</span> <span class=s>&#34;snm&#34;</span> <span class=s>&#34;vrb&#34;</span> <span class=s>&#34;dvi&#34;</span> <span class=s>&#34;fdb_latexmk&#34;</span> <span class=s>&#34;blg&#34;</span> <span class=s>&#34;brf&#34;</span> <span class=s>&#34;fls&#34;</span> <span class=s>&#34;entoc&#34;</span> <span class=s>&#34;ps&#34;</span> <span class=s>&#34;spl&#34;</span> <span class=s>&#34;bbl&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=nv>org-latex-prefer-user-labels</span> <span class=no>t</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=auctex class=headerLink><a href=#auctex class=header-mark></a>auctex</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nf>load</span> <span class=s>&#34;auctex.el&#34;</span> <span class=no>nil</span> <span class=no>t</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>;; (load &#34;preview-latex.el&#34; nil t t)</span>
</span></span></code></pre></div><h4 id=cdlatex class=headerLink><a href=#cdlatex class=header-mark></a>cdlatex</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=c1>;; (require &#39;cdlatex)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;LaTeX-mode-hook</span> <span class=ss>&#39;turn-on-cdlatex</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;latex-mode-hook</span> <span class=ss>&#39;turn-on-cdlatex</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;org-mode-hook</span> <span class=ss>&#39;turn-on-org-cdlatex</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=math-preview class=headerLink><a href=#math-preview class=header-mark></a>math preview</h4><p>关于在 org-mode 中进行数学公式预览的功能前前后后己经尝试了多个包，有 org 自带的 org-latex-preview ，还有第三方包如： org-latex-impatient， popweb， xenops ，以及目前使用的这个包 math-preview。</p><p>首先 popweb 很好用，尤其是在 linux 系统上，即时预览公式很丝滑。只要配置好 eaf ，其可以跨系统使用。在 Mac 上使用，不太好，是因为 Mac 的全屏导致屏幕在工作区之间来回滑动。如果不全屏使用 Emacs ， popweb 也可以用。</p><p>Xenops 其主要是在 latex 环境下使用，同样也可以在 org-mode 中使用。我在 org-mode 中使用，存在的问题是，使用 hook 的方式启动 xenops-mode ，当我打开 Emacs 配置文件时，反应有点卡卡的。</p><p>Math-preview 和 org-latex-impatient 是类似的包，它们都是要借助于外部的 nodejs 程序实现公式的预览。 org-latex-impatient 有一段时间不更新了。初步尝试后决定使用 math-preview 进行公式的预览。在 MacOS M1 上使用下面的配置公式看起来还不错，你可能需要跟据自己的需要进行一定的修改。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>math-preview-scale</span> <span class=mf>1.2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>math-preview-raise</span> <span class=mf>0.4</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>math-preview-margin</span> <span class=o>&#39;</span><span class=p>(</span><span class=mi>1</span> <span class=o>.</span> <span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>face-spec-set</span> <span class=ss>&#39;math-preview-face</span>
</span></span><span class=line><span class=cl>	       <span class=o>&#39;</span><span class=p>((((</span><span class=nv>background</span> <span class=nv>light</span><span class=p>))</span>
</span></span><span class=line><span class=cl>		  <span class=nb>:foreground</span> <span class=s>&#34;#721045&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		 <span class=p>(</span><span class=no>t</span>
</span></span><span class=line><span class=cl>		  <span class=nb>:foreground</span> <span class=s>&#34;#feacd0&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	       <span class=ss>&#39;face-override-spec</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;org-mode-hook</span> <span class=nf>#&#39;</span><span class=nv>math-preview-all</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=benchmark class=headerLink><a href=#benchmark class=header-mark></a>Benchmark</h3><p>Organize Life With Plain Text 启动时间约 0.13s 。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nf>message</span> <span class=s>&#34;Organize Life With Plain Text: %.2fs&#34;</span>
</span></span><span class=line><span class=cl>	 <span class=p>(</span><span class=nf>float-time</span> <span class=p>(</span><span class=nf>time-subtract</span> <span class=p>(</span><span class=nf>current-time</span><span class=p>)</span> <span class=nv>my/section-start-time</span><span class=p>)))</span>
</span></span></code></pre></div><h2 id=emacs-can-do-more-applications class=headerLink><a href=#emacs-can-do-more-applications class=header-mark></a>Emacs Can DO More, Applications</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>my/section-start-time</span> <span class=p>(</span><span class=nf>current-time</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=pdf-reader class=headerLink><a href=#pdf-reader class=header-mark></a>PDF Reader</h3><h4 id=pdf-tools class=headerLink><a href=#pdf-tools class=header-mark></a>pdf tools</h4><p>如果不想高亮文件后打开标注，可以将 <code>pdf-annot-activate-created-annotations</code> 设置为 <code>nil</code> 。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>pdf-view-use-unicode-ligther</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>pdf-view-use-scaling</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>      <span class=nv>pdf-view-use-imagemagick</span> <span class=no>nil</span>
</span></span><span class=line><span class=cl>      <span class=nv>pdf-annot-activate-created-annotations</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;doc-view-mode-hook</span> <span class=ss>&#39;pdf-tools-install</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;revert-without-query</span> <span class=s>&#34;.+\\.pdf&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;pdf-tools-enabled-hook</span> <span class=ss>&#39;pdf-view-themed-minor-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;pdf-outline</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>define-key</span> <span class=nv>pdf-outline-buffer-mode-map</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;&lt;RET&gt;&#34;</span><span class=p>)</span> <span class=ss>&#39;pdf-outline-follow-link-and-quit</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=pdf-print class=headerLink><a href=#pdf-print class=header-mark></a>pdf print</h4><p>可以通过命令行使用打印机，不再需要用外部软件打开再去打印文件，而且可以选择打印的页数。来自 <a href=https://qua.name/mrb/an-org-babel-based-emacs-configuration#orgbf8348e target=_blank rel="noopener noreffer">Marcel van der Boom</a> 的配置文件。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>pdf-misc-print-program-executable</span> <span class=s>&#34;/usr/bin/lp&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>mrb/pdf-misc-print-pages</span><span class=p>(</span><span class=nv>filename</span> <span class=nv>pages</span> <span class=kp>&amp;optional</span> <span class=nv>interactive-p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;Wrapper for `pdf-misc-print-document` to add page selection support&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>interactive</span> <span class=p>(</span><span class=nf>list</span> <span class=p>(</span><span class=nv>pdf-view-buffer-file-name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		       <span class=p>(</span><span class=nf>read-string</span> <span class=s>&#34;Page range (empty for all pages): &#34;</span>
</span></span><span class=line><span class=cl>				    <span class=p>(</span><span class=nf>number-to-string</span> <span class=p>(</span><span class=nv>pdf-view-current-page</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>		       <span class=no>t</span><span class=p>)</span> <span class=nv>pdf-view-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>pdf-misc-print-program-args</span>
</span></span><span class=line><span class=cl>	   <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nv>not</span> <span class=p>(</span><span class=nv>string-blank-p</span> <span class=nv>pages</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	       <span class=p>(</span><span class=nf>cons</span> <span class=p>(</span><span class=nf>concat</span> <span class=s>&#34;-P &#34;</span> <span class=nv>pages</span><span class=p>)</span> <span class=nv>pdf-misc-print-program-args</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	     <span class=nv>pdf-misc-print-program-args</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>pdf-misc-print-document</span> <span class=nv>filename</span><span class=p>)))</span>
</span></span></code></pre></div><h4 id=pdf-key-settings class=headerLink><a href=#pdf-key-settings class=header-mark></a>pdf key settings</h4><p>绑定 w ，获得文件名，我不需要那一大串路径。
重新定义按键，相比原来的 <code>C-x C-a h</code> 等按键设定要方便的多。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my/get-file-name</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>kill-new</span> <span class=p>(</span><span class=nv>file-name-base</span> <span class=p>(</span><span class=nf>buffer-file-name</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>message</span> <span class=s>&#34;Copied %s&#34;</span> <span class=p>(</span><span class=nv>file-name-base</span> <span class=p>(</span><span class=nf>buffer-file-name</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;pdf-view</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>define-key</span> <span class=nv>pdf-view-mode-map</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;w&#34;</span><span class=p>)</span> <span class=ss>&#39;my/get-file-name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>define-key</span> <span class=nv>pdf-view-mode-map</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;h&#34;</span><span class=p>)</span> <span class=ss>&#39;pdf-annot-add-highlight-markup-annotation</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>define-key</span> <span class=nv>pdf-view-mode-map</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;t&#34;</span><span class=p>)</span> <span class=ss>&#39;pdf-annot-add-text-annotation</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>define-key</span> <span class=nv>pdf-view-mode-map</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;d&#34;</span><span class=p>)</span> <span class=ss>&#39;pdf-annot-delete</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>define-key</span> <span class=nv>pdf-view-mode-map</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;q&#34;</span><span class=p>)</span> <span class=ss>&#39;kill-this-buffer</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>define-key</span> <span class=nv>pdf-view-mode-map</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;y&#34;</span><span class=p>)</span> <span class=ss>&#39;pdf-view-kill-ring-save</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>define-key</span> <span class=nv>pdf-view-mode-map</span> <span class=p>[</span><span class=nv>remap</span> <span class=nv>pdf-misc-print-document</span><span class=p>]</span> <span class=ss>&#39;mrb/pdf-misc-print-pages</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;pdf-annot</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>define-key</span> <span class=nv>pdf-annot-edit-contents-minor-mode-map</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;&lt;return&gt;&#34;</span><span class=p>)</span> <span class=ss>&#39;pdf-annot-edit-contents-commit</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>define-key</span> <span class=nv>pdf-annot-edit-contents-minor-mode-map</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;&lt;S-return&gt;&#34;</span><span class=p>)</span> <span class=ss>&#39;newline</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=pdf-annotations class=headerLink><a href=#pdf-annotations class=header-mark></a>pdf annotations</h4><p>Create pdf annotations file.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my/edit-notes</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Edit reference note base pdf name.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>file-name-extension</span> <span class=p>(</span><span class=nf>buffer-name</span><span class=p>))</span> <span class=s>&#34;pdf&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>consult-bibtex-edit-notes</span> <span class=p>(</span><span class=nv>file-name-sans-extension</span> <span class=p>(</span><span class=nf>buffer-name</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>consult-bibtex-edit-notes</span> <span class=p>(</span><span class=nv>consult-bibtex--read-entry</span><span class=p>))))</span>
</span></span></code></pre></div><p>Extract pdf annotations with <a href=https://github.com/0xabu/pdfannots target=_blank rel="noopener noreffer">pdfannots</a>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my/org-delete-heading-content</span> <span class=p>(</span><span class=nv>heading</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Delete content of specific HEADING&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>org-map-entries</span>
</span></span><span class=line><span class=cl>   <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>     <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>name</span> <span class=p>(</span><span class=nf>nth</span> <span class=mi>4</span> <span class=p>(</span><span class=nv>org-heading-components</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>       <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nv>string=</span> <span class=nv>name</span> <span class=nv>heading</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	   <span class=p>(</span><span class=nb>save-restriction</span>
</span></span><span class=line><span class=cl>	     <span class=p>(</span><span class=nv>org-mark-subtree</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	     <span class=p>(</span><span class=nf>forward-line</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	     <span class=p>(</span><span class=nf>delete-region</span> <span class=p>(</span><span class=nf>region-beginning</span><span class=p>)</span> <span class=p>(</span><span class=nf>region-end</span><span class=p>))))))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my/extract-pdf-annots-to-ref-note</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let</span> <span class=p>(</span><span class=nv>annots</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>setf</span> <span class=nv>annots</span> <span class=p>(</span><span class=nv>shell-command-to-string</span> <span class=p>(</span><span class=nf>format</span> <span class=s>&#34;pdfannots.py %s&#34;</span> <span class=p>(</span><span class=nv>find-file</span> <span class=p>(</span><span class=nf>buffer-name</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>consult-bibtex-edit-notes</span> <span class=p>(</span><span class=nv>file-name-sans-extension</span> <span class=p>(</span><span class=nf>buffer-name</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>my/org-delete-heading-content</span> <span class=s>&#34;Research Contribution&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>goto-char</span> <span class=p>(</span><span class=nv>org-find-exact-headline-in-buffer</span> <span class=s>&#34;Research Contribution&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>forward-line</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>dolist</span> <span class=p>(</span><span class=nv>item</span> <span class=p>(</span><span class=nv>split-string</span> <span class=nv>annots</span> <span class=s>&#34;\n&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nv>string-prefix-p</span> <span class=s>&#34;   &gt;&#34;</span> <span class=nv>item</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	  <span class=p>(</span><span class=nf>princ</span> <span class=p>(</span><span class=nf>concat</span> <span class=p>(</span><span class=nv>replace-regexp-in-string</span> <span class=s>&#34;   &gt;&#34;</span> <span class=s>&#34;+&#34;</span> <span class=nv>item</span><span class=p>)</span> <span class=s>&#34;\n&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		 <span class=p>(</span><span class=nf>current-buffer</span><span class=p>))))))</span>
</span></span></code></pre></div><h3 id=git class=headerLink><a href=#git class=header-mark></a>GIT</h3><h4 id=magit class=headerLink><a href=#magit class=header-mark></a>Magit</h4><p>Magit related configuration</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>transient-history-file</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;transient/history.el&#34;</span> <span class=nv>my-cache-directory</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;magit</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>magit-display-buffer-function</span> <span class=ss>&#39;magit-display-buffer-fullframe-status-topleft-v1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>magit-add-section-hook</span> <span class=ss>&#39;magit-status-sections-hook</span>
</span></span><span class=line><span class=cl>			  <span class=ss>&#39;magit-insert-modules</span>
</span></span><span class=line><span class=cl>			  <span class=ss>&#39;magit-insert-unpulled-from-upstream</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=git-timemachine class=headerLink><a href=#git-timemachine class=header-mark></a>git-timemachine</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>unless</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>fboundp</span> <span class=ss>&#39;git-timemachine</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>autoload</span> <span class=nf>#&#39;</span><span class=nv>git-timemachine</span> <span class=s>&#34;git-timemachine&#34;</span> <span class=no>nil</span> <span class=no>t</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=browse-at-remote class=headerLink><a href=#browse-at-remote class=header-mark></a>Browse at remote</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>require</span> <span class=ss>&#39;browse-at-remote</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=eshell class=headerLink><a href=#eshell class=header-mark></a>eshell</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-`&#34;</span><span class=p>)</span> <span class=ss>&#39;eshell</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>eshell-directory-name</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;eshell&#34;</span> <span class=nv>my-cache-directory</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=rss-management class=headerLink><a href=#rss-management class=header-mark></a>Rss management</h3><h4 id=elfeed class=headerLink><a href=#elfeed class=header-mark></a>elfeed</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>elfeed-db-directory</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;elfeed&#34;</span> <span class=nv>my-cache-directory</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>elfeed-show-entry-switch</span> <span class=nf>#&#39;</span><span class=nv>elfeed-display-buffer</span><span class=p>)</span>
</span></span></code></pre></div><p>elfeed buffer display. 代码借鉴自 <a href=https://github.com/karthink/.emacs.d/blob/master/lisp/setup-elfeed.el target=_blank rel="noopener noreffer">karthink</a> 的配置。这样可以去掉 elfeed-goodies 这个包了。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>elfeed-display-buffer</span> <span class=p>(</span><span class=nv>buf</span> <span class=kp>&amp;optional</span> <span class=nv>act</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>pop-to-buffer</span> <span class=nv>buf</span> <span class=o>&#39;</span><span class=p>((</span><span class=nv>display-buffer-reuse-window</span> <span class=nv>display-buffer-in-side-window</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		       <span class=p>(</span><span class=nv>side</span> <span class=o>.</span> <span class=nv>bottom</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		       <span class=p>(</span><span class=nv>window-height</span> <span class=o>.</span> <span class=mf>0.8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		       <span class=p>(</span><span class=nv>reusable-frames</span> <span class=o>.</span> <span class=nv>visible</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		       <span class=p>(</span><span class=nf>window-parameters</span>
</span></span><span class=line><span class=cl>			<span class=p>(</span><span class=nv>select</span> <span class=o>.</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			<span class=p>(</span><span class=nv>quit</span> <span class=o>.</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			<span class=p>(</span><span class=nv>popup</span> <span class=o>.</span> <span class=no>t</span><span class=p>)))))</span>
</span></span></code></pre></div><h4 id=elfeed-org class=headerLink><a href=#elfeed-org class=header-mark></a>elfeed-org</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;elfeed</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>rmh-elfeed-org-files</span> <span class=p>(</span><span class=nf>list</span> <span class=s>&#34;~/Nextcloud/L.Personal.Galaxy/roam/main/elfeed.org&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>elfeed-org</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=elfeed-score class=headerLink><a href=#elfeed-score class=header-mark></a>elfeed-score</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;elfeed</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>elfeed-score-rule-stats-file</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;elfeed.stats&#34;</span> <span class=nv>my-cache-directory</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>elfeed-score-enable</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>define-key</span> <span class=nv>elfeed-search-mode-map</span> <span class=s>&#34;=&#34;</span> <span class=nv>elfeed-score-map</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=elfeed-summary class=headerLink><a href=#elfeed-summary class=header-mark></a>elfeed-summary</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=c1>;; (require &#39;elfeed-summary)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>elfeed-summary-other-window</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>elfeed-summary-settings</span>
</span></span><span class=line><span class=cl>      <span class=o>&#39;</span><span class=p>((</span><span class=nv>group</span> <span class=p>(</span><span class=nb>:title</span> <span class=o>.</span> <span class=s>&#34;Searches&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	       <span class=p>(</span><span class=nb>:elements</span> <span class=p>(</span><span class=nv>search</span> <span class=p>(</span><span class=nb>:filter</span> <span class=o>.</span> <span class=s>&#34;@7-days-ago +unread&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>				  <span class=p>(</span><span class=nb>:title</span> <span class=o>.</span> <span class=s>&#34;Unread entries this week&#34;</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=nv>group</span> <span class=p>(</span><span class=nb>:title</span> <span class=o>.</span> <span class=s>&#34;Blogs&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	       <span class=p>(</span><span class=nb>:elements</span> <span class=p>(</span><span class=nv>query</span> <span class=o>.</span> <span class=p>(</span><span class=nb>and</span> <span class=nv>blogs</span> <span class=p>(</span><span class=nv>not</span> <span class=nv>Emacs</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>			  <span class=p>(</span><span class=nv>group</span> <span class=p>(</span><span class=nb>:title</span> <span class=o>.</span> <span class=s>&#34;Emacs&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>				 <span class=p>(</span><span class=nb>:elements</span> <span class=p>(</span><span class=nv>query</span> <span class=o>.</span> <span class=nv>Emacs</span><span class=p>))</span>
</span></span><span class=line><span class=cl>				 <span class=p>(</span><span class=nb>:face</span> <span class=o>.</span> <span class=nv>modus-themes-heading-1</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=nv>group</span> <span class=p>(</span><span class=nb>:title</span> <span class=o>.</span> <span class=s>&#34;News&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	       <span class=p>(</span><span class=nb>:elements</span> <span class=p>(</span><span class=nv>query</span> <span class=o>.</span> <span class=nv>news</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=nv>group</span> <span class=p>(</span><span class=nb>:title</span> <span class=o>.</span> <span class=s>&#34;Books&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	       <span class=p>(</span><span class=nb>:elements</span> <span class=p>(</span><span class=nv>query</span> <span class=o>.</span> <span class=nv>book</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>advice-add</span> <span class=ss>&#39;elfeed-summary</span> <span class=nb>:after</span> <span class=ss>&#39;elfeed-update</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=email class=headerLink><a href=#email class=header-mark></a>Email</h3><p>我使用 Mu4e 和 mbsync 管理邮件。Mu4e 的安装见官方手册（<a href=https://www.djcbsoftware.nl/code/mu/mu4e/Installation.html target=_blank rel="noopener noreffer">Installation</a>）。
Macos 上安装的可见，<a href=https://macowners.club/posts/email-emacs-mu4e-macos/ target=_blank rel="noopener noreffer">Blog</a>，目前最详细的教程。</p><h4 id=mu4e class=headerLink><a href=#mu4e class=header-mark></a>mu4e</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>unless</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>fboundp</span> <span class=ss>&#39;mu4e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>autoload</span> <span class=nf>#&#39;</span><span class=nv>mu4e</span> <span class=s>&#34;mu4e&#34;</span> <span class=no>nil</span> <span class=no>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>mu4e-mu-binary</span> <span class=p>(</span><span class=nv>executable-find</span> <span class=s>&#34;mu&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=nv>mu4e-get-mail-command</span> <span class=p>(</span><span class=nf>concat</span> <span class=p>(</span><span class=nv>executable-find</span> <span class=s>&#34;mbsync&#34;</span><span class=p>)</span> <span class=s>&#34; -a&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>mu4e-maildir</span> <span class=s>&#34;~/.maildir&#34;</span>
</span></span><span class=line><span class=cl>      <span class=nv>mu4e-attachment-dir</span> <span class=s>&#34;~/Downloads/&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>mail-user-agent</span> <span class=ss>&#39;mu4e-user-agent</span>
</span></span><span class=line><span class=cl>      <span class=nv>mu4e-update-interval</span> <span class=p>(</span><span class=nf>*</span> <span class=mi>15</span> <span class=mi>60</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=nv>mu4e-index-update-in-background</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>      <span class=nv>mu4e-index-update-error-warning</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>      <span class=nv>mu4e-view-show-images</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>      <span class=nv>mu4e-view-image-max-width</span> <span class=mi>800</span>
</span></span><span class=line><span class=cl>      <span class=nv>mu4e-confirm-quit</span> <span class=no>nil</span>
</span></span><span class=line><span class=cl>      <span class=nv>mu4e-view-show-addresses</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>      <span class=nv>mu4e-index-update-error-warning</span> <span class=no>nil</span>
</span></span><span class=line><span class=cl>      <span class=nv>mu4e-index-cleanup</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>      <span class=nv>mu4e-context-policy</span> <span class=ss>&#39;pick-first</span>
</span></span><span class=line><span class=cl>      <span class=nv>mu4e-compose-reply-ignore-address</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;no-?reply&#34;</span> <span class=s>&#34;duan_n@outlook.com&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;mu4e</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>mu4e-sent-folder</span>   <span class=s>&#34;/outlook/Sent&#34;</span>
</span></span><span class=line><span class=cl>	<span class=nv>mu4e-drafts-folder</span> <span class=s>&#34;/outlook/Drafts&#34;</span>
</span></span><span class=line><span class=cl>	<span class=nv>mu4e-trash-folder</span>  <span class=s>&#34;/outlook/Deleted&#34;</span>
</span></span><span class=line><span class=cl>	<span class=nv>mu4e-refile-folder</span>  <span class=s>&#34;/outlook/Archive&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>my/mail-start</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>mu4e</span> <span class=ss>&#39;background</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;after-init-hook</span> <span class=ss>&#39;my/mail-start</span><span class=p>)</span>
</span></span></code></pre></div><ul><li><p>mu4e headers</p><p>Replace fancy icon with all-the-icons。原来的 icon 看起来丑。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>mu4e-headers-precise-alignment</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>mu4e-headers-include-related</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>mu4e-headers-auto-update</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>mu4e-headers-date-format</span> <span class=s>&#34;%d/%m/%y&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>mu4e-headers-time-format</span> <span class=s>&#34;%H:%M&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>mu4e-headers-fields</span> <span class=o>&#39;</span><span class=p>((</span><span class=nb>:flags</span> <span class=o>.</span> <span class=mi>12</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			    <span class=p>(</span><span class=nb>:human-date</span> <span class=o>.</span> <span class=mi>9</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			    <span class=p>(</span><span class=nb>:subject</span> <span class=o>.</span> <span class=mi>90</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			    <span class=p>(</span><span class=nb>:from-or-to</span> <span class=o>.</span> <span class=mi>40</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			    <span class=p>(</span><span class=nb>:tags</span> <span class=o>.</span> <span class=mi>20</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>mu4e-use-fancy-chars</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>mu4e-headers-seen-mark</span> <span class=o>`</span><span class=p>(</span><span class=s>&#34;S&#34;</span> <span class=o>.</span> <span class=o>,</span><span class=p>(</span><span class=nf>propertize</span>
</span></span><span class=line><span class=cl>				       <span class=p>(</span><span class=nv>all-the-icons-material</span> <span class=s>&#34;mail_outline&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>				       <span class=ss>&#39;face</span> <span class=o>`</span><span class=p>(</span><span class=nb>:family</span> <span class=o>,</span><span class=p>(</span><span class=nv>all-the-icons-material-family</span><span class=p>)</span>
</span></span><span class=line><span class=cl>						       <span class=nb>:foreground</span> <span class=o>,</span><span class=p>(</span><span class=nv>face-background</span> <span class=ss>&#39;default</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>      <span class=nv>mu4e-headers-new-mark</span> <span class=o>`</span><span class=p>(</span><span class=s>&#34;N&#34;</span> <span class=o>.</span> <span class=o>,</span><span class=p>(</span><span class=nf>propertize</span>
</span></span><span class=line><span class=cl>				      <span class=p>(</span><span class=nv>all-the-icons-material</span> <span class=s>&#34;markunread&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>				      <span class=ss>&#39;face</span> <span class=o>`</span><span class=p>(</span><span class=nb>:family</span> <span class=o>,</span><span class=p>(</span><span class=nv>all-the-icons-material-family</span><span class=p>)</span>
</span></span><span class=line><span class=cl>						      <span class=nb>:foreground</span> <span class=o>,</span><span class=p>(</span><span class=nv>face-background</span> <span class=ss>&#39;default</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>      <span class=nv>mu4e-headers-unread-mark</span> <span class=o>`</span><span class=p>(</span><span class=s>&#34;u&#34;</span> <span class=o>.</span> <span class=o>,</span><span class=p>(</span><span class=nf>propertize</span>
</span></span><span class=line><span class=cl>					 <span class=p>(</span><span class=nv>all-the-icons-material</span> <span class=s>&#34;notifications_none&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>					 <span class=ss>&#39;face</span> <span class=ss>&#39;mu4e-unread-face</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=nv>mu4e-headers-signed-mark</span> <span class=o>`</span><span class=p>(</span><span class=s>&#34;s&#34;</span> <span class=o>.</span> <span class=o>,</span><span class=p>(</span><span class=nf>propertize</span>
</span></span><span class=line><span class=cl>					 <span class=p>(</span><span class=nv>all-the-icons-material</span> <span class=s>&#34;check&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>					 <span class=ss>&#39;face</span> <span class=o>`</span><span class=p>(</span><span class=nb>:family</span> <span class=o>,</span><span class=p>(</span><span class=nv>all-the-icons-material-family</span><span class=p>)</span>
</span></span><span class=line><span class=cl>							 <span class=nb>:foreground</span> <span class=s>&#34;DarkCyan&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>      <span class=nv>mu4e-headers-encrypted-mark</span> <span class=o>`</span><span class=p>(</span><span class=s>&#34;x&#34;</span> <span class=o>.</span> <span class=o>,</span><span class=p>(</span><span class=nf>propertize</span>
</span></span><span class=line><span class=cl>					    <span class=p>(</span><span class=nv>all-the-icons-material</span> <span class=s>&#34;enhanced_encryption&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>					    <span class=ss>&#39;face</span> <span class=o>`</span><span class=p>(</span><span class=nb>:family</span> <span class=o>,</span><span class=p>(</span><span class=nv>all-the-icons-material-family</span><span class=p>)</span>
</span></span><span class=line><span class=cl>							    <span class=nb>:foreground</span> <span class=s>&#34;CornflowerBlue&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>      <span class=nv>mu4e-headers-draft-mark</span> <span class=o>`</span><span class=p>(</span><span class=s>&#34;D&#34;</span> <span class=o>.</span> <span class=o>,</span><span class=p>(</span><span class=nf>propertize</span>
</span></span><span class=line><span class=cl>					<span class=p>(</span><span class=nv>all-the-icons-material</span> <span class=s>&#34;drafts&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>					<span class=ss>&#39;face</span> <span class=ss>&#39;mu4e-draft-face</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=nv>mu4e-headers-attach-mark</span> <span class=o>`</span><span class=p>(</span><span class=s>&#34;a&#34;</span> <span class=o>.</span> <span class=o>,</span><span class=p>(</span><span class=nf>propertize</span>
</span></span><span class=line><span class=cl>					 <span class=p>(</span><span class=nv>all-the-icons-material</span> <span class=s>&#34;attachment&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>					 <span class=ss>&#39;face</span> <span class=ss>&#39;mu4e-attach-number-face</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=nv>mu4e-headers-passed-mark</span> <span class=o>`</span><span class=p>(</span><span class=s>&#34;P&#34;</span> <span class=o>.</span> <span class=o>,</span><span class=p>(</span><span class=nf>propertize</span> <span class=c1>; ❯ (I&#39;m participated in thread)</span>
</span></span><span class=line><span class=cl>					 <span class=p>(</span><span class=nv>all-the-icons-material</span> <span class=s>&#34;center_focus_weak&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>					 <span class=ss>&#39;face</span> <span class=o>`</span><span class=p>(</span><span class=nb>:family</span> <span class=o>,</span><span class=p>(</span><span class=nv>all-the-icons-material-family</span><span class=p>)</span>
</span></span><span class=line><span class=cl>							 <span class=nb>:foreground</span> <span class=s>&#34;yellow&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>      <span class=nv>mu4e-headers-flagged-mark</span> <span class=o>`</span><span class=p>(</span><span class=s>&#34;F&#34;</span> <span class=o>.</span> <span class=o>,</span><span class=p>(</span><span class=nf>propertize</span>
</span></span><span class=line><span class=cl>					  <span class=p>(</span><span class=nv>all-the-icons-material</span> <span class=s>&#34;flag&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>					  <span class=ss>&#39;face</span> <span class=ss>&#39;mu4e-flagged-face</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=nv>mu4e-headers-replied-mark</span> <span class=o>`</span><span class=p>(</span><span class=s>&#34;R&#34;</span> <span class=o>.</span> <span class=o>,</span><span class=p>(</span><span class=nf>propertize</span>
</span></span><span class=line><span class=cl>					  <span class=p>(</span><span class=nv>all-the-icons-material</span> <span class=s>&#34;reply_all&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>					  <span class=ss>&#39;face</span> <span class=ss>&#39;mu4e-replied-face</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=nv>mu4e-headers-trashed-mark</span> <span class=o>`</span><span class=p>(</span><span class=s>&#34;T&#34;</span> <span class=o>.</span> <span class=o>,</span><span class=p>(</span><span class=nf>propertize</span>
</span></span><span class=line><span class=cl>					  <span class=p>(</span><span class=nv>all-the-icons-material</span> <span class=s>&#34;delete_forever&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>					  <span class=ss>&#39;face</span> <span class=ss>&#39;mu4e-trashed-face</span><span class=p>)))</span>
</span></span></code></pre></div></li></ul><ul><li><p>mu4e bookmarks</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>mu4e-bookmarks</span> <span class=o>&#39;</span><span class=p>((</span><span class=s>&#34;flag:unread AND NOT flag:trashed&#34;</span> <span class=s>&#34;Unread messages&#34;</span> <span class=sc>?u</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		       <span class=p>(</span><span class=s>&#34;date:today..now&#34;</span> <span class=s>&#34;Today&#39;s messages&#34;</span> <span class=sc>?t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		       <span class=p>(</span><span class=s>&#34;date:7d..now&#34;</span> <span class=s>&#34;Last 7 days&#34;</span> <span class=sc>?w</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		       <span class=p>(</span><span class=s>&#34;date:1d..now AND NOT list:emacs-orgmode.gnu.org&#34;</span> <span class=s>&#34;Last 1 days&#34;</span> <span class=sc>?o</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		       <span class=p>(</span><span class=s>&#34;date:1d..now AND list:emacs-orgmode.gnu.org&#34;</span> <span class=s>&#34;Last 1 days (org mode)&#34;</span> <span class=sc>?m</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		       <span class=p>(</span><span class=s>&#34;maildir:/drafts&#34;</span> <span class=s>&#34;drafts&#34;</span> <span class=sc>?d</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		       <span class=p>(</span><span class=s>&#34;flag:flagged AND NOT flag:trashed&#34;</span> <span class=s>&#34;flagged&#34;</span> <span class=sc>?f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		       <span class=p>(</span><span class=s>&#34;mime:image/*&#34;</span> <span class=s>&#34;Messages with images&#34;</span> <span class=sc>?p</span><span class=p>)))</span>
</span></span></code></pre></div></li></ul><h4 id=mu4e-alert class=headerLink><a href=#mu4e-alert class=header-mark></a>mu4e-alert</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;mu4e</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>require</span> <span class=ss>&#39;mu4e-alert</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=c1>;; (mu4e-alert-set-default-style &#39;notifier)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;after-init-hook</span> <span class=nf>#&#39;</span><span class=nv>mu4e-alert-enable-notifications</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;awesome-tray-active-modules</span> <span class=s>&#34;mail&#34;</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=sent-mail class=headerLink><a href=#sent-mail class=header-mark></a>sent mail</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>message-send-mail-function</span> <span class=ss>&#39;smtpmail-send-it</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=mu4e-column-faces class=headerLink><a href=#mu4e-column-faces class=header-mark></a>mu4e-column-faces</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;mu4e</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>mu4e-column-faces-mode</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=map-osm class=headerLink><a href=#map-osm class=header-mark></a>Map osm</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>osm-server</span> <span class=ss>&#39;default</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>osm-tile-directory</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;osm&#34;</span> <span class=nv>my-cache-directory</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>osm-home</span> <span class=o>&#39;</span><span class=p>(</span><span class=mf>31.93</span> <span class=mf>118.80</span> <span class=mi>3</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=telegaram class=headerLink><a href=#telegaram class=header-mark></a>Telegaram</h3><p>非官方的 telegram 客户端。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>telega-server-libs-prefix</span> <span class=s>&#34;~/td/tdlib&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>telega-proxies</span> <span class=p>(</span><span class=nf>list</span>
</span></span><span class=line><span class=cl>		      <span class=o>&#39;</span><span class=p>(</span><span class=nb>:server</span> <span class=s>&#34;127.0.0.1&#34;</span> <span class=nb>:port</span> <span class=mi>7891</span> <span class=nb>:enable</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>				<span class=nb>:type</span> <span class=p>(</span><span class=nb>:@type</span> <span class=s>&#34;proxyTypeSocks5&#34;</span><span class=p>))))</span>
</span></span></code></pre></div><h3 id=proxy class=headerLink><a href=#proxy class=header-mark></a>Proxy</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>proxy-socks-show</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Show SOCKS proxy.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nf>fboundp</span> <span class=ss>&#39;cadddr</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nv>bound-and-true-p</span> <span class=nv>socks-noproxy</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=nf>message</span> <span class=s>&#34;Current SOCKS%d proxy is %s:%d&#34;</span>
</span></span><span class=line><span class=cl>		 <span class=p>(</span><span class=nv>cadddr</span> <span class=nv>socks-server</span><span class=p>)</span> <span class=p>(</span><span class=nv>cadr</span> <span class=nv>socks-server</span><span class=p>)</span> <span class=p>(</span><span class=nv>caddr</span> <span class=nv>socks-server</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nf>message</span> <span class=s>&#34;No SOCKS proxy&#34;</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>proxy-socks-enable</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Enable SOCKS proxy.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>require</span> <span class=ss>&#39;socks</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>url-gateway-method</span> <span class=ss>&#39;socks</span>
</span></span><span class=line><span class=cl>	<span class=nv>socks-noproxy</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;localhost&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nv>socks-server</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;Default server&#34;</span> <span class=s>&#34;127.0.0.1&#34;</span> <span class=mi>7890</span> <span class=mi>5</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>setenv</span> <span class=s>&#34;all_proxy&#34;</span> <span class=s>&#34;socks5://127.0.0.1:7890&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>proxy-socks-show</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>proxy-socks-disable</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Disable SOCKS proxy.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>require</span> <span class=ss>&#39;socks</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>url-gateway-method</span> <span class=ss>&#39;native</span>
</span></span><span class=line><span class=cl>	<span class=nv>socks-noproxy</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>setenv</span> <span class=s>&#34;all_proxy&#34;</span> <span class=s>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>proxy-socks-show</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>proxy-socks-toggle</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Toggle SOCKS proxy.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>require</span> <span class=ss>&#39;socks</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nv>bound-and-true-p</span> <span class=nv>socks-noproxy</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>proxy-socks-disable</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>proxy-socks-enable</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;on-first-buffer-hook</span> <span class=nf>#&#39;</span><span class=nv>proxy-socks-enable</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=benchmark class=headerLink><a href=#benchmark class=header-mark></a>Benchmark</h3><p>Emacs Can DO More 启动时间约 0.10s 。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nf>message</span> <span class=s>&#34;Emacs Can DO More: %.2fs&#34;</span>
</span></span><span class=line><span class=cl>	 <span class=p>(</span><span class=nf>float-time</span> <span class=p>(</span><span class=nf>time-subtract</span> <span class=p>(</span><span class=nf>current-time</span><span class=p>)</span> <span class=nv>my/section-start-time</span><span class=p>)))</span>
</span></span></code></pre></div><h2 id=emacs-keybindings class=headerLink><a href=#emacs-keybindings class=header-mark></a>Emacs Keybindings</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>my/section-start-time</span> <span class=p>(</span><span class=nf>current-time</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=keyfreq class=headerLink><a href=#keyfreq class=header-mark></a>Keyfreq</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>keyfreq-file</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;.emacs.keyfreq&#34;</span> <span class=nv>my-cache-directory</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>keyfreq-excluded-commands</span> <span class=o>&#39;</span><span class=p>(</span><span class=nf>self-insert-command</span>
</span></span><span class=line><span class=cl>				  <span class=nf>forward-char</span>
</span></span><span class=line><span class=cl>				  <span class=nf>backward-char</span>
</span></span><span class=line><span class=cl>				  <span class=nv>previous-line</span>
</span></span><span class=line><span class=cl>				  <span class=nv>next-line</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;on-first-input-hook</span> <span class=ss>&#39;keyfreq-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;on-first-input-hook</span> <span class=ss>&#39;keyfreq-autosave-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=meow class=headerLink><a href=#meow class=header-mark></a>Meow</h3><p>Meow 是 Emacs 中的一个模式编辑插件。另一个很火的插件是 Evil 。我选择使用的是 meow ，和 Emacs 的结合使用更紧密。使用 Evil 需要为不同的 major mode 绑定不同的按键，而 meow 可以使用各 major mode 默认的按键。原生的 Emacs 按键需要同时按下多个键以执行某个命令，Emacs 借鉴了 god-mode 中的方法，使得需要同时按的键可以按顺序按，这大大减小对于手指的伤害。</p><p>不然怎么说使用 Emacs 的人都是折了小指的天使，现在有了 meow ，再也不会出现肌鞘炎的问题了。</p><blockquote><p><a href=https://github.com/meow-edit/meow target=_blank rel="noopener noreffer">Meow</a> is yet another modal editing mode for Emacs.</p></blockquote><h4 id=meow-setup class=headerLink><a href=#meow-setup class=header-mark></a>meow-setup</h4><p>使用不用的键盘布局，需要使用不用的 meow-setup ，这个在 meow 的 github 主页中察看。</p><p>我很想知道的是使不同的的键盘布局对于按键的效率，便捷性有多大的影响，但是为了适应不同的按键布局需要投入很多的时间，是否合适又是另外的一个话题了。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>meow-setup</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>meow-motion-overwrite-define-key</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;j&#34;</span> <span class=o>.</span> <span class=nv>meow-next</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;k&#34;</span> <span class=o>.</span> <span class=nv>meow-prev</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>meow-leader-define-key</span>
</span></span><span class=line><span class=cl>   <span class=c1>;; SPC j/k will run the original command in MOTION state.</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;j&#34;</span> <span class=o>.</span> <span class=s>&#34;H-j&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;k&#34;</span> <span class=o>.</span> <span class=s>&#34;H-k&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=c1>;; Use SPC (0-9) for digit arguments.</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;1&#34;</span> <span class=o>.</span> <span class=nv>meow-digit-argument</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;2&#34;</span> <span class=o>.</span> <span class=nv>meow-digit-argument</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;3&#34;</span> <span class=o>.</span> <span class=nv>meow-digit-argument</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;4&#34;</span> <span class=o>.</span> <span class=nv>meow-digit-argument</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;5&#34;</span> <span class=o>.</span> <span class=nv>meow-digit-argument</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;6&#34;</span> <span class=o>.</span> <span class=nv>meow-digit-argument</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;7&#34;</span> <span class=o>.</span> <span class=nv>meow-digit-argument</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;8&#34;</span> <span class=o>.</span> <span class=nv>meow-digit-argument</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;9&#34;</span> <span class=o>.</span> <span class=nv>meow-digit-argument</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;0&#34;</span> <span class=o>.</span> <span class=nv>meow-digit-argument</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=c1>;; &#39;(&#34;/&#34; . meow-keypad-describe-key)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;?&#34;</span> <span class=o>.</span> <span class=nv>meow-cheatsheet</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>meow-normal-define-key</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;0&#34;</span> <span class=o>.</span> <span class=nv>meow-expand-0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;9&#34;</span> <span class=o>.</span> <span class=nv>meow-expand-9</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;8&#34;</span> <span class=o>.</span> <span class=nv>meow-expand-8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;7&#34;</span> <span class=o>.</span> <span class=nv>meow-expand-7</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;6&#34;</span> <span class=o>.</span> <span class=nv>meow-expand-6</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;5&#34;</span> <span class=o>.</span> <span class=nv>meow-expand-5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;4&#34;</span> <span class=o>.</span> <span class=nv>meow-expand-4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;3&#34;</span> <span class=o>.</span> <span class=nv>meow-expand-3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;2&#34;</span> <span class=o>.</span> <span class=nv>meow-expand-2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;1&#34;</span> <span class=o>.</span> <span class=nv>meow-expand-1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;-&#34;</span> <span class=o>.</span> <span class=nv>negative-argument</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;;&#34;</span> <span class=o>.</span> <span class=nv>meow-reverse</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;,&#34;</span> <span class=o>.</span> <span class=nv>meow-inner-of-thing</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;.&#34;</span> <span class=o>.</span> <span class=nv>meow-bounds-of-thing</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;[&#34;</span> <span class=o>.</span> <span class=nv>meow-beginning-of-thing</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;]&#34;</span> <span class=o>.</span> <span class=nv>meow-end-of-thing</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;a&#34;</span> <span class=o>.</span> <span class=nv>meow-append</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;A&#34;</span> <span class=o>.</span> <span class=nv>meow-open-below</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;b&#34;</span> <span class=o>.</span> <span class=nv>meow-back-word</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;B&#34;</span> <span class=o>.</span> <span class=nv>meow-back-symbol</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;c&#34;</span> <span class=o>.</span> <span class=nv>meow-change</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;d&#34;</span> <span class=o>.</span> <span class=nv>meow-delete</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;D&#34;</span> <span class=o>.</span> <span class=nv>meow-backward-delete</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;e&#34;</span> <span class=o>.</span> <span class=nv>meow-next-word</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;E&#34;</span> <span class=o>.</span> <span class=nv>meow-next-symbol</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;f&#34;</span> <span class=o>.</span> <span class=nv>meow-find</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;g&#34;</span> <span class=o>.</span> <span class=nv>meow-cancel-selection</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;G&#34;</span> <span class=o>.</span> <span class=nv>meow-grab</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;h&#34;</span> <span class=o>.</span> <span class=nv>meow-left</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;H&#34;</span> <span class=o>.</span> <span class=nv>meow-left-expand</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;i&#34;</span> <span class=o>.</span> <span class=nv>meow-insert</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;I&#34;</span> <span class=o>.</span> <span class=nv>meow-open-above</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;j&#34;</span> <span class=o>.</span> <span class=nv>meow-next</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;J&#34;</span> <span class=o>.</span> <span class=nv>meow-next-expand</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;k&#34;</span> <span class=o>.</span> <span class=nv>meow-prev</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;K&#34;</span> <span class=o>.</span> <span class=nv>meow-prev-expand</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;l&#34;</span> <span class=o>.</span> <span class=nv>meow-right</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;L&#34;</span> <span class=o>.</span> <span class=nv>meow-right-expand</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;m&#34;</span> <span class=o>.</span> <span class=nv>meow-join</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;n&#34;</span> <span class=o>.</span> <span class=nv>meow-search</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;o&#34;</span> <span class=o>.</span> <span class=nv>meow-block</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;O&#34;</span> <span class=o>.</span> <span class=nv>meow-to-block</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;p&#34;</span> <span class=o>.</span> <span class=nv>meow-yank</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;q&#34;</span> <span class=o>.</span> <span class=nv>meow-quit</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;Q&#34;</span> <span class=o>.</span> <span class=nv>meow-goto-line</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;r&#34;</span> <span class=o>.</span> <span class=nv>meow-replace</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;R&#34;</span> <span class=o>.</span> <span class=nv>meow-swap-grab</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;s&#34;</span> <span class=o>.</span> <span class=nv>meow-kill</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;t&#34;</span> <span class=o>.</span> <span class=nv>meow-till</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;u&#34;</span> <span class=o>.</span> <span class=nv>undo</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;U&#34;</span> <span class=o>.</span> <span class=nv>undo-redo</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=c1>;; &#39;(&#34;u&#34; . meow-undo)</span>
</span></span><span class=line><span class=cl>   <span class=c1>;; &#39;(&#34;U&#34; . meow-undo-in-selection)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;v&#34;</span> <span class=o>.</span> <span class=nv>meow-visit</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;w&#34;</span> <span class=o>.</span> <span class=nv>meow-mark-word</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;W&#34;</span> <span class=o>.</span> <span class=nv>meow-mark-symbol</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;x&#34;</span> <span class=o>.</span> <span class=nv>meow-line</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;X&#34;</span> <span class=o>.</span> <span class=nv>meow-goto-line</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;y&#34;</span> <span class=o>.</span> <span class=nv>meow-save</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;Y&#34;</span> <span class=o>.</span> <span class=nv>meow-sync-grab</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;z&#34;</span> <span class=o>.</span> <span class=nv>meow-pop-selection</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;&#39;&#34;</span> <span class=o>.</span> <span class=nv>repeat</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;&lt;escape&gt;&#34;</span> <span class=o>.</span> <span class=nv>mode-line-other-buffer</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;after-init-hook</span> <span class=ss>&#39;meow-setup</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=meow-mode-state class=headerLink><a href=#meow-mode-state class=header-mark></a>meow-mode-state</h4><p>Meow 中可以在不同的 major mode 中启用不同的状态。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>meow-global-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>meow-use-clipboard</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;meow-mode-state-list</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>netease-cloud-music-mode</span> <span class=o>.</span> <span class=nv>motion</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;meow-mode-state-list</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>osx-dictionary-mode</span> <span class=o>.</span> <span class=nv>motion</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;meow-mode-state-list</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>stock-tracker-mode</span> <span class=o>.</span> <span class=nv>motion</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;meow-mode-state-list</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>elfeed-show-mode</span> <span class=o>.</span> <span class=nv>normal</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;meow-mode-state-list</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>elfeed-summary-mode</span> <span class=o>.</span> <span class=nv>motion</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;meow-mode-state-list</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>helpful-mode</span> <span class=o>.</span> <span class=nv>normal</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;meow-mode-state-list</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>calibredb-search-mode</span> <span class=o>.</span> <span class=nv>motion</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;meow-mode-state-list</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>Info-mode-hook</span> <span class=o>.</span> <span class=nv>motion</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>;; (advice-add &#39;org-edit-special :after &#39;meow-insert)</span>
</span></span></code></pre></div><h3 id=one-key-and-meow-leader-define-key class=headerLink><a href=#one-key-and-meow-leader-define-key class=header-mark></a>one-key and meow-leader-define-key</h3><p>默认不弹出 one-key 的菜单，当不知道的时候，使用 <code>?</code> 触发。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>require</span> <span class=ss>&#39;one-key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>one-key-popup-window</span> <span class=no>nil</span><span class=p>)</span>
</span></span></code></pre></div><p>meow-leader-define-key 不要绑定 leader 键在 <code>c</code> <code>m</code> <code>g</code> 上，这几个键在 <code>Meow</code> 中被保留。也不要绑定在 <code>k</code> 上，在 magit 中 <code>SPC k</code> 会触发 magit-discard 。</p><h4 id=key-a-for-org-agenda class=headerLink><a href=#key-a-for-org-agenda class=header-mark></a>key &ldquo;a&rdquo; for org-agenda</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>meow-leader-define-key</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;a&#34;</span> <span class=o>.</span> <span class=nv>my/org-agenda</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=key-b-for-bibtex class=headerLink><a href=#key-b-for-bibtex class=header-mark></a>key &ldquo;b&rdquo; for bibtex</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>one-key-create-menu</span>
</span></span><span class=line><span class=cl> <span class=s>&#34;BIBTEX&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>&#39;</span><span class=p>(((</span><span class=s>&#34;a&#34;</span> <span class=o>.</span> <span class=s>&#34;Actions&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>orb-note-actions</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;o&#34;</span> <span class=o>.</span> <span class=s>&#34;open&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>consult-bibtex-open-any</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;e&#34;</span> <span class=o>.</span> <span class=s>&#34;entry&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>consult-bibtex-show-entry</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;g&#34;</span> <span class=o>.</span> <span class=s>&#34;refresh&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>citar-refresh</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;n&#34;</span> <span class=o>.</span> <span class=s>&#34;note&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>my/edit-notes</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;x&#34;</span> <span class=o>.</span> <span class=s>&#34;extract annots&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>my/extract-pdf-annots-to-ref-note</span><span class=p>))</span>
</span></span><span class=line><span class=cl> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>meow-leader-define-key</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;b&#34;</span> <span class=o>.</span> <span class=nv>one-key-menu-bibtex</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=key-d-for-directory class=headerLink><a href=#key-d-for-directory class=header-mark></a>key &ldquo;d&rdquo; for directory</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>one-key-create-menu</span>
</span></span><span class=line><span class=cl> <span class=s>&#34;DIRECTORY&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>&#39;</span><span class=p>(((</span><span class=s>&#34;c&#34;</span> <span class=o>.</span> <span class=s>&#34;Cloud&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span> <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span> <span class=p>(</span><span class=nv>dired</span> <span class=s>&#34;~/Nextcloud/&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;d&#34;</span> <span class=o>.</span> <span class=s>&#34;Downloads&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span> <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span> <span class=p>(</span><span class=nv>dired</span> <span class=s>&#34;~/Downloads/&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;p&#34;</span> <span class=o>.</span> <span class=s>&#34;Pictures&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span> <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span> <span class=p>(</span><span class=nv>dired</span> <span class=s>&#34;~/Pictures/&#34;</span><span class=p>))))</span>
</span></span><span class=line><span class=cl> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>meow-leader-define-key</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;d&#34;</span> <span class=o>.</span> <span class=nv>one-key-menu-directory</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=key-f-for-file class=headerLink><a href=#key-f-for-file class=header-mark></a>key &ldquo;f&rdquo; for file</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>one-key-create-menu</span>
</span></span><span class=line><span class=cl> <span class=s>&#34;FILE&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>&#39;</span><span class=p>(((</span><span class=s>&#34;f&#34;</span> <span class=o>.</span> <span class=s>&#34;FINANCE&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>one-key-menu-beancount</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;r&#34;</span> <span class=o>.</span> <span class=s>&#34;recent&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>consult-recent-file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;o&#34;</span> <span class=o>.</span> <span class=s>&#34;open&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>one-key-menu-specific-file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;e&#34;</span> <span class=o>.</span> <span class=s>&#34;External&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>xah-html-open-in-safari</span><span class=p>))</span>
</span></span><span class=line><span class=cl> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>meow-leader-define-key</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;f&#34;</span> <span class=o>.</span> <span class=nv>one-key-menu-file</span><span class=p>))</span>
</span></span></code></pre></div><ul><li><p>one-key-menu-specific-file</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>one-key-create-menu</span>
</span></span><span class=line><span class=cl> <span class=s>&#34;SPECIFIC-FILE&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>&#39;</span><span class=p>(((</span><span class=s>&#34;b&#34;</span> <span class=o>.</span> <span class=s>&#34;Blog file&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span> <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span> <span class=p>(</span><span class=nv>find-file</span> <span class=s>&#34;~/hugo-source/content-org/all-posts.org&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;I&#34;</span> <span class=o>.</span> <span class=s>&#34;README.org&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span> <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span> <span class=p>(</span><span class=nv>find-file</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;README.org&#34;</span> <span class=nv>user-emacs-directory</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;i&#34;</span> <span class=o>.</span> <span class=s>&#34;Inbox&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span> <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span> <span class=p>(</span><span class=nv>find-file</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;daily/inbox.org&#34;</span> <span class=nv>my-galaxy</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;r&#34;</span> <span class=o>.</span> <span class=s>&#34;rss&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span> <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span> <span class=p>(</span><span class=nv>find-file</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;main/elfeed.org&#34;</span> <span class=nv>my-roam</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;g&#34;</span> <span class=o>.</span> <span class=s>&#34;gtd&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span> <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span> <span class=p>(</span><span class=nv>find-file</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;todos/org-gtd-tasks.org&#34;</span> <span class=nv>my-galaxy</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;a&#34;</span> <span class=o>.</span> <span class=s>&#34;alipay&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span> <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span> <span class=p>(</span><span class=nv>find-file</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;alipay.bean&#34;</span> <span class=nv>my-finance-year</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;m&#34;</span> <span class=o>.</span> <span class=s>&#34;Beancount main&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span> <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span> <span class=p>(</span><span class=nv>find-file</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;main.bean&#34;</span> <span class=nv>my-finance</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl> <span class=no>t</span><span class=p>)</span>
</span></span></code></pre></div></li></ul><h4 id=key-o-for-org class=headerLink><a href=#key-o-for-org class=header-mark></a>key &ldquo;o&rdquo; for org</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>one-key-create-menu</span>
</span></span><span class=line><span class=cl> <span class=s>&#34;ORG&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>&#39;</span><span class=p>(((</span><span class=s>&#34;c&#34;</span> <span class=o>.</span> <span class=s>&#34;Capture&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>one-key-menu-org-capture</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;d&#34;</span> <span class=o>.</span> <span class=s>&#34;Download&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>one-key-menu-download</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;p&#34;</span> <span class=o>.</span> <span class=s>&#34;Process&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>one-key-menu-org-property</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;P&#34;</span> <span class=o>.</span> <span class=s>&#34;Pomodoro&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-pomodoro</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;l&#34;</span> <span class=o>.</span> <span class=s>&#34;cliplink&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-cliplink</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;i&#34;</span> <span class=o>.</span> <span class=s>&#34;Image&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-toggle-inline-images</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;I&#34;</span> <span class=o>.</span> <span class=s>&#34;Image refresh&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-redisplay-inline-images</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;t&#34;</span> <span class=o>.</span> <span class=s>&#34;Transclusion&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>one-key-menu-transclusion</span><span class=p>))</span>
</span></span><span class=line><span class=cl> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>meow-leader-define-key</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;o&#34;</span> <span class=o>.</span> <span class=nv>one-key-menu-org</span><span class=p>))</span>
</span></span></code></pre></div><ul><li><p>one-key-menu-org-clock</p><p>当 org-mode 被激活后， org-clock 有默认绑定的按键，在 meow 上使用，这些原本需要同时按的按键可以序列化执行，还是很舒服的。困难的是，当长时间没有使用过这个按键后，会忘记默认的按键绑定是什么。</p><p>我原本将 org-clock 上的一些按键绑定在了 <code>SPC o c</code> 上，但是目前我的工作流程严重依赖 org-capture ，所以这个位置需要让出来给它。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>one-key-create-menu</span>
</span></span><span class=line><span class=cl>   <span class=s>&#34;ORG-CLOCK&#34;</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(((</span><span class=s>&#34;i&#34;</span> <span class=o>.</span> <span class=s>&#34;In&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-clock-in</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=p>((</span><span class=s>&#34;o&#34;</span> <span class=o>.</span> <span class=s>&#34;Out&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-clock-out</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=p>((</span><span class=s>&#34;g&#34;</span> <span class=o>.</span> <span class=s>&#34;goto&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-clock-goto</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=p>((</span><span class=s>&#34;l&#34;</span> <span class=o>.</span> <span class=s>&#34;last&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-clock-in-last</span><span class=p>))</span>
</span></span><span class=line><span class=cl>   <span class=no>t</span><span class=p>)</span>
</span></span></code></pre></div></li></ul><ul><li><p>one-key-menu-org-property</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>one-key-create-menu</span>
</span></span><span class=line><span class=cl>     <span class=s>&#34;ORG-PROPERTY&#34;</span>
</span></span><span class=line><span class=cl>     <span class=o>&#39;</span><span class=p>(((</span><span class=s>&#34;i&#34;</span> <span class=o>.</span> <span class=s>&#34;ID&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-id-get-create</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=p>((</span><span class=s>&#34;p&#34;</span> <span class=o>.</span> <span class=s>&#34;Property&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-set-property</span><span class=p>))</span>
</span></span><span class=line><span class=cl>     <span class=no>t</span><span class=p>)</span>
</span></span></code></pre></div></li></ul><ul><li><p>one-key-menu-org-download</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>one-key-create-menu</span>
</span></span><span class=line><span class=cl> <span class=s>&#34;DOWNLOAD&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>&#39;</span><span class=p>(((</span><span class=s>&#34;c&#34;</span> <span class=o>.</span> <span class=s>&#34;clipboard&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-download-clipboard</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;i&#34;</span> <span class=o>.</span> <span class=s>&#34;image&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-download-image</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;r&#34;</span> <span class=o>.</span> <span class=s>&#34;rename&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-download-rename-at-point</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;s&#34;</span> <span class=o>.</span> <span class=s>&#34;screenshot&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-download-screenshot</span><span class=p>))</span>
</span></span><span class=line><span class=cl> <span class=no>t</span><span class=p>)</span>
</span></span></code></pre></div></li></ul><ul><li><p>one-key-menu-org-transclusion</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>one-key-create-menu</span>
</span></span><span class=line><span class=cl> <span class=s>&#34;TRANSCLUSION&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>&#39;</span><span class=p>(((</span><span class=s>&#34;a&#34;</span> <span class=o>.</span> <span class=s>&#34;Add&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-transclusion-add</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;A&#34;</span> <span class=o>.</span> <span class=s>&#34;Add all&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-transclusion-add-all</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;r&#34;</span> <span class=o>.</span> <span class=s>&#34;Remove&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-transclusion-remove</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;R&#34;</span> <span class=o>.</span> <span class=s>&#34;Remove all&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-transclusion-remove-all</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;g&#34;</span> <span class=o>.</span> <span class=s>&#34;Refresh&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-transclusion-refresh</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;m&#34;</span> <span class=o>.</span> <span class=s>&#34;make&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-transclusion-make-from-link</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;o&#34;</span> <span class=o>.</span> <span class=s>&#34;Open&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-transclusion-open-source</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;e&#34;</span> <span class=o>.</span> <span class=s>&#34;Edit&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-transclusion-live-sync-start</span><span class=p>))</span>
</span></span><span class=line><span class=cl> <span class=no>t</span><span class=p>)</span>
</span></span></code></pre></div></li></ul><ul><li><p>one-key-menu-org-capture</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>one-key-create-menu</span>
</span></span><span class=line><span class=cl> <span class=s>&#34;ORG-CAPTURE&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>&#39;</span><span class=p>(((</span><span class=s>&#34;d&#34;</span> <span class=o>.</span> <span class=s>&#34;Diary&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span> <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span> <span class=p>(</span><span class=nv>my/org-capture-shortcut</span> <span class=s>&#34;d&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;t&#34;</span> <span class=o>.</span> <span class=s>&#34;Today tasks&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span> <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span> <span class=p>(</span><span class=nv>my/org-capture-shortcut</span> <span class=s>&#34;tt&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;T&#34;</span> <span class=o>.</span> <span class=s>&#34;Date tasks&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span> <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span> <span class=p>(</span><span class=nv>my/org-capture-shortcut</span> <span class=s>&#34;td&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;i&#34;</span> <span class=o>.</span> <span class=s>&#34;Inbox&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span> <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span> <span class=p>(</span><span class=nv>my/org-capture-shortcut</span> <span class=s>&#34;i&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;r&#34;</span> <span class=o>.</span> <span class=s>&#34;Random note&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span> <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span> <span class=p>(</span><span class=nv>my/org-capture-shortcut</span> <span class=s>&#34;r&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;s&#34;</span> <span class=o>.</span> <span class=s>&#34;Code Snippet&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span> <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span> <span class=p>(</span><span class=nv>my/org-capture-shortcut</span> <span class=s>&#34;s&#34;</span><span class=p>))))</span>
</span></span><span class=line><span class=cl> <span class=no>t</span><span class=p>)</span>
</span></span></code></pre></div></li></ul><h4 id=key-l-for-language class=headerLink><a href=#key-l-for-language class=header-mark></a>key &ldquo;l&rdquo; for language</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>one-key-create-menu</span>
</span></span><span class=line><span class=cl> <span class=s>&#34;LANGUAGE&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>&#39;</span><span class=p>(((</span><span class=s>&#34;t&#34;</span> <span class=o>.</span> <span class=s>&#34;Translate&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>gts-do-translate</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;f&#34;</span> <span class=o>.</span> <span class=s>&#34;Fanyi Point&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>fanyi-dwim2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;F&#34;</span> <span class=o>.</span> <span class=s>&#34;Fanyi Input&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>fanyi-dwim</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;d&#34;</span> <span class=o>.</span> <span class=s>&#34;Dictionary Point&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>osx-dictionary-search-pointer</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;D&#34;</span> <span class=o>.</span> <span class=s>&#34;Dictionary Input&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>osx-dictionary-search-input</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;t&#34;</span> <span class=o>.</span> <span class=s>&#34;Thesaurus&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>powerthesaurus-lookup-dwim</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;s&#34;</span> <span class=o>.</span> <span class=s>&#34;Style region&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>smog-check</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;S&#34;</span> <span class=o>.</span> <span class=s>&#34;Style buffer&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>smog-check-buffer</span><span class=p>))</span>
</span></span><span class=line><span class=cl> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>meow-leader-define-key</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;l&#34;</span> <span class=o>.</span> <span class=nv>one-key-menu-language</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=key-r-for-org-roam class=headerLink><a href=#key-r-for-org-roam class=header-mark></a>key &ldquo;r&rdquo; for org-roam</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>one-key-create-menu</span>
</span></span><span class=line><span class=cl> <span class=s>&#34;ROAM&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>&#39;</span><span class=p>(((</span><span class=s>&#34;a&#34;</span> <span class=o>.</span> <span class=s>&#34;Alias&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>one-key-menu-roam-alias</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;b&#34;</span> <span class=o>.</span> <span class=s>&#34;Roam Buffer&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>my/org-roam-buffer-turn-on-off</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;c&#34;</span> <span class=o>.</span> <span class=s>&#34;Roam capture&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-roam-capture</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;d&#34;</span> <span class=o>.</span> <span class=s>&#34;Dailies&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>one-key-menu-roam-dailies</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;e&#34;</span> <span class=o>.</span> <span class=s>&#34;Extract&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-roam-extract-subtree</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;f&#34;</span> <span class=o>.</span> <span class=s>&#34;Node find&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-roam-node-find</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;i&#34;</span> <span class=o>.</span> <span class=s>&#34;Node insert&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-roam-node-insert</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;m&#34;</span> <span class=o>.</span> <span class=s>&#34;Remark&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>one-key-menu-remark</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;s&#34;</span> <span class=o>.</span> <span class=s>&#34;Search content&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>bms/org-roam-rg-search</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;t&#34;</span> <span class=o>.</span> <span class=s>&#34;Tags&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>one-key-menu-roam-tags</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;r&#34;</span> <span class=o>.</span> <span class=s>&#34;Ref&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>one-key-menu-roam-ref</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;u&#34;</span> <span class=o>.</span> <span class=s>&#34;UI&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>one-key-menu-roam-ui</span><span class=p>))</span>
</span></span><span class=line><span class=cl> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>meow-leader-define-key</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;r&#34;</span> <span class=o>.</span> <span class=nv>one-key-menu-roam</span><span class=p>))</span>
</span></span></code></pre></div><ul><li><p>one-key-menu-roam-alias</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>one-key-create-menu</span>
</span></span><span class=line><span class=cl> <span class=s>&#34;ROAM-ALIAS&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>&#39;</span><span class=p>(((</span><span class=s>&#34;a&#34;</span> <span class=o>.</span> <span class=s>&#34;Add&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-roam-alias-add</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;r&#34;</span> <span class=o>.</span> <span class=s>&#34;Remove&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-roam-alias-remove</span><span class=p>))</span>
</span></span><span class=line><span class=cl> <span class=no>t</span><span class=p>)</span>
</span></span></code></pre></div></li></ul><ul><li><p>one-key-menu-roam-dailies</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>one-key-create-menu</span>
</span></span><span class=line><span class=cl> <span class=s>&#34;ROAM-DAILIES&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>&#39;</span><span class=p>(((</span><span class=s>&#34;t&#34;</span> <span class=o>.</span> <span class=s>&#34;Today&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-roam-dailies-find-today</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;y&#34;</span> <span class=o>.</span> <span class=s>&#34;Yesterday&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-roam-dailies-find-yesterday</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;d&#34;</span> <span class=o>.</span> <span class=s>&#34;Directory&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-roam-dailies-find-directory</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;j&#34;</span> <span class=o>.</span> <span class=s>&#34;Date&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-roam-dailies-goto-date</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;p&#34;</span> <span class=o>.</span> <span class=s>&#34;Past Diary&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>my/history-morning-diary</span><span class=p>))</span>
</span></span><span class=line><span class=cl> <span class=no>t</span><span class=p>)</span>
</span></span></code></pre></div></li></ul><ul><li><p>one-key-menu-roam-ref</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>one-key-create-menu</span>
</span></span><span class=line><span class=cl> <span class=s>&#34;ROAM-REF&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>&#39;</span><span class=p>(((</span><span class=s>&#34;a&#34;</span> <span class=o>.</span> <span class=s>&#34;Add&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-roam-ref-add</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;f&#34;</span> <span class=o>.</span> <span class=s>&#34;Find&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-roam-ref-find</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;r&#34;</span> <span class=o>.</span> <span class=s>&#34;Remove&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-roam-ref-remove</span><span class=p>))</span>
</span></span><span class=line><span class=cl> <span class=no>t</span><span class=p>)</span>
</span></span></code></pre></div></li></ul><ul><li><p>one-key-menu-roam-tags</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>one-key-create-menu</span>
</span></span><span class=line><span class=cl> <span class=s>&#34;ROAM-TAGS&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>&#39;</span><span class=p>(((</span><span class=s>&#34;a&#34;</span> <span class=o>.</span> <span class=s>&#34;Add&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-roam-tag-add</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;c&#34;</span> <span class=o>.</span> <span class=s>&#34;Completion&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-roam-tag-completions</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;r&#34;</span> <span class=o>.</span> <span class=s>&#34;Remove&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-roam-tag-remove</span><span class=p>))</span>
</span></span><span class=line><span class=cl> <span class=no>t</span><span class=p>)</span>
</span></span></code></pre></div></li></ul><ul><li><p>one-key-menu-roam-ui</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>one-key-create-menu</span>
</span></span><span class=line><span class=cl> <span class=s>&#34;ROAM-UI&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>&#39;</span><span class=p>(((</span><span class=s>&#34;o&#34;</span> <span class=o>.</span> <span class=s>&#34;Open&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-roam-ui-open</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;l&#34;</span> <span class=o>.</span> <span class=s>&#34;Local&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-roam-ui-node-local</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;z&#34;</span> <span class=o>.</span> <span class=s>&#34;Zome&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-roam-ui-node-zoom</span><span class=p>)))</span>
</span></span></code></pre></div></li></ul><ul><li><p>one-key-menu-remark</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>one-key-create-menu</span>
</span></span><span class=line><span class=cl> <span class=s>&#34;REMARK&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>&#39;</span><span class=p>(((</span><span class=s>&#34;m&#34;</span> <span class=o>.</span> <span class=s>&#34;Mark&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-remark-mark</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;o&#34;</span> <span class=o>.</span> <span class=s>&#34;Open&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-remark-open</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;n&#34;</span> <span class=o>.</span> <span class=s>&#34;Next&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-remark-view-next</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;p&#34;</span> <span class=o>.</span> <span class=s>&#34;Prev&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-remark-view-prev</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;r&#34;</span> <span class=o>.</span> <span class=s>&#34;Remove&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-remark-remove</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;v&#34;</span> <span class=o>.</span> <span class=s>&#34;View&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>org-remark-view</span><span class=p>))</span>
</span></span><span class=line><span class=cl> <span class=no>t</span><span class=p>)</span>
</span></span></code></pre></div></li></ul><h4 id=key-w-for-windows class=headerLink><a href=#key-w-for-windows class=header-mark></a>key &ldquo;w&rdquo; for windows</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>one-key-create-menu</span>
</span></span><span class=line><span class=cl> <span class=s>&#34;WINDOWS&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>&#39;</span><span class=p>(((</span><span class=s>&#34;d&#34;</span> <span class=o>.</span> <span class=s>&#34;Destroy&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>kill-this-buffer</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;h&#34;</span> <span class=o>.</span> <span class=s>&#34;Left&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>windmove-left</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;j&#34;</span> <span class=o>.</span> <span class=s>&#34;Down&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>windmove-down</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;k&#34;</span> <span class=o>.</span> <span class=s>&#34;Up&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>windmove-up</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;l&#34;</span> <span class=o>.</span> <span class=s>&#34;Right&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>windmove-right</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;g&#34;</span> <span class=o>.</span> <span class=s>&#34;Groups&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>one-key-menu-tabs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;e&#34;</span> <span class=o>.</span> <span class=s>&#34;Email&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>mu4e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;r&#34;</span> <span class=o>.</span> <span class=s>&#34;RSS&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>elfeed-summary</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;t&#34;</span> <span class=o>.</span> <span class=s>&#34;Telega&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>telega</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;m&#34;</span> <span class=o>.</span> <span class=s>&#34;Message&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span> <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span> <span class=p>(</span><span class=nv>switch-to-buffer</span> <span class=s>&#34;*Messages*&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;s&#34;</span> <span class=o>.</span> <span class=s>&#34;scratch&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span> <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span> <span class=p>(</span><span class=nv>switch-to-buffer</span> <span class=s>&#34;*scratch*&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;u&#34;</span> <span class=o>.</span> <span class=s>&#34;Winner Undo&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>winner-undo</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;v&#34;</span> <span class=o>.</span> <span class=s>&#34;vundo&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>vundo</span><span class=p>))</span>
</span></span><span class=line><span class=cl> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>meow-leader-define-key</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;w&#34;</span> <span class=o>.</span> <span class=nv>one-key-menu-windows</span><span class=p>))</span>
</span></span></code></pre></div><ul><li><p>one-key-menu-tab</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>one-key-create-menu</span>
</span></span><span class=line><span class=cl> <span class=s>&#34;TABS&#34;</span>
</span></span><span class=line><span class=cl> <span class=o>&#39;</span><span class=p>(((</span><span class=s>&#34;e&#34;</span> <span class=o>.</span> <span class=s>&#34;Emacs&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span> <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span> <span class=p>(</span><span class=nv>centaur-tabs-switch-group</span> <span class=s>&#34;Emacs&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;o&#34;</span> <span class=o>.</span> <span class=s>&#34;Org&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span> <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span> <span class=p>(</span><span class=nv>centaur-tabs-switch-group</span> <span class=s>&#34;OrgMode&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>   <span class=p>((</span><span class=s>&#34;p&#34;</span> <span class=o>.</span> <span class=s>&#34;Pdf&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span> <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span> <span class=p>(</span><span class=nv>centaur-tabs-switch-group</span> <span class=s>&#34;PDF&#34;</span><span class=p>))))</span>
</span></span><span class=line><span class=cl> <span class=no>t</span><span class=p>)</span>
</span></span></code></pre></div></li></ul><h4 id=key-t-for-tools class=headerLink><a href=#key-t-for-tools class=header-mark></a>key &ldquo;t&rdquo; for tools</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>one-key-create-menu</span>
</span></span><span class=line><span class=cl>   <span class=s>&#34;TOOLS&#34;</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(((</span><span class=s>&#34;o&#34;</span> <span class=o>.</span> <span class=s>&#34;Outline&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>consult-outline</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=p>((</span><span class=s>&#34;m&#34;</span> <span class=o>.</span> <span class=s>&#34;Menu&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>my/imenu-list-on-off</span><span class=p>))</span>
</span></span><span class=line><span class=cl>   <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>meow-leader-define-key</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;t&#34;</span> <span class=o>.</span> <span class=nv>one-key-menu-tools</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=one-key-for-blog class=headerLink><a href=#one-key-for-blog class=header-mark></a>one key for blog</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>one-key-create-menu</span>
</span></span><span class=line><span class=cl>   <span class=s>&#34;BLOG&#34;</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(((</span><span class=s>&#34;h&#34;</span> <span class=o>.</span> <span class=s>&#34;Easy hugo&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>easy-hugo</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=p>((</span><span class=s>&#34;n&#34;</span> <span class=o>.</span> <span class=s>&#34;New post&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>easy-hugo-newpost</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=p>((</span><span class=s>&#34;g&#34;</span> <span class=o>.</span> <span class=s>&#34;Magit&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>easy-hugo-magit</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=p>((</span><span class=s>&#34;p&#34;</span> <span class=o>.</span> <span class=s>&#34;note&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>easy-hugo-preview</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=p>((</span><span class=s>&#34;t&#34;</span> <span class=o>.</span> <span class=s>&#34;Tags&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=nv>easy-hugo-complete-tags</span><span class=p>))</span>
</span></span><span class=line><span class=cl>   <span class=no>t</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=benchmark class=headerLink><a href=#benchmark class=header-mark></a>Benchmark</h3><p>Emacs Keybindings 启动时间约 0.05s 。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nf>message</span> <span class=s>&#34;Emacs Keybindings: %.2fs&#34;</span>
</span></span><span class=line><span class=cl>	 <span class=p>(</span><span class=nf>float-time</span> <span class=p>(</span><span class=nf>time-subtract</span> <span class=p>(</span><span class=nf>current-time</span><span class=p>)</span> <span class=nv>my/section-start-time</span><span class=p>)))</span>
</span></span></code></pre></div><p>Emacs 总计启动时间约 0.66s (+ 0.13 system time) 。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>init-time</span> <span class=p>(</span><span class=nf>float-time</span> <span class=p>(</span><span class=nf>time-subtract</span> <span class=p>(</span><span class=nf>current-time</span><span class=p>)</span> <span class=nv>my/init-start-time</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>total-time</span> <span class=p>(</span><span class=nf>string-to-number</span> <span class=p>(</span><span class=nv>emacs-init-time</span> <span class=s>&#34;%f&#34;</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>message</span> <span class=s>&#34;Initialization time: %.2fs  (+ %.2f system time)&#34;</span>
</span></span><span class=line><span class=cl>	   <span class=nv>init-time</span> <span class=p>(</span><span class=nf>-</span> <span class=nv>total-time</span> <span class=nv>init-time</span><span class=p>)))</span>
</span></span></code></pre></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>更新于 2022-05-13</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=# onclick=return!1 title="分享到 Twitter" data-sharer=twitter data-url=http://example.org/posts/emacs-configuration/ data-title="Jousimies's Personal Emacs Configuration" data-hashtags=Emacs,Org-mode><i class="fab fa-twitter fa-fw"></i></a><a href=# onclick=return!1 title="分享到 Reddit" data-sharer=reddit data-url=http://example.org/posts/emacs-configuration/><i class="fab fa-reddit fa-fw"></i></a><a href=# onclick=return!1 title="分享到 Evernote" data-sharer=evernote data-url=http://example.org/posts/emacs-configuration/ data-title="Jousimies's Personal Emacs Configuration"><i class="fab fa-evernote fa-fw"></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/emacs/>Emacs</a>,&nbsp;<a href=/tags/org-mode/>Org-mode</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/posts/emacs-%E4%B8%AD-org-mode-%E6%96%87%E6%A1%A3%E7%BC%96%E8%AF%91-pdf-%E7%9A%84%E5%9F%BA%E6%9C%AC%E8%AE%BE%E7%BD%AE/ class=prev rel=prev title="Emacs 中 org-mode 文档编译 PDF 的基本设置"><i class="fas fa-angle-left fa-fw"></i>Emacs 中 org-mode 文档编译 PDF 的基本设置</a>
<a href=/posts/%E7%AE%97%E6%B3%95/ class=next rel=next title=算法>算法<i class="fas fa-angle-right fa-fw"></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>由 <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.97.3">Hugo</a> 强力驱动&nbsp;|&nbsp;主题 - <a href=https://github.com/HEIGE-PCloud/DoIt target=_blank rel="noopener noreffer" title="DoIt 0.2.13"><i class="far fa-edit fa-fw"></i> DoIt</a></div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2022</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank rel="noopener noreferrer">Jousimies</a></span></div><div class=footer-line></div><div class=footer-line></div></div></footer></div><div id=fixed-buttons><a href=#back-to-top id=back-to-top-button class=fixed-button title=回到顶部><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title=查看评论><i class="fas fa-comment fa-fw"></i></a></div><div class=assets><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lunr/lunr.stemmer.support.min.js></script><script type=text/javascript src=/lib/lunr/lunr.zh.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/topbar/topbar.min.js></script><script type=text/javascript src=/lib/pjax/pjax.min.js></script><script type=text/javascript src=/js/theme.min.js defer></script></div><div class=pjax-assets><script type=text/javascript>window.config={code:{copyTitle:"复制到剪贴板",maxShownLines:10},comment:{},search:{highlightTag:"em",lunrIndexURL:"/index.json",lunrLanguageCode:"zh",lunrSegmentitURL:"/lib/lunr/lunr.segmentit.js",maxResultLength:10,noResultsFound:"没有找到结果",snippetLength:50,type:"lunr"},sharerjs:!0}</script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script></div></body></html>